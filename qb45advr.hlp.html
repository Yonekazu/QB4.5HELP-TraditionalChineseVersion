<!DOCTYPE html>
<html lang="zh-TW">
<head>
<title>QB4.5繁體中文版幫助文檔</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="QB45幫助文檔繁體中文版" />
<meta name="keywords" content="QB45,幫助文檔,繁體中文版" />
<meta name="author" content="yonekazu" />
<style type="text/css">
body {
  margin: 0;
  padding: 20px;
  background-color: #000;
  color: #aaa;
  font-family: "PMingLiU", "SimSun", sans-serif, monospace;
  font-size: 16px;
  line-height: 18px;
}

pre {
  font-family: "PMingLiU", "SimSun", sans-serif, monospace;
}

a:link, a:visited, a:active {
  color: inherit;
  text-decoration: none;
}

a:hover, a:focus {
  text-decoration: underline;
  outline: none;
}

.menu, .QBtitle {
  background-color: #aaa;
  color: #000;
}

.QH_1 { /*Bold*/
  color: #fff;
}

.QH_2 { /*Italic*/
  color: #0a0;
}

.container, .QBwin {
  position: relative;
  width: 640px;
  margin: 0 auto;
}

.QBwin {
  padding: 0;
}

.QBtitle {
  padding: 0 16px;
  display: block; 
  width: fit-content; 
  margin: 0 auto;
}
</style>
</head>   
<body><div class="container"><div class="QBwin"><pre>
<span id="L8000" class="QBtitle">使用 QuickBASIC</span>
<span class="QH_1">使用 QuickBASIC</span>

在螢幕左邊的關係鏈項目,為說明如何使用 QuickBASIC 的一般主題。

<span class="QH_1">主題                         摘要</span>

<span class="QH_2">&lt;</span><a href="#L820B"> 簡化鍵摘要 </a><span class="QH_2">&gt;</span>               為一個按鍵的組合表,是 QuickBASIC 所能辨認
                             的命令。某些鍵的組合等於 QuickBASIC 功能表
                             內的命令;但其他執行命令不包括在功能表中。

<span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D2"> 中文版使用時應注意的事項 </a><span class="QH_2">&gt;</span> 說明 QuickBASIC 中文版內有些函數或敘述
                             在使用時應注意的事項。

<span class="QH_2">&lt;</span><a href="#L8215"> QuickBASIC 的限制 </a><span class="QH_2">&gt;</span>        QuickBASIC 可以處理的最大及最小的範圍和值。

<span class="QH_2">&lt;</span><a href="#L8008"> 4.5 版的差異 </a><span class="QH_2">&gt;</span>             比較 QuickBASIC 4.5 版的新功能與 2.0, 3.0
                             和 4.0 版本的差異。

<span class="QH_2">&lt;</span><a href="#L8003"> QB 命令行的選擇項 </a><span class="QH_2">&gt;</span>        顯示啟動 QuickBASIC 時,所有可以在 QB 命令行
                             以後使用的選擇項。

<span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8000"> 使用指南 </a><span class="QH_2">&gt;</span>                 是摘要如何在 QuickBASIC 功能表,交談框和視窗
                             中使用鍵盤和滑鼠。


<hr>

<span id="L8001" class="QBtitle">BASIC 程式語言</span>
<span class="QH_1">BASIC 程式語言</span>

在螢幕左邊的關係鏈項目,用來說明 BASIC 程式語言設計的相關訊息。

<span class="QH_1">主題                           摘要</span>

<span class="QH_2">&lt;</span><a href="#L821B"> 關鍵字清單 </a><span class="QH_2">&gt;</span>                 根據一般程式任務,例如:建立一個迴圈,定義一個
                               程序式,由鍵盤輸入資料,或者將資料寫入一個
                               檔案中等等,來將大部份的 BASIC 關鍵字
                               加以分類。

<span class="QH_2">&lt;</span><a href="#L821A"> 語法表示符號 </a><span class="QH_2">&gt;</span>               顯示如何在線上援助中閱讀 BASIC 語言關鍵字
                               的語法訊息。

<span class="QH_2">&lt;</span><a href="#L8009"> 基本的程式架構 </a><span class="QH_2">&gt;</span>             說明 BASIC 程式行中字元組成的規則;同時
                               也列出在 BASIC 程式行中具有特殊意義的字元
                               (例如: % , ! , 或 # )。

<span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>                   摘要不同的資料型態和資料結構的優缺點。

<span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a><span class="QH_2">&gt;</span>             顯示如何將程式中的變數組成一個運算式,以用
                               來計算值,比較值,和建立新的畫面。

<span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>               顯示如何將程式本文中簡短且易於瞭解
                               的模組組合成一個程式。

<span class="QH_2">&lt;</span><a href="#L8035"> 精選程式範例 </a><span class="QH_2">&gt;</span>               為一系列 10 到 20 行的程式模組, 這些是
                               程式師常需要做的工作--例如:建立一個資料檔,
                               或寫入一個資料檔。

<span class="QH_2">&lt;</span><a href="#L8223"> ASCII 字元碼 </a><span class="QH_2">&gt;</span>               這些表格顯示程式設計師
<span class="QH_2">&lt;</span><a href="#L8034"> 鍵盤掃描碼 </a><span class="QH_2">&gt;</span>                 在寫程式時,常用到的值。


<hr>

<span id="L8002" class="QBtitle">版權和註冊商標</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8005"> 線上援助 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8008"> 產品支援 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 版權 &gt;</span>
───────────────────────────────────────

                                <span class="QH_1">版權</span>

  Microsoft QuickBASIC 中文版是國內第一套全中文化的 BASIC 語言開發工具。
  由美國微軟公司與國內神通電腦機構,聯強國際機構合作開發。

  在此文件中的資訊可能更動而不另通知,並且 Microsoft 公司亦不具告知的義務
  與責任。在這文件上所描述的軟體 和/或 資料庫皆獲得同意或不公開使用的同意
  聲明。此軟體 和/或 資料庫僅根據以上所同意的約定條件下來使用或拷貝。
  購買者可自行拷貝一份此軟體以供備份之需。本手冊 和/或 資料庫的任何部份
  資料,除了購買者個人使用外,未經 Microsoft 公司的書面同意不得擅自以任何
  方式重製或轉載, 或以任何的電子或機械的方法,包括照相,錄音或資訊儲存及存取
  系統作為其他目的之使用。

  (C) Copyright Microsoft Corporation, 1985-1991.
      All rights reserved.

  Microsoft(R), MS(R), MS-DOS(R),CodeView(R),和 Xenix(R) 皆為註冊商標。

  Microsoft 文件中使用的術語: "OS/2" 是參考到 OS/2 systems -
  Microsoft(R) Operating System/2 (MS(R)OS/2) 和 IBM(R) OS/2。
  同樣地, 術語 "DOS" 是參考到 MS-DOS(R) 和 IBM PC DOS 作業系統。
  特定作業系統的名稱在必須註明某特性是那一系統所特有的時候才使用的。

  IBM(R) 是 IBM 公司 (International Business Machines corporation)
  的註冊商標。

  Hercules(R) 為 Hercules 電腦科技公司的註冊商標
  及 Hercules(R) Incolor Card(TM) 是該公司的商標。

  Intel(R) 是 Intel 公司的註冊商標。

  PC/AT(R), PC/XT(R), 和  PS/2(R) 是 IBM 公司的註冊商標。

  Tandy(R) 是 Tandy 公司的註冊商標。

  UNIX(R) 是 AT&T 貝爾實驗室的註冊商標 。


<hr>

<span id="L8003" class="QBtitle">QuickBASIC 命令行</span>
  <span class="QH_1">&lt; QuickBASIC 命令行 &gt;</span>         <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內 容 </a><span class="QH_2">&gt;</span>          <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 命令行的選擇項</span>

QB 命令行的完整語法如下 :

QB [/RUN[程式名稱]] [/B] [/C:緩衝區大小] [/L[程式庫名稱]] [MBF] [/AH]
   [/CMD 字串]

這些選擇項可在 DOS 命令列(command line)下緊跟在 QB 命令之後鍵入, 並產生
如下述之作用 。使用這些選擇項時,請依其所列之順序使用 。

<span class="QH_1">選擇項              說  明</span>

/RUN[程式名稱]      啟動 QuickBASIC 以後,同時將程式檔載入到記憶體內,
                    並且執行。

程式名稱            為啟動 QuickBASIC 時,所要載入的程式檔案名稱。

/B                  允許在彩色繪圖卡上, 使用黑白兩色所組成的顯示器。
                    假如您有彩色螢幕,則 /B 選擇項會使 QuickBASIC 工作
                    環境螢幕以黑白畫面顯示。

/C:緩衝區大小       設定接收資料緩衝區的大小。此一選擇項只能用在非同步
                    通訊卡(asynchronous communications card)上。預設的
                    緩衝區最小為 512 位元組,最大為 32,767 位元組。

/L[程式庫名稱]      所載入的 Quick 程式庫檔名。假如未指定程式庫名稱時,
                    則預設的 Quick 程式庫(QB.QLB) 將被載入。

/MBF                使得 QuickBASIC 的轉換功能,能將 "IEEE-格式" 視為
                    "Microsoft 二進位格式" 的數值。

/AH                 允許型態為記錄,固定長度字串和數值資料的動態陣列
                    大於 64K 位元組。

/CMD 字串           將字串傳到 COMMAND$ 函數內。此選擇項必須是命令行
                    的最後一個選擇項。


<hr>

<span id="L8004" class="QBtitle">SCREEN 模式 0 (僅適用本文)</span>
                <span class="QH_1">MGA, EGA, 或 VGA 轉接板</span>

SCREEN 0: 僅適用本文模式(Text Mode)
  * 25 列(row) x 80 行(column)的本文格式。
  * 對 MGA, EGA 而言,字元框大小為 8 x 15; 而 VGA 為 8 x 18。
  * 256K 種顏色提供給調色盤內 16 個顏色屬性暫存器(color attributes)
    使用( VGA 適用 )。
  * 64 種顏色提供給調色盤內 16 個顏色屬性暫存器使用( EGA 適用 )。


<hr>

<span id="L8005" class="QBtitle">SCREEN 模式 3, 80 和 82</span>
                 <span class="QH_1">EGA 或 VGA 轉接板</span>

SCREEN 0, 3: 本文模式(Text Mode)適用
  * 25 列(row) x 80 行(column)的本文格式。
  * 對 EGA 而言,字元框為 8 x 15; 而 VGA 為 8 x 18。
  * 256K 種顏色提供給調色盤內 16 個顏色屬性暫存器(color attributes)
    使用( VGA 適用 )。
  * 64 種顏色提供給調色盤內 16 個顏色屬性暫存器使用( EGA 適用 )。

SCREEN 80: EGA 繪圖模式(Graphic Mode)適用
  * 640(橫向座標) x 375(縱向座標)的繪圖區域。
  * 25 列 x 80 行的本文格式,字元框大小為 8 x 15。
  * 64 種顏色提供給調色盤內 16 個顏色屬性暫存器使用。

SCREEN 82: VGA 繪圖模式適用
  * 640(橫向座標) x 450(縱向座標)的繪圖區域。
  * 25 列 x 80 行的本文格式,字元框大小為 8 x 18。
  * 256K 種顏色提供給調色盤內 16 個顏色屬性暫存器使用。


<hr>

<span id="L8006" class="QBtitle">SCREEN 模式 7, 71</span>
                  <span class="QH_1">MGA 轉接板</span>

SCREEN 0,7: 本文模式(Text Mode)適用
  * 25 列(row) x 80 行(column)的本文格式,字元框大小為 8 x 15。

SCREEN 71: 繪圖模式(Graphic Mode)適用
  * 640(橫向座標) x 375(縱向座標)的繪圖區域。
  * 25 列 x 80 行的本文格式,字元框大小為 8 x 15。



<hr>

<span id="L8007" class="QBtitle">搜尋鍵</span>
<span class="QH_1"> &lt; 搜尋鍵 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
─────────────────搜  尋  鍵─────────────────
     搜尋所指定的(反白)本文                                    Ctrl+\
     重覆上一次找尋的本文                                         F3


<hr>

<span id="L8008" class="QBtitle">4.5 版本的差異</span>
  <span class="QH_1">&lt; 4.5 版本的差異 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 4.5 版與先前各版本的差異</span>

此以英文版為主,說明與前面各版本之間的差異性。

                                          QuickBASIC 版 本
功能                           2.0          3.0           4.0          4.5
                            ─────────────────────────

QB Advisor 線上援助             沒有         沒有          沒有        有
(細節的參考)
選擇滑鼠右鍵的功能              沒有         沒有          沒有        有
變數和運算式的立即監看          沒有         沒有          沒有        有
設定預設的搜尋路徑              沒有         沒有          沒有        有
使用者自定型態                  沒有         沒有          有          有
IEEE 格式,數學輔助處理器        沒有         有            有          有
線上援助                        沒有         沒有          有          有
長整數 (32位元(bit))            沒有         沒有          有          有
固定長度的字串                  沒有         沒有          有          有
輸入時的語法檢查                沒有         沒有          有          有
二進位檔的輸入/輸出             沒有         沒有          有          有
FUNCTION 程序式                 沒有         沒有          有          有
提供 Code View 功能             沒有         沒有          有          有
與其他語言的相容性              沒有         沒有          有          有
在主記憶體中的多重模組          沒有         沒有          有          有
ProKey, SideKick, 和            沒有         有            有          有
SuperKey 的相容性
插入/覆蓋(overtypes)模式        沒有         有            有          有
WordStar 型態的鍵盤介面         沒有         沒有          有          有
遞迴(recursion)                 沒有         沒有          有          有
獨立編譯時的錯誤列印            沒有         有            有          有
獨立編譯時的組合語言程式列印    沒有         有            有          有


注意 : QuickBASIC 中文版下,對於浮點算術運算是不理會數學輔助處理器的存在,
       一律採用軟體程式來模擬。


<span class="QH_1">QuickBASIC 4.5 版的新特性</span>

現在,您可以使用線上援助功能來查詢有關 QuickBASIC 的關鍵字,命令和功能表,
以及一般的程式設計主題和您所使用的變數。在援助畫面上所顯示的範例程式可以
被複製,並且直接剪貼到您的程式中,以減少程式發展的時間。

對滑鼠的使用者而言,現在您可以利用 "O/選用功能" 功能表的 "滑鼠右鍵" 命令
來設定滑鼠右鍵的功能。您可以選用最適合的功能。

為了快速偵錯, QuickBASIC 提供了立即監看命令,以便立即指出變數的值,或一個
運算式的條件(真或假)。

4.5 版也讓您對 QuickBASIC 工作環境下所使用到特定型態的檔案,來設定
預設的搜尋路徑。這可使您根據檔案的型態來組織您的檔案,並將他們儲存
在個別的目錄中。QuickBASIC 在您設定新的預設搜尋路徑後,將會找尋正確
的目錄。您可以對執行檔,內含檔,程式庫和援助檔設定預定的搜尋路徑。


<hr>

<span id="L8009" class="QBtitle">BASIC 語言的基本架構</span>
  <span class="QH_1">&lt; 語言的基本架構 &gt;</span>            <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>               <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">語 言 的 元 素</span>

標記(labels),關鍵字(keywords),變數(variables),和運算子(operators)是
由 BASIC 字元集(character set)的字元(characters)所組成。先由標記,變數,
關鍵字和運算子組成一個敘述;再由許多的敘述組成一個程式。

以下所列的主題包含更多有關 BASIC 基本元素的資訊:

  <span class="QH_1">BASIC 主題                          摘要</span>
  <span class="QH_2">&lt;</span><a href="#L800A"> 字元集 </a><span class="QH_2">&gt;</span>                          使用在 BASIC 的字元
  <span class="QH_2">&lt;</span><a href="#L800B"> 程式行 </a><span class="QH_2">&gt;</span>                          BASIC 程式行的語法
  <span class="QH_2">&lt;</span><a href="#L800C"> 敘述 </a><span class="QH_2">&gt;</span>                            BASIC 敘述型態


<hr>

<span id="L800A" class="QBtitle">語言的基本架構:字元集</span>
  <span class="QH_2">&lt;</span><a href="#L8009"> 語言的基本架構 </a><span class="QH_2">&gt;</span>        <span class="QH_1">&lt; 字元集 &gt;</span>        <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>        <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">語言的元素 : BASIC 字元集(Character Set)</span>

Microsoft BASIC 的字元集包含字母字元(A-Z, a-z),數值字元 (0-9 和 十六進制的
數值 A-F 或 a-f ),和特殊字元。下列字元在 BASIC 中有特殊的意義:

     字元           意義

     ENTER          輸入行的結束
     _              換行的繼續符號 (底線)

     <span class="QH_1">資料型態的後置字元</span>
     !              單精確度資料型態的後置符號
     #              倍精確度資料型態的後置符號
     $              字串資料型態的後置符號
     %              整數資料型態的後置符號
     &              長整數資料型態的後置符號

     <span class="QH_1">數學特殊字元</span>
     *              乘法符號
     +              加法符號
     -              減法符號
     .              小數點
     /              除法符號(斜線)
     &lt;              小於
     =              關係運算子(relational operator)或指定符號
     &gt;              大於
     \              整數除法符號(倒斜線)
     ^              指數符號(向上箭號或補註符號)


<hr>

<span id="L800B" class="QBtitle">語言的基本架構:程式行</span>
  <span class="QH_2">&lt;</span><a href="#L8009"> 語言的基本架構</a> <span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 程式行 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">語言的元素 : BASIC 程式行(Program Line)</span>

所有的 BASIC 程式行有下列的語法:

  [行 識 別 字][敘 述][:敘 述]...[註  解]

<span class="QH_1">行識別字 (Line identifier)</span>

在 BASIC 中一行可能有一個行識別字。BASIC 提供兩種型態的行識別字(在同一個
程式中可以同時使用):

  * <span class="QH_1">(一). 行號 (line numbers)</span>

       * 範圍從 0 到 65,529。
       * 可從任何一欄(column)開始;而且必須是一行(line)中的第一個字元。

       * <span class="QH_1">行號 (範例)</span>:
               200
               300 PRINT "哈囉"       '300 是行號

       * <span class="QH_1">行號 (特別注意)</span>:
            * 不鼓勵以 0 為行號,因為在 ON ERROR, ON 事件 和 RESUME 三種
              敘述中, 0 是有特殊意義的。

            * 在 QuickBASIC 中,行號是不能決定敘述的執行順序。例如,
              QuickBASIC 對下列程式的執行順序是 100, 10, 5 :

                   100 PRINT "第 一 行 被 執 行"
                    10 PRINT "第 二 行 被 執 行"
                     5 PRINT "第三行也是最後一行被執行"

              某些早期的 BASIC 版本,如: BASICA, 其行號必須按照數值的
              順序:5, 10, 100。

  * <span class="QH_1">(二). 文數字的行標記 (Alphanumeric line labels)</span>

       * 1 到 40 個英文字母,和數字所組成。
       * 必須以字母為開頭且以冒號做結束。
       * 不允許使用 BASIC 的關鍵字。
       * 可以在任何一欄(column)開始;但標記必須是這一行(line)中的第一個
         字元。
       * 大小寫沒有區別( alpha: ALPHa: 和 ALPHA: 代表相同的行標記 )。
       * 空白和 TAB 鍵皆允許在標記和冒號之間出現。

       * <span class="QH_1">文數字的行標記 (範例)</span>:
               Alpha:
               ScreenSub:

       * <span class="QH_1">文數字的行標記 (特別注意)</span>:

            *  不能使用在 IF...THEN 敘述中,除非是使用在一個 GOTO 敘述中:

                    IF A = 10 THEN 500     '正確的使用行號

            *  假如 IF...THEN 敘述的分歧目的(Branch destination)是行標記,
               則 GOTO 敘述是需要的:

                   IF A = 10 THEN GOTO IncomeData

<span class="QH_1">BASIC 程式行的長度</span>

  * 在 QuickBASIC 的編輯器內 :
     * QuickBASIC 的內建編輯器所限制的長度為 256 個位元組。
     * 不能使用底線字元 (_) 來當作一行的繼續。

  * 在您自己的編輯器內 :
     * 您可使用底線符號當做是程式行的最後一個符號,以連接下一個程式行,
       如下例:

            IF (TestChar$ = " " OR TestChar$ = ".") AND LineNumber &lt; 23 _
            AND NOT EOF(FileNumber) THEN

     * 當用 QuickBASIC 載入您的程式時,底線符號會被去掉,並且將其連續的
       程式行合併成為一行,此時程式行的長度可能會超過 256 個位元組。

     * 底線不能用來當做 DATA 或 REM 敘述的連續符號。


<hr>

<span id="L800C" class="QBtitle">語言的基本架構: BASIC 敘述</span>
  <span class="QH_2">&lt;</span><a href="#L8009"> 語言的基本架構</a> <span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 敘述 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">語言的元素 : BASIC 敘述(Statements)</span>

一個 BASIC 敘述分成 "可執行",或 "不可執行" 的敘述。

  * 一個可執行敘述,用來告訴程式往下做什麼,使得一個程式邏輯的流向,能夠往前
    推進。(例如:讀取輸入資料,寫入資料,將兩數值相加,並將結果存到一個變數中)。

  * 不可執行敘述並不能控制程式邏輯往前推進的流向。不可執行敘述所能做的事,
    如:配置變數的儲存空間,宣告並定義變數的型態,和標示程序式間共用的變數。

    下列 BASIC 敘述是不可執行的敘述:

         REM 或 '                      DIM (靜態陣列適用)
         COMMON                        OPTION BASE
         CONST                         SHARED
         DATA                          STATIC
         DECLARE                       TYPE...END TYPE
         DEF型態


<hr>

<span id="L800D" class="QBtitle">BASIC 資料型態</span>
  <span class="QH_1">&lt; 資料型態 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">資料型態                  宣告字元         最大             最小</span>
<span class="QH_2">&lt;</span><a href="#L800E"> 字串 </a><span class="QH_2">&gt;</span>                        $          32,767 位元組    0 位元組
<span class="QH_2">&lt;</span><a href="#L800F"> 整數 </a><span class="QH_2">&gt;</span>                        %          32,767          -32,768
<span class="QH_2">&lt;</span><a href="#L800F"> 長整數 </a><span class="QH_2">&gt;</span>                      &          2,147,483,647   -2,147,483,648
<span class="QH_2">&lt;</span><a href="#L8010"> 單精確度 (7位數) </a><span class="QH_2">&gt;</span>            !          ±3.402823 E+38  ±1.401298 E-45
<span class="QH_2">&lt;</span><a href="#L8010"> 倍精確度 (15位數) </a><span class="QH_2">&gt;</span>           #          ±1.7976931 D+308±4.940656 D-324
<span class="QH_2">&lt;</span><a href="#L8011"> 使用者自定資料型態 </a><span class="QH_2">&gt;</span>

可 參 閱  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8041">DEF型態 敘述</a><span class="QH_2">&gt;</span> - 設定預設的資料型態
          <span class="QH_2">&lt;</span><a href="#L8012">變數型態主記憶體的需求</a><span class="QH_2">&gt;</span> -變數型態所需要的主記憶體空間
          <span class="QH_2">&lt;</span><a href="#L8013">常 數</a><span class="QH_2">&gt;</span> -預先設定的值且不會更改
          <span class="QH_2">&lt;</span><a href="#L8014">變 數</a><span class="QH_2">&gt;</span> - 參考到一個元素的名稱
          <span class="QH_2">&lt;</span><a href="#L801C">有效範圍規則</a><span class="QH_2">&gt;</span> - 變數或常數所定義的範圍
          <span class="QH_2">&lt;</span><a href="#L8022">靜態和動態陣列</a><span class="QH_2">&gt;</span> - 陣列儲存的空間
          <span class="QH_2">&lt;</span><a href="#L8023">自動和靜態變數</a><span class="QH_2">&gt;</span> - 變數的啟始化
          <span class="QH_2">&lt;</span><a href="#L8024">型態轉換</a><span class="QH_2">&gt;</span> - BASIC 資料型態之間的轉換


<hr>

<span id="L800E" class="QBtitle">基本的資料型態-字串</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 字串 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">基本的資料型態--字串 (Strings)</span>

字串的型態有兩類:

  * 變動長度的字串 (Variable-length String) :
      一個變動長度的字串是一串至多 32,767 個位元組的字串。這些字元
      正規的 ASCII 碼(美國標準的資訊交換碼)其值是介於 0 和 127 之間。而
      擴充的 ASCII 碼,其值是介於 128 和 255 之間。請參閱<span class="QH_2">&lt;</span><a href="#L8223">ASCII 字元碼表</a><span class="QH_2">&gt;</span>

  * 固定長度字串 (Fixed-length String) :
      一個固定長度字串所包含的位元組數目是依其宣告而定,不能超過 32,767 個
      位元組。
      類似變動長度的字串一樣,一個固定長度字串所包含字元的 ASCII 碼,
      亦是介於 0 和 255 之間。

注意 : 在 QuickBASIC 中文版下已經將這些擴充的 ASCII 碼拿來當成中文碼使用。


<hr>

<span id="L800F" class="QBtitle">基本的資料型態:整數和長整數</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 整數和長整數 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
──────────────────────────────────────
<span class="QH_1">基本的資料型態--整數和長整數 (Integers and Long Integers)</span>

整數是以 16 個位元(bit)(2 個位元組)長度的二進制數值來儲存,其值
介於 -32,768 到 +32,767 之間。

"長" 整數是以有正負符號的 32 個位元(4 個位元組)長度的二進制數值來儲存,
其值介於 -2,147,483,648 到 +2,147,483,647 之間。

所有 BASIC 的整數是以 2 的補數來表示,此種方式是電腦最常用來表示整數的方式。
整數佔用 16 個位元(2 個位元組),而長整數佔用 32 個位元(4 個位元組)。


<hr>

<span id="L8010" class="QBtitle">基本的資料型態-浮點數</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 浮點數 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">資料型態的元素--浮點數 (Floating-Point Numbers)</span>

QuickBASIC 是使用 IEEE 格式的浮點數,而不像早期版本是用 Microsoft 二進制的
格式。使用 IEEE 格式能得到更正確的計算結果,並且適用於數學輔助處理器(例如:
8087, 80287,或 80387)。

浮點數值的格式不同於整數表示方式。每一個浮點數值是由 "正負符號", "指數"
(exponent),和 "數值大小"(mantissa)三個部份所組成的。

在單精確度數(single-precision number)中,正負符號佔一個位元(bit),指數部份
佔 8 個位元,而數值大小部份是使用剩下的 23 個位元,和一個額外的隱含(implied)
位元。至於倍精確度數(double-precision number)佔用 8 個位元組或 64 個位元,
其中正負符號佔 1 個位元,指數部份佔 11 個位元, 1 個隱含位元以及佔 52 個位元
的數值大小部份。

注意 : QuickBASIC 中文版下,對於浮點算術運算是不理會數學輔助處理器的存在,
       一律採用軟體程式來模擬。




<hr>

<span id="L8011" class="QBtitle">使用者自定資料型態</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 使用者自定資料型態 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">使用者自定資料型態 -- User-Defined Data Type</span>

BASIC 允許使用者使用 TYPE 敘述來定義新的資料型態。一個使用者自定型態
是一個由 BASIC 基本資料型態所組合而成的集合型態。例如,下列 TYPE 敘述
定義一個叫做 SymTabEntry 的型態:

  TYPE SymTabEntry
    Identifier AS STRING * 40
    LineNumber AS LONG
    Value      AS LONG
  END TYPE

這個新型態包括一個固定長度字串,及兩個長整數。一個使用者自定型態的變數
所佔的空間,是所有個別元素所佔空間的總和。例如,上例的 SymTabEntry 型態
共佔 48 個位元組: 固定字串佔 40 個位元組,和 2 個分別佔 4 位元組的長整數。　　

您可以在使用者自定型態中,使用基本的資料型態(除了變動長度字串以外),如:
整數,長整數,單精確度,倍精確度,和固定長度字串。

  注意: 使用者自定型態不能包括陣列或變動長度的字串。


<hr>

<span id="L8012" class="QBtitle">變數型態主記憶體的需求</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 主記憶體需求 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">後置     AS 型態              變數                資料</span>
<span class="QH_1">字元     名稱      DEF型態    型態                的大小</span>

  %      INTEGER   DEFINT     整數                佔 2 個位元組
  &      LONG      DEFLNG     長整數              佔 4 個位元組
  !      SINGLE    DEFSNG     單精確度            佔 4 個位元組
  #      DOUBLE    DEFDBL     倍精確度            佔 8 個位元組

  $      STRING    DEFSTR     變動長度字串        描述元(Descriptor)佔 4 個
                                                  位元組;
                                                  在字串中每一個英文字元
                                                  佔 1 個位元組,每一個中文
                                                  字元佔 2 個位元組。

  $      STRING * num         固定長度字串        佔 num 個位元組

         宣告使用者                               由各個元素所需要
         自定型態                                 的位元組數目所組成


<hr>

<span id="L8013" class="QBtitle">常數</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>        <span class="QH_1">&lt; 常數 &gt;</span>        <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>        <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">常數 -- Constants</span>

常數是事先定義的值,在程式執行中,並不會改變其值。

<span class="QH_1">字串常數 (String Constants)</span>

一個字串常數是一串以雙引號括住的文數(Alphanumeric)字元。

這些文數字元可以為 ASCII 碼介於 0 到 255 之間的任意字元(除了雙引號字元(")
和換行(line-feed),或歸位(carriage-return)字元之外皆可)。
這些碼的範圍包括基本的 ASCII 字元(0-127)和擴充的 ASCII 字元 (128-255)。


注意 : 在 QuickBASIC 中文版下已經將這些擴充的 ASCII 字元拿來當成中文碼使用。


<span class="QH_1">數值常數 (Numeric Constants)</span>

數值常數可以為正數或負數。在 BASIC 中數值常數不可以包括逗號。常數的型態及
次型態如下表:

  <span class="QH_1">型態 (次型態)     說明</span>

整數                一個或多個十進制的數字(0-9),與具有可選擇的前置符號
(十進制)            (+ 或 -)。十進制整數常數,其值介於 -32,768 到 +32,767
                    之間。

整數                一個或多個十六進制數字(0-9, a-f, 或 A-F),與具有前置
(十六進制)          符號 &H 或 &h。十六進制的整數常數值是介於 &h0 到 &hFFFF
                    之間。

整數                一個或多個八進制數字(0-7),與具有前置符號 &O, &o, 或 &。
(八進制)            八進制整數常數其值介於 &o0 到 &o177777 之間。

長整數              一個或多個十進制數字(0-9),與具有可選擇的前置符號
(十進制)            (+ 或 -), 並且後置符號是 &。十進制的長整數常數值
                    是介於 -2,147,483,648 到 +2,147,483,647 之間。

長整數              一個或多個十六進制數字(0-9, a-f, 或 A-F),與具有前置
(十六進制)          符號 &H 或 &h, 及後置符號 &。十六進制的整數常數值是
                    介於 &h0& 到 &hFFFFFFFF& 之間。

長整數              一個或多個八進制數字(0-7),與具有前置符號 &O, &o, 或 &,
(八進制)            及後置符號 &。八進制長整數常數值是介於 &o0& 到
                    &o37777777777& 之間。

定點                正實數(real numbers)或負實數(數字中有包含小數點)。

浮點                以指數型態表示的正數或負數。單精確度浮點常數是一個
(單精確度)          可選擇的有正負號的整數,或定點的數字(mantissa - 為
                    數值大小部份)跟隨著英文字母 E, 及可選擇的有正負號
                    整數(exponent - 為指數部份)。
                    常數的值是數值大小部份乘上以 10 為底的指數次方。
                    單精確度常數值是介於 -3.37E+38 到 3.37E+38 之間。

浮點                倍精確度浮點常數與單精確度浮點常數有相同的格式,但是
(倍精確度)          以 D 英文字母代替 E 英文字母來表示指數部份。倍精確度
                    常數值是介於 -1.67D+308 到 1.67D+308 之間。

<span class="QH_1">單精確度浮點常數 (Single-Precision Constants)</span>

單精確度數值常數是以 7 位數(digits)的精確度(加上指數)來儲存,倍精確度
數值是以 15 位或 16 位數的精確度(加上指數)來儲存。

單精確度常數為具有下列特性之一的任意數值常數:
  * 以英文字母 E 表示的指數型式。
  * 數值尾端有驚歎號(!)。
  * 一個數值具有小數點,但指數部份沒有符號 D, 或數值尾端沒有 # 符號,
    並且小於 15 位數。
  * 一個數值沒有小數點且小於 15 位數,但不能以長整數型態來表示。

<span class="QH_1">倍精確度常數 (Double-Precision Constants)</span>

倍精確度常數為具有下列特性之一的數值常數:
  * 以英文字母 D 表示的指數型式。
  * 數值尾端有 # 符號。
  * 一個數值具有小數點,且指數部份沒有符號 E, 或數值尾端沒有驚歎號(!),
    並且超過 15 位數的數值常數。

<span class="QH_1">符號常數 (Symbolic Constants)</span>

BASIC 提供符號常數(CONST),可以代替數值或字串的值。下列程式片斷宣告
兩個符號常數,並且其中一個用來定義陣列的維度(dimension):

  CONST MAXCHARS% = 254, MAXBUF% = MAXCHARS% + 1
  DIM Buffer%(MAXBUF%)

符號常數的命名規則如同 BASIC 變數名稱的命名規則。在名稱中可以包括型態
宣告字元(%, #, !, 或 $)用來指定其型態,但是這個字元並不是名稱的一部份。
例如,在下列宣告後,名稱 N!, N#, N$, N%, 和 N& 不能再當作變數名稱來使用,
因為它們與常數名稱具有相同的資料型態:

  CONST N=45

常數型態可由外在的型態宣告字元或運算式的型態來決定其資料型態。符號常數
並不受 DEF型態 敘述的影響。

假如省略型態宣告字元,則常數的型態是依據運算式來給定的。所以在運算式為
字串時,則產生字串常數。關於數值運算式,此運算式會將計算所得的常數指定為
所能表示的最簡單型態。例如:運算式的結果可以表示成整數,則此常數就被指定
為整數型態。


<hr>

<span id="L8014" class="QBtitle">變數</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 變數 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">變數 -- Variables</span>

變數是參考一個元件(object)的名稱,而元素可以為一個特殊的數字,字串或記錄
(record : 一個記錄是指一個變數被宣告為使用者自定型態)。

  * 簡單的變數參考到單一的數值,字串,或記錄。
  * 陣列變數參考到一群相同型態的元件(object)。

一個簡單或陣列的數值變數,只可以給一個數值(如:整數,長整數,單精確度,或
倍精確度)。

一個字串變數只能給一個單一的字元字串值。

您可以指定一個記錄變數給另一個記錄變數,只要兩個記錄變數的使用者自定型態
是相同,無論如何,您通常可以指定一個記錄的個別元素給對應型態的一個變數。

下列是將一些值指定給變數的範例:

  * 一個常數值:
      A = 4.5

  * 其他字串或數值變數的值:
      B$ = "愚人船"
      A$ = B$
      Profits = NetEarnings

  * 一個記錄元素的值:
      TYPE EmployeeRec
        FullName AS STRING * 25
        SocSec   AS STRING * 9
      END TYPE
      DIM CurrentEmp AS EmployeeRec
      .
      .
      .
      OutSocSec$=CurrentEmp.SocSec

  * 可以指定一個記錄變數的值給另一個相同型態的記錄變數:
      TYPE FileBuffer
        FullName AS STRING * 25
        JobClass AS INTEGER
      END TYPE
      DIM Buffer1 AS FileBuffer
      DIM Buffer2 AS FileBuffer
      .
      .
      .
      Buffer2 = Buffer1

  * 藉著組合其他變數,常數和運算子(operator)可以得到一個值:
      CONST PI = 3.141593
      Conversion = 180 / PI
      TempFile$ = FileSpec$+".BAK"

在任何情況下,變數必須與指定給它的值的資料型態(數值或字串)相符合。

  注意: 在指定一個變數的值以前,通常假設其值為零(就數值變數而言)或空字串
        (就字串變數而言)。在記錄中的所有欄位(包含字串欄位)都設定為零。

可參閱    <span class="QH_2">&lt;</span><a href="#L8015">變數名稱</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L8016">宣告簡單變數</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L801A">宣告陣列變數</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L801B">變數儲存配置</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8015" class="QBtitle">變數名稱</span>
  <span class="QH_2">&lt;</span><a href="#L8014"> 變數 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 變數名稱 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">變數名稱 -- Variable Names</span>

一個 BASIC 變數名稱可以包括最多 40 個英文字元。在一個變數名稱中的字元允許
使用英文字母,數字,點號和型態宣告字元(%, &, !, #,和 $)。在變數名稱中的第一個
字元必須是英文字母。假如變數以 FN 為開始,就假設呼叫一個 DEF FN 函數。

一個變數名稱不是保留字,但允許在保留字前後加入字元。例如:下面的敘述是不合法
的,因為 LOG 是一個保留字(BASIC 不會區別大小寫):

  Log = 8

無論如何,下列敘述是合法的:

  TimeLog = 8

保留字是包含所有 BASIC 命令,敘述,函數名稱,和運算子(operator)名稱。

注意: 變數名稱不能與程序式名稱(SUB 和 FUNCTION)或符號常數(CONST)名稱重覆。


<hr>

<span id="L8016" class="QBtitle">宣告簡單變數</span>
  <span class="QH_2">&lt;</span><a href="#L8014"> 變數 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 宣告簡單變數 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007">索引</a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">宣告簡單變數 -- Declaring Simple Variables</span>

簡單變數可以是數值,字串,或記錄變數。您可以使用下列三種不同的方式來指定簡單
的變數型態:

  <span class="QH_2">&lt;</span><a href="#L8017">型態宣告的後置字元</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8018">AS 宣告敘述</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8019">DEF型態 宣告敘述</a><span class="QH_2">&gt;</span>



<hr>

<span id="L8017" class="QBtitle">型態宣告後置字元</span>
  <span class="QH_2">&lt;</span><a href="#L8016"> 宜告簡單變數 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 後置字元 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">型態宣告後置字元 -- Type-Declaration Suffix</span>

添加右列型態宣告後置字元中的任一個到變數名稱的尾端: %, &, !, #, $。

錢號($)是字串變數的型態宣告字元。您可以指定一個字串常數到一個至多含有
32,767 個位元組的變數,如下列所示。

  A$ = "銷貨報告"

數值變數名稱可以宣告為整數值(以一個後置字元 % 表示)長整數值(以一個後置
字元 & 表示),單精確度值(以一個後置字元 ! 表示),或者倍精確度值(以一個
後置字元 # 表示)。

若一個變數沒有一個型態後置字元時,則預設為單精確度。

對一個使用者自定型態而言,是沒有型態宣告的後置字元。


<hr>

<span id="L8018" class="QBtitle">AS 宣告敘述</span>
  <span class="QH_2">&lt;</span><a href="#L8016"> 宣告簡單變數 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; AS 宣告 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">AS 宣告敘述 -- AS Declaration Statement</span>

變數的宣告格式如下 :

 宣告 變數名稱 AS 型態

其中 "宣告" 參數可以是 DIM, COMMON, REDIM (就陣列而言), SHARED, 或
STATIC 敘述, 而 "型態" 參數可以為 INTEGER, LONG, SINGLE, DOUBLE, STRING,
或是一個使用者自定型態。例如下列敘述宣告變數 A 是一個長整數型態。

  DIM A AS LONG

字串變數是在 AS STRING 子句中宣告,它可以是變動長度字串或固定長度字串變數。
變動長度字串是可以擴充的,即:它們字串的長度是與其他字串指定給該字串的長度
有關。固定長度的字串有一定的長度,藉著 "* number" 來指定給 AS STRING 子句,
其中 number 表示以位元組為單位的字串長度。例如 :

  ' String1 為一個變動長度的字串
  DIM String1 AS STRING
  ' String2 為一個佔 7 個位元組長度的固定字串
  DIM String2 AS STRING * 7
  String1  = "1234567890"
  String2  = "1234567890"
  PRINT String1
  PRINT String2

  輸出:

  1234567890
  1234567

藉著 AS 子句中的使用者型態名稱來宣告記錄變數(record variables):

  TYPE InventoryItem
    Description AS STRING * 25
    Number AS STRING * 10
    Quantity AS LONG
    OrderPoint AS LONG
  END TYPE
  DIM CurrentItem AS InventoryItem, PreviousItem AS InventoryItem

使用下列的格式來參考一個新變數中各個元素(individual elements):

  變數名稱.元素名稱

如下範例 :

  IF CurrentItem.Description = "Ergonomic Desk Chair" THEN
    PRINT CurrentItem.Number; CurrentItem.Quantity
  END IF

注意: 假如您使用 AS 子句來宣告一個變數,該變數的每一個宣告都必須使用
      AS 子句。例如:在下列程式片斷中,因為在 DIM 敘述中有用到 AS 子句,
      所以在 COMMON 敘述中也需使用 AS 子句。

        CONST MAXEMPLOYEES = 250
        DIM EmpNames(MAXEMPLOYEES) AS STRING
        COMMON EmpNames() AS STRING
        .
        .
        .


<hr>

<span id="L8019" class="QBtitle">DEF型態 宣告敘述</span>
  <span class="QH_2">&lt;</span><a href="#L8016"> 宣告簡單變數 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; DEF型態 宣告 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF型態 宣告敘述 -- DEFtype Declaration Statement</span>

在 BASIC 中使用 DEFINT, DEFLNG, DEFSTR, DEFSNG, 和 DEFDBL 敘述來對特定的
變數名稱宣告其型態。藉著使用這些 DEF型態 敘述中的一個敘述,您可以指定所有
由某個英文字母開頭的變數,或某些英文字母範圍的變數為基本變數型態中的一種,
而不必使用後置型態宣告字元。

DEF型態 敘述僅影響在模組中所出現的變數名稱。記得一個 DEF型態 敘述影響所有由
給定字母開頭的變數或設定字母範圍的變數。

            AS 型態                   變數                  資料的
後置字元    名稱         DEF型態      型態                   大小
------      ------       -------     --------          -------------------
  %         INTEGER      DEFINT      整數              佔 2 個位元組
  &         LONG         DEFLNG      長整數            佔 4 個位元組
  !         SINGLE       DEFSNG      單精確度          佔 4 個位元組
  #         DOUBLE       DEFDBL      倍精確度          佔 8 個位元組

  $         STRING       DEFSTR      變動長度字串      描述元(Descriptor)
                                                       佔 4 個位元組;
                                                       字串中每一個英文字元
                                                       佔 1 個位元組,每一個
                                                       中文字元佔 2 個位元
                                                       組。

  $         STRING * num             固定長度字串      需 num 個位元組

            宣告使用                                   佔用各個元素
            者自定型態                                 所需要的位元組
                                                       的總合


<hr>

<span id="L801A" class="QBtitle">宣告陣列變數</span>
  <span class="QH_2">&lt;</span><a href="#L8014"> 變數 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 宣告陣列變數 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">宣告陣列變數 -- Declaring Array Variables</span>

一個陣列(array)是一群參考到相同變數名稱的元件(objects),在陣列中的每一個值
是元素(elements)。陣列元素也是變數,而且陣列中的元素可在 BASIC 敘述或函數中
當作變數來使用。當您第一次使用陣列或當您宣告陣列的名稱,型態和元素的個數時,
則需要先設定一個陣列的維度(dimension)。

在陣列中需參考到一個元素時,是透過一個陣列變數加上由整數或整數運算式所形成
的註標(subscript)。(若數值運算式為非整數,需先四捨五入成整數值,才可當作陣列
的註標值)一個陣列變數名稱的註標個數和陣列的維度一樣多。例如: V(10) 參考到
一維陣列的一個值,而 T$(1,4) 則參考到二維字串陣列的一個值。

若沒有設定陣列的大小,電腦預設的陣列註標上限值為 10, 最大的註標值和維度
的個數可利用 DIM 敘述來加以設定。一個陣列最大的維度是 60。每一維所能
擁有最大陣列元素是 32,767。

您可能擁有任何簡單變數型態的陣列,包括記錄。為了宣告一個記錄陣列,首先
在一個 TYPE 敘述中先宣告其資料型態,然後設定陣列的維度:

  TYPE TreeNode
    LeftPtr AS INTEGER
    RightPtr AS INTEGER
    DataField AS STRING * 20
  END TYPE
  DIM Tree(500) AS TreeNode

樹狀陣列中的每一個元素是型態為 TreeNode 的一個記錄。為了使用某一特定
記錄中的陣列元素,須使用點符號(.)格式(例如: 變數名稱.元素名稱):

  CONST MAXEMPLOYEES = 500
  TYPE EmployeeRec
    FullName AS STRING * 25
    SocSec   AS STRING * 9
  END TYPE
  DIM Employees(MAXEMPLOYEES) AS EmployeeRec
  .
  .
  .
  PRINT Employees(I).FullName;" ";Employees(I).SocSec

注意: 陣列名稱和簡單變數名稱是不相同的。陣列變數 T 和簡單變數 T 在下列
      的例子中為不相同的兩個變數:

        DIM T(11)
        T = 2 : T(0) = 1          'T 是簡單變數
        FOR I% = 0 TO 10          'T(0) 是陣列的元素
          T(I% + 1) = T * T(I%)
        NEXT

陣列元素和簡單變數類似,所需要的記憶體數目是與變數的型態有關。

為了計算一個陣列所需要主記憶體空間的總和,可以由陣列中元素個數乘上每一個
元素所需要的位元組數,就是該陣列型態所需的主記憶體空間。例如,考慮下面兩個
陣列 :

  DIM Array1(0 TO 100) AS INTEGER
  DIM Array#(-5 TO 5)

第一個陣列 Array1 有 101 個整數元素,因此該陣列所佔的主記憶體空間為 202 個
位元組。第二個陣列 Array2 有 11 個倍精確度元素,因此該陣列所佔的主記憶體
空間為 88 個位元組。又因為 BASIC 必須儲存關於陣列及陣列值的有關資訊,所以
陣列真正所需的空間是略大於剛剛所計算出來的數值。


<hr>

<span id="L801B" class="QBtitle">變數儲存空間的配置</span>
  <span class="QH_2">&lt;</span><a href="#L8014"> 變數 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 變數儲存空間的配置 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> C/內 容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">變數儲存空間的配置 -- Variable Storage Allocation</span>

BASIC 對不同種類的變數在主記憶體中是儲存在不同的區域。若您有使用混合式
程式語言來設計程式或者使用下列的 BASIC 敘述或函數,便需要考慮到變數的儲存
空間的配置。

  CALL, CALLS (非 BASIC 程序式)
  DECLARE (非 BASIC 程序式)
  SADD
  SETMEM
  VARPTR
  VARSEG
  VARPTR$

BASIC 儲存變數的區域可在 DGROUP 中,或是將變數當作一個遠程元件(far object)。
(DGROUP 是預設的資料節區(Data Segment),當使用 DEF SEG 敘述,而不給予位址參數
時,會參考到此節區)。存放在 DGROUP 中的變數,可以使用近程位址(near address)
或指標(near pointer)來參用。近程位址由一個簡單的值; 或由一個節區或是記憶體
區段(block)的起始位址開始算起,到該變數位址之間的位移位址(Offset Address)。
遠程元素是使用遠程位址(far address),或指標(far pointer)來參用。遠程位址包含
兩部分: 一個節區或記憶體區段的起始位址,與在此節區內的位移位址所組成。

一個變數是儲存在 DGROUP 中,或是被看成一個遠程元素,與此變數是一個簡單的變數
或是一個陣列有關係。所有簡單的變數都被儲存在 DGROUP 中。
陣列儲存方式較複雜,而且程式以 .EXE 檔執行和在 QuickBASIC 環境下執行,兩者間
陣列的儲存方式是有些微的差異。

在混合式語言設計程式(mixed-language programming)時,最好使用遠程位址,以保證
所產生的程式碼是與 BASIC 系統的執行沒有關聯。

在以 .EXE 檔案執行的程式中,陣列變數儲存方式如下:

  * 所有靜態陣列皆存放 DGROUP 中,而且可使用近程位址方式來參用。
  * 所有變動長度字串的動態陣列也同時存放在 DGROUP 中,所以也可使用近程位址
    方式來參用。
  * 所有其他動態陣列皆以遠程元素方式儲存,所以需要以遠程位址方式來參用。

在 QuickBASIC 環境下執行程式時,陣列變數存放的規則如下:

  * 所有在 COMMON 敘述中的靜態陣列都存放在 DGROUP 中,並以近程位址來參用。
  * 所有變動長度字串的陣列也存放在 DGROUP 中,所以也可用近程位址來參用。
  * 其他所有的陣列皆以遠程元素方式儲存,所以需使用遠程位址方式來參用。

因為 BASIC 會嘗試使得記憶體的使用能夠最有效率,所以在許多情況下,將會導致
變數常在主記憶體中移動:
  * 當參用到一個固定字串或運算式時。
  * 當使用 DEF FN 或 FUNCTION 敘述時。
  * 當使用 BASIC 字串或與記憶體相關的函數時。

因為 BASIC 的變數會被移動,所以請立刻使用呼叫 VARPTR, VARSEG, VARPTR$,或 SADD
函數以後所傳回的值。


<hr>

<span id="L801C" class="QBtitle">BASIC 變數有效範圍規則</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 有效範圍規則 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">有效範圍規則 -- Scoping Rules</span>

下面列出 BASIC 的有效範圍規則:

  * 一個變數若在 DIM, REDIM, 或 COMMON 敘述中使用 SHARED 屬性來宣告,
    則此變數在此模組中是一個全域(global)變數。在模組中任何一個 SUB 或
    FUNCTION 程序式都可參考到該變數。

  * 一個符號常數(symbolic constant)若在模組層次碼中使用 CONST 敘述宣告,
    則為全域變數。若符號常數是宣告在 SUB 或 FUNCTION 程序式內,則為區域
    (local)變數。

  * 假如一個變數出現在一個程序式內,且不是宣告為全域變數,則稱為區域變數。
    您可以使用全域變數的名稱來當作一個程序式中的區域變數,這方式是:在程序式
    中使用 STATIC 敘述來宣告,或使用它當作一個形式參數(formal parameter)。

  * SHARED 敘述使您在其他程序式有使用等效的 SHARED 敘述中,能和模組層次碼共用
    變數,而不需宣告為全域變數。

  * 在 DEF FN 函數中,所有變數皆為模組層次碼的一部份,除非在 STATIC 敘述
    中宣告為區域變數或是形式參數。

可參閱    <span class="QH_2">&lt;</span><a href="#L801D">變數和常數的有效範圍</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L801E">全域變數和常數</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L801F">區域變數和常數</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L8020">共用變數</a><span class="QH_2">&gt;</span>
          <span class="QH_2">&lt;</span><a href="#L8021">DEF FN 函數</a><span class="QH_2">&gt;</span>


<hr>

<span id="L801D" class="QBtitle">變數和常數的有效範圍</span>
  <span class="QH_2">&lt;</span><a href="#L801C"> 有效範圍規則 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 變數和常數的有效範圍 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">變數和常數的有效範圍 -- Scope of Variables and Constants</span>

一個變數出現在程式本文中, BASIC 會依照一套規則來決定變數可以參考到那一個
元件(object)。這些規則用來描述一個變數的有效範圍--它是指變數被定義後所
涵蓋敘述的範圍。

您可將變數和常數的有效範圍看成全域或區域兩者之一。

  * 全域變數一經宣告後,可在模組的任何地方參考到所對應的元件(object)。
  * 區域變數對模組中某些部份是區域性(亦即:模組層次碼或是某一個程序式)。

除此之外,變數可以另一種方式來共用,即:不是宣告成全域性的變數,也不是完全
區域性時,可以使用 SHARED 敘述來完成。


<hr>

<span id="L801E" class="QBtitle">全域變數和常數</span>
  <span class="QH_2">&lt;</span><a href="#L801C"> 有效範圍規則 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 全域變數和常數 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引</a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">全域變數和常數 -- Global Variables and Constants</span>

在 BASIC 程式中,變數和符號常數二者皆可為全域性。定義全域變數或全域符號
常數是提供給整個模組使用。

  * 如果是在模組層次碼中以 CONST 敘述宣告,則一個符號常數可以成為一個全域
    常數。

  * 將一個變數變成全域性的方法是:在模組層次碼中,或在 DIM, REDIM, COMMON
    敘述加入 SHARED 屬性。例如,下列程式片斷中使得 TabStops 變成全域變數。

      DIM SHARED TabStops(MAXLINE)
      .
      .
      .
      SUB SetTabPos STATIC
      .
      .
      .
      END SUB
      FUNCTION ThisIsATab(LastColumn AS INTEGER) STATIC
      .
      .
      .

SHARED 敘述(與上面所介紹的 SHARED 屬性是不相同的)允許特定的程序式共用在
模組層次碼中的變數。這和將變數變成全域性是不相同的, SHARED 敘述僅對模組
層次碼和所有使用 SHARED 敘述的程序式中之變數視為全域性。


<hr>

<span id="L801F" class="QBtitle">區域變數和常數</span>
  <span class="QH_2">&lt;</span><a href="#L801C"> 有效範圍規則 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 區域變數和常數 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">區域變數和常數 -- Local Variables and Constants</span>

區域變數或常數僅在一個程序式或在模組層次碼中有效。假如區域變數名稱使用
在同一模組,但在不同的程序式中,則這名稱代表不同的變數和參考到不同的元件
(object)。

一個區域變數較簡單的想法是:假如任何一個變數不是全域性時便是區域變數。若
變數不是在 DIM, REDIM, 或 COMMON 敘述中使用 SHARED 敘述來宣告,則任何出現
在模組層次碼或一個程序式中的變數均屬於區域變數。即使一個變數出現在以上這些
敘述中,仍可將該變數名稱用 STATIC 敘述宣告為區域變數,而在程序式中仍使用相同
變數名稱。

在 SUB 或 FUNCTION 程序式中所宣告的任何符號常數(symbolic constant)是屬於
區域常數。例如,下例程式片斷中, ENDOFLIST 是一個區域符號常數,此常數僅能存
在 FindElement 函數中。

  FUNCTION FindElement(X())
  CONST ENDOFLIST = -32767
  .
  .
  .
  END FUNCTION

注意: STATIC 敘述不僅宣告變數成為區域性,也指示編譯器(compiler)將介於程式間
      呼叫的變數值儲存起來。假如您不想讓變數的值在遞迴(recursion)呼叫時仍然
      保存著,請勿在遞迴的程序式中使用 STATIC 敘述。


<hr>

<span id="L8020" class="QBtitle">共用變數</span>
  <span class="QH_2">&lt;</span><a href="#L801C"> 有效範圍規則 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 共用變數 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">共用變數 -- Sharing Variables</span>

在模組中主程式與次程式共用變數,不需將變數變成全域化,只須使用 SHARED 敘述
就可以。例如共用 TabStops 不需使得該變數成為全域變數,而是在您所要共用變數
的程序式中,加入 SHARED 敘述來宣告該變數就可以了:

  DIM TabStops(MAXLINE)
  .
 .
  .
  SUB SetTabPos STATIC
  SHARED TabStops()
  .
  .
  .
  END SUB
  FUNCTION ThisIsATab(LastColumn AS INTEGER) STATIC
  SHARED TabStops()
  .
  .
  .
  END FUNCTION

SHARED 敘述表示兩個程序式中名稱為 TabStops 都是參考到定義在模組層次碼上的
相同變數。


<hr>

<span id="L8021" class="QBtitle">有效範圍規則 : DEF FN 函數</span>
  <span class="QH_2">&lt;</span><a href="#L801C"> 有效範圍規則 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 有效範圍規則: DEF FN 函數 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF FN 函數</span>

DEF FN 函數對於 BASIC 的有效範圍規則來說,是一項例外。多行型式自定函數區段
中的每一個變數,若不存在參數串列中,則屬於模組層次碼,且視為全域變數。
在 DEF FN 函數中,您必須使用 STATIC 敘述宣告該變數為區域性。下例中 STATIC
敘述使得 DEF FN 函數中的變數 I 為區域變數:

  CONST NO = 0, YES = NOT NO
  DEF FNIsThereAZ (A$)
  STATIC I
    FOR I = 1 TO LEN(A$)
     IF UCASE$(MID$(A$, I, 1)) = "Z" THEN
        FNIsThereAZ = YES
        EXIT DEF
      END IF
    NEXT I
    FNIsThereAZ = NO
  END DEF

注意 : 一般而言,FUNCTION 較優於 DEF FN 函數,因為可攜帶性高,增加模組化,
       與具有結構化的程式風格。


<hr>

<span id="L8022" class="QBtitle">靜態和動態陣列</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 靜態和動態陣列 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">靜態和動態陣列 -- Static and Dynamic Arrays</span>

藉著控制陣列的儲存空間,您可以方便控制程式對記憶體的使用。當程式被編譯
(compiled)時,或程式執行時,陣列的空間可以被保留。

  * 靜態陣列是在編譯時,便配置記憶體空間。

  * 動態陣列是在程式執行時,才配置陣列的儲存空間。所以動態陣列的儲存空間
    可先被釋放(free)出來,以提供可用記憶體空間給其他使用。

由一個陣列的宣告方式,以決定是靜態陣列或動態陣列。

  * 陣列所宣告的維度(dimension)若使用常數註標(constant subscripts),或者
    是以隱含(implicit)方式來宣告陣列時,皆屬於靜態陣列。

  * 陣列的維度若用變數註標(variable subscripts),或在 COMMON 敘述中第一次
    宣告,皆為動態陣列。

  * 在 SUB 或 FUNCTION 程序式中沒有宣告為 STATIC 時,則所有陣列皆為動態陣列。

您也可以使用 $STATIC 和 $DYNAMIC 假命令來控制陣列記憶體空間的配置。然而,
$STATIC 假命令無法強制將 "程序式中沒有使用 STATIC 敘述宣告的陣列" 變成
靜態陣列,且在程序式中此種形式的陣列皆為動態的。


<hr>

<span id="L8023" class="QBtitle">自動和靜態變數</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 自動和靜態變數 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">自動和靜態變數 -- Automatic and Static Variables</span>

BASIC 程序式可使用自動和靜態兩種變數 :

  * 自動(Automatic)變數是在每一個 FUNCTION 或 SUB 程序式開始呼叫時,被設立
    初值。

  * 靜態(Static)變數是在程序式呼叫之間,仍保留其值。

您可以在 SUB 或 FUNCTION 敘述中,藉著使用或省略 STATIC 關鍵字,來控制預設為
自動變數或是靜態變數 :

  * 若省略 STATIC ,則預設為自動變數。

  * 若有使用 STATIC 關鍵字,則程序式中所有變數預設為靜態變數,即:變數的值
    在程序式之間呼叫時,仍然保留其值。

在一個程序式中,您可以在 SUB 或 FUNCTION 敘述中省略 STATIC 關鍵字,使得變數
成為自動變數;或者選擇使用 STATIC 敘述來設定成靜態變數。


<hr>

<span id="L8024" class="QBtitle">型態轉換</span>
  <span class="QH_2">&lt;</span><a href="#L800D"> 資料型態 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 型態轉換 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">型態轉換 -- Type Conversion</span>

當需要將一個 BASIC 的數值常數從一個型態轉換成另外一個型態時,可以根據下列
的規則:

  * 假如將一個數值常數值設定給另一個不同資料型態的數值變數,則會依該變數
    名稱所宣告的資料型態來儲存,如下例:

      A% = 23.42
      PRINT A%

      輸出:

      23

    假如將一個數值設定給字串變數時,將會出現一個 "資料型態不符" 錯誤訊息。

  * 運算式做計算時,在一個算術或關係運算中所有的運算元(operand)將被轉換成
    最高精確度運算元的精確度,然後再執行每一運算。同時算術運算的結果是將
    最後運算時的精確度傳回,如下例所示:

      X% = 2 : Y! = 1.5 : Z# = 100
      A! = X% / Y!
      PRINT A! * Z#

      輸出:

      133.3333373069763

    雖然上面的結果是以倍精確度來顯示(因為變數 Z# 是倍精確度變數),但它僅有
    單精確度的正確性--因為將 X% / Y! 執行結果,強制指定給單精確度的變數 A!。
    這告訴我們非有效位數(73069763)是在小數點後面第五位以後。可以對照下面
    例子的輸出結果, X% / Y! 在中間運算過程中仍保留倍精確度的正確性。

      X% = 2 : Y# = 1.5 : Z# = 100
      PRINT X% / Y# * Z#

      輸出:

      133.3333333333333

  * 像 AND 和 NOT 邏輯運算子(logical operators)，若需要將他們之間的運算元
    (operand)轉換成長整數時,運算元的值必須介於 -2,147,483,648 和
    +2,147,483,647 之間,否則將產生 "超值溢位"(overflow) 錯誤訊息。

  * 當一個浮點數轉換為整數時,小數點部份會被四捨五入,如下例所示:

      Total% = 55.88
      PRINT Total%

      輸出:

      56


<hr>

<span id="L8025" class="QBtitle">BASIC 運算式和運算子</span>
  <span class="QH_1">&lt; 運算式和運算子 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">運算式和運算子 -- Expressions and Operators</span>

一個運算式(expression)可以是一個字串或是數值常數,一個變數,或者是透過常數,
變數和其他運算式與運算子(operator)結合,而獲得的一個單一值。

運算子是對一個值做數學或邏輯運算。BASIC 所提供的運算子可分為五類:

      <span class="QH_1">分類             目標</span>
  <span class="QH_2">&lt;</span><a href="#L8027"> 算術運算子 </a><span class="QH_2">&gt;</span>       做計算
  <span class="QH_2">&lt;</span><a href="#L8028"> 關係運算子 </a><span class="QH_2">&gt;</span>       比較字串和數值的大小
  <span class="QH_2">&lt;</span><a href="#L8029"> 邏輯運算子 </a><span class="QH_2">&gt;</span>       測試複雜的條件或處理個別的位元
  <span class="QH_2">&lt;</span><a href="#L802A"> 函數運算子 </a><span class="QH_2">&gt;</span>       提供較簡單的運算子
  <span class="QH_2">&lt;</span><a href="#L802B"> 字串運算子 </a><span class="QH_2">&gt;</span>       組合和比較字串

可參閱    <span class="QH_2">&lt;</span><a href="#L8026">運算的階層</a><span class="QH_2">&gt;</span> - 運算子的優先次序表
          <span class="QH_2">&lt;</span><a href="#L802C">真值表</a><span class="QH_2">&gt;</span>     - BASIC 邏輯運算子的真值表


<hr>

<span id="L8026" class="QBtitle">運算的階層</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 運算的階層 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">運算的階層 -- Hierarchy of Operations</span>

當許多 BASIC 運算子(operator)同時出現在一個敘述上,他們執行的優先次序如下:

  1. 算術運算 :
     a. 指數 (^)
     b. 負數 (-)
     c. 乘法和除法 (*, /)
     d. 整數除法 (\)
     e. 模數運算 (MOD)
     f. 加法和減法 (+, -)

  2. 關係運算 (=, &gt;, &lt;, &lt;&gt;, &lt;=, &gt;=)

  3. 邏輯運算 :
     a. NOT
     b. AND
     c. OR
     d. XOR
     e. EQV
     f. IMP

當一個運算式中有指數運算子,且其後緊跟著負數運算子時,上述運算的優先順序就
產生一個例外的現象。在這個情況下,負數的優先次序較指數運算子高。例如,下面
敘述的結果是 0.625 ,而非 -16 :

   PRINT 4 ^ - 2

假如這些不相同的運算子,都屬於同一個層次,其執行的順序是由左而右。現在說明
如下:

   A = 3 + 6 / 12 * 3 - 2          'A = 2.5

在上例中運算的次序如下 :

   1. 6 / 12   (= 0.5)
   2. 0.5 * 3  (= 1.5)
   3. 3 + 1.5  (= 4.5)
   4. 4.5 - 2  (= 2.5)


<hr>

<span id="L8027" class="QBtitle">BASIC 算術運算子</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 算術運算子 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">算術運算子 -- Arithmetic Operators</span>

在算術運算式中,括號會改變運算子的優先次序: 有括號的運算先處理。但在括號內,
仍維持著原先的運算次序。

一般而言,兩個連續的運算子必須用括號分開,但是這個規則對於 * - , * + , ^ - ,
和 ^ + 運算子而言是例外的。

<span class="QH_1">整 數 除 法</span>

整數除法以倒斜線( \ )來代表,而斜線( / )則代表浮點的除法。在整數除法執行之前,
運算元(operand)將被四捨五入成為整數或長整數,且其值必須介於 -2,147,483,648.5
和 +2,147,483,647.5之間。整數除法的商,是捨棄小數以後的整數值。

範例:

  PRINT 10 \ 4, 10 / 4, -32768.499 \ 10, -32768.499 / 10

  輸出 :

  2             2.5          -3276         -3276.8499


<span class="QH_1">模數算術 (Modulo Arithmetic)</span>

模數算術是以模數(modulus)運算子 MOD 來表示,模數算術提供一個整數除法的餘數,
而非商數。

範例:

  X% = 10.4 \ 4
  REMAINDER% = INT(10.4) - 4*X%       '10\4 = 2, with remainder 2
  PRINT REMAINDER%, 10.4 MOD 4

  輸出 :

  2             2


<span class="QH_1">超值溢位和除數為 0</span>

除數為零,或由於指數次方為負數使其計算值為零,或算術溢位(overflow)都會產生執行
期間(run-time)錯誤訊息,這個錯誤可以藉由設陷錯誤常式(error-trapping routine)
來設陷。下列是 BASIC 有用的錯誤設陷敘述:

        <span class="QH_2">&lt;</span><a href="#L80CD">ERROR</a><span class="QH_2">&gt;</span>     - 允許使用者定義錯誤代碼
        <span class="QH_2">&lt;</span><a href="#L8139">ON ERROR</a><span class="QH_2">&gt;</span>  - 錯誤處理
        <span class="QH_2">&lt;</span><a href="#L8192">RESUME</a><span class="QH_2">&gt;</span>    - 在錯誤設陷後繼續執行
        <span class="QH_2">&lt;</span><a href="#L80CB">ERR, ERL</a><span class="QH_2">&gt;</span>  - 錯誤狀態


<hr>

<span id="L8028" class="QBtitle">BASIC 關係運算子</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 關係運算子 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">關係運算子 -- Relational Operators</span>

關係運算子用來比較兩個值,比較的結果可為 "真"(不為零) 或 "假"(零)。
這樣的結果可以用來做程式流程的決策。雖然 BASIC 將任何不為零的值視為真,
但通常仍以 -1 代表真值。

    <span class="QH_1">運算子        關係                        運算式</span>
      =           等於                        X = Y
      &lt;&gt;          不等於                      X &lt;&gt; Y
      &lt;           小於                        X &lt; Y
      &gt;           大於                        X &gt; Y
      &lt;=          小於或等於                  X &lt;= Y
      &gt;=          大於或等於                  X &gt;= Y

當算術和關係運算子組合成一個運算式(expression),算術運算通常先處理。例如,
假設 X + Y 的值小於 (T - 1)/Z 的值,則下列運算式的值為真:

  X + Y &lt; (T - 1) / Z

運算元(operand)與關係運算子組合成一個運算式,當運算元為單精確度或倍精確度時,
請小心使用關係運算子, 尤其應儘量避免測試二個值是否相等,因為運算結果可能是
"相當接近" 但是 "卻不相等"。請參閱下面的例子:

(1). 這個例子中的 IF 敘述, 除非 A! 的值正好是等於 0.0, 否則將不會執行 PRINT
     敘述。當 A! 是一個相當小的值,例如 1.0E-23 , 則此 PRINT 敘述仍然不會被
     執行:

     IF A! = 0.0 THEN PRINT "相等結果"

(2). 這個例子中也是不會執行 PRINT 敘述 :

     CLS
     A$ = "123.45"
     IF VAL(A$) = 123.45 THEN PRINT "相等結果"


解決方法 :請在關係運算式中使用變數名稱就可以得到 "相等" 的結果,
          例如上面第二個例子可以改寫為 :

          CLS
          A$ = "123.45"
          B! = VAL(A$)
          IF B! = 123.45 THEN PRINT "相等結果"



<hr>

<span id="L8029" class="QBtitle">BASIC 邏輯運算子</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算式 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 邏輯運算子 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">邏輯運算子 -- Logical Operators</span>

邏輯運算子可以處理多層關係式,位元運算,或布林運算(Boolean operations)的測試,
並且傳回真(不為零)值,或假(為零)值,以用來做決策。

範例:

  IF D &lt; 200 AND F &lt; 4 THEN 80
  WHILE I &gt; 10 OR K &lt; 0
  .
  .
  .
  WEND
  IF NOT P THEN PRINT "找不到名字"

在 BASIC 中的六個邏輯運算子,其優先次序如下所示:

  <span class="QH_1">運算子                意義</span>
  NOT                   邏輯補數
  AND                   合取
  OR                    或 (內含"或")
  XOR                   互斥 "或"
  EQV                   等效
  IMP                   隱含

每一個運算子傳回下列的結果。"T" 代表真值,和 "F" 代表假值。運算子是以其優先
次序來排列。


值             邏輯運算子傳回的值
                      X    X    X     X     X
                NOT  AND  OR   XOR   EQV   IMP
X     Y          X    Y    Y    Y     Y     Y
─────────────────────────
T     T          F    T    T    F     T     T

T     F          F    F    T    T     F     F

F     T          T    F    T    T     F     T

F     F          T    F    F    F     T     T

在一個運算式中,邏輯運算(又稱: 布林(Boolean)運算)是在算術運算和關係運算之後。
邏輯運算子的運算元(operand)其值必須介於 -2,147,483,648 到 +2,147,483,647 之間,
否則會產生錯誤訊息。在做邏輯運算之前,運算元先轉換成整數(如果有需要時,會轉換成
長整數),假如運算元為 0 或 -1,邏輯運算子則傳回 0 或 -1 為其結果。


<hr>

<span id="L802A" class="QBtitle">BASIC 函數運算子</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 函數運算子 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">函數運算子 -- Functional Operators</span>

一個函數是一個預先已設定好的運算,能在一個運算式中被呼叫來當成一個運算元
(operand)做運算。例如, SQR 函數在下列指定的敘述中被使用兩次:

  A = SQR (20.25) + SQR (37)

BASIC 具有兩種函數 : 內建(intrinsic)函數和使用者自定(user-defined)函數。

  * 有許多事先定義(內建)的函數,已被建立在 BASIC 語言中。
    例如 SQR (平方根 -- square root) 和 SIN (正弦值 -- sine) 函數。

  * 您可以用 FUNCTION...END FUNCTION 或早期的 DEF FN...END DEF 來建立
    屬於自己的函數。
    像此類定義的函數只能在此程式中有效(除非將他們建在 QUICK 程式庫內)
    而且他們並不是 BASIC 語言的一部份。

除了 FUNCTION 和 DEF FN 以外, QuickBASIC 也允許您使用 SUB 來定義副程式。


<hr>

<span id="L802B" class="QBtitle">BASIC 字串運算子</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a>       <span class="QH_1">&lt; 字串運算子 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">字串運算子 -- String Operators</span>

一個字串運算式是由字串常數,字串變數及其他藉由字串運算子(operator)結合的
字串運算式所組合而成的。關於字串運算有兩種方式: 連結(concatenation)與比較
(comparison)。

將兩個字串組合起來的動作稱為連結,加號(+)是字串的連結運算子。
例如下列程式的片斷中,將字串變數 A$ 和 B$ 組合成為 "FILE NAME" 的字串值。


  A$ = "FILE": B$ = "NAME"
  PRINT A$ + B$
  PRINT "NEW " + A$ + B$

  輸出

  FILENAME
  NEW FILENAME

字串可以藉著下列關係運算子來做字串的比較:

  &lt;&gt;, =, &lt;, &gt;, &lt;=, 和  &gt;=

注意: 這些使用在字串中的關係運算子是與使用在數字上相同的。

字串的比較是根據每一個字串中相對的字元,以其 ASCII 碼來比較大小。
假如兩個字串中的所有字元,其 ASCII 碼皆相同,則這兩個字串是相等的。
假如 ASCII 碼不同, ASCII 碼值較低的排在較高之前。假若字串在作比較時,
一個字串先到達該字串的最後一個字元,且兩個字串在這之前所有的字元皆相等,
則比較短的字串比較小。字串的前後有空白時,在比較字串時均是有意義的。
下面是字串運算式經過運算以後,其結果為真的例子:


  "AA" &lt; "AB"
  "FILENAME" = "FILE"+"NAME"
  "X&" &gt; "X#"
  "CL " &gt; "CL"
  "kg" &gt; "KG"
  "SMYTH" &lt; "SMYTHE"
  B$ &lt; "9/12/78"              '當 B$ = "8/12/85" 時

字串的比較可以用來測試字串值或字母字串(to alphabetize strings)。
所有字串常數用在比較運算式時,必須以雙引號括起來。
完整的 ASCII 碼表列在 <span class="QH_2">&lt;</span><a href="#L8223">ASCII 字元碼表中</a><span class="QH_2">&gt;</span>。



<hr>

<span id="L802C" class="QBtitle">BASIC 邏輯運算子的真值表</span>
  <span class="QH_2">&lt;</span><a href="#L8025"> 運算式和運算子 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 真值表 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">邏輯運算子的真值表(Truth Table)</span>

每一個運算子(operator)傳回下表的結果。"T" 代表真值, 而 "F" 代表假值。
運算子按其優先次序排列。


     值                  邏輯運算子所傳回的值
                           X    X    X     X     X
                     NOT  AND  OR   XOR   EQV   IMP
     X     Y          X    Y    Y    Y     Y     Y
   ──────────────────────────
     T     T          F    T    T    F     T     T

     T     F          F    F    T    T     F     F

     F     T          T    F    T    T     F     T

     F     F          T    F    F    F     T     T


<hr>

<span id="L802D" class="QBtitle">模組和程序式</span>
  <span class="QH_1">&lt; 模組和程序式 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">模組和程序式 -- Modules and Peocedures</span>

QuickBASIC 程式由下列所組成:

<span class="QH_2">&lt;</span><a href="#L802E">模組</a><span class="QH_2">&gt;</span>                - 可以被獨立編譯的原始程式檔。
<span class="QH_2">&lt;</span><a href="#L802F">FUNCTION 程序式</a><span class="QH_2">&gt;</span>     - 使用在運算式中,能直接傳回一個值。
<span class="QH_2">&lt;</span><a href="#L8031">DEF FN 函數</a><span class="QH_2">&gt;</span>         - 僅能在模組層次碼中定義。
<span class="QH_2">&lt;</span><a href="#L8030">SUB 程序式</a><span class="QH_2">&gt;</span>          - 不能使用在運算式中,但能傳回許多值。

最後,在 QuickBASIC 所提供的兩個高層次的技術 :

<span class="QH_2">&lt;</span><a href="#L8032">參數傳遞方法</a><span class="QH_2">&gt;</span> - 可藉由傳址或傳值方式傳遞到另一個程序式。
<span class="QH_2">&lt;</span><a href="#L8033">遞迴</a><span class="QH_2">&gt;</span> - SUB 或 FUNCTION 程序式可以遞迴處理。


<hr>

<span id="L802E" class="QBtitle">Modules</span>
  <span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 模組 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">模組 -- Modules</span>

QuickBASIC 程式是由一個或多個模組所組成。一個模組是指一個可以被獨立編譯的
原始程式檔案(source file)。

一個模組可以包括 SUB 和 FUNCTION 程序式,和不屬於一個 SUB 或 FUNCTION 的
程式碼。若敘述不是一個 SUB 或 FUNCTION 的一部份便為模組層次碼(module-level
code)。模組層次碼包括: 如 DIM 和 TYPE 的宣告敘述,錯誤處理碼(error-handling
code)和事件處理碼(event-handling code)。

一個程式中要有一個特別的模組稱為主模組。主模組包含程式的進入點(是程式要
開始執行的地方)。每一個程式只能包含一個主模組。在主模組中的模組層次碼就是
我們常稱的主程式。


<hr>

<span id="L802F" class="QBtitle"> FUNCTION 程序式</span>
  <span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; FUNCTION 程序式 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FUNCTION 程序式</span>

FUNCTION 程序式提供一個比 DEF FN 函數更有效的選擇, FUNCTION 程序式類似
DEF FN 函數,可以使用在運算式中,而且直接傳回一個單一值。

然而兩者間有明顯的不同。一個 FUNCTION 程序式可以:
  * 藉著傳址方式來傳遞參數,因此它可以傳回在參數串列中,被改變以後的變數值。
  * 不是模組層次碼的一部份。
  * 使用遞迴(recursion)呼叫--它能自己呼叫自己本身。
  * 被使用在不是定義該程序式的模組中。若您使用一個 FUNCTION, 而它是在其他
    模組中被定義時,您的模組就必須包含 DECLARE 敘述。
    若對 FUNTION 程序式作定義且使用在同一模組中, QuickBASIC 會自動產生
    DECLARE 敘述。您也可以自己輸入 DECLARE 敘述:


      DECLARE FUNCTION Log10(X)
      INPUT " 輸入一個數字 : ",Num
      PRINT "10 ^ Log10(";Num;") is" 10.0^Log10(Num)
      END
      ' 此函數是計算以 10 為底的自然對數值,
      ' 它使用 BASIC 內建的自然對數函數(LOG)。
      FUNCTION Log10 (X) STATIC
        Log10 = LOG(X) / LOG(10.0)
      END FUNCTION

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8031">DEF FN 函數</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8030" class="QBtitle">SUB 程序式</span>
  <span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; SUB 程序式 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SUB 程序式</span>

SUB 程序式(procedure)不同於 DEF FN 函數和 FUNCTION 程序式, SUB 被引用時
可視為一個獨立的敘述:

  ' 在螢幕中央顯示訊息
  CLS
  CALL PrntMsg(12,40,"哈囉 !")
  END
  ' 在指定的列和行中印出訊息
  SUB PrntMsg(Row%,Col%,Message$) STATIC
    ' 儲存目前游標的位置
    CurRow% = CSRLIN
    CurCol% = POS(0)
    ' 在指定的位置上印出訊息
    LOCATE Row%,Col% : PRINT Message$;
    ' 恢復游標的位置
    LOCATE CurRow%,CurCol%
  END SUB

SUB 程序式可以用來傳回多個值到呼叫的常式(calling routine),而且不能將 SUB
當作一個運算式的一部份。

所有 SUB 的參數是以傳址方式來傳遞,因此允許 SUB 程序式傳回參數串列中的變數
已經被改變以後的值--這是 SUB 程序式傳回值的唯一方式。

若 SUB 有用 DECLARE 宣告,在呼叫 SUB 程序式時就可以不必使用 CALL 關鍵字。
若您使用此種方式,則可省略環境參數串列的左右括號。

  DECLARE SUB PrntMsg (Row%,Col%,Msg$)
  ' 在螢幕中央印出訊息
  CLS
  PrntMsg 12,40,"哈囉 !"    ' 注意:可以遺漏括號
  END
  .
  .
  .

SUB 程序式可以遞迴(recursion)呼叫--亦即,您可以寫一個 SUB 程序式來呼叫自己
本身。


<hr>

<span id="L8031" class="QBtitle">DEF FN 函數</span>
  <span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; DEF FN 函數 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 &gt;</a>
───────────────────────────────────────
<span class="QH_1">DEF FN 函數</span>

DEF FN 函數通常是程式模組層次碼中的一部份。為了這個理由, DEF FN 函數的
用法比 SUB 或 FUNCTION 有更多的限制。
DEF FN 函數類似 FUNCTION 程序式,它傳回一個單一值,且其用法類似 BASIC 的
內建(built-in)函數:

  ' 使用 BASIC 內建的自然對數函數,來計算以 10 為底的自然對數值。
  DEF FNLog10 (X)
  FNLog10 = LOG(X) / LOG(10.0)
  END DEF

  INPUT " 輸入一個數字 : ",Num
  PRINT "10 ^ Log10(";Num;") is" 10.0 ^ FNLog10(Num)
  END

DEF FN 函數是以傳值方式來傳遞參數。DEF FN 函數的名稱通常以 FN 為開始。
除此之外, DEF FN 函數:
  * 必須在使用之前就先定義。
  * 不能在定義函數的模組以外呼叫此函數。
  * 不能使用遞迴(recursion)呼叫。


<hr>

<span id="L8032" class="QBtitle">參數傳遞規則</span>
  <span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 傳遞參數 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">傳址和傳值 -- Passing by Reference and Passing by Value</span>

BASIC 使用兩種不同的方法來傳遞參數給程序式。

"傳址" 方式是使用在 SUB 和 FUNCTION 程序式中,它意味著傳遞每一個參數的位址
到此程序式,並且藉用堆疊(stack)來放置參數的位址值。

"傳值" 方式是使用在 DEF FN 函數中,表示是參數的值被放在堆疊上,而不是位址。
因為一個參數的傳遞是以傳值方式,程序式無法存取到該變數,所以程序式無法改變
變數的值。


<hr>

<span id="L8033" class="QBtitle">遞迴</span>
  <span class="QH_2">&lt;</span><a href="#L802D"> 模組和程序式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 遞迴 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 &gt;</a>
───────────────────────────────────────
<span class="QH_1">遞迴 -- Recursion</span>

QuickBASIC 允許您使用遞迴的 SUB 或 FUNCTION 程序式(程序式呼叫自己本身)。
例如下面的程式是使用一個遞迴 FUNCTION 來反轉一個字串中的字元。


  DECLARE FUNCTION Reverse$ (StringVar$)
  LINE INPUT "請輸入將要反轉的字串:", X$
  PRINT Reverse$(X$)
  END

  FUNCTION Reverse$ (S$)
    C$ = MID$(S$, 1, 1)
    IF C$ = "" THEN
      ' 若第一個字元是空字元,則返回。
      ' 空字元 -- 也就是字串中沒有剩餘的字元。
      Reverse$ = ""
    ELSE
      ' 反轉一個非空字串的方法是:將第一個字元插入到剩餘字串的尾端。
      Reverse$ = Reverse$(MID$(S$, 2)) + C$
    END IF
  END FUNCTION


  範例輸出

  請輸入將要反轉的字串: abcdefgh...tuvwxyz
  zyxwvut...hgfedcba

Reverse$ 函數用來反轉一個字串,首先測試是否為空字串。若字串是空的,
則傳回空字串。若不是空字串(例如:有存在字元)則由 Reverse$ 函數來簡化
此問題。非空字串的反轉是將字串剩餘的部分與 C$ 字串的第一個字元連結,
如此透過 Reverse$ 函數繼續自已呼叫自己本身,將剩下的字串作反轉,陸續地
將剩下字串中的第一個字元連結到已反轉字串的後面。

遞迴會使用大量的主記憶體,因為在 FUNCTION 或 SUB 程序式內的自動變數
必需儲存,以便提供當此遞迴呼叫完成後再次執行此程序式時所需要的變數值。
因為自動變數儲存在堆疊(stack)中,可能需要增加堆疊的空間,此時可以使用
CLEAR 敘述來防止堆疊空間不夠的情形發生。可以使用 FRE 函數來調整堆疊
空間的大小。



<hr>

<span id="L8034" class="QBtitle">鍵盤掃描碼</span>
  <span class="QH_1">&lt; 鍵盤掃描碼 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">鍵盤掃描碼 -- Keyboard Scan Codes</span>

  鍵      十六進制  鍵       十六進制  鍵    十六進制     鍵    十六進制

  ESC         01    U            16   | 或 \      2B   F6          40
  ! 或 1      02    I            17   Z           2C   F7          41
  @ 或 2      03    O            18   X           2D   F8          42
  # 或 3      04    P            19   C           2E   F9          43
  $ 或 4      05    { 或 [       1A   V           2F   F10         44
  % 或 5      06    } 或 ]       1B   B           30   NUMLOCK     45
  ^ 或 6      07    ENTER        1C   N           31   SCROLL LOCK 46
  & 或 7      08    CTRL         1D   M           32   HOME 或 7   47
  * 或 8      09    A            1E   &lt; 或 ,      33   ↑ 或 8     48
  ( 或 9      0A    S            1F   &gt; 或 .      34   PGUP 或 9   49
  ) 或 0      0B    D            20   ? 或 /      35   -           4A
  _ 或 -      0C    F            21   RIGHT SHIFT 36   ← 或 4     4B
  + 或 =      0D    G            22   PRTSC 或 *  37   5           4C
  LEFT        0E    H            23   ALT         38   → 或 6     4D
  TAB         0F    J            24   SPACEBAR    39   +           4E
  Q           10    K            25   CAPSLOCK    3A   END 或 1    4F
  W           11    L            26   F1          3B   ↓ 或 2     50
  E           12    : 或 ;       27   F2          3C   PGDN 或 3   51
  R           13    " 或 '       28   F3          3D   INS 或 0    52
  T           14      或 &gt;       29   F4          3E   DEL 或 .    53
  Y           15    LEFT SHIFT   2A   F5          3F


<hr>

<span id="L8035" class="QBtitle">精選程式</span>
  <span class="QH_1">&lt; 精選程式 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">精選程式 -- Selected Programs</span>

有六組範例程式,每一組包含數個程式。每一個程式的長度是 10 到 20 行並且以
函數的方式來撰寫,通常函數都使用在較大的程式中。例如,在一個檔案輸入/輸出
程式中,於磁碟上建立一個新的循序資料檔,從鍵盤上輸入資料並將這些資料寫入
檔案 -- 總共才使用 13 個程式行。

  <span class="QH_2">&lt;</span><a href="#L8036">控制流程程式</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8038">檔案和裝置輸入/輸出程式</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8039">字串處理程式</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L803B">錯誤和事件設陷程式</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L803A">繪圖程式</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8037">展示如何建立函數和程序式的程式</a><span class="QH_2">&gt;</span>

這些範例程式不同於線上援助所提供的每一個 BASIC 關鍵字的程式範例,這些
程式比較有實際上的效用,而不是只展示如何使用一個敘述或函數的方法。

這些程式也不同於 QuickBASIC 磁片內的範例程式,如: INDEX.BAS 和 TERMINAL.BAS,
因為那些範例程式相當大且複雜。


<hr>

<span id="L8036" class="QBtitle">精選控制流程範例程式</span>
  <span class="QH_2">&lt;</span><a href="#L8035"> 精選程式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 控制流程程式 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">迴圈和決策 -- Looping and Decision Making</span>

下面程式範例說明如何撰寫迴圈和決策程式結構。


<span class="QH_1">範例 1</span>

下列範例說明 SELECT CASE 和 IF...THEN...ELSE 敘述的異同處。

這個範例是使用區段 IF...THEN...ELSE 來對多種選擇作決策:


  INPUT X
  IF X = 1 THEN
    PRINT "一 "
  ELSEIF X = 2 THEN
    PRINT "二 "
  ELSEIF X = 3 THEN
    PRINT "三  "
  ELSE
    PRINT "必須是介於 1 到 3 的整數"
  END IF

上述的決策,使用 SELECT CASE 敘述重新撰寫如下:

  INPUT X
  SELECT CASE X
    CASE 1
      PRINT "一"
    CASE 2
      PRINT "二"
    CASE 3
      PRINT "三"
    CASE ELSE
      PRINT "必須是介於 1 到 3 的整數"
  END SELECT

下列決策可使用 SELECT CASE 或區段 IF...THEN...ELSE 敘述。
在此例中,以區段 IF ...THEN...ELSE 敘述來做比較是較有效率的,
因為在 IF 和 ELSEIF 子句中有不同的運算式要做計算。

  INPUT X, Y
  IF X = 0 AND Y = 0 THEN
    PRINT " 皆為零 "
  ELSEIF X = 0 THEN
    PRINT " 僅 X 為零 "
  ELSEIF Y = 0 THEN
    PRINT " 僅 Y 為零 "
  ELSE
    PRINT " 皆不為零 "
  END IF


<hr>

<span id="L8037" class="QBtitle">精選程序式範例程式</span>
  <span class="QH_2">&lt;</span><a href="#L8035"> 精選程式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 程序式範例 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">程序式 -- Procedures</span>

下列程式範例說明如何撰寫程式,並且組合程式成為一個小邏輯單元,範例中
有使用 FUNCTION 程序式。

<span class="QH_1">程式範例 1 ---使用函數</span>

一個函數中,參數和參數串列中所對應的變數,必須具有相同的型態,如下例 :

在範例中,兩個參數被傳遞到 FUNCTION 程序式中,第一個參數是一個整數,
指定由 FUNCTION 傳回的字串長度,而第二個參數是指定重覆印出的字元。


  FUNCTION CharString$(A AS INTEGER, B$) STATIC
    CharString$ = STRING$(A%, B$)
  END FUNCTION

  DIM X AS INTEGER
  INPUT "請輸入一個數字( 1 到 80 ):", X
  INPUT "請輸入一個字元:", Y$

' 重覆列印由 Y$ 字元所組成 X 次的字元字串
  PRINT CharString$(X, Y$)
  END

<span class="QH_1">範例輸出</span>

請輸入一個數字( 1 到 80 ):21
請輸入一個字元:#
#####################



<hr>

<span id="L8038" class="QBtitle">精選輸入/輸出範例程式</span>
  <span class="QH_2">&lt;</span><a href="#L8035"> 精選程式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 輸入/輸出程式 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">檔案和裝置的輸入/輸出程式 -- File and Device I/O Programs</span>

下列程式範例說明如何撰寫檔案的輸入/輸出,和裝置(device)的輸入/輸出敘述 :

<span class="QH_1">範例 1 -- 循序檔案輸入/輸出</span>

下列簡短的程式中,建立一個檔案名稱為 "Price.Dat," 的循序資料檔案,然後
由鍵盤上鍵入所要增加的資料到檔案中。在此程式中 OPEN 敘述用來建立檔案
且準備接收資料記錄。使用 WRITE # 敘述將每筆記錄寫入指定的檔案中。

注意 : 在 WRITE # 敘述中所使用的檔案代碼,是在 OPEN 敘述中開啟 Price.Dat
       檔案時所用的檔案代碼。

  ' 建立一個檔名為 Price.Dat 的資料檔,並且打開該檔案以接受新的資料:

  OPEN "Price.Dat" FOR OUTPUT AS #1

  DO
    ' 繼續輸入新記錄(record)到 Price.Dat 檔內,
    ' 直到在輸入公司名稱處,直接按 ENTER 鍵則結束。
    '
    INPUT "公司名稱(按 &lt;&lt;ENTER&gt;&gt; 則結束): ", Company$

    IF Company$ &lt;&gt; "" THEN
      ' 輸入記錄中的其他欄位:
      INPUT "款式:", Style$
      INPUT "大小:", Size$
      INPUT "顏色:", Clr$
      INPUT "數量: ", Qty
      ' 將新記錄寫到檔案中
      ' 使用 WRITE # 敘述:
      WRITE #1, Company$, Style$, Size$, Clr$, Qty
    END IF
  LOOP UNTIL Company$ = ""
  ' 關閉 Price.Dat 檔(用來結束輸出檔):
  CLOSE #1
  END

<span class="QH_1">範例 2 -- 循序檔的輸入/輸出</span>

下列程式開啟 "範例 1" 所建立的資料檔 Price.Dat,且從檔案中讀取記錄。
若資料檔中的數量低於輸入的數量時便將該筆記錄顯示在螢幕上。

INPUT #1 敘述每一次讀取 Price.Dat 資料檔中的一筆記錄,並指定記錄中
的每一個欄位到對應的 Company$, Style$, Clr$, 和 Qty 變數中。
因為此檔案為循序檔,所以讀取資料的方式是從第一筆依序讀到最後一筆。

EOF (End Of File - 檔案的結束)函數用來測試 INPUT# 敘述是否讀到
最後一筆記錄。假如讀到最後一筆記錄時,則 EOF 傳回 1 (真),而且終止
讀取資料的迴圈;假如還沒有讀到最後一筆記錄,則 EOF 傳回 0 (假),
並且繼續讀取下一筆記錄。


  OPEN "Price.Dat" FOR INPUT AS #1
  INPUT "請輸入要查詢的最高數量值"; Reorder
  DO UNTIL EOF(1)
    INPUT #1, Company$, Style$, Size$, Clr$, Qty
    IF Qty &lt; Reorder THEN
      PRINT  Company$, Style$, Size$, Clr$, Qty
    END IF
  LOOP
  CLOSE #1
  END

<span class="QH_1">範例 3-- 循序檔的輸入/輸出</span>

WRITE# 敘述可以將記錄寫入到一個指定的循序檔中。
然而,還有另外一個敘述也可以用來將記錄寫入到循序檔中:

  PRINT #

比較這兩個儲存資料敘述的差異,最好的方法是以這兩個敘述來建檔,並檢查
檔案內容的差異。
下列簡短的程式片斷用來開啟檔案 Test.Dat,然後將同一筆記錄寫入二次,
一次用 WRITE # 敘述,另一次使用 PRINT # 敘述。
在此程式執行之後,您可以用 DOS 的 TYPE 命令檢查 TEST.DAT 檔案的內容 :

  OPEN "Test.Dat" FOR OUTPUT AS #1
  Nm$ = "張三"
  Dept$ = "教育程度"
  Level = 4
  Age = 25
  WRITE #1, Nm$, Dept$, Level, Age
  PRINT #1, Nm$, Dept$, Level, Age
  CLOSE #1


<hr>

<span id="L8039" class="QBtitle">精選字串處理範例程式</span>
  <span class="QH_2">&lt;</span><a href="#L8035"> 精選程式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 字串處理 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">字串處理程式 -- String Processing Programs</span>

下例程式範例展示由不同的方法來處理 ASCII 字元所組成的字串:


<span class="QH_1">範例 1</span>

最常使用的字串處理工作之一就是找尋一個字串是否出現在另一個字串中。
INSTR 函數告訴您字串 1 是否包含字串 2,若是,則傳回字串 2 在字串 1 中
第一個字元出現的位置。若沒有匹配(亦即,字串 2 不是字串 1 的子字串),
則 INSTR 函數將傳回零值。

程式範例如下:

  String1$ = "A line of text with 37 letters in it."
  String2$ = "letters"
  PRINT "         1         2         3         4"
  PRINT "1234567890123456789012345678901234567890"
  PRINT String1$
  PRINT String2$
  PRINT INSTR(String1$, String2$)

<span class="QH_1">範例輸出</span>

         1         2         3         4
1234567890123456789012345678901234567890
A line of text with 37 letters in it.
letters
 24

<span class="QH_1">範例 2</span>

INSTR(位置,字串 1 ,字串 2)函數的變化對於找尋字串 2 每次出現在
字串 1 中,來取代找尋字串 2 第一次在字串 1 中出現時,是很有用的。

  String1$ = "the quick basic jumped over the broken saxophone."
  String2$ = "the"
  PRINT String1$
  Start = 1
  NumMatches = 0
  DO
    Match = INSTR(Start, String1$, String2$)
    IF Match &gt; 0 THEN
      PRINT TAB(Match); String2$
      Start = Match + 1
      NumMatches = NumMatches + 1
    END IF
  LOOP WHILE MATCH
  PRINT "符合的數目="; NumMatches

<span class="QH_1">範例輸出</span>

the quick basic jumped over the broken saxophone.
the
                            the
符合的數目= 2


<hr>

<span id="L803A" class="QBtitle">精選繪圖範例程式</span>
  <span class="QH_2">&lt;</span><a href="#L8035"> 精選程式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 繪圖程式 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">繪圖程式 -- Graphic Programs</span>

下列範例程式在螢幕上產生圖形。


<span class="QH_1">範例 1</span>

若 CIRCLE 敘述的起始值和終值參數為正數,您可以在一個圓上只連接起始值
或終值兩點成為一個圓孤。相反地,負數則會使該端點與圓心連接起來。若兩個
參數為負值,您可以繪製一個楔形(wedge),或者交換兩端點的順序,畫出缺了一片
楔形的餅狀圖。

  SCREEN 71       'MGA 繪圖螢幕模式
  CONST RADIUS = 150, PI = 3.141592653589#
  StartAngle = 2.5
  EndAngle = PI
  ' 繪製楔形(wedge):
  CIRCLE (295, 160), RADIUS, , -StartAngle, -EndAngle
  ' 交換起始和結束的角度:
  SWAP StartAngle, EndAngle
  ' 將圓心往下移 10 個圖素(pixel),且往右移 70 個圖素,
  ' 然後繪出一個餅狀,但會遺漏一片楔形:
  CIRCLE STEP(70, 15), RADIUS, , -StartAngle, -EndAngle

<span class="QH_1">範例輸出</span>

您必須執行此程式才能看到輸出結果。


<hr>

<span id="L803B" class="QBtitle">選定事件和錯誤設陷的範例程式</span>
  <span class="QH_2">&lt;</span><a href="#L8035"> 精選程式 </a><span class="QH_2">&gt;</span>       <span class="QH_1">&lt; 設陷程式 &gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>       <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">錯誤和事件設陷程式 -- Error and Event Trapping Programs</span>

下列程式顯示如何在程式執行時,對一個事件作設陷。此事件設陷可使程式
在執行時,能偵測執行時期的事件是否有按鍵發生。

<span class="QH_1">範例 1 --事件設陷</span>

假如您的鍵盤是 101 個鍵,可使用下列字串來設陷任何指定的按鍵 :

  CHR$(128) + CHR$(掃描碼)

可以用來提供給使用者自定鍵碼 15 到 25 之間使用。


下面範例顯示如何在專用的游標鍵和數字鍵上對 &lt;向左鍵&gt; 作設陷:

  ' 128 = 在專用的游標鍵盤上按鍵的鍵盤旗號
  '  75 = &lt;向左鍵&gt; 的掃描碼
  '
  KEY 15, CHR$(128) + CHR$(75)    ' 在專用的游標鍵上對 &lt;向左鍵&gt; 設陷
  ON KEY(15) GOSUB CursorPad
  KEY(15) ON

  ON KEY(12) GOSUB NumericPad     ' 在數字鍵上對 &lt;向左鍵&gt; 作設陷
  KEY(12) ON

  DO
  LOOP UNTIL INKEY$ = "q"          ' 閒置迴路
  END

  CursorPad:
    PRINT "在游標鍵上按 &lt;向左鍵&gt;"
  RETURN

  NumericPad:
    PRINT "在數字鍵上按 &lt;向左鍵&gt;"
  RETURN


<hr>

<span id="L803C" class="QBtitle">$INCLUDE 假命令 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8057"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8058"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">$INCLUDE</span> - 為一假命令(metacommand),用來導致 QuickBASIC 在假命令所指定
           的地方讀入一個檔案,並且編譯檔案內的 BASIC 程式。

<span class="QH_1">語法</span>
  REM $INCLUDE: '檔案名稱'
  或
  ' $INCLUDE: '檔案名稱'

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L805B"> 假命令語法 </a><span class="QH_2">&gt;</span>



<hr>

<span id="L803D" class="QBtitle">$STATIC 和 $DYNAMIC 假命令 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8059"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L805A"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">$STATIC 和 $DYNAMIC</span> - 為一假命令(metacommand),用來控制多維陣列
                      (dimensioned arrays)的配置。


<span class="QH_1">語法</span>
  REM $STATIC
  或
  ' $STATIC

  REM $DYNAMIC
  或
  ' $DYNAMIC

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L805B">假命令語法</a><span class="QH_2">&gt;</span>


<hr>

<span id="L803E" class="QBtitle">DATE$ 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A6"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80A7"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATE$</span> - 為一個字串函數,用來傳回目前設定的日期。

<span class="QH_1">語法</span>
  DATE$
    * 傳回一個含有 10 位元組的字串,其格式如下:

        yyyy-mm-dd

      yyyy 是 年 (1980-2099)
      mm   是 月 (01-12), 和
      dd   是 日 (01-31)

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803C">DATE$ 敘述</a><span class="QH_2">&gt;</span> - 用來設定日期。


<hr>

<span id="L803F" class="QBtitle">DECLARE (非 BASIC) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80AC"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80AD"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DECLARE (非 BASIC)</span> - 用來宣告以其它語言所寫的外部程序式的呼叫順序。

<span class="QH_1">語法 1</span>
  DECLARE FUNCTION 名稱 [CDECL] [ALIAS "別名"] [([參數串列])]

<span class="QH_1">語法 2</span>
  DECLARE SUB 名稱 [CDECL] [ALIAS "別名"] [([參數串列])]

    * 名稱參數是被呼叫的程序式名稱。
    * CDECL, 別名和參數串列,請參考<span class="QH_2">&lt;</span><a href="#L80AC">細節</a><span class="QH_2">&gt;</span>。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801B">CALLS 和 CALL(非 BASIC) 敘述</a><span class="QH_2">&gt;</span> -瞭解如何呼叫非 BASIC 程序式的方法


<hr>

<span id="L8040" class="QBtitle">GET(繪圖) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E5"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GET</span> - 為一繪圖敘述,用來儲存螢幕上的圖形影像。

<span class="QH_1">語法</span>
  GET [STEP] (x1,y1)-[STEP] (x2,y2), 陣列名稱[(索引)]
    * (x1,y1) 與 (x2,y2) 是數值運算式,分別代表要被截取的矩形對角點的座標。
    * STEP 參數允許您使用螢幕上的相對座標。
    * 陣列名稱代表一個用來儲存影像的陣列名稱。
    * 索引參數代表您要開始儲存影像資訊的陣列註標(subscript),有時未必
      是從陣列中第一個元素開始儲存。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L804F">PUT(繪圖)</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A6">SCREEN 敘述</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8041" class="QBtitle">INPUT # 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F5"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT #</span> - 為一檔案輸入/輸出敘述,用來從指定的循序裝置或檔案中讀取資料
          項目,並載入到所對應的變數中。

<span class="QH_1">語法</span>
  INPUT #檔案代碼, 變數串列
    * 檔案代碼是一個開啟循序檔時的檔案代號。
    * 變數串列是一個或多個以逗號分開的簡單變數的名稱,從檔案中讀取資料
      指定給對應變數,且需確定在串列中每一個變數的資料型態須和讀取的
      資料型態相符。


<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8063">INPUT$</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L8044">LINE INPUT #</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8042" class="QBtitle">KEY(n) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8103"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8104"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KEY(n)</span> - 為一事件設陷敘述,用來啟動,關閉或暫停所指定的鍵之設陷。

<span class="QH_1">語法</span>
  KEY(n) ON
  KEY(n) OFF
  KEY(n) STOP

    * KEY(n) ON 透過 ON KEY 敘述來啟動軟鍵(soft-key)或游標方向鍵的
      事件設陷。
    * KEY(n) OFF 用來關閉事件設陷;即使有一個事件發生時,也沒有被記錄。
    * KEY(n) STOP 用來禁止事件設陷; 換句話說,若您按下所指定設陷的鍵,
      此動作將被記錄,一旦 KEY(n) ON 敘述被執行時, ON KEY 事件所設定
      的設陷常式馬上會被執行。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8069">KEY</a><span class="QH_2">&gt;</span> - 有關指定軟鍵(soft-key)值給功能鍵的資訊
        <span class="QH_2">&lt;</span><a href="#L813F">ON KEY(n)</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8043" class="QBtitle">LINE INPUT 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8113"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8114"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE INPUT</span> - 為一裝置輸入/輸出敘述,用來輸入一整行(至多 255 個位元組)
             的資料給字串變數,並且不需要使用分隔符號。

<span class="QH_1">語法</span>
  LINE INPUT[;] ["提示字串";] 字串變數
    * 提示(prompt)字串為一字串常數。它會在當使用者要輸入資料之前,
      先在螢幕上顯示此提示字串資訊,以提供使用者輸入正確的資料。
      如果需要顯示問號,則必須將問號包含在提示字串常數中。
    * 字串變數用來儲存所輸入的字元,一直到使用者按下 ENTER 鍵為止。
    * [;] 是一個游標控制符號,請參閱<span class="QH_2">&lt;</span><a href="#L8113">細節</a><span class="QH_2">&gt;</span>。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8062">INPUT</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8063">INPUT$</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8044" class="QBtitle">LINE INPUT # 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8115"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8116"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE INPUT #</span> - 為一檔案輸入/輸出敘述,用來從一個循序檔上讀入沒有
               分隔符號的資料給一個字串變數。

<span class="QH_1">語法</span>
  LINE INPUT #檔案代碼, 字串變數
    * 檔案代號為開啟循序檔時,所設定的檔案代號。
    * 字串變數用來儲存在循序檔中從目前位址處開始的所有字元,直到有歸位
      (carriage-return)與換行(line-feed)連續字元為止(但不包括該歸位
      與換行的連續字元); 此歸位與換行連續字元不會被輸入。


<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8041">INPUT #</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L8043">LINE INPUT</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8062">INPUT</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8063">INPUT$</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8045" class="QBtitle">MID$ 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8129"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L812A"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MID$</span> - 為一字串處理函數,用來傳回一個字串的子字串。

<span class="QH_1">語法</span>
  MID$(字串運算式, 起始 [,長度])
    * 字串運算式指定要被截取成子字串的母字串。
    * 起始參數是一數值運算式,是介於 1 和 32,767 之間的整數。
      用來指定母字串被截取的起始位置(以 "位元組" 為計算單位)。
    * 若長度參數省略,則由起始位置開始,往右截取所有的字元。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807B">MID$ 敘述</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806D">LEFT$</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A0">RIGHT$</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806E">LEN</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8046" class="QBtitle">ON ERROR 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8139"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L813A"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON ERROR</span> - 為一錯誤設陷敘述,用來啟動錯誤處理,並且將控制權移到
             錯誤處理常式(error-handling routine)的第一行。

<span class="QH_1">語法</span>
  ON ERROR GOTO 行
    * 行參數是指行標記或行號,用來設定在程式執行中發生錯誤時,所要執行的下一個
      敘述。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809E">RESUME</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804D">ERR</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804D">ERL</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804E">ERROR</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8047" class="QBtitle">ON...GOSUB, ON...GOTO 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8137"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8138"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON...GOSUB</span> 和 <span class="QH_1">ON...GOTO</span> - 為一控制流程敘述,根據運算式來
                           分歧到數個指定行號之一。

<span class="QH_1">語法 1</span>
  ON 運算式 GOSUB {行號串列 | 行標記串列}

<span class="QH_1">語法 2</span>
  ON 運算式 GOTO {行號串列 | 行標記串列}

    * 運算式中若有小數時,會先做四捨五入成為整數,以便當作行號或行標記的索引。
      請參閱<span class="QH_2">&lt;</span><a href="#L8137">細節</a><span class="QH_2">&gt;</span> 若整數值大於串列上項目的個數時,將會有什麼狀況。
    * 行號/標記串列是程式的一組行標記和行號,藉著逗號所分開的行號與標記,
      是用來指定分歧的目標行。行標記和行號可以混合使用在同一個串列上。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A8">SELECT CASE</a><span class="QH_2">&gt;</span> -- 瞭解更多的方法來撰寫這種型態的控制流程架構。


<hr>

<span id="L8048" class="QBtitle">ON UEVENT GOSUB 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8150"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8151"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON UEVENT GOSUB</span> - 為一錯誤設陷敘述,用來對一個使用者自定事件定義
                  其事件處理常式(event-handling routine)。

<span class="QH_1">語法</span>
  ON UEVENT GOSUB {行標記|行號}
    * 行標記或行號用來指定一個事件處理常式的第一行。
    * 請參閱<span class="QH_2">&lt;</span><a href="#L8150">&lt;細節&gt;</a><span class="QH_2">&gt;</span> 有指引如何撰寫使用者自定事件處理模組。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C6">UEVENT</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8049" class="QBtitle">OPEN COM 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8154"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8155"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPEN COM</span> - 為一裝置輸入/輸出敘述,用來打開和啟始化一個輸入/輸出的通訊通道。

<span class="QH_1">語法</span>
  OPEN "COMn: 選項串列 1 選項串列 2" [FOR 模式] AS [#檔案代碼 [LEN=記錄長度]]
    * n 可以為 1 或 2,用來指定被開啟的通訊埠(port)。
    * 選項串列 1 有下列語法:
        [速率][,[同位元][,[資料數][,[結束位元]]]]
      其中預設為傳輸本文(text,而非數值)資料。
      若要傳輸數值資料請參閱 <span class="QH_2">&lt;</span><a href="#L8154">細節</a><span class="QH_2">&gt;</span>。

───────────────────────────────────────
速率    每秒傳輸的位元數("Bard Rate"),| 資料數   每個位元組(byte)資料所佔的
        預設為 300。                  |          位元(bit)數,預設為 7。
同位元  錯誤檢查的型態,               | 結束位元 在每一個資料位元組後,結束位元
        預設為偶同位(Even Parity)。   |          (stop bit)的數目,預設為 1。
───────────────────────────────────────

    * 選項串列 2 可以指定至少 10 個其他資料的通訊協定(communications
      handshaking)參數。請參閱<span class="QH_2">&lt;</span><a href="#L8154">細節</a><span class="QH_2">&gt;</span>。
    * 檔案代碼,為一個介於 1 和 255 之間的整數,此參數是一個尚未指定給
      開啟檔案的代號。
    * 模式和記錄長度請參閱<span class="QH_2">&lt;</span><a href="#L8154">細節</a><span class="QH_2">&gt;</span>。


<hr>

<span id="L804A" class="QBtitle">PEN 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8162"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8163"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PEN</span> -- 為一裝置輸入函數,用來讀取光筆的座標。

<span class="QH_1">語法</span>
  PEN(n)
    * 為一數值運算式,是介於 0 於 9 之間的整數值,表示藉著下列值傳回
      何種型態的資訊:
───────────────────────────────────────
0  自上次呼叫後,光筆是否有被壓按      | 4  取得上次光筆位置的 X 座標
   的狀態(-1 = 按下, 0 = 未壓按)      | 5  取得上次光筆位置的 Y 座標
1  取得上次光筆按下時的 X 座標        | 6  取得上次光筆按下時的字元列(Row)
2  取得上次光筆按下時的 Y 座標        | 7  取得上次光筆按下時的字元行(Column)
3  取得目前光筆的開關狀態             | 8  取得上次光筆位置的字元列
   (-1 = 按下, 0 = 沒有按下)          | 9  取得上次光筆位置的字元行
───────────────────────────────────────

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808F"> PEN 敘述 </a><span class="QH_2">&gt;</span>


<hr>

<span id="L804B" class="QBtitle">PLAY 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L816C"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L816D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY</span> - 為一事件設陷函數,用來傳回目前背景音樂佇列(Queue)中的音符。

<span class="QH_1">語法</span>
  PLAY(n)
    * 可為任意值,但不能在 PLAY 函數中使用。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8141">ON PLAY(n)</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8090">PLAY</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L804C">PLAY ON, PLAY OFF, PLAY STOP</a><span class="QH_2">&gt;</span>


<hr>

<span id="L804C" class="QBtitle">PLAY ON, PLAY OFF, 和 PLAY STOP 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L816E"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L816F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY ON, PLAY OFF,</span> 和  <span class="QH_1">PLAY STOP</span> - 為一事件設陷敘述,用來啟動,關閉
                                   或暫停演奏事件的設陷。

<span class="QH_1">語法</span>
  PLAY ON
  PLAY OFF
  PLAY STOP

    * PLAY ON 啟動演奏事件設陷,藉著 ON PLAY 敘述來設陷。
    * PLAY OFF 關閉事件設陷,即使演奏事件發生,也不予記錄。
    * PLAY STOP 禁止事件設陷,假如事件發生時會給予記錄,並且一旦 PLAY ON
      被執行時, ON PLAY 事件的設陷常式立刻會被執行。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8141">ON PLAY(n)</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8090">PLAY</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L804B">PLAY 函數</a><span class="QH_2">&gt;</span>


<hr>

<span id="L804D" class="QBtitle">PRINT USING 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L817C"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L817D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT USING</span> - 為一裝置輸入/輸出敘述,使用指定的格式來列印字串或數值。

<span class="QH_1">語法</span>
  PRINT USING 格式字串; 運算式串列[{,|;}]
    * 格式字串為一字串運算式,用來指定列印的格式。這些格式字串中的字元
      有下列意義:

─────── 下 面 的 字 元 用 來 格 式 化 一 個 數 值 運 算 式  ─────
 #    數字的位置                         | -     只對數值為負的數字,在其尾部
 .    十進制小數點的位置                 |       加上負號
 ,    自十進制小數點的左邊,每三個數位    | $$    在數值前面加上 $ 號
      會加印一個逗號。                   | **    使用 * 號填滿前面空白
 +    安放數值符號的位置                 | **$   配合 ** 和  $ 使用
^^^^  以指數格式印出數值                 |


───────下 面 的 字 元 用 來 格 式 化 一 個 字 串 運 算 式 ──────
 &    列印整個字串                       | \  \  印出字串中最前面 n+2 個位元
 !    僅印出給定字串中的第一個字元       |       組長度的資料。
      (英文或中文字元)                   |       其中 n 值是介於兩個倒斜線間
                                         |       的空白字元(&H20)數,若所印出
                                         |       的最右邊位置不能容納一個完整
                                         |       的中文字元時,該中文字元不會
                                         |       被印出。


───  下 面 的 字 元 在 格 式 化 字 串 中 用 來 列 印 定 字 字 元  ────
 _    將跟隨在參數後的一個格式化的字元   |       任何不在這些表中的字元都被
      當做定字(literal)印出              |       當作定字(literal)印出
                                         |

    * 運算式串列包含將被列印的項目。
    * 選項 "," 或 ";" 為運算式串列參數結尾的游標控制符號, 請參閱<span class="QH_2">&lt;</span><a href="#L817C">細節</a><span class="QH_2">&gt;</span>。


<hr>

<span id="L804E" class="QBtitle">PRINT # 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L817E"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L817F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT #, PRINT # USING</span> - 為一檔案輸入/輸出敘述,用來將資料寫入一個
                         循序檔中。

<span class="QH_1">PRINT # 語法</span>
  PRINT #檔案代碼, [USING 格式字串;] 運算式串列[{,|;}]
    * 檔案代碼是一個開啟循序檔時的檔案代號。
    * 運算式串列包含所要寫入檔案的資料項。假如省略此參數,則寫入一個空白行
      到檔案中。

<span class="QH_1">PRINT # USING 語法</span>
  PRINT #檔案代碼, USING 格式字串; 運算式串列[{,|;}]
    * 格式字串為一字串運算式,用來指定資料要寫到檔案中的正確格式。
      在格式化字串中的字元有下列的意義:

──────  下 面 的 字 元 用 來 格 式 化 一 個 數 值 運 算 式  ──────
 #    數字的位置                         | -     只對數值為負的數字,在其尾部
 .    十進制小數點的位置                 |       加上負號
 ,    自十進制小數點的左邊,每三個數位    | $$    數值前面加上 $ 號
      會加印一個逗號。                   | **    使用 * 號填滿前面空白
 +    安放數值符號的位置                 | **$   結合 ** 和  $ 使用
^^^^  以指數格式印出數值                 |

──────  下 面 的 字 元 用 來 格 式 化 一 個 字 串 運 算 式  ──────
 &    列印整個字串                       | \  \  印出字串中最前面 n+2 個位元
 !    僅印出給定字串中的第一個字元       |       組長度的資料。
      (英文或中文字元)                   |       其中 n 值是介於兩個倒斜線間
                                         |       的空白字元(&H20)數,若所印出
                                         |       的最右邊位置不能容納一個完整
                                         |       的中文字元時,該中文字元不會
                                         |       被印出。
                                         |

─── 下 面 的 字 元 在 格 式 化 字 串 中 用 來 列 印 定 字 字 元 ─────
 _     將跟隨在 "-" 後的一個字元當做     |       任何不在這些表中的字元,都被
       定字印出                          |       當作定字(literal)印出

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8086">OPEN</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D0">WRITE #</a><span class="QH_2">&gt;</span>


<hr>

<span id="L804F" class="QBtitle">PUT(繪圖) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8184"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8185"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> C/內 容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> I/索 引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PUT</span> - 為一繪圖敘述,用來將由 GET 敘述所儲存的圖形影像顯示在螢幕上。

<span class="QH_1">語法</span>
  PUT [STEP] (x, y), 陣列名稱[(索引)] [,作用]
    * (x,y) 參數定義此矩形圖形影像(graphic image)的左上角,顯示在螢幕上的
      座標。
    * STEP 允許您使用螢幕上的相對座標。
    * 陣列名稱參數代表儲存圖形影像的陣列名稱。
    * 索引參數,允許您不必由陣列第一個元素開始取出影像資料。
    * 作用參數,允許您用特殊效果來顯示影像,這些參數必須是根據下面關鍵字之一
      來設定(預設值是 XOR):

                                      |
PSET    擦掉已存在的影像,改以所存的影 | XOR   將所儲存的影像與現在螢幕上的
        像畫出。                      |       影像作 XOR 邏輯運算。
PRESET  擦掉己存在的影像,改以所存影像 |       使用連續 XOR 作用,再配合時間的
        的反相畫出。                  |       延遲,可以使儲存的影像顯示或消
AND     將儲存的影像與現在螢幕上的    |       失。如此便可利用影像的移動來達
        影像作 AND 邏輯運算。         |       到動畫的效果。
OR      將儲存的影像與現在螢幕上的    |
        影像作 OR 邏輯運算。          |

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8040">GET(繪圖)</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8050" class="QBtitle">SCREEN 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A4"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A5"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SCREEN</span> - 為一繪圖函數,用來在本文螢幕模式(Text Screen Mode)下讀取一個
         指定位置上的字元碼或顏色。

<span class="QH_1">語法</span>
  SCREEN(列, 行 [,顏色旗標])
    * 列參數是螢幕上的列(Row)位置。
    * 行參數是螢幕上的行(Column)位置。
    * 若顏色旗標(color flag)未被使用或者為零,則傳回螢幕位置上的字元碼,
      有下列幾種範圍 :
      (1). 當 (列,行) 位置是在一個英文字元上,傳回的範圍是:
           &H00 - &H7F
      (2). 當 (列,行) 位置是在一個中文字元的左半邊上,傳回的範圍是:
           &H0181 - &H01FE
      (3). 當 (列,行) 位置是在一個中文字元的右半邊上,傳回的範圍是:
           &H0240 - &H027E
           &H02A1 - &H02FE
    * 若顏色旗標是一個不為零的數值,則傳回該位置儲存在視訊本文緩衝區
      (Video Text Buffer)內的顏色屬性(彩色螢幕)或顯示屬性(單色螢幕)值。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A6">SCREEN 敘述</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L8223">ASCII 碼表</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802F">COLOR</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808C">PALETTE</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8051" class="QBtitle">SEEK 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AB"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SEEK</span> - 為一檔案輸入/輸出函數,用來傳回目前檔案的位置。

<span class="QH_1">語法</span>
  SEEK(檔案代碼)
    * 檔案代碼是一個開啟隨機存取,循序或二進位檔案時的檔案代號。
      如果是隨機存取檔,那麼經由 SEEK 函數傳回的是一個相對的記錄號碼
      (relative record number);如果是循序或二進位檔,則傳回一個相對的
      位元組數目(relative byte number)。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8086">OPEN</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8059">GET(檔案輸入/輸出)</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805A">PUT(檔案輸入/輸出)</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A7">SEEK 敘述</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8052" class="QBtitle">STRIG 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CD"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STRIG</span> - 為一裝置輸入/輸出函數,用來傳回一個指定搖桿觸動的狀態。

<span class="QH_1">語法</span>
  STRIG(n)
    * n, 是數值運算式,其值為介於 0 和 7 之間的一個整數值,此參數代表何種
      資訊的型態,可藉由參數傳回:
───────────────────────────────────────
參 數     按 鈕    搖 桿      傳 回 值
 0         下        A        自從上次呼叫 STRIG(0) 以後,若搖桿 A 的下按鈕
                              有被按過,則傳回 -1, 否則傳回零。
 1         下        A        如果目前搖桿 A 的下按鈕是按下,則傳回 -1, 否則
                              傳回零。
 2         下        B        自從上次呼叫 STRIG(2) 以後,若搖桿 B 的下按鈕
                              有被按過,則傳回 -1, 否則傳回零。
 3         下        B        如果目前搖桿 B 的下按鈕是按下,則傳回 -1, 否則
                              傳回零。
 4         上        A        自從上次呼叫 STRIG(4) 以後,若搖桿 A 的上按鈕
                              有被按過,則傳回 -1, 否則傳回零。
 5         上        A        如果目前搖桿 A 的上按鈕是按下,則傳回 -1, 否則
                              傳回零。
 6         上        B        自從上次呼叫 STRIG(6) 以來,若搖桿 B 的上按鈕
                              有被按過,則傳回 -1, 否則傳回零。
 7         上        B        如果目前搖桿 B 的上按鈕是按下,則傳回 -1, 否則
                              傳回零。
───────────────────────────────────────

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8142">ON STRIG(n)</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B8">STRIG 敘述</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8053" class="QBtitle">TIME$ 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DD"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIME$</span> - 為一與 DOS 之間的介面函數,用來傳回目前的時間。

<span class="QH_1">語法</span>
  TIME$
    * 傳回一個 8 個位元組長度的字串,其形式如下:
        hh:mm:ss
      hh 為時 (00-23)
      mm 為分 (0-59)
      ss 為秒 (00-59)

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BF">TIME$ 敘述</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8054" class="QBtitle">TIMER 函數 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E1"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIMER</span> - 用來傳回自午夜零點以後,己過去的時間的總秒數。

<span class="QH_1">語法</span>
  TIMER



<hr>

<span id="L8055" class="QBtitle">VIEW PRINT 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F9"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VIEW PRINT</span> - 為一裝置輸入/輸出敘述,用來設定螢幕上本文景象埠的邊界。

<span class="QH_1">語法</span>
  VIEW PRINT [頂行 TO 底行]
    * 省略參數時,則設定本文景像埠(Text Viewport)為目前螢幕的實際大小。
    * 頂行參數為一個整數值的數值運算式,代表新的本文景象埠的最上端一行(Line)。
    * 底行參數是新的本文景象埠的最下端一行。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A6">SCREEN 敘述</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CE">WIDTH</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802C">CLS</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8072">LOCATE</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8096">PRINT</a><span class="QH_2">&gt;</span>
        <span class="QH_2">&lt;</span><a href="#L8050">SCREEN 函數</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8056" class="QBtitle">WRITE 敘述 Quick 畫面</span>
  <span class="QH_1">&lt; Quick 畫面 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8201"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8202"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WRITE</span> - 為一裝置輸入/輸出敘述,用來將資料傳送到螢幕上。

<span class="QH_1">語法</span>
  WRITE [運算式串列]
    * 如果運算式串列省略,則列印一個空白行。
    * 運算式串列可以包含一個或多個運算式,中間以逗號分開。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8096">PRINT</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L804D">PRINT USING</a><span class="QH_2">&gt;</span>



<hr>

<span id="L8057" class="QBtitle">$INCLUDE 假命令細節</span>
  <span class="QH_2">&lt;</span><a href="#L803C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8058"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">$INCLUDE 假命令細節</span>

$INCLUDE 假命令指示編譯器(Compiler)暫時離開正在處理的檔案,並且切換到由
$INCLUDE 後面的參數所指定的 BASIC 內含檔,來讀取程式敘述。當內含檔案的處理
結束時,編譯器會返回到最初正在處理的檔案。因為編譯是繼續由跟隨在 $INCLUDE
的下一行開始編譯,所以 $INCLUDE 應該是該行的最後一個敘述。底下的敘述是正確的:

  DEFINT I-N   ' $INCLUDE: 'COMMON.BAS'

使用內含檔(include file)有二個限制:
  * 內含檔是不能包含 SUB 和 GOTO 敘述。
  * 由 BASICA 所產生的內含檔,在存檔時必須使用 ",A" 選擇項。


<hr>

<span id="L8058" class="QBtitle">$INCLUDE 假命令程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L803C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8057"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範 例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_2">&lt;</span><a href="#L820A">CALL INTERRUPT 敘述程式範例</a><span class="QH_2">&gt;</span> 有使用一個$INCLUDE 假命令。



<hr>

<span id="L8059" class="QBtitle">$STATIC 和 $DYNAMIC 假命令細節</span>
  <span class="QH_2">&lt;</span><a href="#L803D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L805A"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">$STATIC 和 $DYNAMIC 假命令細節</span>

$STATIC 和 $DYNAMIC 假命令是告訴編譯器(Compiler)如何為陣列配置記憶體空間。
這些假命令都不需要任何參數:

  '使所有陣列為動態。
  '$DYNAMIC

$STATIC 在編譯時就對陣列設定好儲存空間,當 $STATIC 假命令有被使用在程式時,
ERASE 敘述會重新啟始所有陣列的值為 0 (數值陣列)或空字串(字串陣列),但不會
刪除陣列。REDIM 敘述對 $STATIC 陣列沒有影響。

$DYNAMIC 假命令在程式執行時才對陣列配置記憶體空間,這意思是說 ERASE 敘述
可刪除陣列並把它從記憶體中釋放掉給其他變數使用,但您仍然可以使用 REDIM 敘述
來改變 $DYNAMIC 陣列的大小。

$STATIC 和 $DYNAMIC 假命令除了不明確的陣列宣告(陣列沒有用 DIM 敘述宣告)
以外,對所有陣列都有影響。不明確的陣列宣告只要有使用 $STATIC 便會配置記憶體
空間給該陣列使用。



<hr>

<span id="L805A" class="QBtitle">$STATIC 和 $DYNAMIC 假命令程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L803D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8059"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
請參閱 <span class="QH_2">&lt;</span><a href="#L80C8">ERASE 敘述程式範例</a><span class="QH_2">&gt;</span>, 有 $DYNAMIC和 $ STATIC 命令的使用法。



<hr>

<span id="L805B" class="QBtitle">假命令語法</span>
<span class="QH_1">假命令語法</span>

假命令是以一個錢號($)開始,並且包含在一個程式註解(comment)中。一個註解行中
可以存放多個假命令。多個假命令中間是用空白字元,如:空白,TAB,或跳行(Line-Feed)
來分開。若假命令後面有參數,則假命令與參數之間要有冒號(:)。如下列所示:

  REM $METACOMMAND [:參數]

若為字串參數,則必須要用單引號框起來。在一個假命令元素間的空白部分是會被忽略
的。下列的假命令都是有效的型式:

  REM $STATIC $INCLUDE:  'datadefs.bi'
  REM   $STATIC    $INCLUDE :  'datadefs.bi'&lt;R&gt;
  ' $STATIC $INCLUDE: 'datadefs.bi'
  '     $STATIC    $INCLUDE :  'datadefs.bi'

注意 : 在 $ 符號和假命令之間不可有空白。

假如要在一個描述行內僅參考一個假命令,但卻不執行時,可以放置一個不是 TAB 或
空白字元在該行的第一個錢號之前。例如,在下例一行的二個假命令都會被忽略:

  REM x$STATIC $INCLUDE:  'datadefs.bi'



<hr>

<span id="L805C" class="QBtitle">ABS 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L800B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L805D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ABS 函數細節</span>

<span class="QH_1">語法</span>
  ABS(數值運算式)

此絕對值函數會傳回該參數的無正負符號的數值。例如 ABS(-1) 和 ABS(1) 都是 1。



<hr>

<span id="L805D" class="QBtitle">ABS 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L800B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L805C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ABS 函數程式範例</span>

下面的範例是尋找一個立方根(cube root)的近似值。使用 ABS 函數來尋找兩個猜測值
之間的差是否足夠正確。

DEFDBL A-Z
Precision = .0000001#
CLS                               '清除螢幕
INPUT "請輸入一個值:", Value      '輸入的提示資訊
'  產生最初的兩個猜測值
X1 = 0.0# : X2 = Value
'  一直執行到兩個猜測值間的差是小於所要求的精確度為止
DO UNTIL ABS(X1 - X2) &lt; Precision
    X = (X1 + X2) / 2.0#
    ' 調整猜測值
    IF X * X * X - Value &lt; 0.0# THEN
        X1 = X
    ELSE
        X2 = X
    END IF
LOOP
PRINT "立方根是"; X

<span class="QH_1">範例輸出</span>

請輸入一個值: 27
立方根是 : 2.999999972060323



<hr>

<span id="L805E" class="QBtitle">ASC 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8012"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L805F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ASC 函數細節</span>

<span class="QH_1">語法</span>
  ASC(字串運算式)

若字串運算式為空字串,則 ASC 會產生一個 "不正確的函數呼叫" 的執行期間(run-time)
錯誤訊息。


<hr>

<span id="L805F" class="QBtitle">ASC 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8012"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L805E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ASC 函數程式範例</span>

<span class="QH_1">範例 1</span>

'
' ASC 與 HEX$ 函數連用,求出一個中文字的十六進制值
'
    a$ = "中文化"
    FOR i = 1 to CLEN(a$)
        b$ = CMID$(a$, i, 1)
        PRINT HEX$(ASC(b$))
    NEXT

<span class="QH_1">範例 1 輸出</span>

輸出:  A4A4
       A4E5
       A4C6

<span class="QH_1">範例 2</span>

'
' ASC 函數沒有使用 HEX$ 函數時
'
    a$ = "中文化"
    FOR i = 1 to CLEN(a$)
        b$ = CMID$(a$, i, 1)
        PRINT ASC(b$)
    NEXT

<span class="QH_1">範例 2 輸出</span>

輸 出:-23388
      -23323
      -23354


<hr>

<span id="L8060" class="QBtitle">ATN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8013"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8061"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ATN 函數細節</span>

<span class="QH_1">語法</span>
  ATN(數值運算式)

數值運算式可以為任意的數值型態。

ATN 函數預設以單精確度來計算。若數值運算式是一個倍精確度值, ATN 是以倍精確度
來計算。

其結果是以弳度量來表示,其值介於 -Π/2 到 Π/2 弳度量之間,其中 Π = 3.141593,
Π/2 弳度量是等於 90 度。

您可以由一個角度量乘上 Π/180,使度度量變成弳度量,其中 Π = 3.141593。

將一個弳度量乘上 57.2958 便可轉換成度度量。


<hr>

<span id="L8061" class="QBtitle">ATN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8013"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8060"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ATN 函數程式範例</span>

底下的例子首先找出 PI/4 的正切值(tangent),並且將該值取反正切(arctangent),
其結果是 PI/4。

CONST PI=3.141592653
PRINT ATN(TAN(PI/4.0)), PI/4.0

<span class="QH_1">範例輸出</span>

 .78539816325  .78539816325



<hr>

<span id="L8062" class="QBtitle">BEEP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8014"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8063"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BEEP 敘述細節</span>

<span class="QH_1">語法</span>
  BEEP

BEEP 敘述透過喇叭來產生聲音。這個敘述與下列敘述會產生相同的聲音:

PRINT CHR$(7)



<hr>

<span id="L8063" class="QBtitle">BEEP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8014"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8062"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BEEP 敘述程式範例</span>

底下範例使用 BEEP 以回應一個錯誤:

CLS                ' 清除螢幕
DO
   INPUT "聽到一個嗶聲(Y or N)"; Response$
   R$ = UCASE$ (MID$ (Response$,1,1))
   IF R$ &lt;&gt; "Y" OR R$ = "N" THEN EXIT DO
   BEEP
LOOP



<hr>

<span id="L8064" class="QBtitle">BLOAD 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8017"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8065"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BLOAD 敘述細節</span>

<span class="QH_1">語法</span>
  BLOAD 檔案名稱 [,位移]

  <span class="QH_1">參數        說明</span>
  檔案名稱    為一個包含檔案名稱的字串運算式。除了鍵盤(KYBD:)外,其他的
              輸入裝置(input devices)均被支援。

  位移        為記憶體內的位移位址(Offset Address),此地方是影像將載入
              的記憶體起始點。

BLOAD 敘述允許一個以記憶體影像檔(memory-image file)方式儲存的程式或資料,
可以被載入到記憶體中的任何地方。一個記憶體影像檔是以一個位元組對一個位元組
(byte for byte)方式拷貝原來在記憶體中的內容。

  注意 : 用 BASIC 早期版本寫的程式,如果有使用 VARPTR 來存取(access)數值
         陣列,已經無法再運作了。

載入的起始位址是由指定的位移和最近使用 DEF SEG 敘述來決定。若位移參數
被省略,則包含在檔案中(在 BSAVE 敘述中所使用的位址)的區段位址(節位址
-- Segment Address)和位移位址(節內位址 -- Offset Address)將被拿來使用。
如此,檔案載入所用的位址就是當初儲存檔案時所用的位址。

如果您給予位移參數,那麼所使用的節(區段)位址是由最近執行 DEF SEG 敘述
所設定的節位址。如果沒有使用 DEF SEG 敘述,就使用 BASIC 的資料區段
(DS - Data Segment)來當作預設的節位址。

如果位移參數是單精確度或倍精確度數字,它會被強制轉成整數。如果位移值
介於 -1 到 -32,768 間的負數,它會被視為一個無正負符號的兩個位元組長度
的位移位址值。

  注意 : 因為 BLOAD 沒有對位址範圍做檢查,它可以載入一個檔案到記憶體
         中的任何位址,您必須要小心,不要寫到 BASIC 或作業系統位址上。

不同螢幕模式所使用的記憶體是有差別的,載入繪圖影像(graphic images)應在
與當初產生影像相同的螢幕模式上執行。

                 <span class="QH_1">----------注意------------</span>
而且,不要用 BLOAD 敘述載入由 BASICA 程式所產生的影像檔,因為 BASIC 的
程式碼和資料項並不會和 BASICA 一樣儲存在相同的位址上。
                 <span class="QH_1">--------------------------</span>

<span class="QH_1">和 BASICA 的差異</span>

BLOAD 不支援卡帶裝置。


<hr>

<span id="L8065" class="QBtitle">BLOAD 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8017"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8064"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BLOAD 敘述程式範例</span>

這個範例是使用 BLOAD 敘述來擷取和顯示在一個方框中的立方體。而 BSAVE 敘述的
程式範例是用來將一個圖形建成一個檔案,並儲存到磁碟上。

'*** 使用 BLOAD 程式範例 ***
' 在執行這個程式之前,您必須使用 BSAVE 敘述的程式範例先產生 MAGCUBE.GRH 檔案
' 然後才可使用 MAGCUBE.GRH 檔案。
'
DIM Cube(1 TO 675)
' 設定螢幕模式,這個模式必須和原先繪圖時的模式相同。
SCREEN 71
' 對陣列 Cube's 區段設定節位址並將圖形檔案載入到 Cube 陣列
DEF SEG = VARSEG(Cube(1))
BLOAD "MAGCUBE.GRH", VARPTR(Cube(1))
DEF SEG               ' 恢復 BASIC 預設的區段
' 將所繪的圖放在螢幕上
PUT (80, 10), Cube


<hr>

<span id="L8066" class="QBtitle">BSAVE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8018"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8067"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BSAVE 敘述細節</span>

<span class="QH_1">語法</span>
  BSAVE 檔案名稱, 位移, 長度

  <span class="QH_1">參數        說明</span>
  檔案名稱    一個包含裝置名稱與檔案名稱的字串運算式。除了控制台(SCRN: 和
              CONS:)以外,其他的輸出裝置(device)都被支援。

  位移        由記憶體中區段(節-Segment)內的位移位址(節內位址-Offset Address)
              開始儲存。

  長度        要儲存的位元組數目。這是一個數字運算式會傳回一個
              其值介於 0 - 65,535 之間的無正負符號的整數。

BSAVE 敘述允許資料或程式被當成記憶體影像資料儲存到磁碟上。一個記憶體影像檔
(memory-image file)包含記憶體內容(以一個位元組對一個位元組--byte for byte
方式拷貝),與控制訊息(提供給 BLOAD 敘述使用)。

  注意 : 以 BASIC 早期版本寫的程式,如果有使用 VARPTR 存取(access)數值
         陣列,已經無法再運作了。

儲存區域的起始位址是由最近 DEF SEG 敘述所設定的區段位址(節位址 - Segment
Address),加上區段內的位移位址(節內位址 - Offset Address)來決定。

如果 DEF SEG 敘述在 BSAVE 敘述之前未被執行,那麼程式就使用 BASIC 預設的
資料區段(DS-Data Segment)。否則, BSAVE 是由最近 DEF SEG 敘述所設定的
區段位址加上區段內的位移位址開始儲存。

如果位移參數是一個單精確度或倍精確度浮點值,它們將被強制變成一個整數。
若位移參數範圍是介於 -1 到 -32,768 之間,則被視為一個無正負符號的 2 個
位元組的位移值。

  注意 : 由於不同螢幕模式所使用的記憶體是有差別的,因此載入繪圖影像
         (graphic images)應在與當初產生該影像相同的螢幕模式上執行。

<span class="QH_1">和 BASICA 的差異</span>

BSAVE 不支援卡帶裝置。


<hr>

<span id="L8067" class="QBtitle">BSAVE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8018"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8066"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BSAVE 敘述程式範例</span>

此範例乃在方框中繪製一個立方體,然後使用 BSAVE 敘述將繪製好的圖形存入
MAGCUBE.GRH 檔。 BLOAD 敘述範例程式,顯示如何擷取和顯示己繪製完成之圖形。

DIM Cube(1 TO 675)
SCREEN 71
' 畫一個方框
LINE (140, 25)-(140 + 100, 125), , B
' 在方框內繪製一個立方體的外形
DRAW "C2 BM140,50 M+50,-25 M+50,25 M-50,25"
DRAW "M-50,-25 M+0,50 M+50,25 M+50,-25 M+0,-50 BM190,75 M+0,50"
' 將圖形儲入 Cube 陣列。
GET (140, 25)-(240, 125), Cube
' 設定 Cube 陣列的區段且儲存圖形在 MAGCUBE.GRH 檔內
' 注意: 2700 是在 Cube 陣列所佔的位元組數
' (每一陣列元素佔 4 個位元組,共 675 個元素)
DEF SEG = VARSEG(Cube(1))
BSAVE "MAGCUBE.GRH", VARPTR(Cube(1)), 2700
DEF SEG                 ' 恢復預設的 BASIC 區段(segment)


<hr>

<span id="L8068" class="QBtitle">CALL (BASIC 程序式) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8069"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL (BASIC 程序式) 敘述細節</span>

<span class="QH_1">語法</span>
  CALL 名稱[(參數串列)]

  <span class="QH_1">參數          說明</span>
  名稱          名稱參數代表 BASIC 的 SUB 副程式(subprogram)名稱,長度最多
                為 40 個英文字元。假如 SUB 副程式是在相同的模組中,此名稱
                必須出現在 SUB 敘述中。

  參數串列      參數串列中的變數或常數被用來傳遞到副程式中。參數串列中的
                參數必須以逗號分開。它以傳址方式來傳遞參數,所以可以由副程式
                來改變其值。

假如參數串列包括一個陣列參數,此陣列由陣列名稱,其後緊隨著空的括號來指定,
如下例:

  DIM IntArray(1 TO 20)
  .
  .
  .
  CALL ShellSort(IntArray())

使用 CALL 敘述時,您可選擇是否使用 CALL 關鍵字。無論如何,若省略 CALL 關鍵字,
您必須用 DECLARE 敘述宣告此副程式。同時注意:當您省略 CALL 關鍵字,同時也要省略
參數串列的左右括號。

參數傳址方式 : 傳遞參數的位址給予副程式,同時允許副程式來改變參數的值。

BASIC 也可以用傳值的方式傳遞參數。下列敘述呼叫一個副程式,並且以傳值方式
傳遞一個參數。

  CALL SolvePuzzle((StartValue))

因為 StartValue 參數用括號括住, BASIC 會將它當作運算式來求值,同時將結果
存在暫時位置,然後再將此暫時位置的位址傳遞給 SUB 副程式。
對於副程式 SolvePuzzle 的任何更改僅針對該暫時位置,而非對該變數本身。


<hr>

<span id="L8069" class="QBtitle">CALL (BASIC 程序式) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8068"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL (BASIC 程序式) 敘述程式範例</span>

CALL_EX.BAS 為子目錄 ADVR_EX 之下的程式檔案,用來說明 CALL 敘述的使用。
可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入程式,並可執行它。

此程式拷貝一系列的檔案到一個新的檔案,此新檔案是在命令行(command line)中
一系列輸入的最後一個檔案名稱。在程式中,一旦呼叫 PRINTOUT 副程式時,命令行
上的檔案名稱將被分離,並且將他們存入 FILE$ 陣列中。PRINTOUT 副程式拷貝檔案
的內容到串列中的最後一個檔案,並且送到標準的輸出裝置上(預設為 : 螢幕)。



<hr>

<span id="L806A" class="QBtitle">CBDL$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L806B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CDBL$ 函數細節</span>

<span class="QH_1">語法</span>
  CDBL$(字串運算式)

  * 將含有英文字元的字串,轉換成含有中文字元的字串。
  * CDBL$ 與 CSNG$ 的功能相反。
  * 可以被轉換的英文字元範圍是 ASCII 碼的 &H20 到 &H7E 。
  * 下表是描述佔 1 個位元組長度的英文字元,與佔 2 個位元組長度的
    中文字元之間的轉換對照表(可以在 [英數][全形] 的輸入法下得到
    這些中文碼) :

      +====================================================+
      | 英文字 |   ASCII   |   中文字    |       中文      |
      |  字型  |    碼     |    字型     |        碼       |
      +====================================================+
      |        |    &H20   |             |      &HA140     |
      |   !    |    &H21   |      ！     |      &HA149     |
      |   "    |    &H22   |      ”     |      &HA1A8     |
      |   #    |    &H23   |      ＃     |      &HA1AD     |
      |   $    |    &H24   |      ＄     |      &HA243     |
      |   %    |    &H25   |      ％     |      &HA248     |
      |   &    |    &H26   |      ＆     |      &HA1AE     |
      |   '    |    &H27   |      ’     |      &HA1A6     |
      |   (    |    &H28   |     （      |      &HA15D     |
      |   )    |    &H29   |      ）     |      &HA15E     |
      |   *    |    &H2A   |      ＊     |      &HA1AF     |
      |   +    |    &H2B   |      ＋     |      &HA1CF     |
      |   ,    |    &H2C   |      ，     |      &HA141     |
      |   -    |    &H2D   |      －     |      &HA1D0     |
      |   .    |    &H2E   |      ．     |      &HA144     |
      |   /    |    &H2F   |      ／     |      &HA1FE     |
      | 0 &lt; 9  |&H30 &lt; &H39|   ０ &lt; ９   | &HA2AF &lt; &HA2B8 |
      |   :    |    &H3A   |      ：     |      &HA147     |
      |   ;    |    &H3B   |      ；     |      &HA146     |
      |   &lt;    |    &H3C   |      ＜     |      &HA1D5     |
      |   =    |    &H3D   |      ＝     |      &HA1D7     |
      |   &gt;    |    &H3E   |      ＞     |      &HA1D6     |
      |   ?    |    &H3F   |      ？     |      &HA148     |
      |   @    |    &H40   |      ＠     |      &HA249     |
      | A &lt; Z  |&H41 &lt; &H5A|   Ａ &lt; Ｚ   | &HA2CF &lt; &HA2E8 |
      |   [    |    &H5B   |      〔     |      &HA165     |
      |   \    |    &H5C   |      ＼     |      &HA240     |
      |   ]    |    &H5D   |      〕     |      &HA166     |
      |   ^    |    &H5E   |      ︿     |      &HA173     |
      |   _    |    &H5F   |      ˍ     |      &HA1C5     |
      |   '    |    &H60   |      ‘     |      &HA1A5     |
      | a &lt; z  |&61H&lt; &H7A |    ａ&lt; ｚ   | &HA2E9 &lt; &HA343 |
      |   {    |    &H7B   |      ｛     |      &HA161     |
      |   |    |    &H7C   |      ｜     |      &HA155     |
      |   }    |    &H7D   |      ｝     |      &HA162     |
      |   &lt;    |    &H7E   |      ∼     |      &HA1E3     |
      +----------------------------------------------------+


<hr>

<span id="L806B" class="QBtitle">CBDL$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L806A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CDBL$ 程式範例</span>

下例用來說明字串運算式的精確度如何影響到使用 CDBL$ 的結果:

A$ = "QuickBASIC 中文化"
B$ = CDBL$(A$)
PRINT A$
PRINT B$

<span class="QH_1">範例輸出</span>

QuickBASIC 中文化
ＱｕｉｃｋＢＡＳＩＣ  中文化



<hr>

<span id="L806C" class="QBtitle">CEXT$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8020"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L806D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CEXT$ 函數細節</span>

<span class="QH_1">語法</span>
  CEXT$ (字串運算式,字元型態)

  <span class="QH_1">參數             說明</span>
字串運算式         要被修改的母字串變數

字元型態           00 = 佔 1 個位元組長度的英文字元
                   01 = 佔 2 個位元組長度的中文字元


傳回在一個從字串運算式中由指定的字元型態所組成的字串。
  * 若字元型態參數是 00, 則傳回一個全部由英文字元所構成的字串。
  * 若字元型態參數是 01, 則傳回一個全部由中文字元所構成的字串。



<hr>

<span id="L806D" class="QBtitle">CEXT$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8020"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L806C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CEXT$ 函數程式範例</span>

<span class="QH_1">範例</span>

A$ = "QuickBASIC 程式設計 for V4.50 "
PRINT CEXT$(A$,0) + CEXT$(A$,1)

<span class="QH_1">範例輸出</span>

QuickBASIC  for V4.50 程式設計



<hr>

<span id="L806E" class="QBtitle">CHAIN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8021"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L806F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CHAIN 敘述細節</span>

<span class="QH_1">語法</span>
  CHAIN 檔名

檔名可為一字串運算式,用來表示要載入的檔案名稱。檔名參數可以包括路徑名稱。

  * 程式在 QuickBASIC 的工作環境中執行時,若沒有設定延伸檔名,則預設的鏈結
    延伸檔名為 .BAS 的程式,而且無法與執行檔(延伸檔名為 .COM 或 .EXE
    的檔案)做鏈結(CHAIN)。
  * 程式在 QuickBASIC 工作環境外執行時,若延伸檔名為 .EXE,則無法與
    QuickBASIC 的原始檔(延伸檔名為 .BAS 的檔案)做鏈結。

傳遞變數給另一個程式時,可以使用 COMMON 敘述來設定。一個空白(不具名)
的 COMMON 區段,請參閱 COMMON 敘述。

假如您在 QuickBASIC 環境之外編譯(compiling)一個程式,必須注意: BCOM45C.LIB
程式庫是沒有提供 COMMON 敘述的功能。但在 QuickBASIC 環境之外,可以提供兩種
途徑來使用 COMMON 敘述鏈結程式 :
 * 使用 "產生執行檔..." 交談框 的 "需要 BRUN45C.EXE 的執行檔" 命令選項,
   來使用 BRUN45C.EXE 檔編譯程式。
 * 在編譯(BC)命令行中省略 /O 的選擇項時,就會使用 BRUN45C.LIB 檔來編譯程式。

CHAIN 和 RUN 敘述的用途幾乎相同。其主要差異在於 RUN 敘述會關閉所有己開啟
的檔案,而且不提供 COMMON 資料區段。

  注意: 當程式使用 BRUN45C.LIB 來鏈結時,除非使用 CLOSE 敘述來關閉檔案,
        否則所有的檔案依然開啟著。

<span class="QH_1">與 BASICA 的差異</span>

BASICA 假設延伸檔名為 .BAS, 而 QuickBASIC 假設延伸檔名為 .BAS 或 .EXE
-- 是根據該程式是在 QuickBASIC 環境中執行,或是已被編譯過(compiled)且在
QuickBASIC 環境以外執行來決定的。假如省略延伸檔名,則 CHAIN 敘述在 QuickBASIC
與 BASICA 環境下執行皆相同。

雖然 QuickBASIC 不提供 ALL, MERGE, 或 DELETE 等屬性,而 BASICA 卻有,但基本上
兩者都不提供從那一行開始執行的指定。

若沒有行號選項,通常由被鏈結(chained-to)程式的開頭開始執行。但由於鏈結的疏忽,
常會造成無窮迴路(endless loop)的現象發生。


<hr>

<span id="L806F" class="QBtitle">CHAIN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8021"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L806E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
  <span class="QH_2">&lt;</span><a href="#L8091">COMMON 敘述程式範例</a><span class="QH_2">&gt;</span> 內有說明 CHAIN 敘述的使用方法。



<hr>

<span id="L8070" class="QBtitle">CHDIR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8022"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8071"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CHDIR 敘述細節</span>

<span class="QH_1">語法</span>
  CHDIR 路徑名稱

路徑名稱為一字串運算式,指定該目錄為系統的預設目錄,路徑名稱參數的長度
必須小於 64 個英文字元。其語法如下:

  [磁碟機:][\]目錄[\目錄]...

磁碟機參數是一個可選擇性的磁碟機編號。假如省略磁碟機參數, CHDIR 以目前
的磁碟機為預設的目錄。

QuickBASIC 的 CHDIR 敘述與 DOS 下的 CHDIR 命令有二種差異:

  1. 在 QuickBASIC 環境下,無法縮寫成 CD 。

  2. 在 QuickBASIC 環境下, CHDIR 敘述無法傳回目前的目錄。

  注意: CHDIR 敘述可改變預設的目錄,但不改變預設的磁碟機編號。
        例如: 假如預設為 C 磁碟機,下列 CHDIR 敘述會在 D 磁碟機更改
        預設的目錄,但是預設的磁碟機仍為 C 磁碟機:

          CHDIR "D:\TMP"


<hr>

<span id="L8071" class="QBtitle">CHDIR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8022"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8070"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CHDIR 敘述程式範例</span>

<span class="QH_1">範例 1</span>

' 在預設的磁碟機下,使得 \HOME\SALES 成為目前的目錄。
CHDIR "\HOME\SALES"

<span class="QH_1">範例 2</span>

' 更改目前的目錄到 B 磁碟機下的 USERS 目錄,但是並不更改預設磁碟機為 B。
CHDIR "B:USERS"



<hr>

<span id="L8072" class="QBtitle">CHR$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8023"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8073"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CHR$ 函數細節</span>

<span class="QH_1">語法</span>
  CHR$(代碼1 [,代碼2, ...])

CHR$ 函數通常用在傳送一個特殊字元到螢幕或列表機上; 同時 CHR$ 可以接受
所有的字元代碼,但不會檢查是否為完整的 2 個位元組長度的中文碼。

例如,傳送一個跳頁字元(CHR$(12))來清除螢幕,並且將游標歸位到起始位置。

CHR$ 也可以在字串中插入一個雙引號來混和使用,如下列 :

  Msg$ = CHR$(34) + "引號字串" + CHR$(34)

在此行中,加入兩個雙引號字元在字串的開頭及結尾處。


<hr>

<span id="L8073" class="QBtitle">CHR$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8023"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8072"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CHR$ 函數程式範例</span>

在子目錄 ADVR_EX 中, CHR_EX.BAS 程式檔案用來說明 CHR$ 函數的使用。
可以使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入程式,並可執行它。

此程式使用 CHR$ 產生中文碼的表格符號字元集,並且使用這些中文符號在
螢幕上畫方框。



<hr>

<span id="L8074" class="QBtitle">CINT 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8026"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8075"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CINT 函數細節</span>

<span class="QH_1">語法</span>
  CINT(數值運算式)

假如數值運算式範圍不是介於 -32,768 到 32,767 之間,則該函數會產生執行期間
(run-time) 的 "超值溢位"(overflow) 錯誤訊息。

CINT 不同於 FIX 和 INT 函數,它是對小數點後第一位數作四捨五入後,再將小數部份
捨棄。當小數點後要作四捨五入的數值是 5 時,其處理方式是 : 由小數點前的奇數值
或偶數值來作決定, 如果是奇數值才會進位; 如果是偶數值則不會進位。


<span class="QH_1">可參閱</span> INT 函數<span class="QH_2">&lt;</span><a href="#L80FC">範例</a><span class="QH_2">&gt;</span>,有對這些函數(CINT, FIX, INT)的差異加以說明。



<hr>

<span id="L8075" class="QBtitle">CINT 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8026"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8074"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CINT 函數程式範例</span>

下列範例將弳度量的角度轉換以度度量為單位的 "度" 和 "分" :

'設定符號常數以供轉換成度度量。
CONST PI=3.141593, RADTODEG=180./PI
INPUT "弳度量的角度 = ",Angle  '讀入弳度量的角度
Angle = Angle * RADTODEG       '轉換弳度量成度度量
Min = Angle - INT(Angle)       '計算小數部份
'轉換小數的值介於 0 和 60 之間。
Min = CINT(Min * 60)
Angle = INT(Angle)             '得到整數部份
IF Min = 60 THEN               '60 分 = 1 度
   Angle = Angle + 1
   Min = 0
END IF
PRINT "角度等於" Angle "度" Min "分"

<span class="QH_1">範例輸出</span>

弳度量的角度 = 1.5708
角度等於 90 度 0 分



<hr>

<span id="L8076" class="QBtitle">CINPUT$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8024"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8077"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CINPUT$ 函數細節</span>

<span class="QH_1">語法</span>
  CINPUT$(n [,[#]檔案代碼]])

n 是以字元(將佔 1 個位元組長度的英文 ASCII 碼,與佔 2 個位元組長度的中文碼,
都當成一個字元)的個數做為讀入的單位,用來傳回由指定的檔案中讀取 n 個字元字串。
至於檔案代碼是指開啟檔案時的檔案號碼。

若被開啟的檔案是隨機存取的方式,參數 n 必須小於或等於由 OPEN 敘述中 LEN 子句
所設定的記錄長度(若記錄長度沒有被設定,則長度必須小於或等於 128)。若被開啟的
檔案是二進位或循序存取,則參數 n 必須小於或等於 32,767。

若沒有指定檔案代碼,則是從標準的輸入裝置(standard input device)中讀取字元
(若輸入沒有被轉向(redirection),則鍵盤便是標準的輸入裝置)。

您可以使用 DOS 的轉向符號 (&lt;, &gt;, 或 &gt;&gt;) 或管道(pipe)符號 (|) 來對一個以
BASIC 所產生的執行檔重新定義標準輸入或標準輸出(請參考作業系統手冊中有關
轉向和管道的說明)。

沒有字元會傳回到螢幕上。所有控制字元除了用來中斷函數執行的 CTRL+BREAK 鍵外,
均可以通過。



<hr>

<span id="L8077" class="QBtitle">CINPUT$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8024"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8076"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CINPUT$ 函數程式範例</span>

<span class="QH_1">範例</span>

OPEN "DATA.DAT" FOR OUTPUT AS #1
    PRINT #1, "中文電腦"
CLOSE #1

OPEN "DATA.DAT" FOR INPUT AS #1
   A$ = CINPUT$(1, #1)
CLOSE #1
PRINT A$

<span class="QH_1">範例輸出</span>
中


<hr>

<span id="L8078" class="QBtitle">CINSTR 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8025"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8079"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CINSTR 函數細節</span>

<span class="QH_1">語法</span>
  CINSTR([起始值,] 字串運算式1, 字串運算式2)

  功能與 INSTR 函數相當,但以 "字元" 為處理的單位(將佔 1 個位元組
  長度的英文 ASCII 碼,與佔 2 個位元組長度的中文碼,都當成一個字元)。

  <span class="QH_1">參數                 說明</span>
  起始值               是一個位移(Offset)的選擇項,用來設定開始尋找的位置;
                       起始值參數其值是介於 1 - 32,767 之間。若未給定
                       起始值參數,則 CINSTR 函數由字串運算式1 的第一個
                       字元開始尋找。

  字串運算式1          被找尋的字串。

  字串運算式2          要找尋的字串。

"字串運算式1" 和 "字串運算式2" 的參數可以為字串變數,字串運算式,或是
字串定字(literal)。

CINSTR 所傳回的值與下列條件有關:

  <span class="QH_1">條件                                傳回值</span>
  "字串運算式2" 在 "字串運算式1"       有找到匹配(match)的位置值
  中找到

  起始值大於 "字串運算式1" 的長度        0

  "字串運算式1" 是空字串                 0

  "字串運算式2" 沒有被找到               0

  "字串運算式2" 是空字串                起始值(若給定);否則為 1

可以使用 CLEN 函數來求得 "字串運算式1" 的字元長度。



<hr>

<span id="L8079" class="QBtitle">CINSTR 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8025"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8078"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CINSTR 函數程式範例</span>

<span class="QH_1">範例</span>

A$ = "QuickBASIC 中文化"
PRINT INSTR(A$, "化")
PRINT CINSTR(A$, "化")

<span class="QH_1">範例輸出</span>

16
14



<hr>

<span id="L807A" class="QBtitle">CIRCLE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8027"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L807B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CIRCLE 敘述細節</span>

<span class="QH_1">語法</span>
  CIRCLE [STEP] (x,y),半徑[,[顏色][,[開始][,[結束][,軸向比]]]]

  <span class="QH_1">參數         說明</span>
  STEP         STEP 參數是一個選擇項,用來指定 x 和 y 是相對於目前繪圖游標
               的位置。

  x,y          x 和 y 座標是圓或橢圓的圓心。

  半徑         在目前座標系統下的圓或橢圓的半徑。

  顏色         為所指定顏色的顏色屬性暫存器號碼。預設是目前的前景顏色。
               請參閱 <span class="QH_2">&lt;</span><a href="#L808A">COLOR 敘述細節</a><span class="QH_2">&gt;</span> 和 <span class="QH_2">&lt;</span><a href="#L81A6">SCREEN 敘述細節</a><span class="QH_2">&gt;</span> 有關如何
               在不同螢幕模式下指定顏色的資訊。

  開始, 結束   是畫圓弧時的起始和結束的弳度量。開始和結束參數用來
               繪製圓或橢圓的部份弧度。而此參數的範圍介於 -2PI 到
               2PI 之間,其中 PI= 3.141593。預設的起始值為零弳度量,
               結束值為 2PI 弳度量。

               假如起始或結束參數為負數,則 CIRCLE 敘述將圓弧上該
               端點與圓心連接,並視此角度為正。

               起始角度可以小於結束角度。若您指定結束角度,但不指定
               起始角度,則圓弧從 2PI 繪到結束角度。假使您指定起始角度,
               但不指定結束角度,則此敘述所繪的圓弧,會從起始角度到 0 度。

  軸向比       軸向比(外觀比),用來指定 y 方向半徑和 x 方向半徑的比值。
               而預設的軸向比值,是希望在各種螢幕型態中能繪製一個正圓。
               此值的計算方式如下:

               螢幕模式 71 : (32/27) * (y 圖素 / x 圖素)
               螢幕模式 80 : (4/3) * (y 圖素 / x 圖素)
               螢幕模式 82 : (4/3) * (y 圖素 / x 圖素)

               其中 y 圖素(pixel)與 x 圖素是螢幕的解析度,例如,
               在螢幕模式 71 下,解析度為 640 x 400,其預設的軸向比為:

                 (32/27)*(400/640), 或 20/27

               假如軸向比小於 1 時,以 x 為半徑。若軸向比大於 1 時,
               以 y 為半徑。

要繪製一個半徑到零度(向右方向的水平線段)時,不必給定一個負零的角度;
而可以以一個非零的極小值來取代。如下所示:

  ' 繪製一個餅狀型如 1/4 楔子狀(a pie-shaped one-quarter wedge)的圓:
  SCREEN 71
  CIRCLE (200,100),60,,-.0001,-1.57

您可以在此敘述的中間省略一個參數,但是必須保留此參數的逗號。
在下列敘述中,顏色參數會被省略:

  CIRCLE STEP (150,200),94,,0.0,6.28

假如您省略最後一個參數,則不需要保留該逗號。

繪製後, CIRCLE 敘述是以橢圓或圓的中心點當作最後的參考點。您可以使用在
螢幕外面或景象埠(viewport)外面的座標。

您可以使用絕對座標,或者使用 STEP 選擇項來顯示相對於最後參考點的中心點
位置。例如:最後參考點是 (10,10),那麼下面的敘述繪製一個半徑為 75,且相對
於最後參考點的 x 座標位移(offset)為 10,與 y 座標位移為 5 的中心點,所以
此圓的實際中心點為 (20,15)。

  CIRCLE STEP (10,5), 75



<hr>

<span id="L807B" class="QBtitle">CIRCLE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8027"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L807A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CIRCLE 敘述程式範例</span>

下列程式中,首先繪製一個缺左上方 1/4 區塊的圓形。然後,以相對座標在所遺漏
的 1/4 區塊中,繪製第二個圓形。最後,以不同的軸向比值,在此小圓形中繪製不同
的小橢圓。

CONST PI=3.141593
SCREEN 71
' 繪製一個缺左上方 1/4 區塊的圓形
' 使用負數,則圓的半徑(弧的兩端)將與圓心連上
CIRCLE (320,160), 200,, -PI, -PI/2
' 使用相對座標在缺 1/4 區塊中繪製一個圓形
CIRCLE STEP (-100,-70),100
' 在圓形內繪一個小橢圓
CIRCLE STEP(0,0), 100,,,, 5/25
' 顯示所繪的圖形,直到按鍵為止
LOCATE 25,1 : PRINT "按任意鍵則結束";
DO
LOOP WHILE INKEY$=""


<hr>

<span id="L807C" class="QBtitle">CLEAR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8028"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L807D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLEAR 敘述細節</span>

<span class="QH_1">語法</span>
  CLEAR [,,堆疊]

CLEAR 敘述執行下列動作:

  * 關閉所有檔案,且將檔案緩衝區釋放掉。
  * 清除所有 COMMON 變數。
  * 設定數值變數和陣列為零。
  * 設定所有字串變數為空字串。
  * 重新對堆疊(stack)啟始化,並且可以選擇性地改變堆疊的大小。

敘述中的堆疊參數用來保留堆疊空間給您的程式使用。QuickBASIC 先取得所需要的
堆疊空間數目,再加上堆疊參數所指定的位元組數目,來設定最後的堆疊大小。

  注意: 為了保持 QuickBASIC 與 BASICA 的相容性,在堆疊的前面使用兩個逗號。
        BASICA 包含一個額外的參數用來設定資料區段(Data Segment)的大小。
        因為 QuickBASIC 能自動管理資料區段的大小,所以第一個參數己不再
        需要了。

假如格式中,使用多層巢狀(nested)次常式(subroutine)或程序式,或者使用遞迴
(recursion)程序式,則您可能需要使用一個 CLEAR 敘述來增加堆疊的空間。同時,
假如您的程序式擁有大量的參數,則也需要增加堆疊的大小。

在執行 GOSUB 敘述時,清除堆疊會破壞放在堆疊上的返回位址,使得 RETURN 敘述
無法正確的執行,同時產生一個 "RETURN 敘述沒有對應的 GOSUB 敘述" 的執行期間
(run-time) 錯誤訊息。在 SUB 或 FUNCTION 中使用 CLEAR 敘述,會產生
"不正確的函數呼叫" 執行期間錯誤訊息。

<span class="QH_1">與 BASICA 的差異</span>

BASICA 程式中有使用 CLEAR 敘述時,就需要修正。在 BASICA 程式中,任何
DEF FN 函數或使用 DEF型態 敘述所宣告的資料型態,在使用 CLEAR 敘述後
會消失。對於被編譯過(compiled)的程式,因為這些宣告在編譯時是固定的,
所以這些資訊不會消失。


<hr>

<span id="L807D" class="QBtitle">CLEAR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8028"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L807C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLEAR 敘述程式範例</span>

下列敘述會清除程式中所有的變數,並且保留 2000 個位元組的堆疊供程式使用:

CLEAR ,,2000


<hr>

<span id="L807E" class="QBtitle">CLEN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8029"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L807F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLEN 函數細節</span>

<span class="QH_1">語法一</span>
  CLEN(字串運算式)

<span class="QH_1">語法二</span>
  CLEN(變數)

語法一 : CLEN 會傳回在字串運算式參數中,字元("中文字元" 與 "英文字元")的
         總數目。
語法二 : CLEN 會傳回一個 BASIC 變數所佔用的位元組數目,這個語法對決定
         一個隨機存取檔內正確的記錄大小(record size)特別有用。


<hr>

<span id="L807F" class="QBtitle">CLEN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8029"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L807E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLEN 函數程式範例</span>

這個例子列出一個字串的長度和變數型態大小(以位元組表示):

CLS     ' 清螢幕
A$ = "QuickBASIC 中文化"
B% = 1234
PRINT LEN(A$)
PRINT CLEN(A$)
PRINT LEN(B%)

<span class="QH_1">範例輸出</span>
 17
 14
 2


<hr>

<span id="L8080" class="QBtitle">CLNG 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8081"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLNG 函數細節</span>

<span class="QH_1">語法</span>
  CLNG(數值運算式)

假如數值運算式的值不是介於 -2,147,483,648 和 2,147,483,647 之間,
則此函數將產生 "超值溢位"(overflow)錯誤訊息。


<hr>

<span id="L8081" class="QBtitle">CLNG 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8080"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLNG 函數程式範例</span>

下列範例顯示 CLNG 函數在轉換之前,如何將一數值四捨五入後成為整數:

A=32767.45
B=32767.55
PRINT CLNG(A); CLNG(B)

<span class="QH_1">範例輸出</span>

 32767  32768



<hr>

<span id="L8082" class="QBtitle">CLOSE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8083"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLOSE 敘述細節</span>

<span class="QH_1">語法</span>
  CLOSE [[#]檔案代碼 [,[#]檔案代碼]...]

檔案代碼,是檔案開啟時的代號。一個 CLOSE 敘述若沒有任何參數,則會關閉
所有己開啟的檔案和裝置(device)。

檔案與檔案代碼的關係在 CLOSE 敘述執行時結束。然後您可以再開啟這個檔案,
使用相同或不同的檔案代碼。一旦關閉一個檔案,可以將此檔案的代碼再提供給
任何未開啟的檔案使用。

一個 CLOSE 敘述對一個以循序輸出模式打開的檔案或裝置,會將其最後留在輸出
緩衝區中的資料寫到指定的檔案或裝置中。

CLOSE 敘述同時會釋放掉被關閉的檔案所使用的緩衝區空間。

CLEAR, END, RESET, RUN, 和 SYSTEM 敘述執行時,也會自動關閉所有的檔案。


<hr>

<span id="L8083" class="QBtitle">CLOSE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8082"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_2">&lt;</span><a href="#L8069">CALL 敘述程式範例</a><span class="QH_2">&gt;</span> 有說明 CLOSE 敘述的用法。



<hr>

<span id="L8084" class="QBtitle">CLS 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8085"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLS 敘述細節</span>

<span class="QH_1">語法</span>
   CLS [{0 | 1 |2}]

  <span class="QH_1">敘述       說明</span>
  CLS 0      清除螢幕上所有的本文(Text)及圖形(Graphic)。

  CLS 1      若有執行 VIEW 敘述時,僅清除繪圖景象埠(graphic viewport),否則
             CLS 1 會清除整個螢幕。

  CLS 2      僅清除本文景象埠(text viewport),但螢幕的底行(第 25 行)不清除。

  CLS        清除景象埠中的圖形或文字。如果繪圖景象埠(graphics viewport)
             有作用,則沒有參數的 CLS 僅會清除此繪圖景象埠。若繪圖景象埠
             沒有作用,則 CLS 會清除本文景象埠和更新功能鍵的顯示行
             (在螢幕最底下的一行)。

CLS 敘述也會將游標返回到畫面上左上角的起始位置(home position)。


<hr>

<span id="L8085" class="QBtitle">CLS 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8084"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CLS 敘述程式範例</span>

下列程式在繪圖景象埠中隨機畫圓,並且在本文景象埠中列印訊息。
在繪圖景象埠中每 30 個圓形畫完後就會被清除。此程式也在每列印 45 次 "哈囉"
訊息後,便清除本文景象埠一次。

RANDOMIZE TIMER
SCREEN 71
' 設定一個繪圖景象埠的邊框
VIEW (5,5)-(100,80),,1
' 設定一個本文的景象埠
VIEW PRINT 12 TO 24
' 在螢幕本文景象埠之外列印訊息
LOCATE 25,1 : PRINT "按任意鍵則結束"
Count=0
DO
   ' 以隨機半徑繪製一圓形
   CIRCLE (50,40),INT((35-4)*RND+5),(Count MOD 4)
   ' 每 30 次清除一次繪圖景象埠
   IF (Count MOD 30)=0 THEN CLS 1
   PRINT "哈囉";
   ' 每 45 次清除一次本文景象埠
   IF (Count MOD 45)=0 THEN CLS 2
   Count=Count+1
LOOP UNTIL INKEY$ &lt;&gt; ""



<hr>

<span id="L8086" class="QBtitle">CMID$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8087"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CMID$ 函數細節</span>

<span class="QH_1">語法</span>
  CMID$(字串運算式, 起始值 [,長度])

  <span class="QH_1">參數               說明</span>
  字串運算式         表示要被選取成子字串的母字串運算式,這個參數可以
                     為任意的字串運算式。

  起始值             為在字串運算式參數中,子字串開始的字元位置。

  長度               為所要選取字元總數目的參數。

起始值和長度參數其值介於 1 到 32,767 之間。若省略長度參數,或者長度參數大於
由指定的起始值字元開始到最右邊的字元數目,則 CMID$ 函數將傳回該起始值到最右邊
的所有字元。

若起始值參數大於字串運算式中的字元數目,則 CMID$ 函數將傳回一個空字串。

使用 CLEN 函數可以求得字串運算式中的字元總數目。


<hr>

<span id="L8087" class="QBtitle">CMID$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8086"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CMID$ 函數程式範例</span>

CLS     '清螢幕
A$ = "中文化"
I = 1
WHILE I &lt;= CLEN(A$)
    B$ = CMID$(A$, I, 1)
    PRINT I, B$
    I = I + 1
WEND

<span class="QH_1">範例輸出</span>
1         中
2         文
3         化


<hr>

<span id="L8088" class="QBtitle">CMID$ 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8089"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CMID$ 敘述細節</span>

<span class="QH_1">語法</span>
  CMID$(字串變數, 起始值 [,長度])=字串運算式

  <span class="QH_1">參數           說明</span>
  字串變數       表示要被修改的字串變數。

  起始值         為一個數值運算式,用來設定在字串變數中要被取代的開始位置。

  長度           長度是一個數值運算式,表示字串運算式內要拿來作取代的字元長度。

  字串運算式     此參數用來取代字串變數參數中的某一部分字串。

起始值和長度參數是整數運算式,而字串變數參數是一個字串變數。但字串運算式參數
可以為一個字串變數,字串常數,或字串運算式。

若長度參數省略,則使用字串運算式參數中所有字元作取代。然而,不管長度參數
省略與否,字元的取代永遠不會超過原來字串變數的長度。


<hr>

<span id="L8089" class="QBtitle">CMID$ 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8088"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CMID$ 敘述程式範例</span>

這個範例使用 CMID$ 敘述來取代字串字元。

CLS     '清螢幕
A$ = "QuickBASIC 中文化"
B$ = A$
CMID$(A$, 12) = "4.5"
CMID$(B$, 1) = "中文化"
PRINT A$
PRINT B$

<span class="QH_1">範例輸出</span>

QuickBASIC 4.5
中文化ckBASIC 中文化



<hr>

<span id="L808A" class="QBtitle">COLOR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L808B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COLOR 敘述細節</span>

<span class="QH_1">語法</span>
  COLOR [前景][,[背景]]                 螢幕模式    00, 03, 07, 80
  COLOR [前景]                          螢幕模式    82

     使用 COLOR 敘述可以設定螢幕的前景和背景顏色,背景色與前景色是一個
     整數運算式。

     下表中說明各種螢幕模式參數數值的範圍:
     +--------+----------+---------------+
     |        |          |     顏色      |
     | 顯示卡 | 螢幕模式 +-------+-------+
     |        |          | 前景  | 背景  |
     +--------+----------+-------+-------+
     |        |  07,00   |       |       |
     |   Ｍ   | 本文模式 | 00-31 | 00-07 |
     |   Ｇ   +----------+-------+-------+
     |   Ａ   |    71    |       |       |
     |        | 繪圖模式 |不支援 |不支援 |
     +--------+----------+-------+-------+
     |        |  03,00   |       |       |
     |   Ｖ   | 本文模式 | 00-31 | 00-07 |
     |   Ｇ   +----------+-------+-------+
     |   Ａ   |    82    |       |       |
     |        | 繪圖模式 | 00-15 |不支援 |
     +--------+----------+-------+-------+
     |        |  03,00   |       |       |
     |   Ｅ   | 本文模式 | 00-31 | 00-07 |
     |   Ｇ   +----------+-------+-------+
     |   Ａ   |    80    |       |       |
     |        | 繪圖模式 | 00-15 | 00-63 |
     +--------+----------+-------+-------+

     (1). 螢幕模式 82 下,背景是使用顏色屬性暫存器(color attribute) 00 內
          的顏色,有關屬性暫存器內顏色的設定,請參閱<span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808C">PALETTE 敘述</a><span class="QH_2">&gt;</span>的
          使用。
          螢幕模式 80 下,背景是使用 EGA 顯示卡所能夠提供的顏色值,
          而不是顏色屬性暫存器號碼。

     (2). 其餘在 VGA 和 EGA 顯示卡中的參數均表示顏色屬性暫存器號碼。
          前景顏色 -- 00 - 15 表示顏色屬性暫存器 00-15 內的顏色;
                      16 - 31 表示顏色屬性暫存器 00-15 內的顏色再加上閃爍。
          背景顏色 -- 00 - 07 表示顏色屬性暫存器 00-07 內的顏色。

     (3). 在 VGA 與 EGA 顯示卡所提供的本文螢幕模式 00 與 03 下; 預設的前景
          是使用顏色屬性暫存器 07 內的顏色,背景是使用顏色屬性暫存器 00 內
          的顏色。
          繪圖螢幕模式 82 下,預設的前景是使用顏色屬性暫存器 15 內的顏色,而
          背景固定取自顏色屬性暫存器 00 內的顏色。
          繪圖螢幕模式 80 下,預設的前景是使用顏色屬性暫存器 15 內的顏色,若
          沒有設定背景顏色時,則取自顏色屬性暫存器 00 內的顏色。

     (4). 下表說明 MGA 顯示卡所提供本文螢幕模式 00 與 07 的顯示屬性。
          預設的前景顯示屬性是 07, 背景顯示屬性是 00。

          +-----------+-----------------------+------+
          | 顏色編號  | 前        景          | 背景 |
          +-----------+-----------------------+------+
          |    00     | 黑色                  | 黑色 |
          +-----------+-----------------------+------+
          |    01     | 白色+底線             | 黑色 |
          +-----------+-----------------------+------+
          |    02     | 白色                  | 黑色 |
          +-----------+-----------------------+------+
          |    03     | 白色                  | 黑色 |
          +-----------+-----------------------+------+
          |    04     | 白色                  | 黑色 |
          +-----------+-----------------------+------+
          |    05     | 白色                  | 黑色 |
          +-----------+-----------------------+------+
          |    06     | 白色                  | 黑色 |
          +-----------+-----------------------+------+
          |    07     | 白色                  | 白色 |
          +-----------+-----------------------+------+
          |    08     | 黑色+高亮度           |      |
          +-----------+-----------------------+------+
          |    09     | 白色+底線+高亮度      |      |
          +-----------+-----------------------+------+
          |   10-15   | 白色+高亮度           |      |
          +-----------+-----------------------+------+
          |    16     | 黑色+閃爍             |      |
          +-----------+-----------------------+------+
          |    17     | 白色+底線+閃爍        |      |
          +-----------+-----------------------+------+
          |   18-23   | 白色+閃爍             |      |
          +-----------+-----------------------+------+
          |    24     | 黑色+高亮度+閃爍      |      |
          +-----------+-----------------------+------+
          |    25     | 白色+底線+高亮度+閃爍 |      |
          +-----------+-----------------------+------+
          |   26-31   | 白色+高亮度+閃爍      |      |
          +-----------+-----------------------+------+

      (5). 參數超出有效範圍時,會產生 "不正確的函數呼叫" 錯誤訊息。

      (6). 前景若和背景使用相同顏色,則顯示的字元會看不見。所有顯示器
           硬體裝置和所有螢幕模式的預設背景色為黑色,或顏色屬性暫存器
           00 內的顏色。

      (7). 在螢幕模式 80 和 82 中,可以用 PALETTE 敘述指定一個顏色值
           給調色盤內的一個顏色屬性暫存器,來設定背景顏色。例如: 在
           螢幕模式 82 下產生一個 8224 背景顏色值(淡紫色)給顏色屬性
           暫存器 0 ,您可以使用下列 PALETTE 敘述:

           PALETTE 0,8224

           PALETTE 敘述對於前景和背景顏色的設定,也有提供另外一種彈性
           地同時指定不同顏色值給一群顏色屬性暫存器的方法。
           請參閱<span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808C">PALETTE 敘述</a><span class="QH_2">&gt;</span>,有更詳細的說明。


<hr>

<span id="L808B" class="QBtitle">COLOR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L802F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L808A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COLOR 敘述程式範例</span>

下面有一系列範例用來顯示 COLOR 敘述和在各種螢幕的模式下的差異:

<span class="QH_1">範例一</span>

SCREEN 0            ' MGA 本文模式 -- SCREEN 0 或 SCREEN 7
CLS
COLOR 7, 0: PRINT "正常顯示": PRINT
COLOR 0, 7: PRINT "反白": PRINT
COLOR 1, 0: PRINT "畫底線": PRINT
COLOR 15, 0: PRINT "高亮度": PRINT
COLOR 9, 0: PRINT "高亮度 + 畫底線": PRINT
COLOR 23, 0: PRINT "閃爍": PRINT
COLOR 17, 0: PRINT "閃爍 + 畫底線": PRINT
COLOR 25, 0: PRINT "閃爍 + 高亮度 + 畫底線": PRINT
COLOR 24, 7: PRINT "反白 + 閃爍 + 高亮度": PRINT
COLOR 7, 0          ' 恢復正常顯示
LOCATE 25: PRINT "按任意鍵,繼續...";
DO: LOOP WHILE INKEY$ = ""
END

<span class="QH_1">範例二</span>

SCREEN 0            ' EGA/VGA 本文模式 -- SCREEN 0 或 SCREEN 3
CLS
COLOR 7, 0: PRINT "黑底白字": PRINT
COLOR 15, 0: PRINT "高亮白色": PRINT
COLOR 23, 0: PRINT "閃爍": PRINT
COLOR 14, 4: PRINT "紅底黃字": PRINT
COLOR 30, 4: PRINT "紅底黃字 + 閃爍": PRINT
COLOR 7, 0          ' 恢復正常顯示
LOCATE 25: PRINT "按任意鍵,繼續...";
DO: LOOP WHILE INKEY$ = ""
END

<span class="QH_1">範例三</span>

SCREEN 80            ' EGA 繪圖模式  -- 640 X 400
COLOR 14, 1          ' 前景=屬性暫存器 14 內的顏色(預設為黃色),
                     ' 背景=顏色值 1
LINE (100, 100)-(540, 275), , BF  ' 繪製一矩形
LOCATE 25: PRINT "按任意鍵,繼續...";
DO: LOOP WHILE INKEY$ = ""
COLOR 11, 60         ' 前景=屬性暫存器 11 內的顏色(預設為亮青藍),
                     ' 背景=顏色值 60
LINE (100, 100)-(540, 275), , BF  ' 繪製一矩形
DO: LOOP WHILE INKEY$ = ""
END

<span class="QH_1">範例四</span>

SCREEN 82            ' VGA 繪圖模式  -- 640 X 480
COLOR 14             ' 前景 = 屬性暫存器 14 內的顏色(預設為黃色)
LINE (100, 100)-(540, 350), , BF   ' 繪製一矩形
LOCATE 25: PRINT "按任意鍵,繼續...";
DO: LOOP WHILE INKEY$ = ""
COLOR 11             ' 前景 = 屬性暫存器 11 內的顏色(預設為亮青藍色)
LINE (100, 100)-(540, 350), , BF   ' 繪製一矩形
DO: LOOP WHILE INKEY$ = ""
END



<hr>

<span id="L808C" class="QBtitle">COM(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8030"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L808D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COM(n) 敘述細節</span>

<span class="QH_1">語法</span>

  COM(n) ON
  COM(n) OFF
  COM(n) STOP

參數 n 是通訊的號碼; n 可以為 1 或 2。

COM ON 敘述啟動通訊事件設陷。假若一個字元在 COM ON 敘述之後到達通訊埠(port)
時,則 ON COM 敘述後面的次常式(subroutine)就會被執行。

COM OFF 敘述關閉通訊事件設陷。沒有通訊設陷事件會發生,直到另外的 COM ON 敘述
被執行為止。若設陷被關閉時,事件發生將會被忽略。

COM STOP 敘述暫停通訊事件設陷。如此設陷將不發生,一直到一個 COM ON 敘述被執行
為止。當設陷暫停時,若有事件發生將會被記錄,並且等待下一個 COM ON 敘述被執行時
再處理。


<hr>

<span id="L808D" class="QBtitle">COM(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8030"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L808C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

沒有 COM(n) 敘述的程式範例。



<hr>

<span id="L808E" class="QBtitle">COMMAND$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8031"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L808F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COMMAND$ 函數細節</span>

<span class="QH_1">語法</span>
  COMMAND$

COMMAND$ 函數會傳回在 BASIC 程式名稱後面包括所有選擇項參數的完整命令。
COMMAND$ 函數會刪除命令行所有的前置空白字元,並將所有的英文字母轉換成大寫字母。
COMMAND$ 函數可使用在獨立的可執行檔,或者在 QuickBASIC 的工作環境下,
使用 /CMD 命令行的選擇項,或在 [R/執行] 功能表中選擇 "修改 COMMAND$" 命令。


<hr>

<span id="L808F" class="QBtitle">COMMAND$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8031"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L808E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COMMAND$ 函數程式範例</span>

在子目錄 ADVR_EX 中 CMD_EX.BAS 程式檔用來說明 COMMAND$ 函數的使用。
可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入 CMD_EX.BAS。再用
[R/執行] 功能表中的 "產生執行檔..." 命令產生 CMD_EX.EXE, 接著使用
[F/檔案] 功能表中的 "D/呼叫 DOS 系統" 命令回到 DOS, 最後執行
CMD_EX.EXE 程式,並且在程式名稱後面加上若干個參數。

此程式將命令行分隔成個別的參數,並將他們存在一個陣列中。每一個參數在命令行
上是以一個或多個或者間隔符號(Tab)來分開的。

下列是一個命令行範例:

CMD_EX one  two   three    four     five      six

<span class="QH_1">範例輸出</span>

參數數目 =  6
參數是:
ONE
TWO
THREE
FOUR
FIVE
SIX


<hr>

<span id="L8090" class="QBtitle">COMMON 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8032"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8091"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COMMON 敘述細節</span>

<span class="QH_1">語法</span>
  COMMON [SHARED] [/區段名稱/] 變數串列

  <span class="QH_1">參數           說明</span>
  SHARED         為一個選擇項的屬性,表示變數在模組中可以被所有的 SUB
                 和 FUNCTION 程序式所共用。SHARED 參數可排除在 SUB 或
                 FUNCTION 程序式內使用 SHARED 敘述的需要。

  區段名稱       有效的 BASIC 識別字(至多 40 個英文字元)用來指定一群
                 變數,在有使用到區段名稱參數時,便可以共用這些變數。
                 當區段名稱被使用,此共用區段稱為具名(Named) COMMON 區段
                 ,若省略區段名稱,則此區段視為空白(Blanked) COMMON 區段。
                 當鏈結到(chain-to)一個新程式時,具名 COMMON 區段中的項目
                 是無法保留的。請參閱 "使用具名 COMMON" 和 "在鏈結程式中
                 使用 COMMON"。

  變數串列       表示能在模組或被鏈結(chained-to)的程式中共用的變數串列。
                 在模組中,相同變數不可以出現在另一個 COMMON 敘述中。

變數串列具有下列的語法:

  變數[()] [AS 型態][, 變數[()] [AS 型態]]...

下列說明一個變數串列的各個部分:

  <span class="QH_1">參數       說明</span>
  變數       任何有效的 BASIC 變數名稱。

  AS 型態    宣告變數為型態參數。型態參數可為 INTEGER, LONG,
             SINGLE, DOUBLE, STRING, 或是一個使用者自定型態。

  注意: 早期 BASIC 的版本,在 COMMON 敘述中動態陣列的名稱需要包含
        陣列的維度(dimension)。如今 QuickBASIC 己不再需要陣列的
        維度參數,但為了保持相容性起見,仍可接受早期的語法。

COMMON 敘述在一個特定的區域建立空間給此變數,並允許在模組間共用變數,
或是使用 CHAIN 敘述呼叫其他程式時,可以彼此之間共用變數。

因為 COMMON 敘述在整個程式中建立全域變數(golbal variable),所以此敘述
必須出現在可執行敘述之前。除了下列敘述外,所有的敘述皆為可執行敘述:

  * COMMON
  * CONST
  * DATA
  * DECLARE
  * DEF型態
  * DIM (靜態陣列適用)
  * OPTION BASE
  * REM
  * SHARED
  * STATIC
  * TYPE...END TYPE
  * 所有的假命令

在 COMMON 區段中的變數以位置和型態來做比對,而不是以名稱。因此,在
COMMON 敘述中的變數次序是很重要的。下列程式片斷,在 COMMON 敘述中
連結(Linked)是以變數的次序,而不是以名稱來做連結的:

' 主程式
COMMON A, D, E
A = 5 : D = 8 : E = 10
.
.
.

' 在其他模組中的 COMMON 敘述
COMMON A, E, D          'A = 5, E = 8, D = 10
.
.
.

將靜態和動態陣列藉著使用陣列名稱跟著一對括號放在 COMMON 敘述中。若
一個靜態陣列在 DIM 敘述前面使用 COMMON 敘述,必須給定維度並且同時要具有
整數常數的註標(subscript)。一個動態陣列必須在 DIM 或 REDIM 敘述的後面
給定維度,而動態陣列的元素並不在共用區段中配置空間,只是將陣列的描述元
(descriptor)放在共用區段中。

若一個不具名(空白)共用區段被使用時,一個共用區域的大小可以和其他模組或
被鏈結的程式不相同。當 BASIC 程式與使用者程式庫的一個常式(routine)共用
COMMON 區段時,呼叫的程式(calling program)可以不必再重新定義 COMMON 區段
成為一個較大的空間。

不匹配的 COMMON 敘述所導致的錯誤是很難發現的。一個簡單的方法來避免不匹配的
COMMON 敘述發生,是在一個單一的內含檔(include file)中放置 COMMON 的宣告,並且
在每一個程式中使用 $INCLUDE 假命令。

下列程式片斷顯示如何在程式中使用 $INCLUDE 假命令來共用包含有 COMMON 敘述的
檔案:

'此檔案是 menu.bas.
' $INCLUDE: 'COMDEF.BI'
.
.
.
CHAIN "PROG1"
END


'此檔案是 prog1.bas.
' $INCLUDE: 'COMDEF.BI'
.
.
.
END


'此檔案是 comdef.bi.
DIM A(100),B$(200)
COMMON I,J,K,A()
COMMON A$,B$(),X,Y,Z
'comdef.bi 檔的結束

下面三個段落是討論當鏈結程式時,使用具名 COMMON 區段,使用 SHARED 關鍵字;
和在鏈結程式中使用 COMMON 敘述的方法:

<span class="QH_1">使用具名 COMMON(Using Named COMMON)</span>

一個具名 COMMON 區段提供便利的方式來將變數分組,如此不同的模組僅能
存取他們自己需要的共用變數。

下列程式片斷,計算長方體的體積和密度,在二個副程式中,使用具名 COMMON 區段來
共用不同模組的資料。副程式 VOLUME 僅需要共用代表面長度的變數(在 SIDES 的
具名 COMMON 區段中)。副程式 DENSITY 也需要表示重量的變數(在 WEIGHT 的具名
COMMON 區段中)。

'主程式
DIM S(3)
COMMON /Sides/ S()
COMMON /Weight/ C

C=52
S(1)=3:S(2)=3:S(3)=6
CALL Volume
CALL Density
END

'副程式 VOLUME 在一個獨立的模組中
DIM S(3)
COMMON SHARED /Sides/ S()

SUB Volume STATIC
    Vol=S(1)*S(2)*S(3)
    .
    .
    .
END SUB


'副程式 DENSITY 在一個獨立的模組中
DIM S(3)
COMMON SHARED /Sides/ S()
COMMON SHARED /Weight/ W

SUB Density STATIC
    Vol=S(1)*S(2)*S(3)
    Dens=W/Vol
    .
    .
    .
END SUB

  注意: 具名 COMMON 區段越過(across)被鏈結(chained)的程式是無法被保留的,
        僅可以使用空白(不具名)COMMON 區段來傳遞變數到一個被鏈結的程式中。

<span class="QH_1">鏈結程式中使用 COMMON (Using COMMON with CHAIN)</span>

COMMON 敘述僅提供一種方法直接傳遞變數值給被鏈結的程式(chained program)。
此方法是在兩個程式中都使用 COMMON 敘述來傳遞變數。需注意的是在傳遞時是以
變數的順序及型態為準則,而不是變數名稱。變數的順序和型態必須和在彼此鏈結的
程式間所有的 COMMON 敘述皆一樣。

雖然變數的順序和型態是決定傳遞正確值的準則,但 COMMON 區段不一定需要相同的
大小。假如被鏈結到的 COMMON 區段小於鏈結程式的 COMMON 區段,則在鏈結程式中,
額外的 COMMON 變數將被忽略。假如被鏈結程式中的 COMMON 區段較大,則額外的
COMMON 數值變數被起始化為零,額外的字串變數被起始化為空字串。

在鏈結程式中以 COMMON 敘述傳遞靜態陣列時,必須在被鏈結到的程式中或宣告為
靜態陣列。同樣地,在鏈結程式中的 COMMON 敘述放置動態陣列,則被鏈結到的程式
中也必須為動態陣列。

  注意: 有使用 COMMON 敘述的鏈結程式,在 QuickBASIC 工作環境以外被編譯
        (compiler)時,必須使用 BRUN45C.EXE 模組。當您在編譯(BC)命令行
        沒有使用 /O 選擇項,或當您建立 .EXE 檔且在交談框中有使用
        "需要 BRUN45C.EXE 的執行檔" 選擇項時,將來程式執行都會使用到
        BRUN45C.EXE 執行模組。


<hr>

<span id="L8091" class="QBtitle">COMMON 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8032"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8090"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COMMON 敘述程式範例</span>

在子目錄 ADVR_EX 下 COM1_EX.BAS 和 COM2_EX.BAS 程式檔,用來說明 COMMON 敘述
的使用。可使用 [F/檔案] 功能表的 "O/載入程式" 命令載入 COM1_EX.BAS 檔,並可
執行它,但 COM2_EX.BAS 檔必需存放在當時執行 COM1_EX.BAS 的工作目錄下。

COMMON 敘述被用來在兩個被鏈結程式中傳遞變數,第一個程式讀入一串數值,
並將值存在陣列中,然後鏈結到其他程式中。第二個程式用來尋找並列印平均值。



<hr>

<span id="L8092" class="QBtitle">CONST 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8033"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8093"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CONST 敘述細節</span>

<span class="QH_1">語法</span>
  CONST 常數名稱 = 運算式 [,常數名稱 = 運算式]...

  <span class="QH_1">參數           說明</span>
  常數名稱       符號常數(symbolic constant)名稱的命名規則與 BASIC 變數名稱
                 的命名規則相同。您可以加入型態宣告字元(%, &, !, #, 或 $)到
                 名稱上,來指定其型態,但此型態宣告字元並不是名稱的一部份。

  運算式         一個運算式是由定字(literal,如 1.0),其他常數或除了指數符號(^)
                 以外的任何算術和邏輯運算子(logical operators)所組成。您也
                 可以使用一個單一定字字串如 "輸入錯誤"。但不能在運算式中使用
                 字串連結符號,變數,使用者自定函數,或像 SIN 或 CHR$ 的內建
                 (intrinsic)函數來指定常數。

假如在符號常數名稱中使用型態宣告字元,當您在程式中使用該名稱時,可以省略該型態
宣告字元,如下面範例所示:

  CONST MAXDIM% = 250
  .
  .
  .
  DIM AccountNames$(MAXDIM)

假如您省略型態宣告字元,則 CONST 敘述中的符號常數資料型態就由運算式來指定。
字串通常可用字串常數來表示。在數值運算式方面,若運算式的計算結果指定給該常數,
則以最簡單的資料型態來表示該常數。例如,若運算式的結果可以表示為整數,則可以
指定該常數為整數型態。

  注意: 符號常數的名稱不受 DEF型態 敘述(如: DEFINT)所影響。符號常數的型態
        可由外在的型態宣告字元或運算式的型態來決定。

符號常數必須在使用之前先定義。下列範例會產生一個錯誤,因為符號常數 ONE 在
未定義之前就先用來定義 TWO。(符號常數的定義是由左而右的)

  CONST TWO = ONE + ONE, ONE = 1

在 SUB 或 FUNCTION 程序式中宣告的符號常數,對 SUB 和 FUNCTION 而言是區域性。
若一個符號常數宣告在程序式以外,則可以在整個模組中使用。您可以在所用的運算式
中使用該符號常數。

一般程式設計常以下列敘述來使用符號常數(任何不為零的值代表 True):

  TRUE = -1

對常數值以符號常數表示,比用變數的優點多:

  * 符號常數值只需在整個模組中定義一次就可以。
  * 符號常數不會因疏忽而改變其值。
  * 在獨立執行的程式,使用符號常數比用變數更有效率。
  * 符號常數使得程式更易於修改。



<hr>

<span id="L8093" class="QBtitle">CONST 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8033"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8092"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CONST 敘述程式範例</span>

此範例使用 CONST 敘述來宣告符號常數給不能列印字元的 ASCII 碼,例如 :
TAB 和 LF 。符號常數也可以使得程式易於修改。

  祕訣: 當您執行此範例,必須提供一個純英文本文檔,此檔可以是您已經建立的
        本文檔,或是用本文編輯器(text editor)所建立的檔案。

' 此程式用來對字句,行和字元計數。
' 一個字句為一連串不含空白的字元所組成的
DEFINT a-z

CONST BLANK = 32, ENDFILE = 26, CR = 13, LF = 10
CONST TABC = 9, YES = -1, NO = 0

CLS    ' 清除螢幕
' 從命令行讀取檔案名稱
FileName$=COMMAND$
IF FileName$="" THEN
   INPUT "請輸入檔案名稱: ",FileName$
   IF FileName$="" THEN END
END IF

OPEN FileName$ FOR INPUT AS #1

Words=0
Lines=0
Characters=0

' 設定旗標(flag)來表示您不是在查看一個字句,然後從檔案中讀取第一個字元。
InaWord=NO
DO UNTIL EOF(1)
   C=ASC(INPUT$(1,#1))
   Characters=Characters+1
   IF C=BLANK or C=CR or C=LF or C=TABC THEN

' 假如字元是空白字元,歸位鍵,換行或 TAB 鍵,則不計算在字句之內。
      IF C=CR THEN Lines=Lines+1
      InaWord=NO
   ELSEIF InaWord=NO THEN

' 若是可列印的字元,則為一個字句的啟始字元。
' 計算字數和設定旗標(flag)。
      InaWord=YES
      Words=Words+1
   END IF

LOOP
PRINT Characters, Words, Lines
END



<hr>

<span id="L8094" class="QBtitle">COS 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8034"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8095"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COS 函數細節</span>

<span class="QH_1">語法</span>
  COS(數值運算式)

數值運算式可為任何數值型態的運算式。

預設的餘弦函數是以單精確度計算。但是,若數值運算式為倍精確度,則餘弦函數
是以倍精確度方式計算。

您可以轉換度度量為弳度量,只須將度度量的角度乘上 Π/180 就是弳度量,
其中 Π = 3.141593。

轉換弳度量為度度量,僅須乘上 57.2958。


<hr>

<span id="L8095" class="QBtitle">COS 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8034"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8094"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">COS 函數程式範例</span>

下列程式繪出極座標方程式 r = nθ 的圖形,其中 n 的值從 0.1 - 1.1 的圖形。
此程式中使用轉換因子 x = cos(θ) 和 y = sin(θ) 將極座標軸轉換為 x,y 直角
座標。此程式所畫出的圖形是著名的阿基米得螺旋(Spiral of Archimedes)。

CONST PI = 3.141593
SCREEN 71
'定義視窗大到可以容納最大的螺旋圖
WINDOW (-4,-6)-(8,2)
'從原點到右邊畫一直線
LINE (0,0)-(2.2*PI,0)
'繪製 10 個螺旋
FOR N = 1.1 TO .1 STEP -.1
   '繪出起始點
   PSET (0,0)
   FOR Angle = 0 TO 2*PI STEP .04
      '螺旋的極座標方程式
      R = N * Angle
      '轉換極座標到直角座標
      X = R * COS(Angle)
      Y = R * SIN(Angle)
      '由前一點到新點畫上一直線
      LINE -(X,Y)
   NEXT
NEXT



<hr>

<span id="L8096" class="QBtitle">CPOS 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8035"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8097"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CPOS 函數細節</span>

<span class="QH_1">語法</span>
  CPOS(字串運算式,n)

傳回以 "位元組" 為計算單位的數目,此數目是由第一個字元(將佔 1 個位元組長度的
英文 ASCII 碼與佔 2 個位元組長度的中文碼,都當成一個字元)到所給定的第 n 個
字元位置參數為止,所佔用的總位元組長度。

使用者以位元組為單位來獲得該字元在字串上的位置。若 "n" 值超過字串運算式
全部的字元長度,則傳回 00。



<hr>

<span id="L8097" class="QBtitle">CPOS 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8035"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8096"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_1"> &lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CPOS 函數程式範例</span>


<span class="QH_1">範例</span>
CLS                 ' 清螢幕
A$ = "QB 中文化"
FOR I = 1 TO CLEN(A$)+1
    PRINT "CPOS(A$, "; I; ")="; CPOS(A$,I)
NEXT

<span class="QH_1">輸出</span>

CPOS(A$, 1 )= 1
CPOS(A$, 2 )= 2
CPOS(A$, 3 )= 3
CPOS(A$, 4 )= 4
CPOS(A$, 5 )= 6
CPOS(A$, 6 )= 8
CPOS(A$, 7 )= 0


<hr>

<span id="L8098" class="QBtitle">CSNG 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8036"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8099"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CSNG 函數細節</span>

<span class="QH_1">語法</span>
  CSNG(數值運算式)

CSNG 函數可將數值運算式轉換成一個單精確度變數的效果。

若有需要的話,在轉換之前 CSNG 會先將此值做四捨五入。


<hr>

<span id="L8099" class="QBtitle">CSNG 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8036"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8098"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CSNG 函數程式範例</span>

下列範例顯示 CSNG 函數在轉換前如何對該值做四捨五入:

A#=975.3421115#
B#=975.3421555#
PRINT A#; CSNG(A#); B#; CSNG(B#)

<span class="QH_1">範例輸出</span>

975.3421115  975.3421  975.3421555  975.3422



<hr>

<span id="L809A" class="QBtitle">CSNG$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8037"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L809B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CSNG$ 函數細節</span>

<span class="QH_1">語法</span>
  CSNG$(字串運算式)

用來將含有中文字元的字串,轉換成含有英文字元的字串。

CSNG$ 與 CDBL$ 的功能相反。
請參考 CDBL$ 函數<span class="QH_2">&lt;</span><a href="#L806A">細節</a><span class="QH_2">&gt;</span>,有關英文字元與中文字元轉換的對照表。


<hr>

<span id="L809B" class="QBtitle">CSNG$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8037"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L809A"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CSNG$ 函數程式範例</span>

用來對含有中文字元的字串,轉換成含有英文字元的字串。

<span class="QH_1">範例</span>

CLS                 ' 清螢幕
A$ = "ＱｕｉｃｋＢＡＳＩＣ 中文化"
B$ = CSNG$(A$)
PRINT A$
PRINT B$

<span class="QH_1">輸出</span>

ＱｕｉｃｋＢＡＳＩＣ 中文化
QuickBASIC 中文化


<hr>

<span id="L809C" class="QBtitle">CDBL 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L809D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CDBL 函數細節</span>

<span class="QH_1">語法</span>
  CDBL(數值運算式)

數值運算式參數可為任何的數值運算式。此函數可將數值運算式轉成一個倍精確度變數
的效果。

注意: CDBL 函數的結果較原來的運算式還不精確,所新增的精確度位數並不是有效位數,
      除非此運算式計算時是使用倍精確度來運算。


<hr>

<span id="L809D" class="QBtitle">CDBL 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L809C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CDBL 函數程式範例</span>

下列範例說明如何使用 CDBL 函數將數值運算式轉換成倍精確度數:

X = 7/9
X# = 7/9
PRINT X
'X# 和 CDBL(X) 的正確性僅小數點後的 7 位數,因為 7/9 是以單精確度來計算的。
PRINT X#
PRINT CDBL(X)
'精確性到小數點後的 15 位。
PRINT 7#/9#

<span class="QH_1">範 例 輸 出</span>

 .7777778
 .7777777910232544
 .7777777910232544
 .7777777777777778



<hr>

<span id="L809E" class="QBtitle">CSRLIN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8038"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L809F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CSRLIN 函數細節</span>

<span class="QH_1">語法</span>
  CSRLIN

可以使用 CSRLIN 函數傳回目前游標上的列(Row)位置。
可以使用 POS 函數傳回目前游標上的行(column)位置。


<hr>

<span id="L809F" class="QBtitle">CSRLIN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8038"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L809E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CSRLIN 函數程式範例</span>

在子目錄 ADVR_EX 之下的 CSR_EX.BAS 程式檔用來說明 CSRLIN 函數的使用。
可使用 [F/檔案] 功能表中 "O/載入程式" 命令載入 CSR_EX.BAS, 並執行它。

此程式使用一個 SUB 程序式,在不干擾目前游標位置前提下,將訊息列印在螢幕上。


<hr>

<span id="L80A0" class="QBtitle">CVSMBF 和 CVDMBF 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8039"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A1"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CVSMBF 和 CVDMBF 函數細節</span>

<span class="QH_1">語法</span>
  CVSMBF(一個含 4 個位元組長度的字串)
  CVDMBF(一個含 8 個位元組長度的字串)

CVSMBF 和 CVDMBF 函數可讓您讀取舊的隨機檔案中以 Microsoft 二進位格式字串儲存
的實數(real numbers)。此函數可將由舊檔案所讀取的字串轉換為 IEEE 格式的數值:


  <span class="QH_1">函數      說明</span>
  CVSMBF    將一個包含有 Microsoft 二進位格式數值的 4 個位元組字串
            轉換成一個單精確度 IEEE 格式數值。

  CVDMBF    將一個包含有 Microsoft 二進位格式數值的 8 個位元組字串
            轉換成一個倍精確度 IEEE 格式數值。


<hr>

<span id="L80A1" class="QBtitle">CVSMBF 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8039"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A0"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CVSMBF 函數程式範例</span>

下列程式是從隨機存取檔案中讀取記錄,檔案中以 Microsoft 二進位格式表示的
的實數是以字串方式儲存,每一筆記錄包含每一位學生的姓名和一個成績。

'
' 對此資料記錄定義一個使用者型態
'
TYPE StudentRec
   NameField AS STRING * 20
   Score AS STRING * 4
END TYPE
' 定義一個使用者型態的變數
DIM Rec AS StudentRec
'********************************************************
' 程式的此部份是建立一個隨機檔,提供給程式的第二部份使用。
'********************************************************
OPEN "TESTDAT1.DAT" FOR RANDOM AS #1 LEN = LEN(Rec)
CLS
RESTORE
READ NameField$, Score$
I = 0
DO WHILE UCASE$(NameField$) &lt;&gt; "END"
   I = I + 1
   Rec.NameField = NameField$
   Rec.Score = Score$
   PUT #1, I, Rec
   READ NameField$, Score$
   IF NameField$ = "END" THEN EXIT DO
LOOP
CLOSE #1
'
  DATA "John Simmons","100"
  DATA "Allie Simpson","95"
  DATA "Tom Tucker","72"
  DATA "Walt Wagner","90"
  DATA "Mel Zucker","92"
  DATA "END","0"
'*********************************************
' 程式的此部份是在展示 CVSMBF 函數的用法
'*********************************************
' 開啟輸入檔
OPEN "TESTDAT1.DAT" FOR RANDOM AS #1 LEN=LEN(Rec)
Max = LOF(1) / LEN(Rec)
' 讀取並印出所有的記錄
FOR I = 1 TO Max
   ' 讀取一個記錄到使用者型態變數記錄中
   GET #1, I, Rec
   ' 轉換一個成績: 將 Microsoft 二進位格式儲存的數值字串成為 IEEE-格式 的數值
   ScoreOut = CVSMBF(Rec.Score)
   ' 顯示姓名及分數
   PRINT Rec.NameField, ScoreOut
NEXT I
CLOSE #1
KILL "TESTDAT1.DAT"
END



<hr>

<span id="L80A2" class="QBtitle">CVI, CVS, CVL, 和 CVD 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803A"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A3"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引</a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CVI, CVS, CVL, 和 CVD 函數細節</span>

<span class="QH_1">語法</span>
  CVI(一個含 2 個位元組長度的字串)
  CVS(一個含 4 個位元組長度的字串)
  CVL(一個含 4 個位元組長度的字串)
  CVD(一個含 8 個位元組長度的字串)

CVI, CVS, CVL, 和 CVD 配合 FIELD 敘述用來讀取隨機檔中的實數,這些函數將
FIELD 敘述所定義的字串轉換成對應的數值型態值。
以上這些函數是 MKI$, MKS$, MKL$, 和 MKD$ 的互補函數:

  <span class="QH_1">函數      說明</span>
  CVI       將一個由 MKI$ 所產生的 2 個位元組字串轉成一個整數值。

  CVS       將一個由 MKS$ 所產生的 4 個位元組字串轉換成一個單精確度數值。

  CVL       將一個由 MKL$ 所產生的 4 個位元組字串轉換成一個長整數值。

  CVD       將一個由 MKD$ 所產生的 8 個位元組字串轉換成一個倍精確度數值。

  注意: 新的 BASIC 記錄變數(record variable)提供一個更有效率且更方便的方法
        來讀取隨機檔案。


<hr>

<span id="L80A3" class="QBtitle">CVI, CVS, CVL 和 CVD 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803A"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A2"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CVI, CVS, CVL, 和 CVD 函數程式範例</span>

下列程式舉例說明 MKS$ 和 CVS 函數使用。
若執行此程式時, 會提示您輸入"帳目號碼 # ",
在範例資料檔 ACCOUNT.INF 中的帳號分別為 1,2,3,4,或 5。

在輸入帳號後,程式提供更新該帳戶餘額的功能。


' *** 範例程式使用 CVS 函數 ***
'
' 為資料記錄(data records)定義一個使用者型態
TYPE Buffer
   AccName AS STRING * 25
   Check   AS STRING * 4
END TYPE
' 定義一個變動型態的變數
DIM BankBuffer AS Buffer
OPEN "ACCOUNT.INF" FOR RANDOM AS #1 LEN = 29
CLS
RESTORE
READ AccName$, Check
I = 0
DO WHILE UCASE$(AccName$) &lt;&gt; "END"
   I = I + 1
   BankBuffer.AccName = AccName$
   BankBuffer.Check = MKS$(Check)
   PUT #1, I, BankBuffer
   READ AccName$, Check$
   IF AccName$ = "END" THEN EXIT DO
LOOP
CLOSE #1
'
   DATA "Bob Hartzell", 300
   DATA "Alice Provan", 150
   DATA "Alex Landow", 75
   DATA "Walt Riley", 50
   DATA "Georgette Gump", 25
   DATA "END", 0

'***********************************************
OPEN "ACCOUNT.INF" FOR RANDOM AS #2 LEN = 29
FIELD #2, 25 AS AccName$, 4 AS Check$

Format$ = "$$#####.##"
DO
   PRINT
   DO
      INPUT "輸入所要更新的帳號 # : ", Rec%
      GET #2, Rec%                               '讀取該記錄
      PRINT "此帳戶為 "; AccName$
      INPUT "此帳目是您所想要的嗎 "; R$
   LOOP WHILE UCASE$(MID$(R$, 1, 1)) &lt;&gt; "Y"

   '轉換字串成為單精度數值
   Checkamt! = CVS(Check$)
   PRINT
   PRINT "此帳戶目前餘額為:";
   PRINT USING Format$; Checkamt!
   PRINT "輸入本次提款的支票和現金 "
   PRINT "輸入 0 則結束 "

   DO
      INPUT Checkout!
      Checkamt! = Checkamt! - Checkout!
   LOOP UNTIL Checkout! = 0

   PRINT
   PRINT "在此帳目下輸入存款金額"
   PRINT "輸入 0 則結束 "

   DO
      INPUT Checkin!: Checkamt! = Checkamt! + Checkin!
   LOOP UNTIL Checkin! = 0

   PRINT
   PRINT "此帳戶關閉時餘額為";
   PRINT USING Format$; Checkamt!
   '轉換單精度數成為字串
   LSET Check$ = MKS$(Checkamt!)
   PUT #2, Rec%                                  '儲存該記錄
   INPUT "更新其他帳號 "; R$

LOOP UNTIL UCASE$(MID$(R$, 1, 1)) &lt;&gt; "Y"
CLOSE #2
END


<hr>

<span id="L80A4" class="QBtitle">DATA 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A5"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATA 敘述細節</span>

<span class="QH_1">語法</span>
  DATA  常數 1 [,常數 2]...

在 DATA 敘述中的常數 1 和常數 2 等等,可以為任何有效的數值或字串常數。


出現在 DATA 敘述中的符號常數名稱(在 CONST 敘述中定義)是被解釋成為字串,
而不是常數的名稱。例如在下列程式段中,第二個資料項是字串 "PI",
而不是數值 3.141593:

  CONST PI=3.141593
  .
  .
  .
  DATA 2.20, PI,45,7
  .
  .
  .

在一行的範圍內, DATA 敘述可包含數個以逗號分開的常數。

  注意: 在 DATA 敘述的字串常數,若包含逗號,冒號或有意義的前/後置空白
        字元時,才需要用雙引號來括住該字串。

空白資料項(表示沒有值)可允許出現在資料串列中:

  DATA 1,2,,4,5

若數值變數讀到空資料時,變數值為零。當一個字串變數讀到空資料項時,
變數值為空字串("")。


您可以使用任意個 DATA 敘述。

在 QuickBASIC 工作環境中執行時, DATA 敘述僅能從模組層次碼中讀入。
QuickBASIC 在載入一個原始檔案時,將會同時移動所有不在模組層次碼的
DATA 敘述到模組層次碼中。但對於使用 DATA 敘述的 READ 敘述是可以
出現在程式中的任何地方。

DATA 敘述是依照這些敘述出現的先後次序循序的被使用。您可以想像成
許多 DATA 敘述的項目,為一連續的資料串列,而不管在那一個項目中
出現多少個資料項,或該敘述出現在程式的那一個地方。

您可以使用 RESTORE 敘述,再重新讀取 DATA 敘述。


<hr>

<span id="L80A5" class="QBtitle">DATA 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803B"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A4"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATA 敘述程式範例</span>

<span class="QH_1">範例 1</span>

下面範例顯示目前的日期,此日期的轉換是透過 DATE 函數來傳回:

' 讀取日期
C$ = DATE$
' 使用 VAL 來分開從 DATE$ 所傳回字串中的月份
FOR I% = 1 TO VAL(MID$(C$,6,2))
    READ Month$
NEXT
DATA 1月, 2月, 3月, 4月, 5月, 6月, 7月
DATA 8月, 9月, 10月, 11月, 12月

' 讀取日
Day$ = MID$(C$,9,2)
IF LEFT$(Day$,1) = "0" THEN Day$ = RIGHT$(Day$,1)
' 讀取年
Year = VAL(LEFT$(C$,4))
Year$ = STR$(Year - 1911)

PRINT "今天是"; Year$; "年"; Month$; Day$; "日"

<span class="QH_1">範例 1 的範例輸出</span>

今天是 79 年 9 月 1 日

<span class="QH_1">範例 2</span>

下列範例顯示如何處理空的資料項:

DATA abc,,def
DATA 1,,2
READ A$, B$, C$         'B$ = ""
PRINT A$, B$, C$
PRINT
READ A, B, C            'B = 0
PRINT A, B, C

<span class="QH_1">例 2 的範例輸出</span>

abc                     def
 1           0           2



<hr>

<span id="L80A6" class="QBtitle">DATE$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L803E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80A7"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATE$ 函數細節</span>

DATE$ 函數傳回一個 10 個位元組長度的字串,其格式為 :
        yyyy-mm-dd

其中 yyyy 是年(1980-2099), mm 代表月(01-12), dd 是日(01-31)。


<hr>

<span id="L80A7" class="QBtitle">DATE$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L803E"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80A6"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATE$ 函數程式範例</span>

PRINT DATE$

<span class="QH_1">範例輸出</span>

 1990-09-21



<hr>

<span id="L80A8" class="QBtitle">DATE$ 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80A9"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATE$ 敘述細節</span>

<span class="QH_1">語法</span>
  DATE$ = 字串運算式

 DATE$ 敘述與<span class="QH_2">&lt;</span><a href="#L803E">DATE$ 函數</a><span class="QH_2">&gt;</span>是互補的。

字串運算式必需為下列其中之一種格式,其中 :
mm (01-12) 及 dd (01-31) 是 "月" 和 "日",而 yy 和 yyyy(1980-2099) 是 "年"。

yy-mm-dd
yyyy-mm-dd
yy/mm/dd
yyyy/mm/dd



<hr>

<span id="L80A9" class="QBtitle">DATE$ 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80A8"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DATE$ 敘述程式範例</span>

下列範例提示您輸入月,日和年,然後在電腦系統中重新啟動系統日期。

'  注意: 請小心執行此程式,假如修改系統日期,則任何您所建立或再版的檔案
'        將標記此新日期。請確定重新啟動的系統日期是目前日期。

PRINT "輸入下列日期(預設為 1991)"
INPUT "年:",Year$
INPUT "月:",Month$
INPUT "日:",Day$
IF Year$ = "" THEN Year$ = "91"
DATE$ = Year$ + "/" + Month$ + "/" + Day$
PRINT DATE$



<hr>

<span id="L80AA" class="QBtitle">DECLARE (BASIC 程序式) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80AB"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DECLARE (BASIC 程序式) 敘述細節</span>

<span class="QH_1">語法</span>
  DECLARE {FUNCTION | SUB } 名稱[([參數串列])]

  <span class="QH_1">參數            說明</span>
  名稱            程序式的名稱。此名稱最長 40 個英文字元, FUNCTION 的
                  名稱可使用型態宣告字元(%,&,!,# 或 $ )來結束,以表示所
                  要傳回值的型態。

  參數串列        當呼叫此程序式時,參數串列用來指定參數的個數及型態。
                  其語法如下所示,僅參數的個數與型態是有意義的。


在 BASIC 中作呼叫時,若沒有使用關鍵字 CALL 來呼叫 SUB 程序式,或所呼叫的
FUNCTION 定義在其他模組時,都需使用 DECLARE 敘述。


一個 DECLARE 敘述也會促使編譯器(compiler)來檢查使用在程序式中參數的數目
和型態。
當您在 QuickBASIC 環境中儲存程式時, QuickBASIC 會自動產生 DECLARE 敘述。
DECLARE 敘述僅可出現在模組層次碼中(而不是在 SUB 或 FUNCTION 中),而且會
影響整個模組。


在呼叫 SUB 或 FUNCTION 中,參數串列被用來當作一個雛型,用來檢查參數的個數
和型態。其語法如下:

  變數 [AS 型態][,變數 [AS 型態]]...

一個變數可為任意合法的 BASIC 變數名稱。若變數是一個陣列,必須在變數後
緊跟著維度(dimension),並以括號括住:

  DECLARE SUB DisplayText (A(2) AS STRING)
  DIM Text$(100,5)
  .
  .
  .
  CALL DisplayText(Text$())

維度的數目是可以選擇的。

型態參數可以為 INTEGER, LONG, SINGLE, DOUBLE, STRING,或是一個使用者自定型態。
再者,僅參數的個數和型態是有意義的。


  注意:不能在 DECLARE 敘述中使用固定長度字串, 因為只有變動長度字串才能
       傳遞到 SUB 和 FUNCTION 程序式。固定長度字串可出現在參數串列上,
       但在傳遞之前需轉換成變動長度字串。

一個變數的型態也可以由明確的型態宣告字元(%,&,!,#,或$),或依據預設的型態來
指定。

參數串列的格式決定是否要作參數檢查,如下所示:


  <span class="QH_1">宣告                            意義</span>
  DECLARE SUB First               若 SUB 或 FUNCTION 函數被分開編譯時,
                                  可以只省略括號,而且不需要檢查參數。

  DECLARE SUB First ()            First 程序式沒有參數。若呼叫 First
                                  程序式的 CALL 敘述中含有參數時,會
                                  被視為錯誤。一個空的參數串列表示
                                  SUB 或 FUNCTION 中沒有參數。

  DECLARE SUB First (X AS LONG)   First 程序式有一個長整數的參數。
                                  當參數串列出現在 DECLARE 敘述時,
                                  在每次的 CALL 呼叫使用時,皆會檢查
                                  參數的個數和型態。



<hr>

<span id="L80AB" class="QBtitle">DECLARE (BASIC 程序式) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80AA"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DECLARE (BASIC 程序式) 敘述程式範例</span>

在子目錄 ADVR_EX 下的程式檔案 DECL_EX.BAS,說明 DECLARE 敘述在 BASIC 程序式
內的應用。可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入程式,並執行它。

在此程式中, DECLARE 敘述的使用法允許不必使用 CALL 關鍵字去呼叫一個 SUB
程序式。



<hr>

<span id="L80AC" class="QBtitle">DECLARE (非 BASIC 程序式) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L803F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80AD"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DECLARE (非 BASIC 程序式) 敘述細節</span>

<span class="QH_1">語法 1</span>
  DECLARE FUNCTION 名稱 [CDECL] [ALIAS "別名"] [([參數串列])]

<span class="QH_1">語法 2</span>
  DECLARE SUB 名稱 [CDECL] [ALIAS "別名"] [([參數串列])]

  <span class="QH_1">參數           說明</span>
  FUNCTION       表示這個外部程序式可傳回一個值,並且此程序式可使用
                 在一個運算式中。

  SUB            表示這個外部程序式可以呼叫一個 BASIC 的 SUB 程序式。

  名稱           此名稱參數可在 BASIC 程式中用來呼叫一個指定的程序式。
                 此名稱參數至多為 40 個英文字元。
                 FUNCTION 名稱可包含明確的型態宣告字元(%,&,!,#, 或 $)
                 來表示 FUNCTION 所要傳回值的型態。

  CDECL          表示該程序式是使用 C 語言參數的傳遞次序。
                 CDECL 由右向左順序傳遞參數,而不是使用 BASIC 慣用從左而右
                 的方式。CDECL 亦影響到 - 在使用於找尋目的檔(object files)
                 及程式庫(libraries)的名稱。

                 * 在 DECLARE 敘述中,若無 ALIAS 子句,則此型態宣告字元
                   可從程序式的名稱中刪除,且增加一條底線到開頭的部份,
                   當搜尋程式庫或外部檔案時將使用到該名稱。
                 * 假如同時使用 CDECL 與 ALIAS 選擇項時需要加入 "別名"
                   這個參數。

  ALIAS          表示此程序式在 .OBJ 或程式庫中還有另外一個名稱。

  別名           在檔案或程式庫中的程序式名稱。

  參數串列       列出要傳遞到被呼叫程序式(Called procedure)的變數,其語法如下:

  [{BYVAL|SEG}] 變數 [AS 型態] [,[{BYVAL|SEG}] 變數 [AS 型態]]...

  下列列出一個參數串列的各項描述:

  <span class="QH_1">項目       說明</span>
  BYVAL      BYVAL 指定參數是以 "傳值" 方式來傳遞,而不是以傳址方式。
             若省略 BYVAL 參數,則預設是傳址方式。BYVAL 只能用在 INTEGER,
             LONG, SINGLE,和 DOUBLE 的參數。當 BYVAL 出現在參數的前面時,
             會使得在傳遞前, DECLARE 敘述先將真實參數轉換成所指定的型態。

  SEG        將被傳遞的參數當作是一個帶有區段(節 - Segment)位址的遠程位址
             (far address, 或遠程指標 - far pointer)傳址方式來傳遞。

  變數       為一個有效的 BASIC 變數名稱。只有在變數的型態下才有意義。
             若變數是一個陣列,在此變數之後須緊跟著維度(dimension),
             並用括號括住(如此是為了保持與 BASIC 舊版本相容)。

               DECLARE SUB EigenValue (A(2) AS DOUBLE)

             維度的數目是一個可選擇性的。

  AS 型態    指定變數的型態。型態元素可以為 INTEGER, LONG, SINGLE,
             DOUBLE, STRING, ANY, 或是一個使用者自定型態。您也可以透過
             一個明確的型態宣告字元(%, &, !, #, 或 $),或者藉著預設的
             型態來表示變數的型態。當宣告由其他語言所寫成的外部程序式,
             您可以在 AS 子句中使用 ANY 關鍵字。ANY 關鍵字會捨棄對該參數
             的型態作檢查, 您不能使用 ANY 以傳值方式來傳遞參數。

  注意: 在不使用 BYVAL 或 SEG 選擇項時,參數都是以近程位址
        (即: 位移位址 - Offset Address)的傳址方式來傳遞。

DECLARE 敘述的格式可讓您參考以其他語言所寫成的程序式。DECLARE 敘述也促使
編譯器(compiler)檢查呼叫該程式的參數個數及型態。一個 DECLARE 敘述僅能出現
在模組層次碼的程式中,並且會影響整個原始檔案。

參數串列的格式決定是否做參數型態檢查:


  <span class="QH_1">宣告                                 意義</span>
  DECLARE SUB First CDECL              在沒有參數串列時,不需要做參數的檢查。

  DECLARE SUB First CDECL ()           First 程序式沒有參數。
                                       若在 CALL 敘述中的 First 程序式
                                       含有參數時,會被標示為一個錯誤。
                                       一個空括號表示 SUB 或 FUNCTION
                                       中沒有參數。

  DECLARE SUB First CDECL (X AS LONG)  First 程序式使用一個整數參數,
                                       當參數串列出現時,在每次呼叫時
                                       需要檢查參數的數目和型態。


一個程序式若出現在 DECLARE 敘述中,呼叫時可以不必使用 CALL 關鍵字。

  注意: 在 DECLARE 敘述中,不可以使用固定長度的字串,因為只有變動長度字串
        能被傳遞到 SUB 或 FUNCTION 程序式。固定長度字串可出現在參數
        串列中,但是在傳遞之前需要轉換成為變動長度字串。

當使用 SEG 關鍵字來傳遞陣列時應小心謹慎,因為 BASIC 可能在被呼叫常式
(called routine)開始執行之前,會移動在記憶體中的變數。在 CALL 敘述的
參數串列,有可能導致記憶體移動而產生問題。若 CALL 敘述的參數串列只包含
簡單變數,算術運算式,或不使用內建的陣列索引,或不使用使用者自定函數的
陣列索引時,皆可毫無顧忌地使用 SEG 來傳遞變數。


<hr>

<span id="L80AD" class="QBtitle">DECLARE (非 BASIC 程序式) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L803F"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80AC"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DECLARE (非 BASIC 程序式) 敘述程式範例</span>

下列範例顯示一個 BASIC 程式來呼叫一個簡短的 C 函數
此 C 函數可獨立編譯而且儲存在 Quick 程式庫,或是連結(Linked)成 .EXE 檔的型式。


'*** 程式範例: DECLARE(非 BASIC 程序式) ***
'
' 請勿嘗試執行此程式,除非您先以大模組(large module)記憶體方式單獨編譯
' 這個 C 函數,並且將它儲存在 Quick 程式庫或連結它成為一個 BASIC 程式。
'
DEFINT a-z

' 函數 addone 使用 C 的參數傳遞,而且以傳值方式傳遞一個整數參數

DECLARE FUNCTION addone CDECL (BYVAL n AS INTEGER)

INPUT x
y=addone(x)
PRINT "x 和 y 是 ";x;y

END

 /* C 函數 addone,傳回整數參數加 1 的值 */
int far addone(n)
int n;
{
   return(++n);
}



<hr>

<span id="L80AE" class="QBtitle">DEF FN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803F"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80AF"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF FN 敘述細節</span>

<span class="QH_1">單行語法</span>
  DEF FN名稱[(參數串列)] = 運算式

<span class="QH_1">區段語法</span>
  DEF FN名稱[(參數串列)]
     [ 敘述區段 ]
  FN名稱 = 運算式
     [ 敘述區段 ]
  END DEF

  <span class="QH_1">參數            說明</span>
  名稱            為一合法的變數名稱,至多 40 個英文字元的長度。此名稱由 FN
                  所組成,它代表函數的名稱。此名稱可包含一個明確的型態宣告
                  字元來指定所傳回值的型態。除了型態宣告字元外,雖然名稱相同
                  但代表著不同函數名稱。例如,下列是三個不同的 DEF FN 函數
                  名稱。

                    FNString$
                    FNString%
                    FNString#

                  為了可從 DEF FN 函數中傳回值,必須指定一個值給這個完整的
                  函數名稱:

                    FNString$ = "沒有答案"

  參數串列        為一個變數名稱串列,可由逗號分開。其語法如下所示,
                  當函數被呼叫時,BASIC 指定每一個參數的值給所對應的參數。
                  函數參數是以傳值方式來傳遞參數,DEF FN 函數並不允許陣列,
                  記錄或固定長度的字串當作參數。


  運算式          在這兩種語法中,運算式被計值後將結果傳給此函數。在單行
                  語法中,運算式是整個變數的主體,且被限制成一個邏輯行。
                  若運算式未被指定給一個函數名稱時,若 DEF FN 是數值函數,
                  則預設的傳回值是零;反之,DEF FN 是字串函數,則傳回空字串
                  ("")。


參數串列有下列的語法:

  變數 [AS 型態] [,變數 [AS 型態]]...

此變數為一任何有效的 BASIC 變數名稱。型態參數可以是 INTEGER, LONG,
SINGLE, DOUBLE, 或 STRING; 也可以使用型態宣告字元(%, &, !, #, 或 $)
來指定變數的型態。

  注意: FUNCTION 程序式比 DEF FN 函數提供更大的彈性及控制能力。
        可參考 <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8058">FUNCTION 敘述</a><span class="QH_2">&gt;</span> 有更多的說明。


在使用函數之前,先用 DEF FN 敘述定義一個 DEF FN 函數。若在定義
該函數之前便呼叫 DEF FN 函數時,將產生 "函數尚未定義" 錯誤訊息。

DEF FN 函數的定義不能出現在其他 DEF FN 定義之中。換言之, DEF FN 函數
無法遞迴(recursion)呼叫。

您可以使用 EXIT DEF 敘述提早離閞多行(區段)型的 DEF FN 敘述。DEF FN 函數
僅可以在所定義的模組中使用,而無法被其他的模組參用。

DEF FN 函數可在模組層次的程式中共用變數。變數若不在參數串列中是屬於
全域性--它們的值可與其他的呼叫程式共用。為了保持變數的值在函數的
定義中為區域性,須使用 STATIC 敘述來宣告該變數。

DEF FN 函數可傳回數值或字串值。若名稱是字串名稱,則 DEF FN 會傳回字串值;
反之,若名稱為數值變數名稱,則傳回數值。
指定一個數值給字串函數名稱,或指定一個字串值給數值函數名稱都會產生
"型態不一致" 錯誤訊息。

假如函數為數值, DEF FN 名稱傳回所指定名稱的精確度。例如,若名稱設定為
倍精確度變數,則 DEF FN 名稱所傳回的值為倍精確度,這與運算式的精確度無關。

為了增加效率, BASIC 可以重新安排算術運算式,但需避免使用 DEF FN 函數,
以免程式內運算式中變數的次序被改變,下例可以得到不同結果:


  DEF FNShort
     I=10
     FNShort=1
  END DEF
  I=1 : PRINT FNShort + I + I

若 BASIC 重新排列運算式,如此,在計算 (I+I) 之後才呼叫 FNShort ,其結果為 3
而不是 21 。藉著獨立的 DEF FN 函數呼叫,便能避免此一問題發生:

  I = 1 : X = FNShort : PRINT X + I + I

在 DEF FN 函數中使用輸入/輸出敘述來做輸入/輸出的運算,或在 DEF FN 函數中
使用繪圖敘述來做繪圖運算,都可能引起類似的問題。


<hr>

<span id="L80AF" class="QBtitle">DEF FN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L803F"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80AE"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF FN 敘述程式範例</span>

在子目錄 ADVR_EX 下的程式檔案 DEFFN_EX.BAS 用來說明 DEF FN 敘述的用法,
可使用 [F/檔案] 功能表的 "O/載入程式" 命令載入該程式,並執行它。

此程式使用 DEF FN 函數來計算所輸入數值的階乘值。(例如, 3 的階乘為 3*2*1)



<hr>

<span id="L80B0" class="QBtitle">DEF SEG 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8040"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B1"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF SEG 敘述細節</span>

<span class="QH_1">語法</span>
  DEF SEG [=位址]

對 BLOAD, BSAVE, CALL ABSOLUTE, PEEK, 和 POKE 敘述而言,位址參數被用來當作
區段位址(節位址 - segment address)。位址參數是一個數值運算式傳回介於 0 到
65,535 之間的無正負號整數值。若一個數值超出範圍,將會產生 "不正確的函數呼叫"
的錯誤訊息。若有錯誤發生,則仍保留上次的區段(節-Segment)位址;若省略位址,
則使用 BASIC 的資料區段(DS - Data Segment)。

在 DEF 和 SEG 之間確定要用空白分開。否則, BASIC 會解釋此敘述為 "指定一個值
給 DEFSEG 變數"。


<span class="QH_1">與 BASICA 的差異</span>

在 QuickBASIC 中,CALL 和 CALLS 敘述不能使用由 DEF SEG 敘述所設定的區段位址
(節位址)。



<hr>

<span id="L80B1" class="QBtitle">DEF SEG 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8040"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B0"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF SEG 敘述程式範例</span>

在子目錄 ADVR_EX 下的程式檔案 DEFSG_EX.BAS 用來說明 DEF SEG 敘述的使用。
可使用 [F/檔案] 功能表的 "O/載入程式" 命令載入程式,並執行它。

本程式使用 DEF SEG,PEEK 和 POKE 敘述來切換 CAPSLOCK 鍵的開啟和關閉。

  注意: 此程式包含硬體規格指令。可在 IBM PC, XT, 和 AT 的電腦上正確的執行。


<hr>

<span id="L80B2" class="QBtitle">DEF型態 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8041"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B3"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF型態 敘述細節</span>

<span class="QH_1">語法</span>
  DEFINT 字母範圍 [,字母範圍 ] ...
  DEFSNG 字母範圍 [,字母範圍 ] ...
  DEFDBL 字母範圍 [,字母範圍 ] ...
  DEFLNG 字母範圍 [,字母範圍 ] ...
  DEFSTR 字母範圍 [,字母範圍 ] ...

字母範圍的格式如下:

  字母 1[-字母 2 ]

其中字母 1 和字母 2 可以是任意的大小寫英文字母。在字母範圍中名稱的起始字母
由下述的三個連續字母來指定型態 : 整數(INT),長整數(LNG),單精確度(SNG),
倍精確度(DBL), 或字串(STR)。例如,在下列的程式片斷中, Message 是一個字串變數。

  DEFSTR A-Q
  .
  .
  .
  Message = "堆疊空間不足"

在字母範圍中的大小寫英文字母是相同的,所以下列的敘述都是相等的 :

  DEFINT I-N
  DEFINT i-n
  DEFINT i-N

型態宣告字元 (%,&, !, #, 或 $) 通常優先於 DEF型態 敘述, DEF型態 敘述並不會
影響記錄元素。


  注意: I!, I#, I&, I$, 和 I% 是不同的變數,且每一變數可能表示不同的數值。

<span class="QH_1">與 BASICA 的差異</span>

BASICA 處理 DEF型態 敘述的方式是不同的。 BASICA 在執行之前,會每次掃描一個
敘述。假如敘述中包含一個沒有明確的型態宣告字元(由 !, #, &, $, 或 % 所指定)
變數,直譯器(Interpreter)便使用目前預設的型態。

在下列範例中,當 BASIC 直譯行號 20 ,就決定目前以 I 開頭的變數且其預設型態為
整數。行號 30 改變預設型態為單精確度, 當 BASICA 回溯到行號 20 ,重新掃描此行
時,會將 IFLAG 當作一個單精確度變數。

  10  DEFINT I
  20  PRINT IFLAG
  30  DEFSNG I
  40  GOTO 20

相反地, QuickBASIC 僅掃描本文一次,一旦一個變數出現在程式行中,其型態便無法
更改。



<hr>

<span id="L80B3" class="QBtitle">DEF型態 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8041"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B2"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DEF型態 敘述程式範例</span>

    請參閱 <span class="QH_2">&lt;</span><a href="#L805D">ABS 函數程式範例</a><span class="QH_2">&gt;</span>。



<hr>

<span id="L80B4" class="QBtitle">DIM 敘述細節</span>
   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8042"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B5"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DIM 敘述細節</span>

<span class="QH_1">語法</span>
  DIM [SHARED] 變數[(註標)] [AS 型態] [,變數[(註標)] [AS 型態]]...

  <span class="QH_1">參數         說明</span>
  SHARED       選擇項 SHARED 屬性允許在同一模組中的所有程序式共用陣列及
               簡單變數。與 SHARED 敘述不同, SHARED 敘述僅影響在單一的
               SUB 或 FUNCTION 中的變數。

  變數         為一個 BASIC 的變數名稱。

  註標         表示陣列的維度(dimension)。可以宣告成多維陣列。註標的語法
               如下所述。

  AS 型態      宣告變數為一個基本元素或是使用者自定型態。其基本的型態為
               INTEGER, LONG, SINGLE, DOUBLE 及 STRING(變動的或固定的)。


在 DIM 敘述中的註標(subscript)有下列格式:

  [下界 TO] 上界 [,[下界 TO] 上界]...

TO 關鍵字提供一種方法來表示陣列註標的上界(upper bound)和下界(lower bound)。
下列敘述是相等的(假如在沒有 OPTION BASE 敘述下 ):

  DIM A(8,3)
  DIM A(0 TO 8, 0 TO 3)
  DIM A(8,0 TO 3)

使用 TO 關鍵字,不再限制註標必須為正數。您可以使用 TO 來指定從 -32,768 到
32,767 之間任意範圍的註標:

  DIM A(-4 TO 10)
  DIM B(-99 TO -5,-3 TO 0)

假如在程式中使用到沒有以 DIM 敘述宣告的陣列,則每一個陣列註標的最大值
為 10 。若您使用一個大於所宣告的最大註標值時,會出現 "陣列註標超出範圍"
錯誤訊息。

DIM 敘述宣告後對所有數值陣列的元素初設為零,及所有字串陣列的元素設為空字串。
記錄變數,包括固定字串欄位會起始化為零。在 DIM 敘述中所允許的最大維度為 60 。


假如對己經定義過的陣列,試圖再用 DIM 敘述定義陣列變數的維度,將會產生
"陣列已經宣告" 錯誤訊息。

好的程式技巧是將需要的 DIM 敘述放在程式閞始的地方,並且要在所有迴圈的外面。

<span class="QH_1">靜態和動態陣列</span>

如何宣告一個陣列同時也決定陣列是否為 $STATIC (當程式被編譯--translated 時
就配置空間)或 $DYNAMIC (當程式執行時才配置空間)。

  * 一個陣列先在 COMMON 敘述中先宣告,是屬於 $DYNAMIC。
  * 沒有明確宣告的陣列則屬於 $STATIC。
  * 陣列用數值常數或 CONST 符號常數來宣告維度,則屬於 $STATIC。
  * 陣列用變數當作註標,來宣告維度是屬於 $DYNAMIC。

下列顯示此敘述的不同組合和結果:

  <span class="QH_1">敘述             結果</span>
  DIM A(0 TO 9)   若 $DYNAMIC 沒作用,則陣列 A 被配置成一個 $STATIC 陣列。

  DIM A(MAXDIM)   若 MAXDIM 在 CONST 敘述中定義,則陣列 A 為 $STATIC 陣列。
                  若 MAXDIM 是一個變數,則陣列為 $DYNAMIC 陣列,而且僅當
                  程式執行到 DIM 敘述時才配置空間 。

  注意: 若陣列的大小超過 64K 位元組,且陣列為動態陣列,同時在 QB 命令行
        並未使用 /AH 選擇項時,將會得到一個 "陣列註標超出範圍" 或是一個
        "陣列太大" 錯誤訊息。
        此時應減少陣列的大小或改變陣列為動態,並且在 QB 命令行中使用 /AH 選項
        參數。

<span class="QH_1">型態宣告</span>

除了宣告陣列的維度外, DIM 敘述也可用來宣告變數的型態,例如,下列敘述宣告變數
成為一個整數型態,且不需要型態宣告字元或 DEFINT 敘述:


  DIM NumberOfBytes AS INTEGER

DIM 敘述提供一種技巧來宣告所指定變數成為一個記錄,在下列範例中變數 TopCard
宣告為記錄變數:


  TYPE Card
     Suit AS STRING * 9
     Value AS INTEGER
  END TYPE

  DIM TopCard AS Card

您也可以宣告含有記錄的陣列:

  TYPE Card
     Suit AS STRING * 9
     Value AS INTEGER
  END TYPE

  DIM Deck(1 TO 52) AS Card

<span class="QH_1">與 BASICA 不同的差異</span>

當 BASICA 在程式中遇到 DIM 敘述,便執行此一敘述。當執行此敘述時,陣列才被配置
空間,所以在 BASICA 中的所有陣列皆屬於動態陣列。


<hr>

<span id="L80B5" class="QBtitle">DIM 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8042"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B4"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DIM 敘述程式範例</span>

下列範例用來尋找並列出數值中的最大值及最小值:


' 由至多 20 個數值中找出最大和最小值
'
' 宣告一個陣列來儲存這些數值
CONST MAXDIM=20
DIM A(1 TO MAXDIM)
' 使用 DIM 來設定二個整數變數,其他所有變數為單精確度
DIM NumValues AS INTEGER, I AS INTEGER

' 讀取數值
NumValues=0
PRINT "每行輸入一個數值,鍵入 END 則結束"
DO
   INPUT A$
   IF UCASE$(A$)="END" OR NumValues&gt;=MAXDIM THEN EXIT DO
   NumValues=NumValues+1
   A(NumValues)=VAL(A$)
LOOP

' 尋找最大和最小數值
IF NumValues&gt;0 THEN
   Max=A(1)
   Min=A(1)
   FOR I=1 TO NumValues
      IF A(I)&gt;Max THEN Max=A(I)
      IF A(I)&lt;Min THEN Min=A(I)
   NEXT I

   PRINT "最大值是 ";Max;" 最小值是 ";Min
ELSE
   PRINT "數值不大於零"
END IF

<span class="QH_1">範例輸出</span>

每行輸入一個值,鍵入 END 則結束
? 23.2
? 11.3
? 1.6
? end
最大值是 23.2 最小值是 1.6



<hr>

<span id="L80B6" class="QBtitle">WHILE...WEND 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8043"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B7"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WHILE...WEND 敘述細節</span>

<span class="QH_1">語法</span>
  WHILE 條件
    [ 敘述區段 ]
  WEND

若條件為真(也就是不為零)則執行介於 WHILE....WEND 間的敘述區段,然後
再回到 WHILE 敘述,並檢查其條件。若條件仍滿足(為真),便重複處理此區段;
若條件為假(即為零),就恢復執行 WEND 敘述的下一個敘述。


  注意: QuickBASIC 的 DO...LOOP 敘述提供一個更強且更有彈性的迴圈控制結構。

WHILE...WEND 迴圈可在任意層次作巢狀(nested)迴圈。每一個 WEND 對應到最近的
WHILE 敘述,若有未對應的 WHILE 敘述會導致 "WHILE 沒有對應的 WEND 敘述"
的錯誤訊息。 若有未對應的 WEND 敘述則會導致 "WEND 敘述沒有對應的 WHILE 敘述"
的錯誤訊息。

  注意: 切勿在未執行 WHILE 測試前,便分歧到 WHILE...WEND 迴圈主體中。
        如此,會導致執行時的錯誤,或者使程式產生無法定址的問題。


<hr>

<span id="L80B7" class="QBtitle">WHILE...WEND 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8043"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B6"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WHILE...WEND 敘述程式範例</span>

下列程式片斷對陣列 A$ 執行氣泡排序(Bubble Sort)法。在 WHILE Exchange
前面的一個敘述設定變數 Exchange 為 True,表示其值不為零,如此才可以先強迫進入
WHILE...WEND 迴圈一次(這種結構在使用 DO...LOOP 時,是不需要的)。當不再有交換
動作時,A$ 內所有元素便被排序完成,此時 Exchange 變數為假(其值為零),程式便繼續
執行 WEND 敘述的下一行敘述。

' 陣列 A$ 的氣泡排序法
CONST FALSE=0, TRUE=NOT FALSE
DIM A$(4)
A$(1) = "New York"
A$(2) = "Boston"
A$(3) = "Chicago"
A$(4) = "Seattle"
Max = UBOUND(A$)
Exchange=TRUE           ' 強迫第一輪迴便進入陣列
WHILE Exchange          ' 一直排序到沒有元素被交換為止
   Exchange=FALSE
   ' 一對一對地比較陣列元素。當兩個元素有交換時,
   ' 藉著設定 Exchange 變數為真,強迫進入下一個輪迴。
   FOR I = 2 TO Max
      IF A$(I-1) &gt; A$(I) THEN
         Exchange = TRUE
         SWAP A$(I - 1), A$(I)
      END IF
   NEXT
WEND
CLS
FOR I = 1 TO 4
   PRINT A$(I)
NEXT I
END

<span class="QH_1">範例輸出</span>
Boston
Chicago
New York
Seattle


<hr>

<span id="L80B8" class="QBtitle">DO...LOOP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8044"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B9"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DO...LOOP 敘述細節</span>

<span class="QH_1">語法 1</span>
  DO [{WHILE | UNTIL} 布林運算式]
    [ 敘述區段 ]
  LOOP

<span class="QH_1">語法 2</span>
  DO
    [ 敘述區段 ]
  LOOP [{WHILE | UNTIL} 布林運算式]


  <span class="QH_1">參數                說明</span>
  敘述區段            被重複執行的一行或多行的 BASIC 敘述。

  布林運算式          用來計算其值為真(不為零)或假(為零)的任意運算式。

您可以使用 DO...LOOP 敘述來代替 WHILE...WEND 敘述。DO...LOOP 敘述較多樣化,
因為可在迴圈的閞始或結束處來測試條件。



<hr>

<span id="L80B9" class="QBtitle">DO...LOOP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8044"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80B8"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DO...LOOP 敘述程式範例</span>

下面有四個範例。前二個範例說明因測試條件位置的不同放法,如何影響敘述區段
執行的次數。第三個範例說明如何在一個迴圈中來暫停程式的執行,一直到使用者
按下任意鍵才繼續執行。第四個範例說明將測試條件放在一個迴圈的尾部(後測式)
同時以一個排序副程式來說明此程式使用後測試是合適的。

<span class="QH_1">DO...LOOP 程式範例 1</span>

下列範例中,在迴圈的開頭做條件測試。
因為變數 I 並不小於 10 ,迴圈(敘述區段)的主體將不會被執行。

' DO...LOOP 在迴圈的開頭做測試(前測式),輸出將顯示迴圈尚未執行。
I = 10
PRINT "在迴圈開始時,I 的值為";I
DO WHILE I &lt; 10
   I = I + 1
LOOP
PRINT "在迴圈結束時,I 的值為";I

<span class="QH_1"> 範例 1 範例輸出</span>

在迴圈開始時,I 的值為 10
在迴圈結束時,I 的值為 10


<span class="QH_1">DO...LOOP 程式範例 2</span>

下列範例使用後測式來測試變數 I,如此一來敘述區段最少執行一次 :

' DO...LOOP 測試條件放在迴圈的尾部, 輸出將顯示出迴圈至少執行一次
I = 10
DO
   PRINT "迴圈開始時,I 的值為";I
   I = I + 1
LOOP WHILE I &lt; 10
PRINT "迴圈結束時,I 的值為";I

<span class="QH_1">範例 2 範例輸出</span>

迴圈開始時,I 的值為 10
迴圈結束時,I 的值為 11


<span class="QH_1">DO...LOOP 程式範例 3</span>

在下列範例中,DO...LOOP 敘述繼續在迴圈的底部測試 Choice$ 的長度,
當使用者按下任意鍵,若 Choies$ 長度大於零時,迴圈便停止。

' DO...LOOP 敘述在迴圈底部做測試(後測式)
DO
   Choice$ = INKEY$
LOOP WHILE Choice$ = ""


<span class="QH_1">DO...LOOP 程式範例 4</span>

下列的排序程式是使用後測式迴圈。因為整個陣列至少須檢查一次,查看是否已依序
排好。一般而言,使用後測式迴圈做測試時,只有在知道此敘述區段至少要執行一次時
才可以使用。

' 設定一個符號常數值來表示沒有交換
'
CONST NOEXCH = -1
DIM Exes(12)
FOR I = 1 TO 12
   Exes(I) = 13 - I
NEXT I
Limit = 12
CLS                                  '清除螢幕
PRINT "這是要作排序的數字串列:
FOR I = 1 TO 12
   PRINT Exes(I);
NEXT I
LOCATE 4,1: INPUT "按任意鍵,繼續...", Gar$
DO
   Exchange = NOEXCH
   FOR I = 1 TO Limit - 1            '對整個陣列執行一圈(pass)
      IF Exes(I) &gt; Exes(I+1) THEN
         SWAP Exes(I), Exes(I+1)     '交換陣列元素
         Exchange = I                '記錄最近交換的位置
      END IF
   NEXT I
   Limit = Exchange                  '僅在最近一圈中有做交換時,
                                     '才能在下一圈繼續排序
LOOP UNTIL Exchange = NOEXCH         '一直排序到沒有元素被交換為止
'
PRINT
PRINT "這是排序完成的串列:"
FOR I = 1 TO 12
   PRINT Exes(I);
NEXT I
END

<span class="QH_1">範例輸出</span>

這是要作排序的數字串列:
 12  11  10  9  8  7  6  5  4  3  2  1

按任意,鍵繼續...

這是排序完成的串列:
 1  2  3  4  5  6  7  8  9  10  11  12


<hr>

<span id="L80BA" class="QBtitle">DRAW 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8045"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BE"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DRAW 敘述細節</span>

<span class="QH_1">語法</span>
  DRAW 字串運算式

DRAW 敘述組合許多其他繪圖敘述的功能成為繪圖巨集語言,此巨集語言用來定義一組
特性以描述一個影像,這些特性包括移動(上,下,左,右),顏色,旋轉角度及標度因素
(scale factor)。語法中字串運算式是由這些巨集命令所組成的。

巨集命令有三種型態:

  <span class="QH_2">&lt;</span><a href="#L80BB">游標移動命令</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L80BC">角度,顏色,與標度因素命令</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L80BD">X 子字串命令</a><span class="QH_2">&gt;</span>

<span class="QH_1">與 BASICA 的差異</span>

當使用在 QuickBASIC 時, BASICA 程式內的 DRAW 敘述需要修改。尤其,編譯器
(Compiler)對於變數必須使用 VARPTR$ 格式。其敘述如下例:

  DRAW "XA$"
  DRAW "TA = ANGLE"

(其中 A$ 和 ANGLE 是變數) 當使用編譯器時,必須改成下列格式:

  DRAW "X" + VARPTR$(A$)
  DRAW "TA =" + VARPTR$(ANGLE)


編譯器並不提供 X 字串運算式命令。無論如何,您可藉著在 X 後面加上 "位址"
的字元型式,來執行一個子字串。例如,下面兩個敘述是相等的。第一個敘述可在
QuickBASIC 環境下及使用編譯器的環境中使用。但第二個敘述僅能在 QuickBASIC
環境下執行。

  DRAW "X" + VARPTR$(A$)
  DRAW "XA$"


<hr>

<span id="L80BB" class="QBtitle">DRAW 敘述巨集語言</span>
  <span class="QH_2">&lt;</span><a href="#L80BA"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 移動 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BC"> 角度,顏色,標度 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BD"> X 子字串 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">游標移動命令</span>

下列前置字元命令可放在任何移動命令之前:

  <span class="QH_1">前置字元 說明</span>
  B        移動, 但不繪任何點。
  N        移動, 但繪完後,會回到原來之參考點。

下列命令指定移動的單位。預設的單位為一點;單位大小可用 S 命令來設定標度因素
(scale factor),並修改。假如沒有提供參數,游標將被移動一個單位。(S 在 "角度,
顏色,與標度因素命令" 中來描述)。

每一個移動命令是從目前的繪圖位置開始移動,此位置通常為最近使用其他繪圖巨集
語言命令所繪的點座標。當一個程式開始執行時,預設的目前座標是螢幕的中心點。

  <span class="QH_1">移動       說明</span>
  U [n]      向上移動 n 個單位。

  D [n]      向下移動 n 個單位。

  L [n]      向左移動 n 個單位。

  R [n]      向右移動 n 個單位。

  E [n]      向右上方對角線移動 n 個單位。

  F [n]      向右下方對角線移動 n 個單位。

  G [n]      向左下方對角線移動 n 個單位。

  H [n]      向左上方對角線移動 n 個單位。

  M x,y      為絕對移動或相對移動。若 x, y 參數前加上 +,-(正負)符號,
             即為相對於目前參考點的移動;也就是:將目前所在參考點的座標加上
             x, y(包括 x, y 前面的正負符號),並且將此兩點用一條線連接起來。
             若 x, y 參數前沒有任何符號,則為絕對移動;也就是說,畫一條線從游標
             目前所在位置(座標)到指定(x, y)位置。


<hr>

<span id="L80BC" class="QBtitle">DRAW 敘述巨集語言</span>
  <span class="QH_2">&lt;</span><a href="#L80BA"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 角度,顏色,標度 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BB"> 移動 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BD"> X 子字串 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">角度,顏色及標度因素命令</span>

下例的命令可用來改變目前圖形的形態,如旋轉,改變顏色及按比例放大(縮小)等等:

  <span class="QH_1">命令                        說明</span>
  A  n                        設定旋轉角度 n。 n 值可為 0-3。依次將圖形
                              旋轉 0 度, 90 度, 180 度, 及 270 度 ;
                              其中 0 指 0 度, 1 指 90 度, 2 指 180 度,
                              和 3 指 270 度。作 0 或 180 度旋轉時,圖形
                              會保持原來的大小形狀;而圖形作 90 度或 270 度
                              旋轉時,則會改變其大小形狀,即以一般標準螢幕
                              (例如: 螢幕模式 71 的 寬/高 之比 = 32/27)來
                              作放大(縮小)的標度。

  TA  n                       此指令將圖形旋轉 n 度;其中 n 的範圍由 -360 度
                              到 360度。若 n 為正,表示逆時針旋轉;若 n 為負,
                              則為順時針旋轉。以下的範例是使用 TA 指令來繪製
                              輻射線:

                                SCREEN 71
                                FOR D=0 TO 360  STEP 10
                                   DRAW "TA="+VARPTR$(D)+"NU50"
                                NEXT D

  C n                         設定顏色為 n 。可參閱 COLOR, PALETTE, SCREEN
                              敘述,有討論正確的顏色,顏色值,屬性暫存器。

  S n                         設定標度因素 n,其值介於 1-255 之間。
                              可將 n 值乘以 U, D, L, R 等指令所指定的
                              移動距離,或是乘以相對於 M 指令所指定的
                              真正移動距離,即為圖形放大(縮小)的倍數。

  P 繪圖顏色,邊界顏色         繪圖顏色參數是在圖形的內部塗滿指定的顏色
                              或圖案,而邊界顏色參數則是在圖形的邊緣塗上
                              指定的顏色或圖案。塗花紋(使用一個圖形花紋
                              塗滿一個區域)DRAW 指令是沒有提供的。


<hr>

<span id="L80BD" class="QBtitle">DRAW 敘述巨集語言</span>
  <span class="QH_2">&lt;</span><a href="#L80BA"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; X 子字串 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BB"> 移動 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L80BC"> 角度,顏色,標度 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
  <span class="QH_1">子字串命令           說明</span>
  X 子字串運算式       可執行的一個子字串。此命令可讓使用者能在一個子字串
                       中,再執行另外一個子字串。您可以由一個字串運算執行
                       另一個包含其他字串運算式(可以為一個,二個,三個....)
                       的字串運算式。其中,數值參數可以是 1, 2, 3 的常數或
                       是變數名稱。

                       在 QuickBASIC 中此命令的格式如下:

                         "X" + VARPTR$(字串運算式)

                       此命令的形式不同於 BASICA 中的命令形式。


<hr>

<span id="L80BE" class="QBtitle">DRAW 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8045"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80BA"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">DRAW 敘述程式範例</span>

<span class="QH_1">範例 1</span>

以下程式將使用綠色畫出三角形的外圍,再以藍色塗滿整個三角形的內部:

SCREEN 82
DRAW "C2"             '設定顏色為綠色
DRAW "F60 L120 E60"   '畫出一三角形
DRAW "BD30"           '將游標移至三角形內部
DRAW "P1,2"           '將三角形內部塗滿藍色

<span class="QH_1">範例 2</span>

以下的範例將以不同的方式來使用 M 巨集命令。如:絕對移動及相對移動,如何使用
字串變數及數值變數作為參數等。

SCREEN 71
'絕對移動
DRAW "M 50,80"
DRAW "M 80,50"
'相對移動
DRAW "M+40,-20"
DRAW "M-40,-20"
DRAW "M-40,+20"
DRAW "M+40,+20"
'使用字串變數
X$ = "400" : Y$ = "190"
DRAW "M" + X$ + "," + Y$
'使用數值變數 (注意以下的兩個 "=" 等號)
A = 300 : B = 120
DRAW "M="+VARPTR$(A)+",="+VARPTR$(B)

<span class="QH_1">範例 3</span>

DRAW_EX.BAS 為一個在 ADVR_EX 子目錄下的程式檔,用來說明 DRAW 敘述的使用。
可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入程式,並執行它。

此程式使用 TIME$ 函數,在螢幕上繪製一個時鐘。


<hr>

<span id="L80BF" class="QBtitle">END 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8046"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">END 敘述細節</span>

<span class="QH_1">語法</span>
  END [{DEF | FUNCTION | IF | SELECT | SUB | TYPE}]

  <span class="QH_1">敘述           說明</span>
  END DEF        用來結束一個多行(區段)型式的 DEF FN 函數定義。使用者
                 必須使用 END DEF 來結束一個多行型式的 DEF FN 函數。

  END FUNCTION   用來結束一個 FUNCTION 程序式的定義。使用者必須使用
                 END FUNCTION 來結束一個 FUNCTION 敘述。

  END IF         用來結束一個 IF...THEN...ELSE 敘述區段。使用者
                 必須使用 END IF 來結束此 IF...THEN...ELSE 區段。

  END SELECT     用來結束一個 SELECT CASE 區段。使用者必須使用
                 END SELECT 來結束一個 SELECT CASE 敘述區段。

  END SUB        用來結束一個 BASIC 副程式。使用者必須使用 END SUB
                 來結束一個 SUB 敘述區段。

  END TYPE       用來結束一個使用者自定資料型態的定義。使用者必須
                 使用 END TYPE 來結束 TYPE 敘述。

單就 END 敘述來說,它可用來結束程式執行,並且自動關閉所有已開啟的檔案。
在一個獨立程式中, END 敘述會將控制權返回操作系統。當您在 QickBASIC 環境
下執行時,執行 END 敘述會將控制權返回此 QuickBASIC 環境下。

編譯器(Compiler)通常會設定一個 END 敘述在任何程式的結束位置。所以,若在
一程式的末端省略 END 敘述,仍然可以結束主程式的執行。

您可以在程式中任意位置以 END 敘述來結束程式的執行。


<hr>

<span id="L80C0" class="QBtitle">END 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8046"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80BF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">END 敘述程式範例</span>

這些範例將說明如何使用 END 敘述的 END IF 和 END SELECT 形式來結束
IF...THEN...ELSE 以及 SELECT CASE 敘述區段。

此處有一個範例使用 END IF 敘述來結束 IF...THEN...ELSE 的多重選擇敘述區段:

  INPUT X
  IF X = 1 THEN
    PRINT "one"
  ELSEIF X = 2 THEN
    PRINT "two"
  ELSEIF X = 3 THEN
    PRINT "three"
  ELSE
    PRINT "必須是 1-3 的整數值"
  END IF

這個範例使用 SELECT CASE 結構和上例一樣來做相同的事情:

  INPUT X
  SELECT CASE X
    CASE 1
      PRINT "one"
    CASE 2
      PRINT "two"
    CASE 3
      PRINT "three"
    CASE ELSE
      PRINT "必須是 1-3 的整數值"
  END SELECT


<hr>

<span id="L80C1" class="QBtitle">ENVIRON 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8048"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ENVIRON 敘述細節</span>

<span class="QH_1">語法</span>
  ENVIRON 字串運算式

字串運算式必須是下列形式:
  參數id = 本文
或是
  參數id 本文

等號或空白的左邊每樣事物均會被設為一個參數,且右邊的每樣事物均會被
設為本文(text)。

如果此 參數id 目前尚未存在於環境字串表格中,它將會被新增到此表格的末端。
若此 參數id 在執行 ENVIRON 敘述之前已存在於此表格中,則先刪除表格中的這個
id 參數,並將新 參數id 新增到此表格的末端。

本文字串參數為一新參數的本文。若本文字串為一空字串(""),或者是一個分號
(";"),則此已存在的參數將從環境字串表中刪除,並對此表中所剩餘的參數作重整
壓縮。

當程式結束後,DOS 會自動捨棄此函數所更改過的環境字串表,即 : 環境字串表
的內容與程式執行前的內容相同。

您可以利用此敘述來更改一個子處理(child process - 包括一個程式,或一個以
SHELL 敘述為起始的命令)中 PATH 的參數,或者藉由產生一個新的環境參數,並將
此參數傳送給一個子處理。

在環境字串表中發生錯誤的原因包括: "參數不是字串" 與 "記憶體空間不足"。
當環境字串表中再也沒有空間可存放其他的參數時,則會產生一個
"記憶體空間不足" 錯誤訊息。在環境字串表中的可用空間通常是相當少的。


<hr>

<span id="L80C2" class="QBtitle">ENVIRON 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8048"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ENVIRON 敘述程式範例</span>

此範例使用 ENVIRON 敘述來更改 PATH 環境變數的設定,將目前處理指到 A 磁碟機的
sales 和 accounting 目錄下:

' 更改 PATH 環境變數的值
ENVIRON "PATH=A:\SALES;A:CCOUNTING"


<hr>

<span id="L80C3" class="QBtitle">ENVIRON$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8047"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ENVIRON$ 函數細節</span>

<span class="QH_1">語法</span>
  ENVIRON$(環境字串)
  ENVIRON$(n)

環境字串參數為一字串常數或包含環境變數名稱的變數,此參數 n 為一個數值運算式。

如果所指定的環境字串名稱在環境字串表中找不到,或沒有本文緊接在此環境字串名稱
之後,則 ENVIRON$ 傳回一個空字串。否則, ENVIRON$ 傳回環境字串表中跟在等號後面
的本文。

如果指定一個數值參數 n ,則傳回環境字串表中第 n 個字串。在此情況下,此字串包含
所有的本文,且包含環境字串名稱。如果第 n 個字串不存在,則 ENVIRON$ 會傳回空字串
。此 n 參數可以為任意的數值運算式;並且四捨五入成一個整數。


<hr>

<span id="L80C4" class="QBtitle">ENVIRON$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8047"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ENVIRON$ 函數程式範例</span>

此範例使用 ENVIRON$ 函數列印出目前設定於環境字串表中的字串:

CLS      ' 清除螢幕
I = 1
DO WHILE ENVIRON$(I) &lt;&gt; ""
    PRINT ENVIRON$(I)
    I = I + 1
LOOP

<span class="QH_1">範例輸出</span>

COMSPEC=C:\COMMAND.COM
TMP=c:\tmp
PATH=C:\TOOLS;C:\BIN
PROMPT=$ec4$l$ec7$p$ec4$g$ec7$eb1
INIT=c:\tools
LIB=c:\lib
INCLUDE=c:\include


<hr>

<span id="L80C5" class="QBtitle">EOF 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8049"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">EOF 函數細節</span>

<span class="QH_1">語法</span>
  EOF(檔案代碼)

若 EOF 函數傳回的值為 -1 (真) 表示循序檔案中資料已被讀完。讀取資料檔時,
可以利用 EOF 函數來判斷檔案的指標是否已經指到檔案的末端。以此種方式可以
避免 "檔案中已無資料" 錯誤訊息的發生。

當 EOF 用於一隨機存取檔或二進位檔時,若最後一次執行的 GET 敘述未能將
整筆記錄都讀入到緩衝區內,則 EOF 函數就會傳回一邏輯值 "真"(true),此種情形
即發生在試圖讀取超出檔案末端的資料時。

EOF 不能使用在右列的 BASIC 裝置(device)上, 如: SCRN:, KYBD:, CONS:,
和 LPTn: 。

當 EOF 函數用在通訊裝置上,則檔案末端條件的定義就必須視您所開啟裝置的模式
(ASCII 或 二進位制)而定了。若為 ASCII 模式,它的值一直保持為假,一直到接收到
CTRL+Z 訊號為止,之後會一直保持為真,直到關閉裝置為止。若為二進位模式,當輸入
佇列(queue)是空時,其值為真(Loc(n)=0)。反之,當所輸入的佇列不是空的,則其值為假。



<hr>

<span id="L80C6" class="QBtitle">EOF 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8049"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">EOF 函數程式範例</span>

此例使用一個 DO LOOP 迴圈,從 DATA.IN 檔案中讀取一個單精確度數值,並將所
讀取的值放在 M 陣列中。迴圈中使用 EOF 函數來判斷檔案的指標是否指到檔案末端。
第二個 DO LOOP 迴圈則將所有陣列 M 的元素顯示在螢幕上,以確定在 DATA.IN 檔案中
的值,都已被存入陣列 M 中。

在此例中若沒有開啟一個可供讀取資料的 DATA.IN 檔,則無法執行。

DIM M(0 TO 2000)

OPEN "DATA.IN" FOR INPUT AS 1
C = 0
DO WHILE NOT EOF(1) AND C &lt;= 2000
      INPUT #1, M(C)
      C = C + 1
LOOP

CLS    ' 清除螢幕
D = 0
DO WHILE D &lt; C
      PRINT M(D)
      D = D + 1
LOOP

  祕訣:執行一個用本文編輯器所建立的簡單資料檔 DATA.IN。例如:用下列
       數列建立一個一行的 DATA.IN 檔:

       10 20 30 40 50 60 70 80 90

       然後執行此範例程式則產生下列結果輸出:

<span class="QH_1">範例輸出</span>

10
20
30
40
50
60
70
80
90



<hr>

<span id="L80C7" class="QBtitle">ERASE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERASE 敘述細節</span>

<span class="QH_1">語法</span>
  ERASE 陣列名稱 [,陣列名稱...]

其中,陣列名稱參數為要被釋放的陣列名稱。使用 ERASE 在 $STATIC 與 $DYNAMIC
陣列下,會產生不同的結果。

若在一個 $STATIC 陣列中使用 ERASE 敘述,則會將陣列中的元素重新設定為初值,
即 : 若為數值陣列則所有的元素均變為零;若為字串陣列,則變為空字串。若是陣列
記錄,則將每一筆記錄的所有元素包括固定字串元素均設為零。

若在 $DYNAMIC 陣列中使用 ERASE,則會將此動態陣列所佔用的記憶體空間釋放,程式
若須再使用到此陣列時,就必須重新宣告一次,至於宣告的方法可用 DIM 或 REDIM 兩種
方式來重新宣告:

(1). 若使用 DIM 敘述重新宣告一陣列,必須先將原來所宣告的陣列釋放掉,
     否則程式在執行過程會產生一個 "陣列已經宣告" 的雙重宣告錯誤訊息。

(2). 若使用 REDIM 來重新宣告陣列,則在此敘述之前不需要用 ERASE 敘述,
     便可釋放原來所宣告的陣列。


<hr>

<span id="L80C8" class="QBtitle">ERASE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERASE 敘述程式範例</span>

下面範例說明 $DYNAMIC 和 $STATIC 假命令的使用法:

REM $DYNAMIC
DIM A(100, 100)
'用來釋放陣列 A
ERASE A
'重新宣告陣列 A
REDIM A(5, 5)

REM $STATIC
DIM B(50, 50)
'設定陣列 B 的所有元素均等於零
'陣列 B 仍具有以 DIM 所宣告陣列的大小
ERASE B


<hr>

<span id="L80C9" class="QBtitle">ERDEV 和 ERDEV$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80CA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERDEV 和 ERDEV$ 函數細節</span>

<span class="QH_1">語法</span>
  ERDEV
  ERDEV$

ERDEV 為一整數函數,由最後產生錯誤的裝置(device)傳回一個錯誤碼。

ERDEV$ 為一字串函數,傳回產生錯誤的裝置名稱。如果錯誤發生在字元裝置(character
device)如:列表機時,則 ERDEV$ 會傳回包含 8 個位元組長度的字元裝置名稱。
若非字元裝置時,則只包含 2 個位元組的區段名稱 (如 A:, B:, 等等)。

因為 ERDEV 和 ERDEV$ 只有在發生錯誤時才會傳回有意義的訊息,所以通常用在
由 ON ERROR 敘述所指定的錯誤處理常式中。

ERDEV 和 ERDEV$ 不可用在一個指定敘述的左邊。

ERDEV 是由錯誤處理常式(error-handling routine)(中斷第 24 號)來設定,當 DOS 偵測
到一個錯誤時,用來防止程式繼續執行。

ERDEV 的值為一個包含 DOS 錯誤訊息的位元編碼值(bit-encoded value)。
一個裝置屬性字(device-attribute word)是由較低的 8 個位元(第一個位元組)
包含 DOS 的錯誤碼,其值為 0 到 12 ,和較高的 8 個位元(第二個位元組)包含
位元 15, 14, 13, XX, 3, 2, 1,和 0 來依序排列。其中 XX 表示此位元通常為零。
請參閱 Microsoft DOS 程式設計師指引。


<hr>

<span id="L80CA" class="QBtitle">ERDEV 和 ERDEV$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80C9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERDEV 和 ERDEV$ 函數程式範例</span>

此範例顯示程式企圖去開啟 A:JUNK.DAT 檔時, ERDEV 及 ERDEV$ 函數所傳回的
錯誤碼。

DEFINT A-Z

' 指出錯誤處理常式第一行的位置
ON ERROR GOTO ErrorHandler

' 企圖去開啟檔案
OPEN "A:JUNK.DAT" FOR INPUT AS #1

END

' 錯誤處理常式
' 列印 ERDEV 和 ERDEV$ 所傳回的錯誤碼之後結束

ErrorHandler:
   PRINT "ERDEV 的值是"; ERDEV
   PRINT "裝置名稱是"; ERDEV$
   ON ERROR GOTO 0

<span class="QH_1">範例輸出</span>

若在一個未關閉的 A 磁碟機下執行程式,則會產生下列輸出( 2 代表 DOS的錯誤碼,
表示 "裝置尚未備妥"):

ERDEV 的值是 2
裝置名稱是 A:



<hr>

<span id="L80CB" class="QBtitle">ERL 和 ERR 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80CC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERL 和 ERR 函數細節</span>

<span class="QH_1">語法</span>
  ERR
  ERL

在錯誤發生後, ERR 函數會傳回一個錯誤碼,而 ERL 函數則傳回發生錯誤的行號。
故在程式發生錯誤後, ERR 與 ERL 皆會傳回一個具有意義的值,通常兩者均被用於
錯誤處理常式(error-handling routine)中,決定出錯誤並設法修正。

因為 ERL 和 ERR 均為函數,故不能單獨將他們用在指定敘述的左側。但可間接地用
ERROR 敘述來設定。

<span class="QH_1">與 BASICA 的差異</span>

QuickBASIC 的 ERL 函數會在程式執行發生錯誤時,傳回發生錯誤該行的行號而非標記。
若在程式中沒有行號,則此函數會傳回零值。


<hr>

<span id="L80CC" class="QBtitle">ERL 和 ERR 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80CB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

<span class="QH_2">&lt;</span><a href="#L813A">ON ERROR 敘述程式範例</a><span class="QH_2">&gt;</span> 有使用 ERR 函數。



<hr>

<span id="L80CD" class="QBtitle">ERROR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80CE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERROR 敘述細節</span>

<span class="QH_1">語法</span>
  ERROR 整數運算式

整數運算式參數表示錯誤代碼,其值介於 0 到 255 之間。若整數運算式已經是 BASIC
所使用的錯誤碼,那麼 ERROR 敘述便會模擬錯誤的發生並且列印出錯誤的訊息。

對於使用者自定的錯誤代碼,必須要比標準 BASIC 所提供的錯誤代碼大(為了能與未來
所發展的 Microsoft BASIC 錯誤代碼保持相容,其值可以自 255 開始,往下設定)。

若 ERROR 敘述中,錯誤代碼沒有被定義,則會顯示一個 "無法列印的錯誤" 錯誤訊息。
執行一個 ERROR 敘述時,若沒有錯誤處理常式(error-handling routine),則會列印
錯誤訊息,並且中止程式的執行。


<hr>

<span id="L80CE" class="QBtitle">ERROR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80CD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ERROR 敘述程式範例</span>

下例即為在錯誤處理常式中使用 ERROR 敘述,處理常式並對使用者的錯誤輸入做設陷。

  祕訣: 執行本例必須使用一個已建好的本文檔。或利用本文編輯器來建立一個
        本文檔,或指定 README.DOC 檔為本文檔皆可。

ON ERROR GOTO Handler
OpenFile:
    INPUT "請輸入要更新的檔名"; FileSpec$
    IF FileSpec$ = "" THEN END
    OPEN FileSpec$ FOR INPUT AS #1
    PRINT FILESPEC$;"最前面五行";"是:" : PRINT
    FOR I = 1 TO 5
        LINE INPUT #1, Temp$
        PRINT Temp$
    NEXT
    PRINT : INPUT "這是正確的檔案嗎"; R$
    'Define error 200
    IF LEFT$(R$,1) &lt;&gt; "y" THEN ERROR 200
    END

Handler:        '錯誤處理常式
    Number = ERR
    '若程式執行時期(run-time)產生一個 "檔案找不到" 錯誤訊息時,會列印此
    '特殊訊息,並且提示使用者輸入一個新檔或結束此程式。
    IF Number = 53 THEN
        CLOSE #1
        PRINT "檔案不在相同目錄中"
        PRINT "請輸入新檔名 ([d:]\xxx\...\xxx),"
        PRINT "或,按 &lt;RETURN&gt; 鍵,則結束此程式。"
        RESUME OpenFile
    ELSEIF Number = 200 THEN    '使用者輸入 "n" 值
        CLOSE #1
        RESUME OpenFile
    ELSE
        ERROR Number       ' 53 或 200 以外的錯誤時
        ON ERROR GOTO 0    '列印訊息,關閉錯誤處理,並終止程式的執行。
    END IF



<hr>

<span id="L80CF" class="QBtitle">EXIT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">EXIT 敘述細節</span>

<span class="QH_1">語法</span>
  EXIT {DEF | DO | FOR | FUNCTION | SUB}

  <span class="QH_1">敘述            說明</span>
  EXIT DEF        會立即從正在執行的 DEF FN 函數中離開。程式返回當初引用
                  (Invoked) DEF FN 的位置繼續執行。

  EXIT DO         提供一個離開 DO...LOOP 迴圈的另一個方法。僅能用在 DO...LOOP
                  迴圈內;當執行 EXIT DO 後,會將控制權轉移到 LOOP 敘述的下一行
                  敘述。若在一個巢狀(nested) DO...LOOP 敘述中,使用此 EXIT DO,
                  則會立即跳出包含它的最近一個 LOOP 迴圈,回到上一層迴圈中。

  EXIT FOR        提供另一個離開 FOR...NEXT 迴圈的方法,只可用於 FOR NEXT
                  迴圈中,
                  則會自動跳出迴圈,並到 NEXT 的下一行敘述繼續執行。
                  若用在巢狀 FOR...NEXT 迴圈中,則會跳出包含它(指 EXIT FOR)
                  的最近一個迴圈,回到上一層迴圈繼續執行。

  EXIT FUNCTION   立即由一 FUNCTION 程序式跳回到由呼叫此 FUNCTION 處的
                  下一敘述繼續執行。它只能用於 FUNCTION 程序式。

  EXIT SUB        立即由一 SUB 程序式跳回到由呼叫此 SUB 程序式處的下一行
                  敘述繼續執行。它只能用於 SUB 程序式中。

EXIT 敘述與這些結構(迴圈,程序式)所使用的結束方式無關。EXIT 敘述只是提供
另外一種不同的方式由這些結構中離開。


<hr>

<span id="L80D0" class="QBtitle">EXIT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L804F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80CF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">EXIT 敘述程式範例</span>

此副程式為 RTRIM$ 函數的擴充,可刪除字串尾端的空白,定位,歸位和換行等字元。
此副程式首先檢查字串尾端的字元,當發現可列印字元時,便使用 EXIT FOR 敘述
跳離 FOR 迴圈。

其餘請參見 STATIC 敘述中有使用 EXIT SUB 敘述之範例程式。

<span class="QH_1">----------- 注意 -----------</span>
若沒有主程式,請不要嘗試去執行。
<span class="QH_1">----------------------------</span>

' Rtrim 用來刪除字串末端的空白,定位,歸位,換行等字元
SUB Rtrim(S$) STATIC
J=0
' 首先由字串的末端開始找尋是否有空白,定位,歸位,換行等字元
FOR I = LEN(S$) TO 1 STEP -1
   C$ = MID$(S$,I,1)
   IF C$ &lt;&gt; " " AND C$ &lt;&gt; CHR$(9) AND C$ &lt;&gt; CHR$(10) AND C$ &lt;&gt; CHR$(13) THEN
      J=I
      EXIT FOR
   END IF
NEXT I
' 刪除尾端不必要的字元
S$=LEFT$(S$,J)
END SUB


<hr>

<span id="L80D1" class="QBtitle">EXP 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8050"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">EXP 函數細節</span>

<span class="QH_1">語法</span>
  EXP(數值運算式)

若 x 為一數值運算式, EXP 函數傳回 e (為自然對數的底數)的 x 次方。其中,
指數 x 不可以大於 88.02969,否則將產生 "超值溢位"(overflow)錯誤訊息。

EXP 函數的計算一般採用預設的單精確度數值。若參數 x 為倍精確度數值,則 EXP
就以倍精確度來計算。


<hr>

<span id="L80D2" class="QBtitle">EXP 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8050"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">EXP 函數程式範例</span>

下例即以 EXP 函數計算細菌在一個以 15 天為週期生長繁殖的情形。此程式提示輸入
一個母體的初值及它的成長率。

CLS    ' 清除螢幕
INPUT "細菌母體的初值"; Colony0
INPUT "每天的成長率以細菌數的百分比計算"; Rate
R = Rate / 100 : Form$ = "##  ###,###,###,###"
PRINT : PRINT "天數       細菌數"
FOR T = 0 TO 15 STEP 5
    PRINT USING Form$; T, Colony0 * EXP(R * T)
NEXT

<span class="QH_1">範例輸出</span>

細菌母體的初值? 10000
每天的成長率以細菌數的百分比計算? 10

天數       細菌數
 0           10,000
 5           16,487
10           27,183
15           44,817


<hr>

<span id="L80D3" class="QBtitle">FIELD 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8051"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FIELD 敘述細節</span>

<span class="QH_1">語法</span>
  FIELD [#]檔案代碼, 欄位寬度 AS 字串變數 [,欄位寬度 AS 字串變數] ...

  <span class="QH_1">參數             說明</span>
  檔案代碼         此參數與 OPEN 敘述所使用的檔案代碼相同。

  欄位寬度         為在記錄中欄位的寬度。

  字串變數         字串變數參數用來包含由一個記錄中讀取資料,或將一筆資料
                   寫入到指定的記錄(record)中。


在 FIELD 敘述中所指定的緩衝區位元組總數,不可超過開啟檔案時所指定隨機檔
記錄的長度大小,否則會產生 "Field 敘述長度不符" 的錯誤訊息(一個記錄長度
的預設值為 128 個位元組)。

在相同的檔案中 FIELD 敘述的執行次數不受限制。所有 FIELD 敘述中在相同的時間
內執行時,均保有相同的效用。

當檔案關閉時,有關此檔案所定義的欄位均會被清除,意即: 所有欄位定義的字串變數
將隨檔案的關閉而設為空字串。

當您想將變數保留給一個欄位,請不要在 INPUT 或指定敘述中使用一個變數名稱來定義
一個欄位。一個以 FIELD 定義的變數名稱,在隨機檔案的緩衝區中,有其相對應的位置。
若在 INPUT 或指定敘述中使用此變數,那麼此變數便不再具有隨機檔案緩衝區所分配的
空間,而僅僅表示一字串位置。

  注意: BASIC 的記錄變數以及延伸的 OPEN 敘述語法,將提供一個更方便的方法來
        使用隨機存取檔。

<span class="QH_1">與 BASICA 中的差異</span>

在 QuickBASIC 中,當以 CLOSE 或 RESET 敘述在一個已編譯的程式中關閉一隨機檔時,
所有的欄位變數均隨此檔的關閉而重設為空字串。而在 BASICA 程式中關閉一隨機檔時,
所有的欄位變數,均會保留最後一個 GET 敘述所指定的值。


<hr>

<span id="L80D4" class="QBtitle">FIELD 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8051"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FIELD 敘述程式範例</span>

此範例將說明重覆定義一隨機檔緩衝區的分配情形:
  * 在第一個 FIELD 敘述中,將佔 67 個位元組的緩衝區分配給五個不同
    的變數 name, address, city, state, 和 zip code。
  * 第二個 FIELD 敘述中,將上述相同大小的緩衝區,全部分配給一個變數,
    Plist$。

此範例的其他部分檢查 Zip$ 是否包含郵遞區號(zip code),而且是否落在某一特定
範圍中。若是如此,則整個地址字串將被印出。

' FIELD 敘述範例程式
TYPE Buffer
   FuName AS STRING * 25
   Addr   AS STRING * 25
   City   AS STRING * 10
   State  AS STRING * 2
   Zip    AS STRING * 5
END TYPE
DIM RecBuffer AS Buffer
'*******************************************************************
' 注意: 此部分程式建立一隨機檔,以便在下面程式中供 FIELD 敘述應用。
'*******************************************************************
OPEN "MAILLIST.DAT" FOR RANDOM AS #1 LEN = LEN(RecBuffer)
CLS
RESTORE
READ FuName$, Addr$, City$, State$, Zip$
I = 0
DO WHILE UCASE$(FuName$) &lt;&gt; "END"
   I = I + 1
   RecBuffer.FuName = FuName$
   RecBuffer.Addr = Addr$
   RecBuffer.City = City$
   RecBuffer.State = State$
   RecBuffer.Zip = Zip$
   PUT #1, I, RecBuffer
   READ FuName$, Addr$, City$, State$, Zip$
   IF FuName$ = "END" THEN EXIT DO
LOOP
CLOSE #1
'
   DATA "Bob Hartzell","1200 Liberty St.","Bow","WA","98232"
   DATA "Alice Provan","123 B St.","Bellevue","WA","98005"
   DATA "Alex Landow","14900 123rd","Bothell","WA","98011"
   DATA "Walt Riley","33 Minnow Lake Road","Lyman","WA","98263"
   DATA "Georgette Gump","400 15th W.","Bellevue","WA","98007"
   DATA "END",0,0,0,0,0
'****************************************
'此部分程式說明 FIELD 敘述之使用法。
'****************************************
' 將所有欄位及記錄的長度以符號常數來定義欄位和記錄的長度
CONST FU = 25, AD = 25, CT = 10, ST = 2, ZP = 5
CONST RECLEN = FU + AD + CT + ST + ZP
'
OPEN "MAILLIST.DAT" FOR RANDOM AS #1 LEN = RECLEN
FIELD #1, FU AS FuName$, AD AS Addr$, CT AS City$, ST AS State$, ZP AS Zip$
FIELD #1, RECLEN AS Plist$

GET #1, 1
' 由檔案中讀取資料,並尋找出介於 98000 到 98015 之間的郵遞區域號碼
DO WHILE NOT EOF(1)
   Zcheck$ = Zip$
   IF (Zcheck$ &gt;= "98000" AND Zcheck$ &lt;= "98015") THEN
      Info$ = Plist$
      PRINT LEFT$(Info$, 25)
      PRINT MID$(Info$, 26, 25)
      PRINT RIGHT$(Info$, 17)
      PRINT
   END IF
   GET #1
LOOP
CLOSE #1


<hr>

<span id="L80D5" class="QBtitle">FILEATTR 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8052"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FILEATTR 函數細節</span>

<span class="QH_1">語法</span>
  FILEATTR(檔案代碼, 屬性)

  <span class="QH_1">參數         說明</span>
  檔案代碼     表示一個已開啟檔案的代號。它必須與 OPEN 敘述所開啟的檔案
               代碼相同,亦可使用一數值運算式,只要它所計算出來的值能符合
               所開啟的檔案代碼。

  屬性         此參數表示傳回訊息的型態。當屬性參數設為 1 時, FILEATTR 會傳回
               檔案模式所代表的代碼(如下表所示)。當屬性參數設為 2 時,FILEATTR
               會傳回在 DOS 檔案控制下的檔案控制代號(File Handle)。

下表列出當屬性參數為 1 時,會傳回各種檔案模式(File Modes)所代表的數值。

<span class="QH_1">傳回值         檔案模式</span>
   1             INPUT
   2             OUTPUT
   4             RANDOM
   8             APPEND
  32             BINARY


<hr>

<span id="L80D6" class="QBtitle">FILEATTR 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8052"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FILEATTR 函數程式範例</span>

以下範例將開啟兩個檔案,並且列印由 FILEATTR 所傳回的 DOS 檔案控制代碼,及
檔案模式:

OPEN "tempfile.dat" FOR APPEND AS #1
OPEN "tempfl2.dat" FOR RANDOM AS #2
PRINT "檔案代碼 DOS控制 檔案模式"
PRINT TAB(2);1;TAB(11);FILEATTR(1,2);TAB(19);FILEATTR(1,1)
PRINT TAB(2);2;TAB(11);FILEATTR(2,2);TAB(19);FILEATTR(2,1)
END

<span class="QH_1">範例輸出</span>

檔案代碼 DOS控制 檔案模式
  1        5       8
  2        6       4



<hr>

<span id="L80D7" class="QBtitle">FILES 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8053"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FILES 敘述細節</span>

<span class="QH_1">語法</span>
  FILES [檔案名稱]

其中,檔案名稱參數為一字串變數或字串常數,它包含一個可選擇性的裝置(device)
名稱,和一個檔案名稱或路徑名稱。

若您省略檔案名稱參數,則 FILES 敘述會顯示目前目錄下所有的檔案名稱。您也可使用
DOS 下 DIR 命令所使用的萬用字元如:問號(?)或星號(*)來查詢。其中,問號(?)可以置
於主檔名(基本檔名)或延伸檔名中,但是一個問號只能取代檔名中的一個字元,而一個
星號(*)卻可取代主檔名及延伸檔名中的一個或多個字元。

若使用一個沒有指定路徑名稱的檔案名稱,則是以目前目錄下的路徑名稱為預設值。

注意 : 若省略路徑名稱,則 FILES 通常以目前目錄來作列印。


<hr>

<span id="L80D8" class="QBtitle">FILES 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8053"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FILES 敘述程式範例</span>

下列說明 FILES 敘述的使用範例。

                    <span class="QH_1">--------------- 注意 ---------------</span>
  執行下列例題時,若 B 磁碟中沒有磁片,或是找不到所指定的檔案名稱,均無法執行。
                    <span class="QH_1">------------------------------------</span>

FILES              '顯示目前目錄中,所有檔案名稱
FILES "*.BAS"      '顯示目前目錄中,延伸檔名為 .BAS 的所有檔案名稱
FILES "B:*.*"      '顯示 B 磁碟中,所有檔案名稱
FILES "B:"         '顯示 B 磁碟中,所有檔案名稱
FILES "TEST?.BAS"  '顯示目前目錄中,主檔名有 5 個字元,且前
                   '4 個字元為 "TEST",延伸檔名為 .BAS 的所有檔案名稱
FILES "\SALES"     '若 SALES 為一目錄,則此敘述即為顯示在
                   'SALES 目錄下的所有檔案名稱。若 SALES 為一個在
                   '目前目錄中的檔案,則此敘述會顯示 SALES 檔名。


<hr>

<span id="L80D9" class="QBtitle">FIX 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8054"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80DA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FIX 函數細節</span>

<span class="QH_1">語法</span>
  FIX(數值運算式)

若 x 為一數值運算式,則 FIX(x) 敘述相當於 SGN(x)*INT(ABS(x))。

FIX 與 INT 的差別在 x 為負數時, FIX 函數取大於或等於 x 的整數,而 INT 函數
取小於或等於 x 的整數。

<span class="QH_1">可參閱</span> INT 函數<span class="QH_2">&lt;</span><a href="#L80FC">範例</a><span class="QH_2">&gt;</span>,有對這些函數(CINT, FIX, INT)之差異加以說明。


<hr>

<span id="L80DA" class="QBtitle">FIX 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8054"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80D9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FIX 函數程式範例</span>

下列敘述將說明 INT 與 FIX 之差異:

CLS    ' 清螢幕
PRINT INT(-99.8)
PRINT FIX(-99.8)
PRINT INT(-99.2)
PRINT FIX(-99.2)

<span class="QH_1">輸出</span>

-100
-99
-100
-99


<hr>

<span id="L80DB" class="QBtitle">FOR...NEXT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8055"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80DC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FOR...NEXT 敘述細節</span>

<span class="QH_1">語法</span>
  FOR 計數器 = 初值 TO 終值 [STEP 增值]
    [ 敘述區段 ]
  NEXT [計數器 [,計數器...]]

  <span class="QH_1">參數        說明</span>
  計數器      此參數用來做為迴圈計數器的數值變數,不能以陣列元素
              或記錄元素來做為變數。

  初值        為計數變數的起始值。

  終值        為計數變數的終值。

  增值        為 LOOP 迴圈每執行一次,計數變數所增加的值,若省略 STEP,
              則預設值為 1。

一個 FOR...NEXT 迴圈中之計數變數的初值參數與終值參數必須與增值參數配合
, 意即 : 若終值大於初值,則增值必為正數;若終值小於初值,則增值必為負數。
在程式執行時會先檢查 "(終值 - 初值)的正負符號 " 與 "增值參數的正負號"
是否相同,便可知道 FOR...NEXT 敘述能否被執行。若為同號,則可進入 FOR...NEXT
迴圈中,否則便跳過此迴圈,而不予執行。

在 FOR...NEXT 迴圈中,自 FOR 下面的敘述區段開始執行一直碰到 NEXT 敘述。
然後計數器變數會依據 STEP 所指定的增量而有所變化,並隨時與終值比較,
以決定何時應離開此迴圈。

若計數器參數的變數值小於或等於終值,則會一再重覆執行 FOR 下面的敘述區段,
直到計數器的值大於終值,才跳出此迴圈,繼續執行 NEXT 後面的敘述(若 STEP 所
指定的增量為負,則迴圈會重覆被執行,直到計數器值小於終值,才跳出此迴圈)。

若初值與終值相等,不論 STEP 所指定的值為何,迴圈只執行一次便跳離。若 STEP
所給定的值為 0,則迴圈將重覆無限地執行。

應避免在迴圈中改變計數器參數的值。改變迴圈中計數參數的值是一種差勁的程式
演練,這將會使得程式的可讀性降低,並且難以偵錯。

也可使用巢狀(nested)式的 FOR...NEXT 迴圈,即 : 將一個 FOR...NEXT 迴圈置於
另一個 FOR...NEXT 迴圈中。 為了確使巢狀式迴圈執行得當,則在每一層迴圈中,
只能給予唯一的計數變數名稱,不可重覆。外層迴圈的 NEXT 敘述必須接在內層迴圈
的 NEXT 敘述之後。下列就是正確的巢狀式迴圈結構:

  FOR I = 1 TO 10
     FOR J = 1 TO 10
        FOR K = 1 TO 10
        .
        .
        .
        NEXT K
     NEXT J
  NEXT I

一個 NEXT 敘述如下:

  NEXT K, J, I

相當於以下三列敘述:

  NEXT K
  NEXT J
  NEXT I

EXIT FOR 敘述為另外一種方便的敘述,用來由 FOR...NEXT 迴圈內中途離開。
請參閱 EXIT FOR 敘述說明。

  注意: 若省略緊接在 NEXT 敘述後之變數,則此 NEXT 敘述會與最近的一個
        FOR 敘述相配合。若將 NEXT 敘述置於 FOR 敘述之前,則會產生一個
        "NEXT 敘述沒有 FOR 敘述" 錯誤訊息,表示沒有相對應的 FOR 存在,
        此屬性的值為 1。

<span class="QH_1">與 BASICA 的差異</span>

QuickBASIC 程式在 FOR...NEXT 迴圈中提供倍精確度數值的控制變數(如:初值,終值,
及計數器參數),然而,若所提供的控制參數值是整數範圍,那麼就使用整數控制,以加快
速度。


<hr>

<span id="L80DC" class="QBtitle">FOR...NEXT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8055"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80DB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FOR...NEXT 敘述程式範例</span>

此範例將列印出帕斯卡(pascal)三角形的前 11 行(column):

'列印出帕斯卡三角形的前 11 行(column),其中每一個數都是由它的前一行(column)
'相鄰的兩數相加所得,再將相加所得的數目立刻放在游標下一行的前一列(row)上

CLS                         ' 清螢幕
CONST MAXCOL=11
DIM A(MAXCOL,MAXCOL)
FOR M = 1 TO MAXCOL
    A(M,1) = 1 : A(M,M) = 1 '每個一維陣列 A 的第一個及最後一個
                            '元素值均設為 1
NEXT
FOR M = 3 TO MAXCOL
   FOR N = 2 TO M-1
      A(M,N) = A(M-1,N-1) + A(M-1,N)
   NEXT
NEXT
Startrow = 13                '跳到螢幕的中央
FOR M = 1 TO MAXCOL
   Col = 6 * M
   Row = Startrow
   FOR N = 1 TO M
      LOCATE Row,Col : PRINT A(M,N)
      Row = Row + 2          '往下跳二列,列印下一個數值
   NEXT
   PRINT
   Startrow = Startrow - 1   '將下一行由 "1" 開始,把 "1" 放在游標下一行的
NEXT                         '前一列上

<span class="QH_1">輸出</span>

                                                  1
                                             1
                                        1         10
                                   1         9
                              1         8         45
                         1         7         36
                    1         6         28        120
               1         5         21        84
          1         4         15        56        210
     1         3         10        35        126
1         2         6         20        70        252
     1         3         10        35        126
          1         4         15        56        210
               1         5         21        84
                    1         6         28        120
                         1         7         36
                              1         8         45
                                   1         9
                                        1         10
                                             1
                                                  1


<hr>

<span id="L80DD" class="QBtitle">FRE 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8056"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80DE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FRE 函數細節</span>

<span class="QH_1">語法</span>
  FRE(字串運算式)
  FRE(數值運算式)

當 FRE 函數中使用數值參數時,所傳回的值如下所示:

  <span class="QH_1">參數            傳回值</span>
  -1              以位元組為單位,傳回能提供給非字串(數值)陣列宣告的最大
                  可用記憶體空間數目。

  -2              以位元組為單位,傳回一個還未被使用的堆疊(stack)空間數目。

  任意其他數值    能提供給下一個字串資料儲存的可用區段空間大小
                  (free block size)。

當此參數為一字串運算式時, FRE 傳回以位元組為單位的可用字串儲存空間大小。
在 FRE 函數傳回可用的位元組數目之前,會先將可用的字串空間壓縮成單一區段
(single block)。

  注意: FRE(-2) 只在程式執行時,才會傳回有意義的值。當此函數是由立即視窗
        或追蹤程式,或觀察變數時, FRE(-2) 函數所傳回的值是不正確。


<hr>

<span id="L80DE" class="QBtitle">FRE 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8056"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80DD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FRE 函數程式範例</span>

以下的範例即為 FRE 函數在陣列宣告前後所傳回的值。

' $DYNAMIC
CLS                 ' 清螢幕
PRINT "陣列宣告之前:   " FRE(""),FRE(0),FRE(-1)
DIM LARGE%(150,150), BIG$(5000)
PRINT "陣列宣告之後:   " FRE(""),FRE(0),FRE(-1)

<span class="QH_1">範例輸出</span>

以下 FRE 所傳回真正的數值可能有所差異。

陣列宣告之前:   58420     58420     322120
陣列宣告之後:   38404     38404     276496


<hr>

<span id="L80DF" class="QBtitle">FREEFILE 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8057"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FREEFILE 函數細節</span>

<span class="QH_1">語法</span>
  FREEFILE

FREEFILE 函數會傳回下一個正確,但尚未被使用的檔案代碼。

此函數可避免使用到在 SUB 或 FUNCTION 程序式中已使用過的檔案代碼。


<hr>

<span id="L80E0" class="QBtitle">FREEFILE 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8057"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80DF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FREEFILE 函數程式範例</span>

以下的範例即使用 FREEFILE 函數,來傳回一檔案代碼給已開啟的檔案:

INPUT "請輸入檔案名稱: ", Filename$
Filenum = FREEFILE
OPEN Filename$ FOR OUTPUT AS Filenum
PRINT Filename$;" 檔案代碼是 #"; Filenum

<span class="QH_1">範例輸出</span>

請輸入檔案名稱: DATA.DAT

DATA.DAT 檔案代碼是 #1


<hr>

<span id="L80E1" class="QBtitle">FUNCTION...END FUNCTION 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8058"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FUNCTION...END FUNCTION 敘述細節</span>

<span class="QH_1">語法</span>
  FUNCTION 名稱[(參數串列)] [STATIC]
      [ 敘述區段 ]
    名稱 = 運算式
      [ 敘述區段 ]
  END FUNCTION

<span class="QH_1">參數              說明</span>
  名稱            此參數表示一函數名稱。FUNCTION 名稱與 BASIC 中的變數名稱
                  命名方式相同,它可以包含型態宣告字元(如 %, &, !, #, 或 $)。
                  注意,此函數名稱的資料型態將決定此函數運算後所傳回值的資料
                  型態。例如:若要傳回一個字串,則必須在名稱後面加上一個 "$"
                  符號,或是給它一個用 DEFSTR 敘述所定義的字串名稱。


參數串列          此為一變數串列,中間須用逗號(",")分開,用來將參數串列傳給
                  FUNCTION。參數是以傳址方式來傳遞,意即:若在此函數內的參數
                  一經改變,則在呼叫程式(calling program)內所對應的變數值也
                  隨之改變。


  STATIC          表示函數中的區域變數在返回呼叫程式時,會將參數的值
                  保留,當下次再呼叫此函數時,便以所保留的值來執行。
                  若無 STATIC 屬性,則每次呼叫函數時,變數值將會重新被設定。
                  意即 : 由函數返回呼叫程式時,這些變數會被釋放,STATIC 屬性
                  並不會影響到一個在 FUNCTION 中所使用的變數--這些變數是在
                  FUNCTION 外面,由 DIM 或使用 SHARED 屬性的 COMMON 敘述
                  所宣告的。


  運算式          為函數的傳回值,一個 FUNCTION 透過等號("=")將運算所得到的
                  結果指定給函數名稱。若沒有將值指定給 FUNCTION 的函數名稱,
                  則傳回一個預設值: 若為數值型態函數則傳回零,若為字串型態
                  函數則傳回空字串("")。



    其中參數串列也可用下列語法來表示:

  變數[()] [AS 型態][, 變數[()] [AS 型態]]
  　
一個變數參數是任意合法的 BASIC 變數。其型態可以是整數或長整數,單精確度
或倍精確度,字串,或一個使用者自定型態。

若為陣列型態,在早期的 BASIC 版本,則需在陣列名稱後面跟著一對括號,在括號中
須加上維度(dimension)大小,在 QuickBASIC 下不需要寫上維度的大小。只有當所
表示的參數是一個陣列時,才需要加上一對括號。例如,以下的敘述即為 KEYWORDS$
及 KEYWORDS TYPES 兩陣列型態的表示:

FUNCTION ParseLine(Keywords$(),KeywordTypes())

一個 FUNCTION 程序式和 SUB 程序式一樣 : 它能夠接受參數,執行一系列的敘述
,並將這些參數的值加以改變。它不像一個 SUB 程序式,而一個 FUNCTION 程序式
如同 BASIC 內建(instrinsic)函數一樣,可以被使用在一個運算式中。

如同 SUB 程序式一樣,FUNCTION 程序式也可使用區域變數。任何不屬於參數串列上
的變數即為區域變數,除非於 FUNCTION 中以 SHARED 敘述所宣告成為一個共同的變數,
或者此變數是用 DIM 或 COMMON 敘述宣告且具有 SHARED 的屬性 。

自函數傳回一個值,且指定一個值給此函數名稱。例如: 在一個 BinarySearch 函數
中,可指定一常數 FALSE 的值來表示指定的值沒有找到:

  FUNCTION BinarySearch(...)
  CONST FALSE=0
  .
  .
  .

  ' 指定值找不到,傳回 FALSE 值(為 0)

     IF Lower &gt; Upper THEN
        BinarySearch = FALSE
        EXIT FUNCTION
     END IF
  .
  .
  .
  END FUNCTION

使用 STATIC 關鍵字會稍微增加程式執行的速度, STATIC 通常是不使用在遞迴
(recursion)的 FUNCTION 程序式中。
EXIT FUNCTION 敘述提供一個離開 FUNCTION 程序式的選擇。可參閱 EXIT 敘述。

因為 BASIC 可重新分配數學運算式,使程式達到更高的效率,須避免在數學運算式中
使用 FUNCTION 程序式來更改程式的變數。同時也要避免在執行輸入/輸出時,使用
FUNCTION 程序式。

QuickBASIC FUNCTION 程序式可形成遞迴呼叫,即:在執行的過程中可呼叫自己本身
而形成一個循環。請參見下面第二個範例。


<hr>

<span id="L80E2" class="QBtitle">FUNCTION...END FUNCTION 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8058"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">FUNCTION...END FUNCTION 敘述程式範例</span>

FUNC_EX.BAS 為在子目錄 ADVR_EX 中的程式檔,主要說明 FUNCTION 敘述的使用。
可使用 [F/檔案]功能表中的 "O/載入程式" 命令載入程式,並可執行它。

此程式即使用遞迴(recursion)函數(函數本身呼叫本身)來算出一字串的長度。


<hr>

<span id="L80E3" class="QBtitle">GET(檔案輸出/輸入) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8059"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GET(檔案輸入/輸出) 敘述細節</span>

<span class="QH_1">語法</span>
  GET [#]檔案代碼 [,[記錄代碼] [,變數]]

  <span class="QH_1">參數           說明</span>
  檔案代碼       此參數與 OPEN 敘述中所開啟的檔案代碼相同。

  記錄代碼       此參數表示將從隨機檔中讀出的資料記錄編號,或表示將讀出
                 二進位檔中資料的位元組起始位置。在一個檔案中第一個記錄
                 或是資料位元組的起始位置,其值皆為1。若省略記錄代碼,則
                 下一筆記錄或下一個資料位元組(即:最後一次 GET 或 PUT 的
                 下一筆,或最後一次 SEEK 的那一筆)將被讀入緩衝區中。
                 其最大容許的記錄號碼是 2^31 -1, 或 2,147,483,647。

  變數           此變數用來接受由檔案所讀出的資料。若您使用一個變數參數時,
                 便不需要使用 CVD, CVL, CVI, 或 CVS 來將記錄欄位轉為數值型態。
                 若您有使用此變數參數時,可以不必對所開啟的檔案使用 FIELD 敘述
                 來定義記錄欄位的大小。

                 在隨機檔中,可以使用任何變數參數,只要此變數的長度小於
                 或等於隨機檔中每一筆記錄的長度即可。一般而言,一個記錄
                 變數的定義都會與資料記錄中的欄位名稱相配合。

                 對於二進位檔而言,也可使用任何變數參數,此時 GET 敘述
                 便會依照變數的長度由二進位檔中讀出資料。

                 當您使用一個變動長度的字串變數,那麼 GET 敘述會讀出與
                 該字串變數所定義的長度的資料數目。以下的兩行敘述就是
                 自檔案代碼為 1 的檔案中,讀出 10 個位元組長度的字元。

                 VarStrings$=STRING$ (10, " ")
                 GET #1,,VarString$

                 請參閱下列範例,可以使您在隨機檔中更熟悉變數參數的運用。
                 注意,一個記錄的長度不可超過 32,767 個位元組。


亦可省略記錄代碼,或變數參數之一,或兩者均省略,若只有省略記錄代碼參數
而不省略變數參數時,您仍然要用逗號將省略的參數保留:

  GET #4,,FileBuffer

若省略此兩參數,則可以不使用逗號:

  GET #4

GET 和 PUT 敘述均允許對 BASIC 通訊檔案做固定長度的輸入和輸出。在使用
GET 敘述時,要注意若有一個通訊上的失敗, GET 將會無限期的等待記錄號碼字元。

  注意: 當使用 GET 配合 FIELD 敘述時,可以在 GET 敘述後面加上 INPUT #,
        來控制自一隨機檔緩衝區中讀取字元資料。亦可在 GET 敘述後加上
        EOF 函數,用來測試檔案指標是否已指到檔案的末端。


<hr>

<span id="L80E4" class="QBtitle">GET(檔案輸入/輸出) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8059"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GET(檔案輸入/輸出) 敘述程式範例</span>

以下程式開啟一個 TESTDAT2.DAT 隨機檔,並將其內容顯示在螢幕上:

' 讀出並顯示一個檔案中的內容,其記錄欄位包括一個佔 20 個字元的名稱,
' 及一個測驗分數。
'
' 定義記錄欄位
TYPE TestRecord
   NameField  AS STRING * 20
   ScoreField AS SINGLE
END TYPE
' 定義一個使用者自定型態變數
DIM Rec AS TestRecord
'**************************************************************
' 此部份程式插入一個建立隨機檔的函數,以供下面第二部份程式使用。
'**************************************************************
OPEN "TESTDAT2.DAT" FOR RANDOM AS #1 LEN = LEN(Rec)
CLS
RESTORE
READ NameField$, ScoreField
I = 0
DO WHILE UCASE$(NameField$) &lt;&gt; "END"
   I = I + 1
   Rec.NameField = NameField$
   Rec.ScoreField = ScoreField
   PUT #1, I, Rec
   READ NameField$, ScoreField
   IF NameField$ = "END" THEN EXIT DO
LOOP
CLOSE #1
'
   DATA "John Simmons", 100
   DATA "Allie Simpson", 95
   DATA "Tom Tucker", 72
   DATA "Walt Wagner", 90
   DATA "Mel Zucker", 92
   DATA "END", 0

'  開啟一個測驗成績的資料檔
'
DIM FileBuffer AS TestRecord
OPEN "TESTDAT2.DAT" FOR RANDOM AS #1 LEN=LEN(FileBuffer)
'  計算此資料檔中的記錄總數
Max = LOF(1) / LEN(FileBuffer)
'  讀出並且列印所有記錄的內容
FOR I = 1 TO Max
   GET #1, I, FileBuffer
   PRINT FileBuffer.NameField, FileBuffer.ScoreField
NEXT I
CLOSE #1
END



<hr>

<span id="L80E5" class="QBtitle">GET(繪圖) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8040"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GET(繪圖) 敘述細節</span>

<span class="QH_1">語法</span>
  GET [STEP] (x1,y1)-[STEP] (x2,y2), 陣列名稱[(索引)]

  <span class="QH_1">參數          敘述</span>
  x1,y1,x2,y2   表示在螢幕上將被截取(讀取)的矩形區塊座標。
                x1, y1, x2, 和 y2 為一數值運算式,用來表示此矩形對角線
                兩頂點的座標。

  STEP          為一關鍵字,表示相對於最近一個圖素(pixel)的相對座標。
                例如,若一個圖素座標為 (10,10),而 STEP 參數的相對座標
                為 (5,10)時,則實際座標是 (5+10,10+10), 或 (15,20)。
                若在 GET 敘述中,第二對座標之前加上 STEP 參數,即為
                相對於第一對座標的相對座標。

  陣列名稱      此參數是一個儲存影像的陣列名稱,它必須是數值陣列,且所宣告
                的大小必須足夠存放整個影像。

  索引          可為數值常數或變數,它代表在陣列中儲存影像的起始位置。


GET 敘述可將螢幕上的影像,轉換存放到一個指定陣列中, PUT 敘述則是將 GET 所
儲存在陣列中的影像資料,重新顯示在螢幕上。

下列的公式是用來計算所需儲存影像的陣列空間大小(以 "位元組" 為單位):

  4 + INT(((x2 - x1 + 1) * (bits-per-pixel-per-plane) + 7)/8)
                         * planes * ((y2 - y1) + 1)

每一平面中每一圖素所需的位元數(bits-per-pixel-per-plane)及平面數(planes)
的值,它們是與由 SCREEN 敘述所設定螢幕模式有關。下表列出不同的螢幕模式下
每一平面中每一圖素所需的位元數和平面數。

  <span class="QH_1">每一平面中每一圖素所需的位元數及平面數</span>

  <span class="QH_1">          每一平面中的一個</span>
  <span class="QH_1">螢幕模式  圖素所需的位元數    平面數</span>

  71 (MGA)        1                1
  80 (EGA)        1                4
  82 (VGA)        1                4


在一個陣列中,每一個元素所佔的位元組數如下:

  * 一個整數型態的陣列元素佔 2 個 位元組長度。
  * 一個長整數型態的陣列元素佔 4 個位元組長度。
  * 一個單精確度數值型態的陣列元素佔 4 個位元組長度。
  * 一個倍精確度數值型態的陣列元素佔 8 個位元組長度。

例如: 要在一個 MGA 螢幕模式(SCREEN 71)下,使用 GET 敘述儲存影像,若被截取
的矩形影像左上角座標為(0,0),右下角的座標為 (32,32) 則所需陣列的大小,以
位元組為單位來計算是 : 4 + INT((33 * 1 + 7)/8) * 1 * (33), 或 169。
也就是說,若此陣列為整數型態,則需 85 個陣列元素才足夠用來儲存影像。

若此陣列不是整數或長整數陣列,由於在執行 GET 時會直接先被檢查,使得陣列的
內容沒有意義。查驗或處理非整數型態的圖形影像陣列時,會引起執行期間(run-time)
的錯誤。

GET 和 PUT 相配合可應用在動畫上,更可充分地發揮它們的功能。


<hr>

<span id="L80E6" class="QBtitle">GET(繪圖) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8040"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

 請參閱 BSAVE 程式範例


<hr>

<span id="L80E7" class="QBtitle">GOSUB...RETURN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>  <span class="QH_2">&lt;</span><a href="#L80E8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GOSUB...RETURN 敘述細節</span>

<span class="QH_1">語法</span>
  GOSUB {行標記1 | 行號1}
  [ 敘述區段 ]
  RETURN [行標記2 | 行號2]

  <span class="QH_1">參數             說明</span>
  行標記1, 行號1   此參數可為一個行號或是行標記,為次常式(subroutine)的
                   第一行。

  行標記2, 行號2   此為一個行標記或行號,為次常式將返回的地方。


  注意: QuickBASIC 中的 SUB 以及 FUNCTION 程序式對 GOSUB...RETURN 次常式提供
        一個較具結構化的方式。

除了一般的 RETURN 不含參數外, QuickBASIC 在 RETURN 敘述後面可緊接行標記或
行號,它允許一個返回的動作, 即: 由一個次常式返回到所指定的行標記或行號敘述
上,代替以往只能返回到 GOSUB 敘述的下一個敘述。但使用此種返回的行指定型態時,
應小心使用。

您可以在一個程式中不受限制地呼叫次常式,也可以從另一個次常式中再呼叫次常式。
巢狀(nested)次常式的深度僅受限於可用的堆疊(stack)空間,(您可以用 CLEAR 敘述
增加堆疊的空間 )。次常式可以呼叫自己本身(遞迴(recursion)次常式),但容易造成
堆疊空間不足。具有行標記或行號的 RETURN 敘述,僅能將控制權傳回到模組層次碼中
的一個敘述,而無法回到程序式層次碼中的敘述。請參閱下面的範例程式。

一個次常式可以包含超過一個以上的 RETURN 敘述。在次常式中簡單的 RETURN 敘述
(不需要行號 2,行標記 2 的選擇項)使得 QuickBASIC 會回到最近一個 GOSUB 敘述
的下一個敘述上。

次常式可以出現在程式中的任何地方,但是好的程式技巧是使得次常式很容易地與
主程式區分開來。為了避免疏忽而進入次常式,在次常式之前可以使用 STOP, END
或 GOTO 敘述來引導程式控制流程。

                 <span class="QH_1">---------   重點    ---------</span>
 此處所討論 "次常式" 的應用僅針對 GOSUB 敘述的用法而言,並不是由 SUB 敘述
 所定義的副程式。同時也不提供使用 GOSUB...RETURN 敘述來進入或離開 SUB 的
 程序式區段。
                 <span class="QH_1">------------------------------</span>


<hr>

<span id="L80E8" class="QBtitle">GOSUB...RETURN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GOSUB...RETURN 敘述程式範例</span>

此範例顯示含有行標記 RETURN 敘述的正確使用方法。

CLS                              ' 清除螢幕
PRINT "在模組層次碼中"
GOSUB Sub1
PRINT "此行在主常式中應該被跳過"
Label1:
   PRINT "回到模組層次碼中"
   END

Sub1:
   PRINT "在次常式 1 中"
   GOSUB Sub2
   PRINT "此行在次常式 1 中應該被跳過"
Label2:
   PRINT "回到次常式 1 中"
   RETURN Label1

Sub2:
   PRINT "在次常式 2 中"
   RETURN Label2   '無法由此處回到主程式 - 僅能回到 SUB1

<span class="QH_1">範例輸出</span>

在模組層次碼中
在次常式 1 中
在次常式 2 中
回到次常式 1 中
回到模組層次碼中


<hr>

<span id="L80E9" class="QBtitle">GOTO 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80EA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GOTO 敘述細節</span>

<span class="QH_1">語法</span>
  GOTO {行標記 | 行號}

GOTO 敘述提供一種無條件分歧到程式中任何一行(行標記或行號)的方法。但僅能分歧
到程式中具有相同層次的其它敘述上。同時您也不能使用 GOTO 敘述來進入,或離開
SUB, FUNCTION 或多行(區段)式 DEF FN 函數。然而,您能夠在任何一個程式架構中,
使用 GOTO 敘述來控制程式的流程。

好的程式技術是使用結構化的控制敘述(DO...LOOP, FOR, IF..THEN...ELSE,
SELECT CASE) 來代替 GOTO 敘述,因為程式中有太多 GOTO 敘述是不容易閱讀
和偵錯的。



<hr>

<span id="L80EA" class="QBtitle">GOTO 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80E9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">GOTO 敘述程式範例</span>

此範例用來計算所輸入的半徑值之圓形面積。

CLS      ' 清除螢幕
PRINT "輸入 0 則結束"
Start:
   INPUT R
   IF R = 0 THEN
     END
   ELSE
      A = 3.14 * R ^ 2
      PRINT "面積 ="; A
   END IF
GOTO Start

<span class="QH_1">範例輸出</span>

輸入 0 則結束
? 5
面積 = 78.5
? 0


<hr>

<span id="L80EB" class="QBtitle">HEX$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80EC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">HEX$ 函數細節</span>

<span class="QH_1">語法</span>
  HEX$(運算式)

將運算式參數四捨五入成整數;或者,若運算式超過整數範圍,則會在使用 HEX$ 函數
之前先轉成長整數。


<hr>

<span id="L80EC" class="QBtitle">HEX$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80EB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">HEX$ 函數程式範例</span>

此範例用來將所輸入的十進制值轉成十六進制值。

CLS          ' 清除螢幕
INPUT X
A$ = HEX$(X)
PRINT X; "為十進制"; "而 "; A$; " 為其十六進制"

<span class="QH_1">範例輸出</span>

? 32
 32 為十進制而 20 為其十六進制


<hr>

<span id="L80ED" class="QBtitle">IF...THEN...ELSE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80EE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">區段 IF...THEN...ELSE 細節</span>

<span class="QH_1">語法</span>
  IF 布林運算式 1 THEN
     [ 敘述區段-1 ]
  [ELSEIF 布林運算式 2 THEN
     [ 敘述區段-2 ]
  . . .
  [ELSE
     [ 敘述區段-n ]]
  END IF

  <span class="QH_1">參數                             說明</span>
  布林運算式 1, 布林運算式 2       可為任何的運算式,來求出
                                   真值(不為零)或假值(為零)。

  敘述區段-1, 敘述區段-2           表示在一行或一行以上的
  敘述區段-n                       程式行中,可包括一個或
                                   多個的 BASIC 敘述。

在執行 IF 區段格式中, QuickBASIC 先測試布林(Boolean)運算式(布林運算式 1),若
布林運算式為真值(不為零)則執行跟在 THEN 後面的敘述。假如第一個布林運算式為
假(零), QuickBASIC 輪流計算每一個 ELSEIF 的條件是否成立。當 QucikBASIC 找到
為真的條件時,則執行所對應 THEN 後面的敘述。若沒有 ELSEIF 條件為真時,則執行
ELSE 後面的敘述。在 THEN 或 ELSE 後面的敘述被執行之後,程式將繼續執行 END IF
後面的敘述。

ELSE 和 ELSEIF 區段都是可選擇項。在 IF 區段中, ELSEIF 子句的數目可由使用者
視需要而決定。而且任何的敘述區段可包含巢狀(nested)區段的 IF 敘述。

QuickBASIC 查看 THEN 後面的關鍵字來決定 IF 敘述是否為 IF 區段。假如 THEN 後面
除了註解(comment)外有其他敘述,則此敘述視為單行 IF 敘述。

區段 IF 敘述必須是該行上的第一個敘述。對於 ELSE, ELSEIF, 和 END IF 這些部份
敘述可有行號或行標記在其前面。而區段必須以 END IF 敘述為結尾。

IF...THEN 命令的區段格式比單行格式有較多的優點如下:

  * 區段格式提供較單行格式更具結構化及彈性化的方式,允許有條件分歧到許多行。
  * 使用區段格式,可以測試較複雜的條件。
  * 區段格式可使用較長的敘述和結構。
  * 區段格式允許您的程式結構為邏輯導向,而不是將多個敘述放在同一命令行中。
  * 程式中使用區段格式的 IF...THEN...ELSE 通常較易閱讀,維護和偵錯。


<span class="QH_1">單行 IF...THEN...ELSE</span>

<span class="QH_1">語法</span>
  IF 布林運算式 THEN 為真的部份 [ELSE 為假的部份]

當僅做單一動作時,單行格式的敘述是最適合於做最簡短且直接的測試。

下列部份描述單行格式的用法:

  <span class="QH_1">參數                     說明</span>
  布林運算式               可為任何運算式,其運算結果為真(不為零)或假(為零)。

 為真的部份,為假的部份     當布林運算式為真則執行為真的部份;若為假則執行
                           為假的部份。
                           二個部份皆有相同的語法,其說明如下：　　　　　　　　

為真的部份 和 為假的部份 皆有下列語法:

  { 敘述 | [GOTO] 行號 | GOTO 行標記 }


下列說明 為真的部份 和 為假的部份 的語法:

  <span class="QH_1">參數         說明</span>
  敘述         一個或多個用冒號分開的 BASIC 敘述。

  行號         一個有效的 BASIC 程式行號(line number)。

  行標記       一個有效的 BASIC 行標記(line label)。

注意: GOTO 敘述可以選擇使用行號,但最好使用行標記。

假如布林運算式為真,則為真的部份將被執行;若布林運算式為假,則為假的部份
將被執行;假如沒有使用 ELSE 子句,控制權將傳遞到程式中的下一個敘述。

您可以在一個條件中允許使用多個敘述,但這些敘述必須在相同命令行上,且須用冒號
分開 :

  IF A &gt; 10 THEN A = A + 1: B = B + A: LOCATE 10,22: PRINT B,A


<hr>

<span id="L80EE" class="QBtitle">IF...THEN...ELSE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80ED"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">IF...THEN...ELSE 敘述程式範例</span>

這些範例顯示單行和區段 IF...THEN...ELSE 敘述的用法。

單行格式:

CLS    ' 清除螢幕
DO
   INPUT "輸入一個大於 0 且小於 10,000 的數字:", X
   IF X &gt;= 0 AND X &lt; 10000 THEN EXIT DO ELSE PRINT X; "超出範圍"
LOOP
IF X&lt;10 THEN Y=1 ELSE IF X&lt;100 THEN Y=2 ELSE IF X&lt;1000 THEN Y=3 ELSE Y=4
PRINT "數字有"; Y; "位"


底下是區段格式,程式易於閱讀且功能更強:

CLS    ' 清除螢幕
DO
   INPUT "輸入一個大於 0 且小於 100,000 的數字:", X
   IF X &gt;= 0 AND X &lt; 100000 THEN
      EXIT DO
   ELSE
      PRINT X; "超出範圍"
   END IF
LOOP

IF X &lt; 10 THEN
   Y = 1
ELSEIF X &lt; 100 THEN
   Y = 2
ELSEIF X &lt; 1000 THEN
   Y = 3
ELSEIF X &lt; 10000 THEN
   Y = 4
ELSE
   Y = 5
END IF
PRINT "數字有"; Y; "位"


<hr>

<span id="L80EF" class="QBtitle">INKEY$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8060"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INKEY$ 函數細節</span>

<span class="QH_1">語法</span>
  INKEY$

INKEY$ 函數傳回由標準輸入裝置(standard input device)所讀入一個字元(英文或
中文字元)字串,假如沒有鍵入任何字元,則傳回空字串。若是一個位元組長度的字串,
則表示它是由鍵盤所讀入的真正英文字元,若是二個位元組長度的字串表示它是一個
擴充碼(extended code),其第一個位元組是十六進制值的 00 (例如 : &lt;PgDn&gt; 鍵由
INKEY$ 函數讀入 : 第一個位元組是十六進制值的 00,第二個位元組是十六進制值
的 &H51 )。

對於中文字元, 由 INKEY$ 函數所讀入的是二個位元組長度的字串: 第一個位元組
存放中文碼的高位元組(High-Byte),第二個位元組存放中文碼的低位元組(Low-Byte)。

請參閱 <span class="QH_2">&lt;</span><a href="#L8034">鍵盤掃描碼表</a><span class="QH_2">&gt;</span> 以及
       <span class="QH_2">&lt;</span><a href="#L8223">ASCII 字元碼表</a><span class="QH_2">&gt;</span> 有提供這些代碼的完整資料。

鍵盤通常為標準輸入裝置。
INKEY$ 函數並不會顯示該字元在螢幕上; 除了下列控制鍵以外,其它的字元皆可讓
程式繼續執行:

  * CTRL+BREAK     中止程式執行
  * CTRL+ALT+DEL   重新啟動系統
  * CTRL+NUMLOCK   暫停程式執行
  * PRTSC          複印螢幕畫面



<hr>

<span id="L80F0" class="QBtitle">INKEY$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8060"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80EF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INKEY$ 函數程式範例</span>

此範例顯示 INKEY$ 的一般用法,此程式會暫停執行,直到使用者按下任意鍵才離開迴圈:

PRINT "按任意鍵,繼續..."
DO
LOOP WHILE INKEY$=""



<hr>

<span id="L80F1" class="QBtitle">INP 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8061"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INP 函數細節</span>

<span class="QH_1">語法</span>
  INP(埠)

埠(port)參數必須是介於 0 到 65,535 之間的整數。INP 函數是 OUT 敘述的互補函數。

INP 和 OUT 敘述可在 BASIC 程式中透過輸入/輸出埠直接控制系統的硬體。
這些敘述必須謹慎使用,因為它們直接控制系統的硬體。



<hr>

<span id="L80F2" class="QBtitle">INP 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8061"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱 <span class="QH_2">&lt;</span><a href="#L8159">OUT 敘述程式範例 </a><span class="QH_2">&gt;</span>,有使用 INP 和 OUT 敘述。


<hr>

<span id="L80F3" class="QBtitle">INPUT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8062"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT 敘述細節</span>

<span class="QH_1">語法</span>
  INPUT[;] ["提示字串"{;|,}] 變數串列

  <span class="QH_1">參數           說明</span>
  ;              在 INPUT 後面直接跟著分號,使得當使用者在按下 ENTER 鍵
                 後,游標仍停留在輸入資料的那一行上。

  提示字串       在變數串列之前會先列印一個字串常數當作提示(prompt)訊息。

  ;              在提示字串的後面同時印出問號。

  ,              僅列印提示字串,而沒有印出問號。

  變數串列       一連串的變數,變數之間是以逗號分開,來接受輸入的值。
                 請參閱下面的說明。

INPUT 敘述導致程式暫停執行,並且等待資料的輸入。此時可從鍵盤上輸入所需要的
資料。

所輸入的資料會指定給變數串列上的變數。對於所輸入資料項的個數,必須與串列上
變數的數目一樣多。若在逗號後面的第一個字元不是空白,歸位(carriage-return),
或換行(line-feed)字元,則假設是一個新資料項的開始。

在串列中的變數名稱可以為數值或字串變數名稱(包括註標(subscript)變數),陣列元素
或記錄的元素。每一個輸入資料的型態必須與變數型態相同(在 INPUT 敘述中所輸入的
字串,不需要使用雙引號括起來)。假如第一個字元是雙引號 ("),字串項將包含第一個到
第二個雙引號之間的所有字元。這意味著一個納入雙引號中的字串並不將雙引號當作一個
字元,假如字串的第一個字元不是雙引號,則此字串不是一個納入雙引號中的字串,而是由
一個逗號(comma),歸位(carriage-return)或換行(line-feed)的字元來結束。

輸入一個值,存到一個記錄的元素中,其輸入方式與單一元素輸入相同:

  TYPE Demograph
     FullName AS STRING * 25
     Age  AS INTEGER
  END TYPE

  DIM Person AS Demograph
  INPUT "輸入姓名和年齡: ";Person.FullName,Person.Age

對 INPUT 敘述回應有太多或太少資料項或錯誤的資料型態時(如:數值代替字串輸入),
將會產生 "重新輸入" 的錯誤訊息。

直到給定一個可接受的回應(如: ENTER 鍵)後,才將輸入的值指定給該變數。

在按 ENTER 鍵之前,可以編輯該輸入行的資料。

下列說明各種組合鍵允許您在輸入行中移動游標,刪除本文(text),及增加本文:

  <span class="QH_1">鍵                  動作命令</span>
  CTRL+\ 或 →        游標向右移一個字元(character)。

  CTRL+] 或 ←        游標向左移一個字元。

  CTRL+F 或           游標向右移一個字(word)。
  CTRL+ →

  CTRL+B 或           游標向左移一個字。
  CTRL+ ←

  CTRL+K 或 HOME      游標移到輸入行的開頭。

  CTRL+N 或 END       游標移到輸入行的結束。

  CTRL+R 或 INS       切換插入模式(Insert Mode)的開關,當插入狀態開啟時,
                      輸入一新的字元會使游標所在位置的字元向右移一個字元。

  CTRL+I 或 TAB       游標移到下一個設定欄位,且插入("插入" 模式開啟時)
                      或覆蓋(overwrite: "插入" 模式關閉時)。

  DEL                 刪除游標上的字元。

  CTRL+H 或           刪除游標左邊的字元。若游標在輸入行的開始位置時,
  BACKSPACE           則刪除游標上的字元。

  CTRL+E 或 CTRL+END  刪除游標到該行結束的所有字元。

  CTRL+U 或 ESC       刪除一整行,與游標位置無關。

  CTRL+M 或 RETURN    完成輸入,並且儲存該輸入行。
  或 ENTER

  CTRL+T              切換螢幕底端功能鍵標記顯示的開關。

  CTRL+BREAK 或       結束輸入(離開被編譯的程式)。
  CTRL+C


<hr>

<span id="L80F4" class="QBtitle">INPUT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8062"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT 敘述程式範例</span>

此範例使用INPUT 敘述來輸入一個圓的半徑,並計算其面積。
此程式提示您輸入一個新的半徑並執行,直到輸入 0 才停止執行。

CLS
PI = 3.141593 : R = -1
DO WHILE R
    PRINT "輸入半徑 (0 表示離開)"
    INPUT ; "若半徑 = ", R
    IF R &gt; 0 THEN
        A = PI * R ^ 2
        PRINT ",則圓面積 ="; A
    END IF
    PRINT
LOOP

<span class="QH_1">範例輸出</span>

輸入半徑 (0 表示離開)
若半徑 = 3,則圓面積 = 28.27434

輸入半徑 (0 表示離開)
若半徑 = 4,則圓面積 = 50.26549

輸入半徑 (0 表示離開 )
若半徑 = 0



<hr>

<span id="L80F5" class="QBtitle">INPUT # 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8041"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT # 敘述細節</span>

<span class="QH_1">語法</span>
  INPUT #檔案代碼, 變數串列

檔案代碼參數是指開啟輸入檔時所指定的檔案代號。變數串列參數為存放從檔案中
所讀取的資料之變數名稱。(變數型態必須符合變數名稱所指定的型態)。在檔案中
的資料項出現方式,必須如 INPUT 敘述一樣所輸入的資料項能對應參數串列。可用
空白(space),歸位(carriage-return)或換行(line-feed)字元來將數值分開。至於
字串可用歸位或換行(前置的空白字元會被省略)來分開字串。另外,檔案結束(end-
of-file)字元,用來結束一個數值或字串的輸入。

假如 BASIC 是在掃描一個循序資料檔內的字串項目時,會將前置空白,歸位和換行字元
忽略。當數值或字串項目被 INPUT # 敘述讀取時, 若遇到檔案結束字元,則此項目的
讀取會被結束。


<hr>

<span id="L80F6" class="QBtitle">INPUT # 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8041"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006">內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT # 敘述程式範例</span>

本範例從循序檔中讀取一系列的成績,並且計算其平均分數。

' 注意:在執行本程式之前,先建立一個線上資料檔(CLASS.DAT),
' 此檔案是由一系列的成績-- 97 84 63 89 100 所組成。

DEFINT A-Z
CLS    ' 清除螢幕
OPEN "class.dat" FOR INPUT AS #1

DO WHILE NOT EOF(1)
   Count = Count + 1
   INPUT #1, Score
   Total = Total + Score
   PRINT Count; Score
LOOP
PRINT
PRINT "學生總數:";Count;" 平均分數:";Total / Count
END

<span class="QH_1">範例輸出</span>

1  97
2  84
3  63
4  89
5  100

學生總數: 5  平均分數: 86.6



<hr>

<span id="L80F7" class="QBtitle">INPUT$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8063"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT$ 函數細節</span>

<span class="QH_1">語法</span>
  INPUT$(n [,[#]檔案代碼])

n 是從檔案中所讀取的位元組數目,檔案代碼是檔案被開啟時所使用的號碼。

假如檔案開啟為隨機檔,參數 n 必須小於或等於在 OPEN 敘述中 LEN 子句所設定的
記錄長度(假如記錄長度沒有設定,則小於或等於 128 個位元組)。
若檔案開啟為二進位檔或循序檔,則 n 必須小於或等於 32,767。

假如檔案代碼未指定,則從標準輸入裝置中讀取字元(若輸入沒有重新導向(Redirection),
則鍵盤為標準的輸入裝置)。

您可以使用 DOS 重新導向符號(&lt;, &gt;, 或 &gt;&gt;) 或管道符號(Pipe)(|)來為 BASIC 所建立
的可執行檔,重新定義標準輸入或標準輸出。(可參閱作業系統手冊,有對重新導向和管道
詳細說明)。

沒有字元會回應到螢幕上。所有控制字元除了 CTRL+BREAK 鍵用來中斷函數的執行外,
其它控制字元均能順利通過。


<hr>

<span id="L80F8" class="QBtitle">INPUT$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8063"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INPUT$ 函數程式範例</span>

本範例列印一個檔案在螢幕上,使用 INPUT$ 一次讀入一個字元,然後轉換此字元成為可
顯示的字元。

  祕訣:當您執行本範例時,必須提供一個純英文的本文檔。

'定義 TAB 鍵的 ASCII 碼,和換行的 ASCII 碼
CONST HTAB = 9, LFEED = 10

CLS    ' 清除螢幕
INPUT "要顯示那一個檔案"; Filename$
OPEN Filename$ FOR INPUT AS #1
CLS
DO WHILE NOT EOF(1)

    ' 從檔案中讀入單一字元
    S$=INPUT$(1,#1)
    ' 轉換字元成為一個整數,並且關閉其高位元(high bit),使得 WordStar(R)
    ' 的檔案能被顯示。
    C=ASC(S$) AND &H7F
    ' 是一個可列印的字元嗎?
    IF (C &gt;= 32 AND C &lt;= 126) OR C = HTAB OR C = LFEED THEN
       PRINT CHR$(C);
    END IF

LOOP
END



<hr>

<span id="L80F9" class="QBtitle">INSTR 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8064"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80FA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INSTR 函數細節</span>

<span class="QH_1">語法</span>
  INSTR([起始,] 字串運算式 1, 字串運算式 2)

  <span class="QH_1">參數                說明</span>
  起始                為一個可選擇的位移(offset)值,設定所要搜尋的
                      起始位置(以 "位元組" 為計算單位); 而且起始
                      參數的範圍必須在 1 - 32,767 之間。假如起始值
                      未給定,則 INSTR 函數從字串運算式 1 的第一個
                      位元組開始搜尋。

  字串運算式 1        表示被搜尋的字串。

  字串運算式 2        表示所要找尋的字串。

字串運算式 1 和字串運算式 2 參數,可為字串變數,字串運算式,或字串定字(literal)。

INSTR 函數根據下列條件來將值傳回:

  <span class="QH_1">條件                                    傳回值</span>
  字串運算式 2 在字串運算式 1 找到        有找到匹配(match)的位置值。

  起始值大於字串運算式 1 的長度           0

  字串運算式 1 是空字串                   0

  字串運算式 2 找不到                     0

  字串運算式 2 是空字串                   起始值(若給定);否則為 1

可以使用 LEN 函數來求得字串運算式 1 的長度。


<hr>

<span id="L80FA" class="QBtitle">INSTR 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8064"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80F9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INSTR 函數程式範例</span>

本範例使用 INSTR 和 UCASE$ 函數從禮貌上的尊稱(Mr.,Mrs.,或 Ms.)來決定
一個人的性別。

' 讀取姓名
CLS    ' 清螢幕
DO
   INPUT "請輸入姓名,其中包括禮貌上的尊稱 (Mr., Mrs., 或 Ms.): ", Nm$
LOOP UNTIL LEN(Nm$) &gt;= 3

' 將小寫字母轉成大寫
Nm$ = UCASE$(Nm$)
' 搜尋 MS, MRS, 或 MR 以設定 Sex$
IF INSTR(Nm$, "MS") &gt; 0 OR INSTR(Nm$, "MRS") &gt; 0 THEN
    Sex$ = "F"
ELSEIF INSTR(Nm$, "MR") &gt; 0 THEN
    Sex$ = "M"
ELSE
    ' 無法決定性別,詢問使用者
    DO
        INPUT "請輸入性別 (M/F): ", Sex$
        Sex$ = UCASE$(Sex$)
    LOOP WHILE Sex$ &lt;&gt; "M" AND Sex$ &lt;&gt; "F"
END IF
' 印出結果
PRINT "性別是 "; Sex$

<span class="QH_1">範例輸出</span>

請輸入姓名,其中包括禮貌上的尊稱 (Mr., Mrs., 或 Ms.): Ms. Elspeth Brandtkeep
性別是 F

請輸入姓名,其中包括禮貌上的尊稱 (Mr., Mrs., 或 Ms.): Dr. Richard Science
請輸入性別 (M/F): M
性別是 M



<hr>

<span id="L80FB" class="QBtitle">INT 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8065"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80FC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INT 函數細節</span>

<span class="QH_1">語法</span>
  INT(數值運算式)

INT 函數刪除數值運算式參數中的小數部分。

當 x 為一數值運算式,INT 與 FIX 的差別在 x 為負數時, FIX 函數取大於或
等於 x 的整數; 而 INT 函數則取小於或等於 x 的整數。



<hr>

<span id="L80FC" class="QBtitle">INT 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8065"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80FB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">INT 函數程式範例</span>

此範例比較 INT, CINT, 和 FIX 的輸出,此三個函數將數值資料轉換成整數。

CLS                ' 清螢幕
PRINT "  N","INT(N)","CINT(N)","FIX(N)" : PRINT
FOR I% = 1 TO 8
    READ N
    PRINT N, INT(N), CINT(N), FIX(N)
NEXT
DATA  99.3, 99.5, 98.5, 99.7, -99.3, -99.5, -98.5, -99.7


<span class="QH_1">範例輸出</span>

  N           INT(N)        CINT(N)       FIX(N)

 99.3          99            99            99
 99.5          99            100           99
 98.5          98            98            98
 99.7          99            100           99
-99.3         -100          -99           -99
-99.5         -100          -100          -99
-98.5         -99           -98           -98
-99.7         -100          -100          -99



<hr>

<span id="L80FD" class="QBtitle">IOCTL$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8067"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L80FE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">IOCTL$ 函數細節</span>

<span class="QH_1">語法</span>
  IOCTL$([#]檔案代碼)

檔案代碼參數是 BASIC 開啟裝置(device)時的檔案代號。IOCTL$ 函數最常用來測試
IOCTL 敘述,以取得目前狀態的資訊是否成功或失敗。

  注意: BASIC 裝置 ( LPT1:, COM1:, COM2:, SCRN:, CONS:) 和 DOS 區段(block)
        裝置 ( A: through Z:) 並不支援 IOCTL 敘述。

您可以使用 IOCTL$ 函數要求通訊裝置傳回目前的鮑率(baud rate),最近一次錯誤的
資訊,邏輯的行寬(line width)等等。真正資訊的傳回將與所指定的裝置驅動器有關係。

IOCTL$ 函數在下列三個條件同時發生時,才能執行:

  1. 裝置驅動器(Device Driver)已安裝妥。

  2. 裝置驅動器有陳述會處理 IOCTL 字串。請參閱有關驅動器的說明文件。
     您也可以藉著使用 DOS 中斷呼叫 &H21(INT 21H) 中的功能 &H44 和
     CALL INTERRUPT 常式(routine)來對 IOCTL 支援作測試。可參閱
     CALL INTERRUPT 敘述有提供更多的資訊。

  3. BASIC 在該裝置上對一個檔案執行一個 OPEN 敘述。



<hr>

<span id="L80FE" class="QBtitle">IOCTL$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8067"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80FD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">IOCTL$ 函數程式範例</span>

本範例顯示如何使用假設的裝置驅動器 ENGINE 與一個裝置驅動器通訊。
IOCTL 敘述在驅動器中設定資料模式,而 IOCTL$ 函數用來測試資料模式。

'   注意: IOCTL$ 函數僅在裝置驅動器安裝妥當,並且有陳述會處理 IOCTL 字串.
'         而且 BASIC 在該裝置上有執行一個 OPEN 敘述時,才能執行。
'         請勿在目前形式下執行此範例。
'
OPEN "\DEV\ENGINE" FOR OUTPUT AS #1
IOCTL #1, "RAW"                   '告訴裝置,資料是原始的
'
' 假如字元驅動器 "ENGINE" 從 IOCTL 敘述中的原始資料模式
' 回應一個假值,則檔案將被關閉。
'
IF IOCTL$(1) = "0" THEN CLOSE 1



<hr>

<span id="L80FF" class="QBtitle">IOCTL 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8068"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8100"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">IOCTL 敘述細節</span>

<span class="QH_1">語法</span>
  IOCTL [#]檔案代碼, 字串

檔案代碼是 BASIC 開啟裝置(device)時的檔案代號。字串參數為送給該裝置的命令。
該命令是指定給裝置驅動器。可參閱裝置驅動器(Device Driver)的文件,查看那些
是屬於有效的 IOCTL 命令。IOCTL 敘述所能控制資料字串的長度至多為 32,767 個
位元組。

IOCTL 敘述僅在下列三個條件全部成立時,才可以執行:

  1. 裝置驅動器已安裝妥。

  2. 裝置驅動器裝置有陳述會處理 IOCTL 字串。請參閱有關驅動器的說明文件。
     您也可以藉著使用 DOS 中斷呼叫 &H21(INT 21H)中的功能 &H44 和
     CALL INTERRUPT 常式(routine)來對 IOCTL 作測試。
     請參閱 Microsoft MS-DOS 程式員參考手冊和 CALL INTERRUPT 敘述有提供
     更多的資訊。

  3. BASIC 在該裝置上對一個檔案執行一個 OPEN 敘述,而且此檔案仍維持開啟的。

大部分標準的 DOS 裝置驅動器並不處理 IOCTL 字串,所以您必需決定是否所指定的
驅動器能接受此命令。


<hr>

<span id="L8100" class="QBtitle">IOCTL 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8068"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L80FF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">IOCTL 敘述程式範例</span>

可參閱 <span class="QH_2">&lt;</span><a href="#L80FE">IOCTL$ 函數程式範例</a><span class="QH_2">&gt;</span>, 顯示 IOCTL 敘述和 IOCTL$ 函數
是如何在一個裝置驅動器上被使用。

  注意: 任何 IOCTL 敘述的用法是與裝置驅動器(Device Driver)有關聯的。
        IOCTL 敘述使用字串參數,僅在驅動器手冊中有記載。



<hr>

<span id="L8101" class="QBtitle">KEY 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8069"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8102"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KEY 敘述細節</span>

  <span class="QH_1">語法</span>                         <span class="QH_1">用法</span>
  KEY n, 字串運算式            指定軟鍵(soft-key)字串值
  KEY LIST                     顯示軟鍵字串值
  KEY {ON|OFF}                 開啟或關閉在螢幕底端軟鍵的顯示行

<span class="QH_1">指定字串給功能鍵</span>

參數 n 是一個數字,用來表示功能鍵。在 101 個鍵的鍵盤上, n 值由 1 到 10 代表
F1 - F10 功能鍵,而 30 和 31 是功能鍵 F11 和 F12。當功能鍵被按下時,所傳回的
是一個至多 15 個位元組的字串運算式,若字串運算式的字串長度超過 15 個位元組,
則多餘的部份將被忽略。

KEY 敘述允許您設計特殊的 "軟鍵" 功能--表示當功能鍵被按下時會傳回指定的字串。

指定一個空字串給一個軟鍵時,會關閉功能鍵的軟鍵功能。

假如功能鍵的號碼不在正確的範圍,此時將會顯示 "不正確的函數呼叫" 錯誤訊息,
並保留前一個鍵的字串運算式。

<span class="QH_1">顯示軟鍵的指定</span>

您可以用 KEY ON, KEY OFF, 和 KEY LIST 敘述來顯示軟鍵:

  <span class="QH_1">敘述        動作</span>
  KEY ON      在螢幕的下端顯示軟鍵字串的前六個位元組。

  KEY OFF     清除底行的軟鍵顯示,使得該行可被程式使用。但此敘述無法
              關閉功能鍵顯示。

  KEY LIST    在螢幕上顯示所有軟鍵的值,每一個鍵以 15 個位元組來顯示。

若按下軟鍵,其效果如同使用者鍵入軟鍵所設定的字串。INPUT$, INPUT,
和 INKEY$ 可用來讀取按下軟鍵時所產生的字串。


<hr>

<span id="L8102" class="QBtitle">KEY 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8069"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8101"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KEY 敘述程式範例</span>

這些例子顯示如何指定值給軟鍵(soft-key)。

本範例是用來指定及關閉一個軟鍵。KEY LIST 敘述首先顯示設定 KEY 4 之後的鍵值,
再關閉 KEY 4,最後再顯示其鍵值:

CLS                       ' 清螢幕
KEY 4, "MENU" + CHR$(13)  '指定字串 "MENU" 其後緊跟著歸位(carriage-return)
                          '字元給軟鍵 4
KEY LIST
KEY 4, ""                 '關閉軟鍵 4
KEY LIST

本範例使用 KEY 敘述,用來設定一個鍵相當於功能表上的一個選擇。
例如,按 F1 鍵如同輸入字串"Add":

CLS                       ' 清螢幕
DIM KeyText$(3)
DATA Add, Delete, Quit
' 指定軟鍵字串給 F1 到 F3 功能鍵
FOR I = 1 TO 3
   READ KeyText$(I)
   KEY I, KeyText$(I) + CHR$(13)
NEXT I
' 印出功能表
PRINT "                 主功能表" : PRINT
PRINT "           增加串列 (F1)"
PRINT "           刪除串列 (F2)"
PRINT "           離開 (F3)" : PRINT
' 讀取輸入並回應
DO
   LOCATE 7,1 : PRINT SPACE$(50);
   LOCATE 7,1 : INPUT "             請選擇:", R$
   SELECT CASE R$
      CASE "Add", "Delete"
         LOCATE 10,1 : PRINT SPACE$(50);
         LOCATE 10,1 : PRINT R$;
      CASE "Quit"
         EXIT DO
      CASE ELSE
         LOCATE 10,1 : PRINT "請輸入第一個字或按鍵"
   END SELECT
LOOP



<hr>

<span id="L8103" class="QBtitle">KEY(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8042"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8104"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KEY(n) 敘述細節</span>

<span class="QH_1">語法</span>
  KEY(n) ON
  KEY(n) OFF
  KEY(n) STOP

參數 n 可以是一個功能鍵的號碼,一個游標方向鍵或是一個使用者自定鍵的代碼。
可參閱 KEY 敘述有關指定軟鍵(soft-key)值給功能鍵之資訊。其中 n 參數值如下所示 :

  <span class="QH_1">值       鍵</span>

   1-10    功能鍵 F1-F10
     11    ↑
     12    ←
     13    →
     14    ↓
  15-25    使用者自定鍵
  30-31    功能鍵 F11-F12 在 101 鍵的鍵盤上適用

  其中 ↑, ↓, →, ← 是方向鍵。


您可以藉著 KEY 敘述的變化來啟動組合鍵的設陷:

  KEY n, CHR$(鍵盤旗標) + CHR$(掃描碼)

參數 n 是介於 15-25 之間,表示一個使用者自定鍵。鍵盤旗標(keyboard flag)可為
下列任何十六進制值的組合:

  <span class="QH_1">值          鍵</span>

  &H00        沒有鍵盤旗標
  &H01-&H03   SHIFT 鍵之一
  &H04        CTRL
  &H08        ALT
  &H20        NUMLOCK
  &H40        CAPSLOCK
  &H80        101 個鍵的鍵盤擴充鍵適用

您可以將以上所列之值相加來對多鍵狀態作測試。例如,一個 &H0C 的鍵盤旗標值
,可測試是否 CTRL 和 ALT 兩鍵同時被按下。

因為鍵的設陷是假設左右兩邊的 SHIFT 鍵皆相同,您可以使用 &H01,&H02,或 &H03
來指定 SHIFT 鍵。掃描碼參數是使用 83 個按鍵的其中一個代碼來設陷,如下表所示。

KEY(n) ON 敘述用來啟動軟鍵或游標方向鍵,並藉著一個 ON KEY 敘述事件做設陷。
當設陷被啟動時,若在 ON KEY 敘述中指定一個不為零的行號,BASIC 會檢查您是否
按下 KEY(n) 鍵。若您按下該鍵,BASIC 會執行在 ON KEY 敘述中 GOSUB 子句所設定
的設陷常式。本文通常都是與一個功能鍵有關係,而不是輸入。

在 QuickBASIC 工作環境下,QuickBASIC 會在敘述中測試按鍵。在獨立執行的程式,
您可以指定在程式行中做檢查。

KEY(n) OFF 關閉事件設陷,即使一個事件發生也無法記錄。KEY(n) STOP 用來暫停
事件設陷;換句話說,若您按下所指定的鍵,該動作將被記錄,一直到一個 KEY(n) ON
敘述被執行時,便馬上執行由 ON KEY 事件設陷的敘述。

  <span class="QH_1">鍵盤掃描碼</span>

  鍵        十六進制碼    鍵          十六進制碼    鍵          十六進制碼

  ESC       01            CTRL        1D            SPACEBAR    39
  ! 或 1    02            A           1E            CAPSLOCK    3A
  @ 或 2    03            S           1F            F1          3B
  # 或 3    04            D           20            F2          3C
  $ 或 4    05            F           21            F3          3D
  % 或 5    06            G           22            F4          3E
  ^ 或 6    07            H           23            F5          3F
  & 或 7    08            J           24            F6          40
  * 或 8    09            K           25            F7          41
  ( 或 9    0A            L           26            F8          42
  ) 或 0    0B            : 或 ;      27            F9          43
  _ 或 -    0C            " 或 '      28            F10         44
  + 或 =    0D           tilde&lt; 或 &gt;  29            NUMLOCK     45
  LEFT      0E            LEFT SHIFT  2A            SCROLL LOCK 46
  TAB       0F            | 或 \      2B            HOME 或 7   47
  Q         10            Z           2C            ↑   或 8   48
  W         11            X           2D            PGUP 或 9   49
  E         12            C           2E            -           4A
  R         13            V           2F            ←   或 4   4B
  T         14            B           30            5           4C
  Y         15            N           31            →   或 6   4D
  U         16            M           32            +           4E
  I         17            &lt; 或 ,      33            END  或 1   4F
  O         18            &gt; 或 .      34            ↓   或 2   50
  P         19            ? 或 /      35            PGDN 或 3   51
  { 或 [    1A            RIGHT SHIFT 36            INS 或 0    52
  } 或 ]    1B            PRTSC 或 *  37            DEL 或 .    53
  RETURN    1C            ALT         38


<hr>

<span id="L8104" class="QBtitle">KEY(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8042"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8103"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KEY(n) 敘述程式範例</span>

本範例對 "向下" 方向鍵及 CTRL+S ( 控制鍵和小寫的 s )做設陷。

     注意: 不可在 Numlock 鍵被按下時,執行此範例。

I = 0
CLS    ' 清螢幕
PRINT "按向下方向鍵至底端"
KEY 15, CHR$(&H04) + CHR$(&H1f)
KEY(15) ON              '對 CTRL+s 設陷
KEY(14) ON              '對向下方向鍵設陷
ON KEY(15) GOSUB Keytrap
ON KEY(14) GOSUB Endprog
Idle: GOTO Idle        '無窮迴圈

Keytrap:   '計算 CTRL+s 被按下的次數
    I = I + 1
RETURN

Endprog:
    PRINT "CTRL+s 設陷"; I; "次"
    END
RETURN



<hr>

<span id="L8105" class="QBtitle">KILL 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8106"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KILL 敘述細節</span>

<span class="QH_1">語法</span>
  KILL 檔案名稱

KILL 敘述與 DOS 下的 ERASE 及 DEL 命令很類似。

KILL 可刪除磁碟中所有型態的檔案:如程式檔,隨機檔,資料檔,以及循序資料檔。
檔案名稱可以包含問號(?)或星號(*)。其中: 問號(?)可置於主檔名(基本檔名)或
延伸檔名,但一個問號(?)只能取代檔名中的一個英文字元。而一個星號(*)卻可
用來表示主檔名及延伸檔名中的一個或多個英文字元。

KILL 只能刪除檔案,而不能刪除子目錄,但 RMDIR 只能刪除子目錄但不能刪除檔案。
KILL 不能刪除目前已開啟的檔案,否則會顯示一 "檔案已經開啟" 錯誤訊息,表示
檔案已經被開啟,所以不可以刪除。

                 <span class="QH_1">----------  警告   ----------</span>
使用 KILL 敘述必須非常小心,也可能因為使用萬用字元(?, *)的不當而誤將檔案刪除。
                 <span class="QH_1">-----------------------------</span>



<hr>

<span id="L8106" class="QBtitle">KILL 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8105"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">KILL 敘述程式範例</span>

以下範例即為如何使用 KILL 刪除檔案。

<span class="QH_1">範例 1</span>

下列是於 KILL 敘述中,利用萬用字元(?,*)來刪除檔案。注意,若找不到所指定的檔案,
則下列敘述均無法執行:

KILL "DATA1?.DAT"     '刪除目前目錄下主檔名有 6 個英文字元,其中
                      '前 5 個字元為 DATA1, 延伸檔名為 .DAT 的所有檔案

KILL "DATA1.*"        '刪除目前目錄下所有主檔名為 DATA1 的任意延伸檔案

KILL "\GREG\*.DAT"    '刪除 GREG 子目錄下,延伸檔名為 .DAT 的所有檔案

<span class="QH_1">範例 2</span>

此範例可直接由命令行上取得檔名並刪除:

' 確定已由[O/選擇功能]功能表中設定為全功能表,並且由[R/執行]功能表選擇
' "C/修改 COMMAND$" 命令去設定一個檔案。
' 它可設定任何檔案,但需確定此檔是您想要刪除的檔案。
DEFINT A-Z
CLS    ' 清螢幕
ON ERROR GOTO Errorhandle '設定錯誤處理常式(error handling routine)
FileName$ = COMMAND$      '讀取檔案名稱
KILL FileName$
PRINT FileName$ "刪除"
END

Errorhandle:
    Number = ERR
    IF Number = 53 THEN
       PRINT "無法刪除" FileName$ ;
       PRINT "; 檔案不存在於目前目錄中"
    ELSE
       PRINT "無法恢復錯誤:";Number
       ON ERROR GOTO 0   'ON ERROR GOTO 終止程式
    END IF
RESUME NEXT



<hr>

<span id="L8107" class="QBtitle">LBOUND 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8108"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LBOUND 函數細節</span>

<span class="QH_1">語法</span>
  LBOUND(陣列 [,維度])

LBOUND 函數通常配合 UBOUND 函數,用來決定陣列的下界(lower bound)。

  <span class="QH_1">參數        說明</span>
  陣列        此參數必須是已經用 DIM 敘述宣告過的陣列。

  維度        是一個由 1 到所宣告的陣列維度(dimension)之間的整數值。
              而 LBOUND 則傳回陣列中每一維的下界。

例如: 一個陣列的維度大小如下,可以利用 LBOUND 來傳回陣列的下界值:

  DIM A(1 TO 100, 0 TO 50, -3 TO 4)

  <span class="QH_1">函數           函數傳回值</span>
  LBOUND(A,1)     1
  LBOUND(A,2)     0
  LBOUND(A,3)    -3

通常陣列註標(subscript)的下界不是 0 就是 1,可由 OPTION BASE 敘述來設定
陣列的下界。若 OPTION BASE 設定為 0, 預設的陣列下界是 0; 若 OPTION BASE
設定為 1, 則預設的陣列下界是 1 。

以 DIM 敘述宣告陣列時,可利用 TO 子句來宣告陣列的上下界。

對於一維陣列,可使用簡化語法 LBOUND(陣列) 來測知陣列的下界。因為預設的
維度為 1, 故可省略上述維度參數;也可以使用 UBOUND 函數來測知陣列中指定
維度的上界(upper bound)。


<hr>

<span id="L8108" class="QBtitle">LBOUND 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8107"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LBOUND 函數程式範例</span>

可參閱 <span class="QH_2">&lt;</span><a href="#L81EA">UBOUND 函數程式範例</a><span class="QH_2">&gt;</span>, 有使用 LBOUND 及 UBOUND 函數。


<hr>

<span id="L8109" class="QBtitle">LCASE$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L810A"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LCASE$ 函數細節</span>

<span class="QH_1">語法</span>
  LCASE$(字串運算式)

LCASE$ 函數,可將字串變數,字串常數或字串運算式視為單一參數。

LCASE$ 可適用於變動或固定長度的字串。

對於與大小寫無關(case insensitive)的字串比對(comparision)運算中,
LCASE$ 和 UCASE$ 是相當實用的兩個測試函數。


<hr>

<span id="L810A" class="QBtitle">LCASE$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8109"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LCASE$ 函數程式範例</span>

此範例可將大寫英文字母的字串轉換成小寫字母的字串。

' 程式將字串轉換成小寫英文字母
CLS                ' 清螢幕
READ Word$
PRINT LCASE$(Word$)
PRINT LCASE$("ＴＨＩＳ ＩＳ Ａ ＢＯＯＫ")
DATA "THIS IS THE STRING in lower case."

<span class="QH_1">範例輸出</span>

this is the string in lower case.
ｔｈｉｓ ｉｓ ａ ｂｏｏｋ


<hr>

<span id="L810B" class="QBtitle">LEFT$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L810C"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LEFT$ 函數細節</span>

<span class="QH_1">語法</span>
  LEFT$(字串運算式, n)

字串運算式參數可以為任一字串變數,字串常數或字串運算式。

參數 n 是一個介於 0-32,767 之間的數值運算式,表示有多少個位元組將被傳回。

若 n 的值大於在字串運算式中的位元組數目,則整個字串將被傳回。若要找出在
字串運算式中位元組的總數目,可使用 LEN(字串運算式) 函數。

若 n 值為零,則傳回空字串(其長度為零)。


<hr>

<span id="L810C" class="QBtitle">LEFT$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L810B"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LEFT$ 函數程式範例</span>

此範例將 A$ 字串中,最左邊開始的五個位元組資料印出。

CLS                ' 清螢幕
A$="BASIC LANGUAGE"
B$=LEFT$(A$, 5)
PRINT B$

<span class="QH_1">範例輸出</span>

BASIC



<hr>

<span id="L810D" class="QBtitle">LEN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L810E"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LEN 函數細節</span>

<span class="QH_1">語法</span>
  LEN(字串運算式)
  LEN(變數)

在第一種語法中,LEN 函數會傳回字串運算式參數中字串的長度。第二種語法則傳回
一個 BASIC 變數所佔用的位元組總數目,此種語法對於決定一個隨機存取檔內正確的
記錄大小(record size)是非常有用的。


<hr>

<span id="L810E" class="QBtitle">LEN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L810D"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LEN 函數程式範例</span>

此範例列印出字串的長度,以及各類變數所佔用的位元組總數目。

CLS    ' 清螢幕
TYPE EmpRec
   EmpName AS STRING * 20
   EmpNum AS INTEGER
END TYPE
DIM A AS INTEGER, B AS LONG, C AS SINGLE, D AS DOUBLE
DIM E AS EmpRec

PRINT "A string:" LEN("A string.")
PRINT "Integer:" LEN(A)
PRINT "Long:" LEN(B)
PRINT "Single:" LEN(C)
PRINT "Double:" LEN(D)
PRINT "EmpRec:" LEN(E)
END

<span class="QH_1">範例輸出</span>

A string: 9
Integer: 2
Long: 4
Single: 4
Double: 8
EmpRec: 22



<hr>

<span id="L810F" class="QBtitle">LET(指定) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8110"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LET(指定) 敘述細節</span>

<span class="QH_1">語法</span>
  [LET] 變數=運算式

注意 LET 關鍵字是一個選擇項,而等號 "=" 在 QuickBASIC 中為一指定敘述。

僅當兩個變數均為相同的使用者自定型態時,LET 敘述才可以使用在記錄變數(record-
variables)中。LET 敘述也可對不同的使用者型態指定記錄變數。


<hr>

<span id="L8110" class="QBtitle">LET(指定) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L806F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L810F"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LET(指定) 敘述程式範例</span>

此範例顯示 LET 關鍵字的使用法。

CLS    ' 清螢幕
LET D = 12
LET E = 12 - 2
LET F = 12 - 4
LET SUM = D + E + F
PRINT D E F SUM

以下是省略 LET 關鍵字,來執行上面相同的程式。

CLS    ' 清螢幕
D = 12
E = 12 - 2
F = 12 - 4
SUM = D + E + F
PRINT D E F SUM

<span class="QH_1">範例輸出</span>

12 10 8 30



<hr>

<span id="L8111" class="QBtitle">LINE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8070"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8112"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE 敘述細節</span>

<span class="QH_1">語法</span>
  LINE [[STEP] (x1,y1)]-[STEP] (x2,y2) [,[顏色][,[B[F]][,型態]]]

(x1,y1) 和 (x2,y2) 兩個座標指定線段的兩端點; 注意:此兩端點出現的順序並
不重要,意即,一條從座標 (10,20) 畫至座標 (120,130) 的線段,與一條從座標
(120,130) 畫至座標 (10,20) 的線段是相同的。

其中,STEP 選擇項表示以所指定的座標相對於上次被畫的點來繪線,以取代絕對
座標。例如:若目前程式座標參考點為 (10,10),那麼 LINE -STEP(10,5) 敘述
就是為將目前 x 座標移動 10 點, y 座標移動 5 點,到達新座標為 (10+10,10+5)
或 (20,15) 的位置上。

同時也可利用 CLS 及 SCREEN 敘述來清除畫面,並重新設定螢幕的初始參考點。
使用 PSET, PRESET, CIRCLE 及 DRAW 敘述,也可重新設定最新的參考點。

下列為各類型使用 STEP 參數的例子,假設上一次被畫的點座標為 (10,10):

  <span class="QH_1">敘述                           說明</span>
  LINE -(50,50)                  畫一線段從 (10,10) 到 (50,50)。

  LINE -STEP(50,50)              畫一線段從 (10,10) 到 (60,60),
                                 意即: 10 加上相對位置 50, 等於 60。

  LINE (25,25)-STEP(50,50)       畫一線段從 (25,25) 到 (75,75),
                                 意即: 25 加上相對位置 50, 等於 75。

  LINE STEP(25,25)-STEP(50,50)   畫一線段從 (35,35) 到 (85,85),
                                 意即: 10 加上相對位置 25, 等於 35 ;
                                       35 加上相對位置 50, 等於 85。

  LINE STEP(25,25)-(50,50)       畫一線段從 (35,35) 到 (50,50),
                                 意即: 10 加上相對位置 25, 等於 35 ;
                                       從 (35,35) 到絕對位置 (50,50)
                                       畫一線段。

顏色參數是表示畫線時所使用的顏色號碼(若選擇 B 或 BF, 則需要此參數來決定
方框的顏色)。至於如何在不同螢幕模式下指定顯示的顏色,
請參閱 <span class="QH_2">&lt;</span><a href="#L808A">COLOR 敘述細節</a><span class="QH_2">&gt;</span> 及 <span class="QH_2">&lt;</span><a href="#L81A6">SCREEN 敘述細節</a><span class="QH_2">&gt;</span>。

B 參數用來畫出以所選定 (x1,y1) 與 (x2,y2) 兩點為對角線的方框,而此方框所塗
的顏色是由顏色參數來決定。

BF 參數與 B 參數類似,均用來畫一個方框,而 BF 參數並以所選定顏色參數的顏色,
塗滿由 (x1,y1) 與 (x2,y2) 所圍成的方框。

型態參數為一個 16 位元(bit)的整數罩幕(mask), 用來將圖素(pixel)顯示在螢幕上。
使用型態參數可用來表示線的樣式。若使用 "型態" 參數,LINE 敘述會由左而右順序
讀出型態參數的位元。若讀到的位元為零,此點不會顯示在螢幕上; 若為 1,則會在
螢幕上顯示一點,當畫一點之後, LINE 敘述繼續選擇 "型態" 中的下一個點位置。

在型態參數中,位元為 0 並不改變螢幕上此點的顏色,所以若您想使用 "型態" 參數
畫一個背景線,必須先知道背景色。型態參數只對線段(lines)及四方框(boxes)有效,
對實心四方形(filled boxes)則無效。

當所指定的座標點超出目前的景象埠(viewport),則只能畫出景象埠範圍內的線段。


<hr>

<span id="L8112" class="QBtitle">LINE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8070"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8111"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE 敘述程式範例</span>

此範例使用 LINE 敘述以不同的線條顯示在螢幕上。此範例必須在 640x480 VGA 繪圖
螢幕模式下執行。

SCREEN 82                         '設定 VGA 繪圖螢幕模式

LINE -(X2, Y2)                    '自目前的參考點畫一條線(以前景顏色)
                                  '到(X2,Y2)
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
LINE(0, 0)-(639, 449)             '由(0,0)到(639,449)畫一條螢幕的對角線
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
LINE(0, 100)-(639, 100)           '畫一條橫跨整個螢幕的水平線
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
LINE(10, 10)-(100, 100), 2        '以顏色屬性暫存器 2 內的顏色來畫一條線
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
FOR X = 0 to 319                  '畫出一個交錯圖形(明線/暗線)
    LINE(X, 0)-(X, 199), X AND 1  '在單色螢幕上
NEXT
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
LINE (0, 0)-(100, 100),, B        '以前景顏色畫一個方框
                                  '(注意 : 此處並無包含顏色設定)
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
LINE STEP(0,0)-STEP(200,200),2,BF '以顏色屬性暫存器 2 內的顏色畫出,並塗滿
                                  '方框(如 STEP 所給定座標所圍成的方框)
DO
LOOP WHILE INKEY$ = ""            '按任意鍵,繼續...
CLS    ' 清螢幕
LINE(0,0)-(319,230),3,,&HFF00     '以顏色屬性暫存器 3 內的顏色,由螢幕左上角
                                  '繪製一條虛線


<hr>

<span id="L8113" class="QBtitle">LINE INPUT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8043"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8114"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE INPUT 敘述細節</span>

<span class="QH_1">語法</span>
  LINE INPUT[;] ["提示字串";] 字串變數

提示字串參數為一字串常數,它會被顯示在輸入資料之前,以用來當作提示使用。
LINE INPUT 不會主動顯示問號,如果需要,則必須將問號包含在提示字串參數內。
在提示字串後面所有由鍵盤輸入的資料均被指定到一個字串變數,直到按下 ENTER 鍵
為止。

緊跟在 LINE INPUT 後直接加上一個分號(;),表示使用者按下 ENTER 鍵後,游標會
停留在輸入資料的那一行上。

LINE INPUT 與 INPUT 所使用的編輯字元相同。


<hr>

<span id="L8114" class="QBtitle">LINE INPUT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8043"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8113"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE INPUT 敘述程式範例</span>

'
'下列程式允許使用者輸入本文(text)到一個備註檔(notes file)中。LINE INPUT 敘述
'允許您輸入任何字元,包含在 INPUT 敘述中用來分開各個變數的逗號(,),皆被視為字串
'常數的一部分。打開並且逐行將資料寫到備註檔中,直到輸入一個空白行後才結束。
'
DO
    CLS
    PRINT "輸入本文,要結束時可在一行的開頭直接按 &lt;歸位&gt; 鍵。";
    PRINT "請輸入新的本文 :" : PRINT
    OPEN "NOTES.TXT" FOR OUTPUT AS #1

    ' 接收資料直到輸入空白行才結束
    DO
        LINE INPUT "-&gt;";Inline$
        IF Inline$ &lt;&gt; "" THEN PRINT #1, Inline$
    LOOP WHILE Inline$ &lt;&gt; ""
    CLS : CLOSE #1

' 顯示備註檔以確定是否正確
    OPEN "NOTES.TXT" FOR INPUT AS #1
    PRINT "您所輸入的內容是 :" : PRINT
    DO WHILE NOT EOF(1)
        LINE INPUT #1, Inline$
        PRINT Inline$
    LOOP
    CLOSE #1
    PRINT : INPUT "正確嗎 ? (Y/N)"; R$

LOOP WHILE UCASE$(R$)="N"
END



<hr>

<span id="L8115" class="QBtitle">LINE INPUT # 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8044"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8116"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE INPUT # 敘述細節</span>

<span class="QH_1">語法</span>
  LINE INPUT #檔案代碼, 字串變數

檔案代碼參數為檔案被開啟時所指定的檔案代號。字串變數參數為一字串變數,
用來存放由資料檔中所讀取的一整行資料。

LINE INPUT # 敘述自循序檔中讀取字元,直到碰到歸位(carriage-return)字元為止,
然後,跳過歸位字元及換行(line-feed)字元。接著,下一個 LINE INPUT # 敘述也會
讀取字元,直到碰到下一個歸位字元為止。

LINE INPUT # 有其特殊的應用,如資料檔中的每行資料已被分成數個欄位,或是在
一個本文檔(text file)要被一次讀取一行時。


<hr>

<span id="L8116" class="QBtitle">LINE INPUT # 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8044"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8115"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LINE INPUT # 敘述程式範例</span>

此範例使用 LINE INPUT # 敘述來回應輸入到檔案中的資料:

'*** LINE INPUT # 敘述程式範例 ***
OPEN "LIST" FOR OUTPUT AS #1
PRINT "客戶資料:"
' 讀取客戶資料
DO
    PRINT
    INPUT "   姓氏: ", LName$
    INPUT "   名字: ", FrName$
    INPUT "   年齡: ", Age$
    INPUT "   性別: ", Sex$
    Sex$=UCASE$(Sex$)
    WRITE #1, LName$, FrName$, Age$, Sex$
    INPUT "再增加嗎"; R$
LOOP WHILE UCASE$(R$)="Y"
CLOSE #1

' 回應新增資料
OPEN "LIST" FOR INPUT AS #1
CLS
PRINT "在檔案中的記錄為:" : PRINT
DO WHILE NOT EOF(1)
    LINE INPUT #1, REC$ '用 LINE INPUT # 自檔案中讀取記錄中的資料,
    PRINT REC$          '並將此記錄顯示在螢幕上。
LOOP

<span class="QH_1">範例輸出</span>

客戶資料:


   姓氏: Saintsbury
   名字: Aloysius
   年齡: 35
   性別: m
再增加嗎? y

   姓氏: Frangio
   名字: Louisa
   年齡: 27
   性別: f
再增加嗎? n

在檔案中的記錄為:

"Saintsbury","Aloysius","35","M"
"Frangio","Louisa","27","F"



<hr>

<span id="L8117" class="QBtitle">LOC 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8071"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8118"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOC 函數細節</span>

<span class="QH_1">語法</span>
  LOC(檔案代碼)

檔案代碼參數為在 OPEN 敘述開檔時所指定的檔案代號。在隨機存取檔中, LOC 函數
傳回檔案上次被讀寫的記錄編號。在循序檔中, LOC 傳回在檔案中目前的位元組
位置除以 128 的值; 在二進位檔中, LOC 函數傳回上一次被讀寫的位元組之位置。

對一個 COM 裝置(device), LOC(檔案代碼)傳回已在輸入佇列(Queue)中等待,且可以
被讀取的字元數目。所傳回之值是與開啟此裝置時所設定 ASCII 或二進位模式有關。
在 ASCII 模式下,當接收到檔案結束字元時,低階常式(Low-level Routine)會立即
停止再接收佇列中之字元。檔案結束字元本身不會被佇列,而且也不會被讀取。
若試圖去讀取一個檔案的結束字元時,將會產生一個 "檔案中已無資料" 錯誤訊息。
在二進位模式下,檔案的結束字元是會被忽略的,並且整個檔案都能夠被讀取。

 LOC 函數不能使用在 SCRN:, KYBD:, 或 LPTn: 等裝置上。


<hr>

<span id="L8118" class="QBtitle">LOC 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8071">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8117"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOC 函數程式範例</span>

此範例顯示若目前傳回檔案的指標位置超過 50 時,則結束程式執行。

                <span class="QH_1">--------- 注意 ---------</span>
此範例尚不完整。不要在目前形式下執行此範例。
                <span class="QH_1">------------------------</span>

IF LOC(1) &gt; 50 THEN STOP


<hr>

<span id="L8119" class="QBtitle">LOCATE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8072">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L811A"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOCATE 敘述細節</span>

<span class="QH_1">語法</span>
  LOCATE [列] [,[行] [,[游標] [,[起始, 結束]]]]

  <span class="QH_1">參數       說明</span>
  列         指螢幕上某一列(Row)的位置值;列參數是一個數值運算式,
             所傳回之值為一整數。若省略列參數,則表示列位置不改變。

  行         指螢幕上某一行(Column)的位置值;行參數是一數值運算式,
             所傳回之值為一整數。若省略行參數,則行位置不改變。

  游標       此參數為一布林(Boolean)值,用來代表游標的顯現與否。
             若游標值為零,則表示不會顯示游標; 若游標值為 1 則表示顯示
             游標(系統預設值為 1)。

  起始       螢幕上游標的起始掃描線編號。此參數是一數值運算式,
             所傳回值為一整數。

  結束       螢幕上游標的結束掃描線編號。此參數為一數值運算式,
             所傳回值為一整數。

您可在 LOCATE 敘述中省略以上任一個參數。若省略列或行參數,則游標停留在上一次
LOCATE 或 INPUT, OUTPUT 敘述以後,最後游標所在之同一列(或同一行)的指定行(或列)
位置。若省略其它參數, QuickBASIC 會自動使用上次給定的參數值。

注意: 此起始與終止掃描線是 CRT 的掃描線(scan lines)用來指定螢幕上那一個
      圖素(pixel)是亮的。若起始與終止掃描線的範圍較寬時,會產生一個較大的
      游標,例如:游標可以和一個字元區塊一樣大。若起始線小於終止線,則
      LOCATE 敘述會將游標分成兩部份。若起始線有設定,則終止線也必須有指定。


螢幕上最後一行是被保留用來顯示軟鍵(soft-key),而且游標不可存取此行,除非軟鍵
的顯示功能被關閉(使用 KEY OFF 敘述)。同時 LOCATE 被用來與 PRINT 配合來寫到
該行上。


<hr>

<span id="L811A" class="QBtitle">LOCATE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8072">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8119"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOCATE 敘述程式範例</span>

這些範例顯示如何使用 LOCATE 敘述來移動游標,並且從功能表中選項。

以下範例即顯示不同的 LOCATE 敘述對游標的影響:

CLS                       '清螢幕
LOCATE 5, 5               '移動游標至螢幕上第 5 列第 5 行
PRINT "C"
DO
LOOP WHILE INKEY$ = ""    '按任意鍵,繼續...
LOCATE 1,1                '移動游標到螢幕的左上角
PRINT "C"
DO
LOOP WHILE INKEY$ = ""    '按任意鍵,繼續...
LOCATE,,1                 '顯現游標;游標位置保持不變

PRINT "C"
DO
LOOP WHILE INKEY$ = ""    '按任意鍵,繼續...
LOCATE,,,7                '顯現游標及位置均不改變;同時
                          '設定游標的顯示為字元框底端的一條線
                          '其起始及終止掃描線均設為 7
PRINT "C"
DO
LOOP WHILE INKEY$ = ""    '按任意鍵,繼續...
LOCATE 5,1,1,0,7          '將游標移動到螢幕上的第 5 列第 1 行;
                          '且設定游標狀態為顯現;游標的起始與終止掃描線
                          '分別為 0 和 7,其大小蓋過整個字元
PRINT "C"

DO
LOOP WHILE INKEY$ = ""    '按任意鍵,繼續...


以下是一個程式片斷,它在螢幕上顯示一個主功能表,然後在可允許的範圍(1-4)內
等待輸入。若輸入的值超過此範圍,則程式繼續提示您再做一個選擇:

                         <span class="QH_1">------ 注意 -----</span>
         此程式尚未完成。不要在目前形式下執行。
                         <span class="QH_1">-----------------</span>

CONST FALSE=0, TRUE=NOT FALSE
DO
    CLS
    PRINT "主功能表" : PRINT
    PRINT "1)  增加記錄"
    PRINT "2)  顯示/更新/刪除一筆記錄"
    PRINT "3)  列印停留在旅館的旅客清單"
    PRINT "4)  結束程式"
    ' 改變游標成為一個方框
    LOCATE ,,1,1,12
    LOCATE 12,1
    PRINT "請選擇?";
    DO
       CH$ = INPUT$(1)
    LOOP WHILE (CH$ &lt; "1" OR CH$ &gt; "4")
    PRINT CH$

' 呼叫適當的副程式
    SELECT CASE VAL(CH$)
       CASE 1
          CALL Add
       CASE 2
          CALL Search
       CASE 3
          CALL Hotel
       CASE 4
          CALL Quit
    END SELECT
LOOP WHILE NOT ENDPROG
.
.
.
END



<hr>

<span id="L811B" class="QBtitle">LOCK...UNLOCK 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8073">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L811C"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOCK...UNLOCK 敘述細節</span>

<span class="QH_1">語法</span>
  LOCK [#]檔案代碼 [,{記錄 | [起始值] TO 終值}]
  [敘述區段]
  UNLOCK [#]檔案代碼 [,{記錄 | [起始值] TO 終值]

此敘述被使用在有多個處理(processes)須同時存取相同檔案的網路環境中。

  <span class="QH_1">參數         說明</span>
  檔案代碼     此參數表示已經被開啟的檔案代號。

  記\xbf                        <span class="QH_32">                                <span class="QH_32"></span>     </span><span class="QH_32"></span><span class="QH_32"></span><span class="QH_32"></span><span<span class="QH_32"></span> class="QH_32"></span><span clas<span class="QH_32"></span>s="QH_32"></span><span class="QH<span class="QH_32"></span>_32"></span><span class="QH_32"><span class="QH_32"></span></span><span class="QH_32"></spa<span class="QH_32"></span>n>
                               </span><<span class="QH_32">span class="QH_32"></span><span <span class="QH_32"></span>class="QH_32"></span><span class<span class="QH_32"></span>="QH_32"></span><span class="QH_<span class="QH_32"></span>32"></span><span class="QH_32"><<span class="QH_32"></span>/span><span class="QH_32"></span<span class="QH_32"></span>><span class="QH_32"></span><spa<span class="QH_32"></span>n class="QH_32"></span>
                               </span><<span class="QH_32">span class="QH_32"></span><span <span class="QH_32"></span>class="QH_32"></span><span class<span class="QH_32"></span>="QH_32"></span><span class="QH_<span class="QH_32"></span>32"></span><span class="QH_32"><<span class="QH_32"></span>/span><span class="QH_32"></span<span class="QH_32"></span>><span class="QH_32"></span><spa<span class="QH_32"></span>n class="QH_32"></span>
                               </span><span class="QH_198"></span><span class="QH_209"></span><span class="QH_185">
穜N被鎖定或釋放的記錄(record)或位元組數目; E               資料記錄的編號可由 1 到 2,147,483,647(相當於 2^31-1), F               一個資料記錄內可以包含最多到達 32,767 </span><span class="QH_1"></span><span class="QH_<span class="QH_166">161"></span><span class="QH_189"></span><span class="QH_184"></span><span class="QH_170"></span><span class="QH_178"></span><span class="QH_164"></span><span class="QH_166"></span><span class="QH_169"></span><span class="QH_191"></span><span class="QH_164"></span><span class="QH_176"></span><span class="QH_173"></span><span class="QH_164"></span><span class="QH_171"></span><span class="QH_179"></span><span class="QH_170"></span><span class="QH_<span class="QH_178"></span>169"></span><span class="QH_196"></span><span class="QH_169"></span><span class="QH_169"></span><span class="QH_194"></span><span class="QH_179"></span><span class="QH_173"></span><span class="QH_177"></span><span<span class="QH_170"></span> class="QH_165"></span><span class="QH_170"></span><span class="QH_188"></span><span class="QH_176"></span><span class="QH_166"></span><span class="QH_32"></span><span class="QH_32"></sp<span class="QH_170"></span>an><span class="QH_32"></span><span class="QH_32"></span><span class="QH_200"></span><span class="QH_215"></span><span class="QH_32"></span><span class="QH_72"></span><span class="QH_67"></span><span class="QH_88"></span><span class="QH_185"></span<span class="QH_171"></span>><span class="QH_186"></span><span class="QH_213"></span><span class="QH_184"></span><span class="QH_236"></span><span class="QH_206"></span><span class="QH_253"></span><span class="QH_79"></span><span class="QH_211<span class="QH_161"></span>"></span><span class="QH_64"></span><span class="QH_196"></span><sp<span class="QH_1"></span>an</span> class="QH_186"></span><span class="QH_241"></span><span class="QH_192<span class="QH_32">"></span><span class="QH_206"></<span class="QH_176"></span>span><span class="QH_119"></span><span class="QH_234"></span><span class="QH_81"></span><span c<span class="QH_169"></span>lass="QH_110"></span><span class="QH_78"></span><span class="QH_220"></span><span class="QH_237"></span><spa<span class="QH_173"></span>n class="QH_198"></span><span class="QH_209"></span><span class="QH_185"></span><span class="QH_32"></span><span class="QH_32"></span><span class="QH_32"></span><span class="QH_32"></span>

對二進位模式的檔案 : 記錄,起始值及終值等三個參數代表相對於檔案起始位置的
                     位元組數目。在檔案中第一個位元組是位元組 1。

對隨機存取的檔案   : 記錄,起始值及終值等參數表示相對於檔案起始位置的第 n 個
                     記錄。第一個記錄為記錄 1。

LOCK 及 UNLOCK 敘述通常是成對使用,當使用 LOCK 及 UNLOCK 敘述時,其參數必須互相
正確的匹配。請參閱以下第二個例子。

假若您只是指定一個記錄,則只有該筆記錄被鎖定或釋放。假若您是指定一個記錄的範圍
且省略起始記錄(即起始值參數),則由第一個記錄到此範圍最後一個記錄(終值參數)將被
鎖定或釋放。LOCK 敘述不加任何參數則鎖定整個檔案,當 UNLOCK 敘述不加任何參數,則
會釋放整個檔案。

如果所開啟的檔案為循序輸入或輸出,則 LOCK 及 UNLOCK 敘述會影響整個檔案,而與指定
範圍的起始值或終值參數無關。LOCK 及 UNLOCK 敘述只能用在提供網路的 DOS 版本上
(3.1 版或更高),而且每部終端機(或網路設定程式)必須執行 DOS 的 SHARE.EXE 程式來
啟動鎖定處理。若 LOCK 和 UNLOCK 被執行時, 較早期版本的 DOS 會傳回一個 "進一步
的功能不可使用" 錯誤訊息。

  注意: 需確定在檔案關閉或程式結束之前,有使用 UNLOCK 敘述釋放所有被鎖定的
        資料,若釋放鎖定失敗時,則會發生難以預測的結果。LOCK 及 UNLOCK 兩者
        的參數必須是正確的配合。

假如試圖存取一個已被鎖定的檔案,將會發生下列的錯誤訊息:

  "錯誤記錄號碼"
  "不被允許"



<hr>

<span id="L811C" class="QBtitle">LOCK...UNLOCK 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8073">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L811B"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOCK...UNLOCK 敘述程式範例</span>

下例說明如何在網路環境中使用 LOCK 和 UNLOCK 敘述,使得數個處理(processes)
能同時存取同一個檔案。此例所設定的為一個隨機存取檔案。

                    <span class="QH_1">------ 注意 -----</span>
    此範例並未完成。不可在目前的型式下執行
                    <span class="QH_1">-----------------</span>

底下的敘述鎖定檔案代號為 2 的整個檔案:

  LOCK #2

底下的敘述鎖定檔案代碼為 2 的第 32 筆記錄:

  LOCK #2, 32

底下的敘述鎖定檔案代碼為 2 的第 1 - 32 筆記錄:

  LOCK #2, TO 32

此兩個 UNLOCK 敘述用來釋放先前兩個用 LOCK 敘述鎖定的記錄:

  LOCK #1, 1 TO 4
  LOCK #1, 5 TO 8
  UNLOCK #1, 1 TO 4
  UNLOCK #1, 5 TO 8

底下的 UNLOCK 敘述是不合法的,因為 UNLOCK 敘述所設定的範圍必須完全正確的
與 LOCK 敘述配合(不會有錯誤回應,但會產生不可預期的結果):


  LOCK #1, 1 TO 4
  LOCK #1, 5 TO 8
  UNLOCK #1, 1 TO 8

底下程式片斷是開啟一個檔案,且允許使用者在更新記錄之前鎖定該筆記錄。當使用者
處理完以後,程式自動釋放被鎖定的記錄。(釋放被鎖定的記錄,可以允許其它的處理
可以使用檔案中的資料。)


TYPE AccountRec
   Payer AS STRING * 15
   Address AS STRING * 20
   Place AS STRING * 20
   Owe AS SINGLE
END TYPE
DIM CustRec AS AccountRec

OPEN "MONITOR" SHARED AS #1 LEN = LEN(CustRec)

DO
   CLS: LOCATE 10,10
   INPUT "客戶代號 ?   #"; Number%
   ' 鎖定目前記錄,所以當使用此筆記錄時,另外的處理便無法改變此筆記錄。
   LOCK #1, Number%
      GET #1, Number%
      LOCATE 11,10: PRINT "客戶 : ";CustRec.Payer
      LOCATE 12,10: PRINT "地址 :  ";CustRec.Address
      LOCATE 13,10: PRINT "目前負債 : $";CustRec.Owe
      LOCATE 15,10: INPUT "變更 (+ or -)", Change!
      CustRec.Owe = CustRec.Owe + Change!
      PUT #1, Number%
   ' 釋放此記錄
   UNLOCK #1, Number%
   LOCATE 17,10: INPUT "是否更新其它 ? ", Continue$
   Update$ = UCASE$(LEFT$(Continue$,1))
LOOP WHILE Update$ = "Y"



<hr>

<span id="L811D" class="QBtitle">LOF 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8074">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L811E"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOF 函數細節</span>

<span class="QH_1">語法</span>
  LOF(檔案代碼)

檔案代碼參數表示在 OPEN 敘述中所使用的檔案代號。

一個檔案以任意模式開啟時, LOF 函數會傳回該檔案以位元組為單位的大小。

LOF 不能使用在 SCRN:, KYBD:, CONS:, LPTn: 的 BASIC 裝置(device)上,當使用
OPEN COM 敘述打開一個裝置當作一個檔案時, LOF 函數會傳回在輸出緩衝區中所
剩餘的位元組數目。



<hr>

<span id="L811E" class="QBtitle">LOF 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8074">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L811D"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

可參閱<span class="QH_2">&lt;</span><a href="#L80E4">GET(檔案的輸入/輸出) 敘述程式範例</a><span class="QH_2">&gt;</span> 有使用 LOF 函數。



<hr>

<span id="L811F" class="QBtitle">LOG 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8075">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8120"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOG 函數細節</span>

<span class="QH_1">語法</span>
  LOG(數值運算式)

數值運算式 n 值必須大於零。

此為以 e 為底的自然對數, e 值約等於 2.718282。


LOG 函數都使用單精確度來計算自然對數值, 除非參數 n 為一個倍精確度數值,
在此情況下, LOG 是用倍精確度來計算。

您可以將某數的自然對數值除以 10 之自然對數值來得到以 10 為基底的對數。
以下函數即以 10 為基底,來計算其對數值:

  FUNCTION Log10(X) STATIC
     Log10=LOG(X)/LOG(10.#)
  END FUNCTION



<hr>

<span id="L8120" class="QBtitle">LOG 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8075">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L811F"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LOG 函數程式範例</span>

此範例列出 e 的值,然後印出以 e 的一次方,二次方,三次方為參數所得到的
自然對數值。

CLS                    ' 清螢幕
PRINT EXP(1),
FOR I = 1 TO 3
    PRINT LOG(EXP(1) ^ I),
NEXT

<span class="QH_1">範例輸出</span>

2.718282       .9999999     2             3


<hr>

<span id="L8121" class="QBtitle">LPOS 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8076">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8122"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LPOS 函數細節</span>

<span class="QH_1">語法</span>
  LPOS(n)

參數 n 為要測試的列表機索引值:

  * LPT1: 使用 LPOS(1) 或 LPOS(0) 來測試第一部列表機。
  * LPT2: 使用 LPOS(2) 來測試第二部列表機。
  * LPT3: 使用 LPOS(3) 來測試第三部列表機。

LPOS 函數不需要傳回列表機表頭的實際位置,因為它不會擴大(expand)定位(tab)字元;
此外,有些列表機內還有字元緩衝區。

請參閱 <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D3">使用函數及敘述應注意的事項</a><span class="QH_2">&gt;</span>內有說明 LPOS 在中文版使用時
應注意的事項。


<hr>

<span id="L8122" class="QBtitle">LPOS 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8076">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8121"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LPOS 函數程式範例</span>

此範例提示輸入球隊名稱及各球隊球員姓名,並將球隊及球員姓名送到印表機列印。


CLS                                ' 清螢幕
LPRINT"球隊成員"; TAB(76); "TEAM" : LPRINT
INPUT "有多少球隊"; TEAMS
INPUT "每隊有多少球員";PPT
PRINT
FOR T = 1 TO TEAMS
    INPUT "球隊名稱: ", TEAM$
    FOR P = 1 TO PPT
        INPUT " 輸入球員姓名: ", PLAYER$
        LPRINT PLAYER$;
        IF P &lt; PPT THEN
            IF LPOS(0) &gt; 55 THEN     '如果列表機表頭超過第 55 欄
                                     '則印出一空行
                LPRINT : LPRINT "     ";
            ELSE
                LPRINT ", ";         '否則印出一個逗號
            END IF
        END IF
    NEXT P
    LPRINT STRING$(80-LPOS(0)-LEN(TEAM$),"."); TEAM$
NEXT T


<hr>

<span id="L8123" class="QBtitle">LPRINT 和 LPRINT USING 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8077">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8124"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LPRINT 和 LPRINT USING 敘述細節</span>

<span class="QH_1">語法 1</span>
  LPRINT [運算式串列][{;|,}]

<span class="QH_1">語法 2</span>
  LPRINT USING 格式字串; 運算式串列[{;|,}]

此二種敘述功能與 PRINT 及 PRINT USING 敘述相同,唯一不同的在於此二種敘述
在輸出資料到列表機時,檔案代碼的選擇項是不被允許的。

LPRINT 敘述預設印表機所能列印的最大寬度為 80 個英文字元。如欲改變此寬度,
可使用 WIDTH LPRINT 敘述。

              <span class="QH_1">-------------   警告  -------------</span>
既然 LPRINT 敘述使用 LPT1 列表機(第一部列表機),您不能在程式中使用 LPRINT 敘述,
並且又包含一個 OPEN LPT1 敘述。若這兩個敘述一起使用時,會產生不可預測之結果。
               <span class="QH_1">----------------------------------</span>

請參閱 <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D3">使用函數及敘述應注意的事項</a><span class="QH_2">&gt;</span>內有說明 LPRINT 在中文版使用時
應注意的事項。

<span class="QH_1">與 BASICA 的差異</span>

如果使用 LPRINT CHR$(13), 則 QuickBASIC 實際上輸出 LPRINT CHR$(13) 和
LPRINT CHR$(10),此特性主要是使 Microsoft BASIC 及 IBM BASICA 可以相容。


<hr>

<span id="L8124" class="QBtitle">LPRINT 和 LPRINT USING 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8077">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8123"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LPRINT 和 LPRINT USING 敘述程式範例</span>

 請參閱 <span class="QH_2">&lt;</span><a href="#L8122">LPOS 函數程式範例</a><span class="QH_2">&gt;</span>,有使用 LPRINT 命令。



<hr>

<span id="L8125" class="QBtitle">LSET 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8078">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8126"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LSET 敘述細節</span>

<span class="QH_1">語法</span>
LSET {字串變數 = 字串運算式 | 字串運算式 1 = 字串運算式 2 }

其中字串變數參數雖然可為任意的字串變數,但通常為隨機存取檔中用 FIELD 敘述
所定義的欄位。字串運算式參數是用來指定給變數的值。

若字串運算式需要的長度小於在 FIELD 敘述中對字串變數所定義的長度,當執行
LSET 敘述時,字串會先向左邊靠齊後,再存到字串變數中(執行 RSET 敘述則字串
會先向右靠齊),空白碼會被使用來填滿空出的位置。反之,若字串運算式的長度
大於 FIELD 敘述所定義的資料長度,則執行 LSET 及 RSET 敘述將右邊多出的
部份刪除,數值必須在執行 LSET 或 REST 敘述之前,先轉成字串。


您也可以使用 LSET 或 RSET 與一個未經 FIELD 敘述定義的字串變數欄位,作向左
對齊或向右對齊。例如,程式行

  A$=SPACE$(20)
  RSET A$=N$

對含有 20 個位元組欄位的字串 N$ 作向右靠齊。此程式對格式化輸出的列印
很有用。

您可以使用 LSET 敘述來指定一個記錄變數(record variable)給其他記錄變數。
下列範例拷貝 RecTwo 的內容給 RecOne :

  TYPE TwoString
     StrFld AS STRING * 2
  END TYPE

  TYPE ThreeString
     StrFld AS STRING * 3
  END TYPE
  DIM RecOne AS TwoString, RecTwo AS ThreeString
  .
  .
  .
  LSET RecOne = RecTwo

注意 LSET 可用來指定不同型態的記錄變數。相同型態的記錄變數可用 LET 來指定。
同時因為 RecOne 僅佔 2 個位元組,所以僅從 RecTwo 拷貝二個位元組而已, LSET
敘述僅拷貝二筆記錄變數中較短的位元組數。




<hr>

<span id="L8126" class="QBtitle">LSET 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8078">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8125"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LSET 敘述程式範例</span>

下列敘述將單精確度數值變數 AMT 轉換成一個含 4 個位元組的字串,並且以向左靠齊
的方式存入 A$ 字串中:

LSET A$ = MKS$(AMT)

相反地,下列敘述將轉換整數數值變數 COUNT%  成為一個含 2 個位元組字串,
並且以向右靠齊方式存入 D$ 字串中:


RSET D$ = MKI$(COUNT%)

  注意: 可查看 LSET 敘述使用在完整的範例程式中。請參閱<span class="QH_2">&lt;</span><a href="#L80A3">CVS 函數程式範例</a><span class="QH_2">&gt;</span>



<hr>

<span id="L8127" class="QBtitle">LTRIM$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807A">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8128"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LTRIM$ 函數細節</span>

<span class="QH_1">語法</span>
  LTRIM$(字串運算式)

字串運算式參數可為任何的字串運算式。


<hr>

<span id="L8128" class="QBtitle">LTRIM$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807A">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8127"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">LTRIM$ 函數程式範例</span>

下列範例拷貝一個檔案到一個新檔中,拷貝時將移掉每行所有的前置/後置空白字元。

               <span class="QH_1">--------- 注意 ---------</span>
        執行此範例,您必須提供一個已存在的本文檔。
               <span class="QH_1">------------------------</span>

CLS                          ' 清除螢幕
' 讀取檔名
INPUT "鍵入輸入檔案的名稱 :", InFile$
INPUT "鍵入輸出檔案的名稱 :", OutFile$

OPEN InFile$ FOR INPUT AS #1
OPEN OutFile$ FOR OUTPUT AS #2

' 讀入,刪改及寫入每一行
DO WHILE NOT EOF(1)
   LINE INPUT #1, LineIn$
   ' 刪除前置和後置的空白
   LineIn$ = LTRIM$(RTRIM$(LineIn$))
   PRINT #2, LineIn$
LOOP

CLOSE #1, #2

END


<hr>

<span id="L8129" class="QBtitle">MID$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L8045">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L812A"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MID$ 函數細節</span>

<span class="QH_1">語法</span>
  MID$(字串運算式, 起始 [,長度])

  <span class="QH_1">參數               說明</span>
  字串運算式         將要被截取成子字串的母字串運算式。
                     它可為任何的字串運算式。

  起始               在字串運算式中要被截取成子字串的起始位元組位置。

  長度               為所要被截取的位元組總數目。

起始和長度兩個參數必須介於 1 到 32,767 之間。假如省略長度參數,或長度參數
大於自第 n 個位元組到最後所剩下位元組的長度,則傳回自起始位元組起,到最右邊
的所有位元組。

若起始值大於在字串運算式中位元組的數目,則 MID$ 會傳回一個空字串。

可以使用 LEN 函數來得到在字串運算式中位元組的總數目。


<hr>

<span id="L812A" class="QBtitle">MID$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8045">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8129"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MID$ 函數程式範例</span>

本範例將一個二進制數值轉換成一個十進制數值。
此程式使用 MID$ 函數從二進制數字(以字串方式輸入)截取位數。

CLS    ' 清除螢幕
INPUT "二進制數  = ", Binary$  '以字串方式輸入二進制數
Length = LEN(Binary$)          '取得字串的長度
Decimal = 0
FOR K = 1 TO Length
   '由左向右從字串中取得每一位數
   Digit$ = MID$(Binary$, K, 1)
   '測試有效的二進制數
   IF Digit$ = "0" OR Digit$ = "1" THEN
      '轉換字元數字成為數值
      Decimal = 2 * Decimal + VAL(Digit$)
   ELSE
      PRINT "錯誤 -- 不合法的二進制數: "; Digit$
      EXIT FOR
   END IF
NEXT
PRINT " 十進制數  =" Decimal

<span class="QH_1">輸出</span>

二進制數  = 10110
十進制數  = 22


<hr>

<span id="L812B" class="QBtitle">MID$ 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807B">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L812C"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MID$ 敘述細節</span>

<span class="QH_1">語法</span>
  MID$(字串變數, 起始 [,長度])=字串運算式

  <span class="QH_1">參數               說明</span>
  字串變數           為將被修改的字串變數。

  起始               為一個數值運算式,表示字串變數要被取代的起始位置
                     (以 "位元組" 為計算的單位)。

  長度               被取代字串的長度。此長度參數為一數值運算式。
                     表示字串運算式中被拿來作取代的位元組個數。

  字串運算式         字串運算式用來取代字串變數參數中的部份字串。

起始和長度參數為整數運算式。字串變數參數為一字串變數,但字串運算式可為一個
字串變數,字串常數,或字串運算式。

假如省略長度參數,字串運算式中的所有位元組皆被使用。無論如何,不管長度參數
省略與否,取代的位元組絕不會超過原來字串變數內的字串長度。


<hr>

<span id="L812C" class="QBtitle">MID$ 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807B">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L812B"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MID$ 敘述程式範例</span>

下列範例使用 MID$ 敘述來取代字串字元。

CLS                        ' 清除螢幕
Test$ = "Paris, France"
PRINT Test$
MID$(Test$, 8)="Texas "    ' 由位置 8 開始,用 Texas 來代替在 Test$ 中的字元
PRINT Test$

<span class="QH_1">範例輸出</span>

Paris, France
Paris, Texas


<hr>

<span id="L812D" class="QBtitle">MKDIR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807C">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L812E"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MKDIR 敘述細節</span>

<span class="QH_1">語法</span>
  MKDIR 路徑名稱

路徑名稱是一個字串運算式,用來指定要被建立的目錄名稱。路徑名稱必須是
小於 128 個英文字元的字串。

MKDIR 敘述與 DOS 中 MKDIR 命令類似; 但在 BASIC 下的語法不能像在 DOS 之下
使用簡寫的 MD。


<hr>

<span id="L812E" class="QBtitle">MKDIR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807C">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L812D"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MKDIR 敘述程式範例</span>

本範例建立一個子目錄,並且在該目錄下建立或拷貝一個檔案:

CLS                     ' 清除螢幕
PRINT "本程式建立名稱為 MONTHS 的子目錄,"
PRINT "然後在該目錄產生或拷貝一個檔案。"
PRINT
MKDIR "MONTHS"
INPUT "檔名"; File$
IF File$ = "" THEN END
OPEN "MONTHS\" + File$ FOR OUTPUT AS #1
PRINT "您已經建立"; File$; " 在 MONTHS 目錄下"
CLOSE #1


<hr>

<span id="L812F" class="QBtitle">MKSMBF$ 和 MKDMBF$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807D">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8130"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MKSMBF$ 和 MKDMBF$ 函數細節</span>

<span class="QH_1">語法</span>
  MKSMBF$(單精確度運算式)
  MKDMBF$(倍精確度運算式)

這些函數被用來將實數(real numbers)寫入到 Microsoft 二進位格式的隨機存取檔內。
這些函數特別用來維護 BASIC 早期版本所建立的資料檔。

MKSMBF$ 和 MKDMBF$ 函數轉換 IEEE-格式 的實數為字串,如此才可寫入隨機存取檔。

將實數以 Microsoft 二進位格式寫入隨機存取檔中,可以使用 MKSMBF$(單精確度適用)
或 MKDMBF$ 函數(倍精確度適用)來轉換數字成為字串,然後將結果儲存到對應的欄位內
(用 FIELD 敘述定義),並使用 PUT 敘述將該記錄(record)寫入檔案。



<hr>

<span id="L8130" class="QBtitle">MKSMBF$ 和 MKDMBF$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807D">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L812F"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MKSMBF$ 和 MKDMBF$ 函數程式範例</span>

下列範例使用 MKSMBF$ 將實數值以 Microsoft 二進位格式儲存在檔案中。

' 從終端機讀取姓名和成績
' 將單精確度的成績值,以 Microsoft 二進位格式存入隨機檔案的記錄中。

TYPE Buffer
   NameField AS STRING * 20
   ScoreField AS STRING * 4
END TYPE

DIM RecBuffer AS Buffer
OPEN "TESTDAT.DAT" FOR RANDOM AS #1 LEN=LEN(RecBuffer)
'
PRINT "請輸入姓名和測試成績,以逗號來分開。"
PRINT "輸入 'END, 0' 時,則結束。"
INPUT NameIn$, Score
'
I=0
' 從終端機讀取一組姓名與測試的成績,直到在姓名處輸入 END 為止。
DO WHILE UCASE$(NameIn$) &lt;&gt; "END"
   I=I+1
   RecBuffer.NameField=NameIn$
'
' 轉換成績成為一個字串
   RecBuffer.ScoreField=MKSMBF$(Score)
   PUT #1,I,RecBuffer
   INPUT NameIn$, Score
LOOP
'
PRINT I;" 筆記錄己寫入。"
CLOSE #1


<hr>

<span id="L8131" class="QBtitle">MKD$, MKI$, MKL$, 與 MKS$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807E">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8132"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">MKD$, MKI$, MKL$, 與 MKS$ 函數細節</span>

<span class="QH_1">語法</span>
  MKI$(整數運算式)
  MKS$(單精確度運算式)
  MKL$(長整數運算式)
  MKD$(倍精確度運算式)

MKI$, MKS$, MKL$, 和 MKD$ 函數與 FIELD 及 PUT 敘述配合使用,用來將實數
(real numbers)寫入到隨機存取檔中。這些函數將數值運算式轉換成字串,並儲存在
FIELD 敘述所定義的字串變數內。這些函數與 CVI, CVS, CVL, 和 CVD 函數相反。


  <span class="QH_1">函數       說明</span>
  MKI$       將一個整數轉換成一個含 2 個位元組長度的字串。
  MKS$       將一個單精確度轉換成一個含 4 個位元組長度的字串。
  MKL$       將一個長整數轉換成一個含 4 個位元組長度的字串。
  MKD$       將一個倍精確度轉換成一個含 8 個位元組長度的字串。

  注意: BASIC 記錄變數提供一個更有效率且方便的方法來讀取和寫入隨機存取檔。


<hr>

<span id="L8132" class="QBtitle">MKD$, MKI$, MKL$, 和 MKS$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L807E">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8131"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

 請參閱<span class="QH_2">&lt;</span><a href="#L80A3"> CVI, CVS, CVL, CVD 敘述的程式範例</a><span class="QH_2">&gt;</span>,有使用 MKS$ 函數。



<hr>

<span id="L8133" class="QBtitle">NAME 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8080">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8134"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">NAME 敘述細節</span>

<span class="QH_1">語法</span>
  NAME 舊檔名 AS 新檔名

NAME 敘述類似 DOS RENAME 命令。NAME 敘述可以將一個目錄下的一個檔案搬移到
另一個目錄下,但不能對目錄作搬移。

舊檔名及新檔名參數皆為字串運算式,其中每一參數包含一個檔名或目錄名稱,及一個
可以選擇的路徑名稱。假如在新檔名中的路徑不同於舊檔名的路徑,則 NAME 敘述會
更改路徑名稱如同新檔名中所指定的路徑名稱。

舊檔名必須存在,且新檔名必須不是正在使用的檔案。兩個檔案必須在同一磁碟機中。
使用 NAME 敘述,其中舊檔名與新檔名在不同的磁碟機中將會產生 "檔案重新命名跨越
磁碟機" 錯誤訊息。

NAME 敘述執行後,檔案會存在相同的磁碟機,且佔用相同的磁碟空間,但以新名稱為該
檔案的檔名。

使用 NAME 敘述在一個已開啟的檔案時,會導致執行期間(run-time) "檔案已開啟" 的
錯誤訊息。在重新命名之前必須先關閉已開啟的檔案。



<hr>

<span id="L8134" class="QBtitle">NAME 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8080">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8133"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">NAME 敘述程式範例</span>

本範例顯示如何使用 NAME 敘述來重新命名 README.DOS 檔

CLS    ' 清除螢幕
'更改 README.DOC 成為 READMINE.DOC
NAME "README.DOC" AS "READMINE.DOC"
FILES  ' 顯示在目錄中的檔案,以確定名稱是否已被修改。
PRINT
PRINT "README.DOC 現在被更名為 READMINE.DOC"
PRINT "請按任意鍵,繼續..."
DO
LOOP WHILE INKEY$ = ""
'將檔名還原成 README.DOC 並將檔案顯示以確認之
NAME "READMINE.DOC" AS "README.DOC"
FILES
PRINT
PRINT "README.DOC 已被還原成原來的檔名"

  秘訣: 您也可以使用 NAME 敘述從一個目錄下搬移一個檔案
        到另一個目錄下。您可以使用下列敘述將 README.DOC
        搬移到 \MYDIR 目錄下 :

        NAME "README.DOC" AS "\MYDIR\README.DOC"



<hr>

<span id="L8135" class="QBtitle">OCT$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8083">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8136"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OCT$ 函數細節</span>

<span class="QH_1">語法</span>
  OCT$(數值運算式)

可為任意型態的數值運算式。在 OCT$ 函數計算之前會將數值運算式作四捨五入後,
成為一個整數或長整數。



<hr>

<span id="L8136" class="QBtitle">OCT$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8083">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8135"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OCT$ 函數程式範例</span>

本範例顯示將多個十進制數值轉換成八進制數值。

PRINT "十進制 24, 其八進制為 :" OCT$(24)
PRINT "十進制 55, 其八進制為 :" OCT$(55)
PRINT "十進制 101, 其八進制為 :" OCT$(101)

<span class="QH_1">範例輸出</span>

十進制 24, 其八進制為 : 30
十進制 55, 其八進制為 : 67
十進制 101, 其八進制為 : 145


<hr>

<span id="L8137" class="QBtitle">ON...GOSUB 和 ON...GOTO 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8047">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8138"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON...GOSUB 和 ON...GOTO 敘述細節</span>

<span class="QH_1">語法 1</span>
  ON 運算式 GOSUB {行號串列 | 行標記串列 }

<span class="QH_1">語法 2</span>
  on 運算式 GOTO {行號串列 | 行標記串列 }

運算式參數可為任何的數值運算式(此運算式在 ON...GOSUB 或 ON...GOTO 執行之前就
先四捨五入為整數);行號串列或行標記串列是由行號或行標記,且中間以逗號分隔的串列
所組成。運算式的值決定程式中將分歧到那一行,例如:若運算式之值為 3, 則表示分歧
到串列上的第 3 個所指定的行號或行標記。

運算式的值應大於或等於 1 ,而且要小於或等於串列上項目的個數。
假如該值落到此範圍之外,其結果可能為下列情形之一:

  <span class="QH_1">值                             結果</span>
  數值等於 0, 或大於             執行 BASIC 的下一個敘述
  串列上項目的數目

  負值,或數值大於 255            產生 "不正確的函數呼叫" 錯誤訊息


您可以在同一個串列上混合使用行號及行標記。

  注意: ON...GOTO 敘述,在一串列上允許至多 60 個行標記或行號。SELECT CASE 敘述
        提供一個功能更強,更方便且更有彈性的方法來執行多行分歧的動作。


<hr>

<span id="L8138" class="QBtitle">ON...GOSUB 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8047">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8137"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON...GOSUB 敘述程式範例</span>

下列程式片斷根據 Chval 的值來決定控制權要分歧到 4 個所列的次常式中的那一個:

DO
    CLS
    PRINT "1) 顯示會議出席人數"
    PRINT "2) 計算註冊費用總額"
    PRINT "3) 列印郵寄清單"
    PRINT "4) 程式結束"
    PRINT : PRINT "請選擇?"
    DO
       Ch$=INKEY$
    LOOP WHILE Ch$=""
    Chval = VAL(Ch$)
    IF Chval &gt; 0 AND Chval &lt; 5 THEN
        ON Chval GOSUB Shop, Fees, Mailer, Progend
    END IF
LOOP
END


<hr>

<span id="L8139" class="QBtitle">ON ERROR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8046">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L813A"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON ERROR 敘述細節</span>

<span class="QH_1">語法</span>
  ON ERROR GOTO 行

行參數必須是在錯誤處理常式(error-handling routine)中第一行的行標記或行號,
此行必須出現在模組層次碼中。

假如行參數在發生錯誤的模組中找不到,或者沒有 ON ERROR GOTO 敘述,則會回溯到
原來呼叫 "此發生錯誤的模組" 的先前模組內搜尋。若發現了一個有效的錯誤處理
常式,則會使用它。若沒有發現有效的錯誤處理常式,則列印錯誤訊息,並停止程式
的執行。其所指定的錯誤訊息會與發生錯誤的型態有關。

僅在呼叫路徑中的模組才會被搜尋;即使沒有有效的錯誤處理常式在該搜尋路徑中,
也不會搜尋該路徑以外的模組。

行號為 0 時,會取消錯誤處理常式,因此不可以指定行號 0 當作錯誤處理常式的開頭,
即使程式中有包含一個為零的行號。若發生錯誤時會列印錯誤訊息,並停止執行程式。
一旦錯誤處理常式被啟動,若有錯誤發生時將會被設陷,並將程式分歧到所指定的錯誤
處理常式中。

在錯誤處理常式的內部,執行到一個使用行號 0 的 ON ERROR 敘述,會停止程式
之執行,並列印導致該設陷錯誤之錯誤訊息。這是一個方便的方法使錯誤發生時
可以停止程式的執行,但卻無法透過錯誤處理常式來處理。

注意: 錯誤處理常式並不是一個 SUB 或 FUNCTION 程序式 或 DEF FN 函數,
      而是由行標記,或行號所標記的模組區段碼(module block of code)。

SUB 或 FUNCTION 程序式及 DEF FN 函數中,可包含他們自己的錯誤處理常式。
這些錯誤處理必須放在最後可執行敘述之後,但需在 END SUB, END FUNCTION,
或 END DEF 敘述之前。在沒有錯誤發生時,為了避免錯誤處理常式被執行,在
錯誤處理常式的前面必須使用 EXIT SUB, EXIT FUNCTION, 或 EXIT DEF 敘述
來結束處理。如下面的範例:

SUB InitializeMatrix (var1, var2, var3, var4)
      .
      .
      .
   ON ERR GOTO ErrorHandler
      .
      .
      .
   EXIT SUB

   ErrorHandler:
      .
      .
      .
   RETURN

END SUB

  注意: 若錯誤發生在錯誤處理常式中將不被設陷。這類錯誤在列印錯誤訊息之後,
        會停止程式執行。


<hr>

<span id="L813A" class="QBtitle">ON ERROR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8046">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8139"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON ERROR 敘述程式範例</span>

下列程式由使用者輸入檔名,並顯示該檔案在螢幕上。假如檔案無法開啟,則錯誤處理
常式會對此錯誤作設陷,並再次啟動該程式和提示輸入檔名。

DEFINT A-Z

' 建立錯誤處理常式
ON ERROR GOTO ErrorHandler

CLS
' 讀取檔名
INPUT "請輸入所要顯示的檔名 : ",filename$
' 開啟檔案
OPEN filename$ FOR INPUT AS #1

' 在螢幕上顯示該檔案
DO WHILE NOT EOF(1)
   LINE INPUT #1, aline$
   PRINT aline$
LOOP
END
'
' 錯誤處理常式僅對 "錯誤檔名" 做處理;其他的錯誤則中止處理。
'
CONST BADFILENAME = 53

ErrorHandler:
   IF ERR = BADFILENAME THEN
      ' 讀取其他檔名
      PRINT "檔案 " UCASE$(filename$) " 找不到"
      INPUT "請輸入所要顯示的檔名 : ",filename$
      RESUME
   ELSE
      ' 有其他錯誤時,則列印訊息並中止。
      PRINT "無法恢復的錯誤 --"; ERR
      ON ERROR GOTO 0
   END IF


<hr>

<span id="L813B" class="QBtitle">ON 事件 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L813C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L813D"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON 事件</span> - 為一事件設陷敘述,指示一個事件設陷常式(event-trapping routine)
          的第一行。

<span class="QH_1">語法</span>
  ON 事件 GOSUB {行號 | 行標記}
    * 事件參數,為一關鍵字,用來棟識所要設陷的事件。
    * 行標記或行號參數,是事件設陷常式的第一行。

  <span class="QH_1">ON 事件的敘述種類            事件被設陷的型態</span>
  <span class="QH_2">&lt;</span><a href="#L813E">ON COM(n)</a><span class="QH_2">&gt;</span>                  在通訊埠(port)上接收字元。
  <span class="QH_2">&lt;</span><a href="#L813F">ON KEY(n)</a><span class="QH_2">&gt;</span>                  在鍵 n 上按鍵。
  <span class="QH_2">&lt;</span><a href="#L8140">ON PEN</a><span class="QH_2">&gt;</span>                     使光筆動作。
  <span class="QH_2">&lt;</span><a href="#L8141">ON PLAY(n)</a><span class="QH_2">&gt;</span>                 在背景音樂緩衝區中少於 n 個音符。
  <span class="QH_2">&lt;</span><a href="#L8142">ON STRIG(n)</a><span class="QH_2">&gt;</span>                在搖捍按鈕 n 上動作。
  <span class="QH_2">&lt;</span><a href="#L8143">ON TIMER(n)</a><span class="QH_2">&gt;</span>                時間己過(elapsed time)的事件。

<span class="QH_1">參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8030">COM(n) ON</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L8042">KEY(n) ON</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808F">PEN ON</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="#L804C">PLAY ON</a><span class="QH_2">&gt;</span>
      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B8">STRIG ON</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C0">TIMER ON</a><span class="QH_2">&gt;</span>


<hr>

<span id="L813C" class="QBtitle">ON 事件 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L813B">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L813D"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON 事件 敘述細節</span>

ON 事件敘述讓您在一個指定的裝置(device)上,當一個事件發生時去執行一個指定的
次常式(subroutine)。

<span class="QH_1">語法</span>
  ON 事件 GOSUB {行號 | 行標記}

  <span class="QH_1">參數         說明</span>
  事件         為一個關鍵字,用來指定事件發生時,程式會分歧到該事件的設陷
               常式(event-trapping routine)上。一個事件是一個指定裝置上
               的一個狀況,事件有下列幾種:

                 COM    在通訊埠(port)上接收字元。
                 KEY    一個指定的按鍵。
                 PEN    光筆啟動。
                 PLAY   存在背景音樂佇列(Queue)中的音符數少於 n 個音符。
                 STRIG  觸動搖桿按鈕。
                 TIMER  時間間隔(time interval)己過。

  行號         為事件設陷常式中第一行的行號或行標記。
  或           此行必須在模組層次碼中。
  行標記

      注意: 行號為 0 表示關閉(disables)事件設陷,因此不能指定行號 0 當作
            次常式的開始。

"ON 事件" 敘述僅用來指定一個事件設陷次常式的起始位置。下面一組敘述用來決定
是否呼叫事件設陷次常式。這組敘述可打開或關閉事件設陷,並決定當設陷關閉時如何
處理事件。下列清單說明這些敘述的一般用法。

  <span class="QH_1">事件         說明</span>
  事件 ON      用來開啟(enable)事件設陷。事件設陷僅發生在 "事件 ON" 敘述
               被執行之後。

  事件 OFF     用來關閉(disable)事件設陷。直到另外一 "事件 ON" 敘述被執行
               後,才有設陷事件發生。當設陷被關閉時,若有事件發生皆會被忽略。

  事件 STOP    用來暫停(inhibit)事件設陷,因此沒有設陷事件發生,一直到一個
               "事件 ON" 敘述被執行時,才有作用。當設陷暫停時,所發生的設陷
               將會被記錄,並且當一個 "事件 ON" 敘述被執行時,立刻會被處理。

  關於這些敘述的個別說明資訊,請參閱 :
    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8030">COM 敘述</a><span class="QH_2">&gt;</span>,
    <span class="QH_2">&lt;</span><a href="#L8042">KEY 敘述</a><span class="QH_2">&gt;</span>,
    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808F">PEN 敘述</a><span class="QH_2">&gt;</span>,
    <span class="QH_2">&lt;</span><a href="#L804C">PLAY 敘述</a><span class="QH_2">&gt;</span>,
    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B8">STRIG 敘述</a><span class="QH_2">&gt;</span>, 或
    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C0">TIMER 敘述</a><span class="QH_2">&gt;</span>。

當一個設陷事件發生時(次常式被呼叫), BASIC 會自動執行一個 "事件 STOP"敘述,
以避免遞迴(recursion)設陷。除非在次常式內部中有執行一個明確的 "事件 OFF"
敘述,否則在設陷次常式(event-trapping subroutine)中的 RETURN 敘述會自動執行
"事件 ON" 敘述。

  注意: 因為有內顯(implicit)的 "事件 STOP" 和 "事件 ON" 敘述,所以假如有
        另一事件發生在目前的設陷次常式正在執行時,則該事件會被記錄,然後
        在目前的設陷次常式結束時,就會處理它。

RETURN 後面加上行號或行標記,可用來從設陷次常式回到指定的行編號。

請小心使用此型態的 RETURN 敘述,因為 :

  * 任何 GOSUB, WHILE,或 FOR 敘述在設陷期間仍然有效,因此,可能會產生如 :
    "NEXT 敘述沒有對應的 FOR 敘述" 錯誤訊息。

  * 假如事件發生在程序式中,則 RETURN 行號或 RETURN 行標記 敘述無法回到
    該程序式,因為行號或行標記必須使用在模組層次碼中。


<span class="QH_1">與 BASICA 的差異</span>

QuickBASIC 假如在 DOS 提示符號下使用 BC 命令行,同時在一個程式中若有包含
"ON 事件" 敘述,則必須使用 /V 或 /W 選擇項。這些選擇項允許編譯器(Compiler)
將事件設陷次常式,含入到一個程式中,使其能夠正確地運作。在 BASICA 則不需要
這些額外的選擇項。


<hr>

<span id="L813D" class="QBtitle">ON 事件 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L813B">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L813C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON 事件 敘述程式範例</span>

下列程式範例顯示如何整合 "ON 事件" 敘述,啟動設陷敘述及事件處理次常式
(event-handling subroutine)成為一個可運作的程式:

  <span class="QH_2">&lt;</span><a href="#L814D">ON PLAY(n) 敘述程式範例</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L814F">ON TIMER(n) 敘述程式範例</a><span class="QH_2">&gt;</span>


<hr>

<span id="L813E" class="QBtitle">ON COM(n) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8144"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L814A"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON COM(n)</span> - 為一事件設陷敘述,當在通訊埠(port) n 中接收到字元時,
            用來指定所要分歧到的次常式。

<span class="QH_1">語法</span>
  ON COM(n) GOSUB {行標記 | 行號}

    * n 為一個整數運算式,它代表串列埠(serial ports) 1 或 2 。
    * 行標記或行號,為事件處理次常式(event-handling subroutine)的第一行。


<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8030">COM(n) ON</a><span class="QH_2">&gt;</span>


<hr>

<span id="L813F" class="QBtitle">ON KEY(n) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8145"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L814B"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON KEY(n)</span> - 為一事件設陷敘述,當鍵 n 被按下時,用來指定所要分歧到的次常式。

<span class="QH_1">語法</span>
  ON KEY(n) GOSUB {行標記 | 行號}

    * n, 為一個整數運算式,可以為功能鍵,方向鍵或使用者自定鍵的代碼。
    * 行標記或行號,是事件處理次常式(event-handling subroutine)的第一行。


<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L8042">KEY(n) ON</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8069">KEY(n)</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8140" class="QBtitle">ON PEN 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8146"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L814C"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON PEN</span> - 為一事件設陷敘述,當光筆被啟動(activated)時,用來指定所要分歧到的
          次常式。

<span class="QH_1">語法</span>
  ON PEN GOSUB {行號|行標記}
    * 行標記或行號為事件處理次常式(event-handling subroutine)的第一行。


<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808F">PEN ON</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8141" class="QBtitle">ON PLAY(n) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8147"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L814D"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON PLAY(n)</span> - 為一事件設陷敘述,當在音樂佇列(Queue)中的音符太少時,
             用來指定所要分歧到的次常式(subroutine)。

<span class="QH_1">語法</span>
  ON PLAY(佇列限制) GOSUB {行標記 | 行號}
    * 佇列限制為一整數運算式,是指定保留在背景音樂佇列(介於 1 到 32 之間)
      中所需要最少的音符數日。
    * 行標記或行號是當在音樂緩衝區中的音符數目少於 "從佇列限制參數到
      佇列限制參數減 1 時",就會分歧到事件處理常式(event-handling routine)
      的第一行。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="#L804C">PLAY ON, PLAY OFF, PLAY STOP</a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8090">PLAY</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8142" class="QBtitle">ON STRIG(n) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8148"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L814E"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON STRIG(n)</span> - 為一事件設陷敘述,當搖桿按鈕 n 被觸動(triggered)時,
              用來分歧到所指定的次常式。

<span class="QH_1">語法</span>
  ON STRIG(n) GOSUB {行標記 | 行號 }
    * n, 為一整數運算式,是一個按鈕選擇值:
      0 = 第一個搖桿(搖桿 A)的下按鈕      2 = 第二個搖桿(搖桿 B)的下按鈕
      4 = 第一個搖桿(搖桿 A)的上按鈕      6 = 第二個搖桿(搖桿 B)的上按鈕
    * 行標記或行號,是當按鈕按下時,就會分歧到的事件處理次常式
      (event-handling subroutine)的第一行。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B8">STRIG ON</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8143" class="QBtitle">ON TIMER(n) 敘述 Quick 畫面</span>
  <span class="QH_1">&lt;Quick 畫面&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8149"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L814F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON TIMER(n)</span> - 為一事件設陷敘述,當 n 秒過去之後,用來指定所要分歧到的
              次常式。

<span class="QH_1">語法</span>
  ON TIMER(n) GOSUB {行標記 | 行號}　　　　　　　　　
    * n, 為整數運算式,其值介於 1 和 86,400 之間,用來表示時間間隔
      (time interval)的秒數。
    * 行標記或行號,是當時間消耗掉時,就會分歧到所指定的事件處理次常式
      (event-handling subroutine)的第一行。

<span class="QH_1">可參閱</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C0">TIMER ON</a><span class="QH_2">&gt;</span>


<hr>

<span id="L8144" class="QBtitle">ON COM(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L813E">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L814A"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON COM(n) 敘述細節</span>

<span class="QH_1">語法</span>
  ON COM(n) GOSUB {行標記 | 行號}

假如程式使用非同步通訊轉接器(asynchronous communications adapter)來接收資料,
則 BASIC 命令行的選擇項 /C 可用來設定資料緩衝區的大小。


<hr>

<span id="L8145" class="QBtitle">ON KEY(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L813F">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L814B"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON KEY(n) 敘述細節</span>

<span class="QH_1">語法</span>
  ON KEY(n) GOSUB {行標記 | 行號}

按鍵的處理順序如下所示:

  1. 首先先處理列表機的回應切換鍵(echo-toggle key),假如有定義該鍵為
     使用者自定鍵時,該按鍵的設陷不會避免字元回應到列表機上。

  2. 其次,檢查功能鍵及游標方向鍵,因為這些鍵已經事先被定義好,所以將
     功能鍵或方向鍵定義為使用者自定鍵時,該按鍵的設陷不會有作用。

ON KEY 敘述可以對任何鍵作設陷,包括 "中斷"(BREAK) 或 "系統重置"。如此可以
防止一個程式意外中斷或重新啟動機器。

  注意: 當一個鍵被設陷以後,該鍵的按鍵事件就被破壞。也就是說您無法再接著使用
        INPUT 或 INKEY$ 敘述來找出當時是那一個鍵導致此設陷。因為沒有方法
        可以知道那一個鍵被按下時,所導致分歧到對應的設陷;如果您想要指定不同
        的功能對應到特定的鍵,必須對每一個鍵建立其對應的次常式(subroutine)。


<hr>

<span id="L8146" class="QBtitle">ON PEN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8140">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L814C"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON PEN 敘述細節</span>

<span class="QH_1">語法</span>
  ON PEN GOSUB {行標記 | 行號}

光筆的任一觸動將被設陷。


<hr>

<span id="L8147" class="QBtitle">ON PLAY(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8141">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L814D"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON PLAY(n) 敘述細節</span>

<span class="QH_1">語法</span>
  ON PLAY(佇列限制) GOSUB {行標記 | 行號}

下列三個規則適用 ON PLAY 的用法:

  1. 演奏事件設陷僅發生在演奏背景音樂時。
     但是演奏事件設陷並不發生在執行前景音樂時。

  2. 當 PLAY ON 敘述執行時,若背景音樂佇列(Queue)中的音符數已經少於
     "由佇列限制參數,到佇列限制參數減 1 " 時,一個演奏事件並不會發生。

  3. 假如佇列限制參數的數目很大時,由於事件設陷經常會發生,而導致程式
     執行速度減慢。


<hr>

<span id="L8148" class="QBtitle">ON STRIG(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8142">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L814E"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON STRIG(n) 敘述細節</span>

<span class="QH_1">語法</span>
  ON STRIG(n) GOSUB {行標記 | 行號}

下列是搖桿每一個按鈕所對應的整數值:

  0 = 第一個搖桿(搖桿 A)的下按鈕
  2 = 第二個搖桿(搖桿 B)的下按鈕
  4 = 第一個搖桿(搖桿 A)的上按鈕
  6 = 第二個搖桿(搖桿 B)的上按鈕


<hr>

<span id="L8149" class="QBtitle">ON TIMER(n) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8143">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L814F"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON TIMER(n) 敘述細節</span>

<span class="QH_1">語法</span>
  ON TIMER(n) GOSUB {行標記 | 行號}

對於時間區間(time interval)所能指定的最大秒數, n 是一天 24 小時(86,400)的
秒數。


<hr>

<span id="L814A" class="QBtitle">ON COM(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L813E">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8144"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON COM(n) 敘述程式範例</span>

ON COM (n) 敘述沒有程式範例。

下列程式範例顯示如何整合 "ON 事件" 敘述,啟動設陷的敘述,與事件處理次常式
(event-handling subroutine)成為一個可運作的程式:

  <span class="QH_2">&lt;</span><a href="#L814D">ON PLAY(n) 敘述程式範例</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L814F">ON TIMER(n) 敘述程式範例</a><span class="QH_2">&gt;</span>


<hr>

<span id="L814B" class="QBtitle">ON KEY(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L813F">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8145"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON KEY(n) 敘述程式範例</span>

可參閱<span class="QH_2">&lt;</span><a href="#L803B">錯誤和事件設陷程式範例 1</a><span class="QH_2">&gt;</span>,有使用 ON KEY(n) 敘述。


<hr>

<span id="L814C" class="QBtitle">ON PEN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8140">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8146"> 細節 </a><span class="QH_2">&gt;</span>  <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON PEN 敘述程式範例</span>

ON PEN 敘述沒有程式範例。

下列程式範例顯示如何整合 "ON 事件" 敘述,啟動設陷敘述與事件處理次常式
(event-handling subroutine),成為一個可運作的程式:

  <span class="QH_2">&lt;</span><a href="#L814D">ON PLAY(n) 敘述程式範例</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L814F">ON TIMER(n) 敘述程式範例</a><span class="QH_2">&gt;</span>


<hr>

<span id="L814D" class="QBtitle">ON PLAY(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8141">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8147"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON PLAY(n) 敘述程式範例</span>

本程式演奏連續的音樂,當音樂緩衝區剩下三個到二個音符時,便呼叫事件設陷次常式
(event-trapping subroutine):

'  當音樂緩衝區剩下 3 個到 2 個音符時,便呼叫 Background 次常式
ON PLAY(3) GOSUB Background
'  打開 PLAY 事件設陷
PLAY ON

'  定義一個包含優美曲調的字串
Lizzie$ = "o3 L8 E D+ E D+ E o2 B o3 D C L2 o2 A"
'  第一次演奏的曲調
PLAY "MB X" + VARPTR$(Lizzie$)

'  繼續演奏直到有按鍵才停止
LOCATE 2, 1 : PRINT "按任意鍵則結束";
DO WHILE INKEY$ = ""
LOOP
END

' 此為 PLAY 事件處理次常式
Background:
   ' 次數加 1 ,並列印出每次計數器的值
   Count% = Count% + 1
   LOCATE 1, 1 : PRINT "背景音呼叫 "; Count%; "次";
   ' 執行其他的 PLAY 敘述以填滿緩衝區
   PLAY "MB X" + VARPTR$(Lizzie$)
RETURN


<hr>

<span id="L814E" class="QBtitle">ON STRIG(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8142">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8148"> 細節 </a><span class="QH_2">&gt;</span>  <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON STRIG(n) 敘述程式範例</span>

ON STRIG(n) 敘述沒有程式範例。

下列程式範例顯示如何整合 "ON 事件" 敘述,啟動設陷敘述,與事件處理次常式
(event-handling subroutine),成為一個可運作的程式:

  <span class="QH_2">&lt;</span><a href="#L814D">ON PLAY(n) 敘述程式範例</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L814F">ON TIMER(n) 敘述程式範例</a><span class="QH_2">&gt;</span>


<hr>

<span id="L814F" class="QBtitle">ON TIMER(n) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8143">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8149"> 細節 </a><span class="QH_2">&gt;</span>  <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON TIMER(n) 敘述程式範例</span>

本程式每隔三秒鐘來繪製三到七邊的隨機多邊形:


SCREEN 82
DEFINT A-Z
DIM X(6), Y(6)
TIMER ON                      '啟動時間事件設陷
ON TIMER(3) GOSUB Drawpoly    '每隔三秒鐘繪製一個新的多邊形
PRINT "按任意鍵來結束程式"
INPUT "按 &lt;RETURN&gt; 鍵開始",Test$

DO
LOOP WHILE INKEY$ = ""        '按任意鍵則結束程式

END

Drawpoly:
   CLS                        '清除舊的多邊形
   N = INT(5 * RND + 2)       'N 是由 2 到 6 之間的隨機亂數
   FOR I = 0 TO N
      X(I) = INT(RND * 319)   '取得多邊形頂點的座標
      Y(I) = INT(RND * 199)
   NEXT
   PSET (X(N), Y(N))
   FOR I = 0 TO N
      LINE -(X(I), Y(I)),2    '繪製新的多邊形
   NEXT
   RETURN


<hr>

<span id="L8150" class="QBtitle">ON UEVENT GOSUB 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8048">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8151"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON UEVENT GOSUB 敘述細節</span>

<span class="QH_1">語法</span>
  ON UEVENT GOSUB {行號 | 行標記}

行號或行標記參數為事件處理次常式(event-handling subroutine)第一行的行號
或標記。當使用者自定事件發生時, ON UEVENT GOSUB 敘述使您的程式能分歧到
所指定的事件處理次常式上。此事件通常為一個硬體的中斷(hardware interrupt)。

它成為使用者自定事件的特性之一,通常透過在 BASIC 中的 COM, KEY 和其它事件
來連用。一旦這些事件用 "ON 事件" 敘述定義後,它們的動作就如同中斷敘述一般。
程式並不需要對此事件作記錄。

正如,一旦 ON UENENT GOSUB 及 UEVENT ON 敘述執行後,使用者自定事件會自動地
啟動 BASIC 常式(routine)的執行來對它作處理。因此程式中並不需要記錄。

至少要二個(有時候三個)程式碼片斷用來設定一個使用者自定事件 :
  * 第一是中斷服務常式(interrupt service routine)。
  * 第二為一個起始化常式(initialization routine)來將服務常式的位址,插入到
    中斷向量表(interrupt vector table)。
  * 第三是您自已 BASIC 程式呼叫的常式(routine),以用來擷取由中斷服務常式
    所搜集的資料(若有的話)。

假如起始化常式 "偷取" (steals)一個己被其他服務常式使用的中斷時,在程式結束
之前,必須恢復其原來的位址(即 :使得中斷向量表內該中斷對應到原來中斷服務常式
的位址上)。

這些常式通常是用組合語言所寫成的。無論如何,任何語言的編譯器所產生的
中斷服務常式,其目的碼(object code)是可以和 BASIC 連結(Link)使用的。

建立使用者自定事件的四個步驟:

  1. 寫一個事件處理常式並將它增加到您的 BASIC 程式中。
  2. 執行 ON UEVENT GOSUB 敘述去指定此使用者事件處理常式。
  3. 執行 UEVENT ON 敘述來啟動使用者事件設陷。
  4. 呼叫中斷起始化常式來將中斷服務常式的位址插入到中斷向量表。

當中斷發生時,中斷會將控制權轉移到中斷服務常式。中斷服務常式會搜集並儲存
使用者所需要的資料,然後呼叫 SetUEvent 常式。SetUEVent 常式會設定旗標(flag),
此旗標將由 QuickBASIC 在執行下一個 BASIC 敘述(或標記 -- 若在執行編譯碼時
使用 /W 代替 /V 的選項)之前來檢查。當旗標被設定時, QuickBASIC 會將控制權
轉移到 ON EVENT GOSUB 敘述所對應的事件處理次常式上。

SetUEvent 程序式是 BASIC 的一部份,並且自動地包含在被編譯過的應用程式中,
或者在啟動 QuickBASIC 時,於 QB 命令行上使用 /L 選擇項。您的中斷服務常式
必須呼叫 SetUEvent; 這是警告您的程式有事件發生的唯一方法。您可以在任何
語言中呼叫 SetEvent,而不是只可以使用在組合語言中而已。

SetUEvent 並不是一個函數,它無法傳回一個值給 BASIC。假如您想要傳回一個值,
您必須為您的 BASIC 程式寫一個函數來呼叫(通常由事件處理常式呼叫之),此函數
必須在宣告敘述中描述,如此一來您的 BASIC 程式才能找到,並且使用它。

雖然 ON UEVENT GOSUB 後面緊跟著一個事件處理常式到一個使用者自定事件,但並不
需要啟動(enable)事件設陷。它使用 UEVENT 敘述來啟動(enable),關閉(disable)及
暫停(suspend)使用者自定事件的設陷。


<hr>

<span id="L8151" class="QBtitle">ON UEVENT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8048">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8150"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">ON UEVENT 敘述程式範例</span>

下列範例說明ON UEVENT GOSUB 敘述的用法:

ON UEVENT GOSUB Event1
UEVENT ON
INPUT "輸入一個數字 "; a
IF a = 5 THEN CALL Setuevent
END
'
Event1:
PRINT "到達事件處理常式"
RETURN


<hr>

<span id="L8152" class="QBtitle">OPEN(檔案輸入/輸出) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8086">Quick 畫面</a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 細節 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8153"> 範例 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPEN(檔案輸入/輸出) 敘述細節</span>

<span class="QH_1">語法</span>
  OPEN 檔案名稱 [FOR 模式1] [ACCESS 存取] [鎖定] AS [#]檔案代碼 [LEN=記錄長度]

檔案名稱參數為一個字串運算式,用來指定一個可選擇的裝置(device),其後跟隨者符合
DOS 命名規則的檔案名稱或路徑名稱。

您必須在任何一個輸入/輸出操作被執行之前,先打開一個檔案。OPEN 敘述會為一個檔案
或裝置的輸入/輸出配置一個緩衝區(buffer),並且決定這個緩衝區所使用的存取模式。

<span class="QH_1">語法 一</span>

在語法一中, 模式1 參數為下列之一種:

  <span class="QH_1">模式     說明</span>
  OUTPUT   設定為循序輸出模式(sequential output mode)。

  INPUT    設定為循序輸入模式(sequential input mode)。

  APPEND   設定為循序輸出模式(sequential output mode),並設定檔案的指標
           (file point)指到該檔案的尾端,而記錄編號(record number)指到
           檔案的最後一筆記錄。然後可以使用 PRINT # 或 WRITE # 敘述由
           檔案的尾端延伸(添加)資料。

  RANDOM   設定為隨機存取模式(random-access mode),此為預設模式。
           在 RANDOM 模式中,假如沒有 ACCESS 子句出現,在使用 OPEN 敘述開檔
           時有三種可能的存取方式,會依下列的次序來做存取:

           1. 可以讀取與寫入
           2. 僅能寫入
           3. 僅能讀取

  BINARY   設定為二進位檔案模式(binary file mode)。在此種模式中,您可以使用
           GET 或 PUT 敘述,來讀取或寫入資訊到檔案中任何位元組的位置上。
           在二進位檔模式,假如沒有 ACCESS 子句出現,開檔時有三種可能的存取
           方式,其存取次序如同 RANDOM 檔案的順序相同。

若模式 1 參數省略,則預設為隨機存取模式。

存取參數用來設定檔案的操作方式。假如檔案已由其他的處理開啟,而且設定的存取
型態不被允許,則 OPEN 會失敗且產生 "磁片或檔案有防寫保護" 的錯誤訊息。
若 OPEN 敘述中使用 ACCESS 子句時,僅能在有提供網路功能的 DOS 版本
(DOS 3.0 版以上)中工作。而且您必須執行 SHARE.EXE 程式(或是執行網路啟動程式)
來執行任何鎖定的動作。若在早期的 DOS 版本下,在 OPEN 敘述中有使用 ACCESS 子句
時,則會產生 "進一步的功能不可使用" 錯誤訊息。

存取參數的型態有下列幾種 :

<span class="QH_1">存取型態        說明</span>
  READ          開啟的檔案僅能讀取。

  WRITE         開啟的檔案僅能寫入。

  READ WRITE    開啟的檔案可讀取及寫入。此模式僅在 RANDOM 與 BINARY 檔,
                以及檔案開啟為 APPEND 模式下有效。

鎖定子句可在多處理(Multiprocessing)環境下使用,用來限制其他處理來存取所開啟
的檔案。鎖定的型態(lock type)有下列幾種:

<span class="QH_1">鎖定型態            說明</span>
  預設(default)     假如鎖定型態未被設定,檔案可被此處理(process)任意
                    次數的開啟,以便做讀寫動作。但是對其他的處理,當此
                    檔案被開啟後,便被拒絕存取此檔案。

  SHARED            在任何機器上的一個處理,均可對此檔案作讀取與寫入的
                    動作。但不要將 SHARED 敘述的 SHARED 鎖定型態與出
                    現在其他敘述的 SHARED 屬性混淆在一起。

  LOCK READ         沒有其他處理被允許來對此檔案作讀取。這個存取僅允許在
                    -- 若沒有其他處理事先對該檔案有做 READ 存取時,才可被
                    允許使用。

  LOCK WRITE        沒有其他處理被允許寫入該檔案。這個鎖定僅允許在
                    -- 若沒有其他處理事先對該檔案有做 WRITE 存取時,才可被
                    允許使用。

  LOCK READ WRITE   沒有其他的處理被允許讀取或寫入該檔案。此存取權僅被允許
                    在 -- 若 READ 或 WRITE 存取權尚未允許給其他處理時,或者
                    LOCK READ 或 LOCK WRITE 尚未執行時。


當 OPEN 敘述若受到上一個處理的限制時,則會在 DOS 下產生錯誤代碼為 70 的
"磁碟片或檔案有防寫保護" 訊息。

檔案代碼參數為一個整數運算式,其值介於 1 - 255 之間。當一個 OPEN 敘述被執行
以後,只要檔案打開著,此檔案代碼都與該檔案相對應。其他的輸入/輸出敘述欲參考到
該檔案時,必須使用此代碼。

記錄長度參數為一整數運算式。若包括此參數時,是用來設定隨機檔每一筆記錄的
長度(一個記錄有多少個位元組數)。對循序檔而言,每筆記錄的預設長度為 512 個
位元組;對隨機存取檔而言,預設長度為 128 個位元組。記錄長度的值不能超過
32,767 個位元組。假如檔案模式為二進位檔,則 LEN 子句將被忽略。

對循序檔而言,記錄長度參數不需要與各個記錄大小作對應,因為循序檔中每一筆記錄的
長度可以不必相同。當用來開啟一個循序檔時,記錄長度參數用在將緩衝區資料寫入磁碟
,或由磁碟讀入資料到緩衝區之前,指定載入到緩衝區內的位元組數目。
一個較大的緩衝區表示佔用較大的 BASIC 空間,但對檔案的輸入/輸出處理速度會較快。
一個較小的緩衝區表示佔用較小的 BASIC 空間,但對檔案的輸入/輸出處理速度會較慢。
預設的緩衝區大小為 512 個位元組。

<span class="QH_1">語法二</span>

  OPEN 模式2, [#]檔案代碼, 檔案名稱 [,記錄長度]

在 OPEN 敘述的語法二中,模式 2 參數為一個字串運算式,其第一個字元必須為
下列格式之一種:

<span class="QH_1">模式     說明</span>
  O      設定為循序輸出模式
  I      設定為循序輸入模式
  R      設定為隨機存取檔輸入/輸出模式
  B      設定為二進位檔模式
  A      設定為循序輸出模式和設定檔案的指標,指到檔案的末端及檔案的最後
         一筆記錄。可利用 PRINT # 和 WRITE # 敘述來延伸(增加)檔案資料。

  注意: OPEN 的第二個語法並不提供第一種語法中的任何存取權及檔案共用的選擇項,
        但是提供與早期 BASIC 版本所寫的程式相容的特性。

下列裝置為 BASIC 所提供的,不但可被命名且可使用在檔案名稱參數中:

  KYBD:,  SCRN:, COMn:, LPTn:, CONS: 。

BASIC 檔案輸入/輸出系統允許您得到使用者安裝裝置(user-installed devices)的
好處。(請參閱 DOS 手冊有提供更多有關字元裝置的資訊)。

字元裝置(character devices)的開啟與使用方式與磁碟檔相同。然而,字元並不像
磁碟檔一樣可以由 BASIC 設定緩衝區來緩衝,對於裝置的檔案,其記錄長度設定為 1。

BASIC 僅在一行的結束送出歸位(carriage-return)字元,若裝置需要一個換行
(line-feed)字元時,則是由驅動器(driver)來提供。
當裝置驅動器(device driver)做寫入時,請記住其他的 BASIC 使用者仍將需要讀取或
寫入控制資訊。裝置控制資料的寫入和讀取是由 IOCTL 敘述和 IOCTL$ 函數來處理。

BASIC 裝置沒有直接提供二進位模式。然而列表機裝置(LPT1:, LPT2:)藉著增加
BIN 關鍵字,可以在二進位模式中重新來打開:

  OPEN "LPT1:BIN" FOR OUTPUT AS #1

開啟一個以二進位模式表示的列表機,將會刪除每一行末端的歸位字元。

  注意: 在 INPUT, RANDOM, 和 BINARY 模式下,您可以不必要關閉檔案,就可以對
        所開啟的檔案再給予不同的檔案代碼。在 OUTPUT 或 APPEND 模式中,您
        必須先關閉檔案,然後再給予不同的檔案代碼來打開它。


<hr>

<span id="L8153" class="QBtitle">OPEN(檔案輸入/輸出) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8086">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8152"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPEN(檔案輸入/輸出) 敘述程式範例</span>

這些範例程式顯示 OPEN(檔案輸入/輸出) 敘述不同的使用方法。

  <span class="QH_1">------------- 注意 -------------</span>
請勿執行這些範例在沒有指定的檔案或裝置上。
  <span class="QH_1">--------------------------------</span>

下列敘述開啟檔案代碼為 1 的 MAILING.DAT,且允許增加資料到檔案尾端而不破壞
原來資料:

OPEN "MAILING.DAT" FOR APPEND AS #1

假如您要寫入並安裝一個檔名為 ROBOT 的裝置驅動器(device driver),則 OPEN 敘述
可以下式來表示:

OPEN "\DEV\ROBOT" FOR OUTPUT AS #1

開啟列表機為輸出模式,您可以使用下列兩行中的任一行。(第一行使用 BASIC 的
裝置 LPT1: ,而第二行使用 DOS 裝置 LPT1 ):

OPEN "LPT1:" FOR OUTPUT AS #1

OPEN "LPT1" FOR OUTPUT AS #1

下列敘述開啟 RECORDS 檔為隨機存取模式而且僅能讀取。這些敘述鎖定檔案,
以防止寫入,但在有效的 OPEN 敘述下,亦能允許其他的處理做讀取:

OPEN "RECORDS" FOR RANDOM ACCESS READ LOCK WRITE AS #1

下列範例開啟檔名為 INVEN,檔案代號為 2 的輸入檔:

OPEN "I",2,"INVEN"



<hr>

<span id="L8154" class="QBtitle">OPEN COM 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8049">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8155"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPEN COM 敘述細節</span>

<span class="QH_1">語法</span>
  OPEN "COMn: 選擇串列1 選擇串列2" [FOR 模式] AS [#]檔案代碼 [LEN=記錄長度]

COMn: 為所要開啟的裝置(device)名稱。其中 n 參數是合法的通訊裝置代號,
      例如, COM1: 或 COM2:。

選擇串列1 有下列的格式 :

  [速度][,[同位元] [,[資料][,[停止位元]]]]

下列清單說明可能的選擇項:

<span class="QH_1">選擇串列     說明</span>
  速度     所要開啟的裝置之"鮑"率(Baud Rate)("Baud": 表示每秒多少個位元(bit))
           。有效速率為 75, 110, 150, 300, 600, 1200, 1800, 2400 和 9600 。

  同位元   所要開啟的裝置之同位元(parity)。有效的同位元輸入值是:
           N (無), E (偶數), O (奇數), S (空白), 或 M (標誌)。

  資料     每一個位元組(byte)內資料位元(data bits)的數目。有效的輸入值
           是: 5,6,7 或 8 。

停止位元   此為設定停止位元(stop bits)的數目。有效的輸入值是: 1, 1.5, 或 2 。


清單中的選擇項必須按照上面的顯示次序輸入;此外,若從選擇串列 2 中選取任何
的選擇項,必須使用逗號,即使選擇串列 1 沒有被選用,亦須使用逗號。例如:

  OPEN "COM1: ,,,,CD1500" FOR INPUT AS #1

若您設定每一個位元組內的資料為 8 個位元,則必須設定為沒有同位元(N)。
因為 QuickBASIC 對數字是使用整個位元組(8 個位元),當傳送或接收數值資料時,
您必須設定為 8 個資料位元。

選擇串列 2 的選項說明在下列的清單中。m 參數是以毫秒(milliseconds)為單位;
m 的預設值是 1000。

<span class="QH_1">選擇項      說明</span>
  ASC      以 ASCII 模式來開啟裝置。在此模式下, TAB 鍵會被延伸成空白碼;
           歸位(carriage-return)鍵是一行的結束; 而 CTRL+Z 視為檔案結束字元。
           當通道(channel)關閉後, CTRL+Z 會被送到 RS-232 線上。

  BIN      以二進位模式(binary mode)來開啟裝置。此選擇項取代 LF 選擇項。
           除非 ASC 被設定,否則預設為 BIN 模式。在 BIN 模式中, TAB 鍵無法
           被延伸成空白碼,歸位鍵不能為一行的結束,且 CTRL+Z 不可視為檔案的
           結束。當通道關閉後, CTRL+Z 並不會送到 RS-232 線上。

  CD[m]    控制在資料載波偵測(DCD-Data Carrier Detect)線上的時段用盡(timeout)
           。若 DCD 低於 m 毫秒,則裝置時段用盡(device timeout)將發生。

  CS[m]    控制清除發送線(CTS-Clear To Send)的時段用盡(timeout)。
           若(CTS)低於(沒有信號) m 毫秒,則裝置時段用盡(device timeout)將發生。

  DS[m]    控制資料集備妥(DSR-Data Set Ready)線的時段用盡(timeout)。
           若 DSR 低於 m 毫秒,則裝置時段用盡(device timeout)將發生。

  LF       允許通訊檔案在一個串列式(serial)的列表機上列印。當 LF 選項被設定,
           在每一歸位(carriage-return)字元(&H0D)之後,會自動地送出一個換行
           (line-feed)字元(&H0A)。而歸位字元的送出是決定寬度(width)的設定。
           注意: INPUT 和 LINE INPUT 敘述,當用來讀取使用 LF 選擇項所開啟的
                 COM 檔案時,若遇到歸位字元則會停止,並且忽略掉後面的換行字元。

  OP[m]    控制該敘述應等待多久,以檢查是否開啟成功。參數 m 的值介於
           0 到 65,535 之間,代表需經過多少毫秒來等待通訊線是否變成有動作。
           若 OP 參數沒有設定值,則會等待 10 秒。若 OP 省略, OPEN COM 會
           等待 CD 或 DS 最大消耗時間的 10 倍。

  RB[n]    設定接收緩衝區的大小為 n 個位元組。若 n 省略,或省略該選項,則使用
           目前的值。而目前的值可在 QuickBASIC 工作環境下,或 BC 命令行中設定
           /C 選擇項。其預設為 512 個位元組,最大的容量為 32,767 個位元組。

  RS       抑止請求送訊(RTS-Request To Send)的偵測。

  TB[n]    設定傳送緩衝區的大小為 n 個位元組。若 n 省略,或者省略該選擇項,
           則使用目前的值。預設的大小為 512 個位元組。

以上所列的選擇項可以按照參數順序輸入,但是參數必須用逗號分開。對於 CS[m],
DS[m],及 CD[m]選擇項,若在 m 毫秒中沒有信號傳回,則將發生時段用盡(timeout)。
m 值的範圍介於 0 到 65,535 之間,其預設值為 1000。CD 的預設值為 0。若任何
選擇項中 m 的值為零,便忽略這些選擇項。若 CS 選擇項有設定,不論是否有資料在
傳輸緩衝區中,CTS 線仍被檢查。若對應的選項(DS,CS)被設定時, DSR 及 DCD 兩線
仍繼續對時段用盡(timeout)做檢查。

模式參數為下列字串運算式中之一種:

  <span class="QH_1">模式     說明</span>
  OUTPUT   指定為循序輸出模式。
  INPUT    指定為循序輸入模式。
  RANDOM   指定為隨機存取模式。

若模式運算式被省略,則假設為隨機存取輸入/輸出模式。其檔案代碼為開啟檔案時
所使用的號碼。OPEN COM 敘述必須在一個裝置以 RS-232 當作通訊界面
(communication interface)之前就先執行。

假如裝置以 RANDOM 模式開啟, LEN 選擇項用來指定隨機存取緩衝區的長度。
預設的長度值為 128。您可以使用任何的隨機存取輸入/輸出敘述,如: GET 或 PUT
來將裝置視為隨機存取檔。

OPEN COM 敘述在開啟通訊裝置時須執行下列步驟:

  1. 配置通訊緩衝區並啟動中斷(interrupt is enabled)。

  2. 將資料終端備妥線(DTR-Data Terminal Ready)設定為高電位。

  3. 假如 OP 或 DS 選擇項不為零, OPEN COM 敘述會在資料組備妥線
     (DSR-Data Set Ready)的指定時段內,等待成為高電位。
     若時間用完,則跳到步驟 6。

  4. 若 RS 選項沒有設定,則請求送訊(RTS-Request To Send)設定為高電位。

  5. 若 OP 或 CD 選項不為零, OPEN COM 敘述會在資料載波偵測線
     (DCD-Data Carrier Detect)指定的時段內,等待成為高電位。
     若時間用完,則跳到步驟 6。否則, OPEN COM 敘述開啟成功。

  6. 開啟失敗是由於時段用盡(timeout)。處理將釋放緩衝區,關閉中斷,並且
     清除所有的控制線。

  注意: 使用比 CS,DS 或 CD 選項還相當大的值來設定 OP 選擇項時,若二個
        程式試圖建立一個通訊連結,則兩者皆需要佔用他們程式執行時間內的
        一半以上的時間來通訊。

任何一個 OPEN COM 敘述語法有錯誤時,將產生 "檔案名稱錯誤" 錯誤訊息。



<hr>

<span id="L8155" class="QBtitle">OPEN COM 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8049">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8154"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPEN COM 敘述程式範例</span>

下列程式片斷用來開啟通訊通道(channel) 1 為隨機存取模式,傳輸速度為 9600
鮑率(Baud Rate),無同位元, 8 個資料位元,及一個停止位元。資料以二進位模式
作輸入/輸出。在其他程式行中,可以使用檔案代碼 2 來存取(access)通訊通道 1。

OPEN "COM1:9600,N,8,1,BIN" AS 2



<hr>

<span id="L8156" class="QBtitle">OPTION BASE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8087">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8157"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPTION BASE 敘述細節</span>

<span class="QH_1">語法</span>
  OPTION BASE n

通常並不需要使用 OPTION BASE 敘述,但該敘述可用來改變陣列註標(subscript)
預設的下界(lower bound)值。

n 的值必須為 0 或 1 。預設的下界值為 0 。

假如下列敘述 :

  OPTION BASE 1

被執行時,則陣列註標的下界值會設定為 1 。

  注意: DIM 敘述提供較簡易且具有彈性的方法,來控制一個陣列註標的範圍。
        假如陣列註標的下界值沒有明確地設定,則可用 OPTION BASE 來修改。
        預設的下界值為 1。

OPTION BASE 敘述在一個模組中(原始檔)僅能使用一次,且僅能出現在模組層次碼中
。OPTION BASE 敘述必須在陣列宣告其大小之前使用。

若這些被鏈結的程式(Chained programs)內,在 COMMON 敘述中沒有陣列參數被傳遞;
或者這些被鏈結的程式中若所設定的基底(base)都相等時,則這些被鏈結的程式可以
有 OPTION BASE 敘述。若被鏈結到的程式省略 OPTION BASE,則會繼承鏈結程式
(Chaining program)中 OPTION BASE 所設定的值。



<hr>

<span id="L8157" class="QBtitle">OPTION BASE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8087">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8156"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OPTION BASE 敘述程式範例</span>

下列範例顯示使用 OPTION BASE 來改變預設的陣列註標值 0 的下界。
陣列 A 的註標範圍將從 1 到 20 ,而不是預設的 0 到 19。

CLS                     ' 清螢幕
OPTION BASE 1
DIM A(20)
PRINT "陣列 A 的註標下界為"; LBOUND(A)
PRINT "陣列 A 的註標上界為"; UBOUND(A)

<span class="QH_1">範例輸出</span>

陣列 A 的註標下界為 1
陣列 A 的註標上界為 20


<hr>

<span id="L8158" class="QBtitle">OUT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8089">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8159"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OUT 敘述細節</span>

<span class="QH_1">語法</span>
  OUT 埠,資料

<span class="QH_1">參數         說明</span>
  埠         埠(port)的代號。為一整數運算式,其範圍介於 0 到 65,535 之間。

  資料       送到輸出埠的資料。其值必須是介於 0 到 255 間的整數運算式。

OUT 和 INP 敘述使得一個 BASIC 程式能夠透過輸入/輸出埠直接控制系統的硬體
(hardware)。這些敘述必須小心地使用,因為他們直接控制硬體。



<hr>

<span id="L8159" class="QBtitle">OUT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8089">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8158"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">OUT 敘述程式範例</span>

OUT_EX.BAS 為子目錄 ADVR_EX 之下的程式檔,使用 OUT 及 INP 敘述來控制計時器
和喇叭以產生音符。可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入程式,並
可執行它。


<hr>

<span id="L815A" class="QBtitle">PAINT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808B">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L815B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PAINT 敘述細節</span>

<span class="QH_1">語法</span>
  PAINT [STEP] (x,y) [,[塗料] [,[邊界顏色] [,背景]]]

 <span class="QH_1">參數                  說明</span>
  STEP          定義座標為相對於最近所繪點的座標。例如,最近所繪的點座標為
                (10,10),然後透過 STEP(4,5) 參考的座標將為(4+10,5+10),也就
                是:(14,15)。

  (x,y)         為所欲塗滿的起始座標。這一點必須是一個圖形的內部或外部,
                而不能在圖形的邊界上。假如此點在圖形的內部,則圖形的內部
                全被塗滿;若點在外部,則背景全被塗滿。

  塗料          為一數值或字串運算式。假如塗料參數是一數值運算式,則為一
                個有效的顏色屬性暫存器號碼(color attribute number)。
                若沒有設定塗料參數,則使用目前的背景顏色來塗滿。關於有效
                的顏色,顏色值及屬性暫存器,請參閱 :
                  <span class="QH_2">&lt;</span><a href="#L808A">COLOR 敘述細節 </a><span class="QH_2">&gt;</span>,
                  <span class="QH_2">&lt;</span><a href="#L81A6">SCREEN 敘述細節 </a><span class="QH_2">&gt;</span>,及
                  <span class="QH_2">&lt;</span><a href="#L815C">PALETTE 敘述細節 </a><span class="QH_2">&gt;</span>。

                假如塗料參數為一字串運算式,則 PAINT 塗以花紋(tiling)而
                不是純以顏色塗滿所指定的區域。塗花紋是類似 "線的格式"
                (line styling)來繪出虛線,而不是用實線。

  邊界顏色      為一數值運算式,表示用來作為圖形邊界顏色的顏色屬性暫存器
                號碼。有使用邊界顏色時,目前邊界行的塗滿動作會停止。
                若省略邊界顏色參數,則使用塗料參數。

  背景          提供一個 "背景花紋切片"(background tile slice) 的字串值,
                以用來跳過對邊界的結束作檢查。當鄰近的點顯示塗料參數的
                顏色時,則會中止塗的動作。指定一個背景花紋切片允許您在已
                塗滿的區域中再作塗色。當您省略背景參數,則預設值為 CHR$(0)。

若一條線被塗色,且線上任何圖素(pixel)的顏色沒有改變,則塗色便表示完成,亦即
當整條線的顏色均相等。PAINT 命令允許所定的座標在螢幕或景象埠(viewport)的
外面。

"花紋" 是一個 PAINT 圖案(pattern)的設計,它是由 8 個位元(bit)寬及 64 個
位元組長所組成的。在花紋字串中,每一個位元組是用 8 位元來罩住(mask),它
沿著 x 軸來放置圖素(pixel)。構成這個花紋罩幕(mask)的語法如下:

  PAINT (x,y), CHR$(參數 1)+CHR$(參數 2)+...+CHR$(參數 n)

CHR$ 的參數為介於 0 到 255 之間的整數,以二進位格式來代表 x 軸的花紋。
CHR$ 的元素至多可有 64 個元素;每一個元素產生的影像不是指定給字元,而是具有
該字元位元編碼(bit arrangement of the code of the character)的影像。例如,
十進制數值 85 是二進位 01010101; 繪圖影像行在單色螢幕上由 CHR$(85) 所產生
的是 8 個圖素組成行(8-pixel line),且偶數點是亮,奇數點為暗。也就是說在單色
螢幕上,該位元若為 1,會顯示該圖素; 若位元為 0, 則不顯示該位元。英文字元
"U" 的 ASCII 碼為 CHR$(85), 在這種情況下並不顯示。

當背景參數有定義 "背景花紋切片" 來跳開邊界結束檢查時,您不能設定超過二個
連續的位元組來符合(match)花紋字串。若設定超過二個連續的位元組時,會產生
"不正確的函數呼叫" 錯誤訊息。

花紋也可由各種不同顏色的圖樣來產生。


<hr>

<span id="L815B" class="QBtitle">PAINT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808B">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L815A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PAINT 敘述程式範例</span>

本範例使用 PAINT 敘述來繪出有藍色尾巴的綠色魚。

CONST PI = 3.1415926536
CLS    ' 清螢幕
SCREEN 82

CIRCLE (190, 100), 100, 1, , , .3   '魚的身體框為藍色
CIRCLE (265, 92), 5, 1, , , .7      '魚的眼晴框為藍色
PAINT (190, 100), 2, 1              '用綠色塗滿魚的身體

LINE (40, 120)-STEP (0, -40), 2     '魚的尾巴框為綠色
LINE -STEP (60, 20), 2
LINE -STEP (-60, 20), 2
PAINT (50, 100), 1, 2               '用藍色塗滿魚的尾巴

CIRCLE (250,100),30,0,PI*3/4,PI* 5/4,1.5  '用黑色繪出魚鰓
FOR Y = 90 TO 110 STEP 4
   LINE (40, Y)-(52, Y), 0          '也在魚尾巴畫梳狀
NEXT


<hr>

<span id="L815C" class="QBtitle">PALETTE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808C">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L815D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PALETTE 敘述細節</span>

<span class="QH_1">語法</span>
  PALETTE [顏色屬性, 顏色代號]
  PALETTE USING 陣列名稱[(陣列索引)]

  <span class="QH_1">參數          說明</span>
  顏色屬性      為調色盤內要改變顏色的屬性暫存器號碼(color attribute
                number)。

  顏色代號      提供給顏色屬性暫存器使用的顏色值。顏色代號必須是一個長整數
                運算式,才可以使用在 IBM 視訊繪圖陣列轉接器(VGA)上。整數或
                長整數運算式,則都可以使用在 IBM 加強型繪圖轉接器(EGA) 上。

  陣列名稱      在目前螢幕模式下,陣列內元素應包含能夠提供給所有顏色屬性
                暫存器使用的顏色值。
                在 VGA 轉接器下需用長整數陣列。若在 EGA 下則可以使用一個
                整數或長整數陣列。

  陣列索引      用來設定提供給調色盤內第一個顏色屬性暫存器使用的陣列內
                第一個元素索引(index)。

PALETTE 敘述僅在系統有 EGA,VGA 轉接器裝置時才可以使用。

此敘述提供一種映射(map)- 即:指定顏色值(真正使用在轉接器的二進制值)給顏色
屬性暫存器(為一小組的值,目前 EGA, VGA 調色盤內都包含 16 個顏色屬性暫存器,
其號碼是 00 - 15)的方法。所有 BASIC 繪圖敘述,如: CIRCLE, COLOR, DRAW 或
LINE, 是間接使用顏色屬性暫存器號碼,而不是直接使用顏色值。

當程式進入一個螢幕模式時,所有顏色屬性暫存器內都會有預設的顏色值。(請參閱
SCREEN 敘述有提供預設的顏色清單)。在 EGA, VGA 轉換器中,由於這些預設值已被
選定,所以即使您已在 EGA 上使用不同的顏色值,一旦進入 QuickBASIC 以後,調色盤
內顏色屬性暫存器都被設定成預設的顏色值。

使用 PALETTE 敘述,可以指定不同顏色給顏色屬性暫存器,因而給予較大的控制權
來掌握顯示器上的顏色。PALETTE 敘述若沒有使用參數,則會還原為預設的顏色值。

當您執行一個含有參數的 PALETTE 敘述以後,不論那一個顏色屬性暫存器號碼出現在
如: DRAW 或 LINE 敘述中,轉接器都會以該顏色屬性暫存器內的顏色值來顯示顏色。
使用 PALETTE 敘述改變一個顏色屬性暫存器內的顏色,此時螢幕上所有使用該顏色
屬性暫存器的顏色也會立即改變。

例如,假設目前調色盤內四個屬性暫存器 0,1,2 和 3 內的顏色值是 0,1,2 和 3。
有一個 DRAW 敘述用法如下:

  DRAW "C3L100"

選擇顏色屬性暫存器 3 內的顏色來繪製一個含有 100 個圖素(pixel) 的一條直線,
假如又有一個敘述如下:

  PALETTE 3,2

執行後,顏色屬性暫存器 3 內的顏色值會更改為 2, 同時目前在螢幕上所有使用到
顏色屬性暫存器 3 的本文或圖形,立刻都將改為顏色值 2 的顏色。並且在此敘述後
的其他敘述,若有用到顏色屬性暫存器 3 來顯示本文或繪圖時,都將顯示新的顏色。
此時調色盤內顏色屬性暫存器 0, 1, 2, 3 內的顏色值是 0, 1, 2 和 2。

使用 USING 選擇項,則調色盤所有顏色屬性暫存器內的顏色值會同時被修改。陣列
名稱參數是一個整數或長整數陣列的名稱,陣列索引參數是設定給調色盤內第一個
顏色屬性暫存器使用的起始元素。調色盤中所有顏色屬性暫存器可以用陣列來同時
指定顏色。陣列必須宣告足夠大,以便在指定的陣列索引之後還有足夠的元素可以
設定給所有顏色屬性暫存器。例如: 若您指定顏色給所有 16 個顏色屬性暫存器,
而且在給定的 PALETTE USING 敘述中第一個陣列元素註標(subscript)為 5, 則此
陣列必須宣告至少能包含 20 個元素的陣列(元素 5 到 20,可以提供給 16 個顏色
屬性暫存器使用):

  DIM PAL%(20)
  .
  .
  .
  PALETTE USING PAL%(5)

若陣列元素的顏色值為 -1 時,會保留顏色屬性暫存器內的顏色,而不更改。其他的
負數值都是不正確的顏色值。

您可以使用 COLOR 敘述來設定預設的前景顏色,及背景顏色。前景顏色參數用來設定
螢幕上本文字元顯示的顏色。在一般調色盤初值的設定下,顏色屬性暫存器 0 在螢幕
上的顯示顏色為黑色(暗)。您可以使用 PALETTE 敘述來改變顏色由黑色(暗)轉到白色
(亮)。

下表列出各種彩色轉接器和螢幕模式所對應的屬性暫存器及顏色範圍。

  <span class="QH_1">各種螢幕的顏色與屬性暫存器的範圍</span>

  螢幕       轉接器    屬性暫存器      顏色
  模式                   範圍           值

  0,3,80     EGA       0-15            0-63
  0,3,82     VGA       0-15            0-262,143 (a)
  ____________________________________________________________________
  (a) 不是在 0 與 262,143 之間的所有顏色值都可以被使用,請參考下面說明。

  注意: 因為 VGA 轉接器顏色值較寬廣,在其螢幕模式 0, 3 與 82 下的
        PALETTE USING 敘述中,必須使用一個長整數陣列。


<span class="QH_1">顏色代號的計算方法</span>

EGA 顏色代號 : 00 - 63。

VGA 使用不同的公式來計算顏色代號(顏色值)。選擇紅色,綠色及藍色的明暗度來
計算顏色的值。顏色的明暗度為介於 0(低亮度)到 63(高亮度)的數值。然後使用
下列的公式來計算實際的顏色代號:

  顏色代號 = 65536 * 藍色 + 256 * 綠色 + 紅色

因為顏色代號的範圍有空隙,您應該使用上述的公式,而不是直接只選擇一個代號。

當使用 IBM 類比單色顯示器(Analog Monochrome Monitor)時, VGA 顏色代號使用
紅色,藍色,及綠色的明暗度來加權其總和,而轉換成為一個灰白明暗度值。

  灰白值 = 11% 藍色 + 59% 綠色 + 30% 紅色

例如,若藍色,綠色,及紅色的明暗度分別為 45, 20 及 20,則灰白值將為 :

       .11*45 + .59*20 + .30*20, 即為 22。(小數部分捨棄掉)



<hr>

<span id="L815D" class="QBtitle">PALETTE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808C">Quick 畫面</a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="#L815C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PALETTE 敘述程式範例</span>

此範例顯示 PALETTE 及 PALETTE USING 不同的形式敘述。

                        <span class="QH_1">--------- 注意 ---------</span>
本範例不是一個完整程式。請勿以目前的形式執行。
                        <span class="QH_1">------------------------</span>

PALETTE 0,2             '更改調色盤中顏色屬性暫存器 0 內的顏色值為 2。

PALETTE USING A%(0)     '更改調色盤每一個顏色屬性暫存器內的顏色。當第一次
                        '宣告時,由於陣列的起始化使得每一元素值為 0, 所有
                        '顏色屬性暫存器內的顏色值為 0, 使得螢幕將顯示單一
                        '的顏色。然而,它仍可以執行 BASIC 敘述。

PALETTE                 '啟始調色盤中每一個顏色屬性暫存器內的顏色值。
                        '真正的啟始顏色是根據所配置的螢幕硬體來決定。



<hr>

<span id="L815E" class="QBtitle">PCOPY 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808D">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L815F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PCOPY 敘述細節</span>

<span class="QH_1">語法</span>
  PCOPY 原始分頁,目的分頁

原始分頁為一整數運算式,其值介於 0 到 n 之間,其中 n 是由目前的視訊記憶大小
(Video memory Size)和目前螢幕模式的每頁大小,來決定其最大的頁數。

目的分頁參數的需求與原始分頁參數相同。

可參閱 SCREEN 敘述有提供在不同螢幕模式下,有關的分頁資訊。



<hr>

<span id="L815F" class="QBtitle">PCOPY 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808D">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L815E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PCOPY 敘述程式範例</span>

下列範例拷貝分頁 1 的內容到分頁 2 之中。

                      <span class="QH_1">------------- 注意 -----------</span>
這不是一個完整的程式。請勿在目前的格式下執行此範例。
                      <span class="QH_1">------------------------------</span>

PCOPY 1,2



<hr>

<span id="L8160" class="QBtitle">PEEK 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808E">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8161"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PEEK 敘述細節</span>

<span class="QH_1">語法</span>
  PEEK(位址)

所傳回的值是介於 0 到 255 之間的整數值。位址參數是介於 0 到 65,535 之間的值,
它是由目前預設的區段位址(節位址--Segment Address)(由 DEF SEG 敘述設定) 內的
位移位址(節內位址--Offset Address)值。

假如參數為單或倍精確度浮點數或長整數,則會轉換成一個佔 2 個位元組長度的整數。

PEEK 函數為 POKE 敘述的互補函數。


<hr>

<span id="L8161" class="QBtitle">PEEK 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808E">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8160"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱 <span class="QH_2">&lt;</span><a href="#L80B1">DEF SEG 敘述程式範例 </a><span class="QH_2">&gt;</span>, 有使用 PEEK 敘述。



<hr>

<span id="L8162" class="QBtitle">PEN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L804A">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8163"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PEN 函數細節</span>

<span class="QH_1">語法</span>
  PEN(n)

參數 n 表示所要傳回的值。n 為一數值運算式,其值介於 0 到 9 之間的整數。

  注意: PEN 函數當滑鼠驅動器(Mouse Driver)啟動時,就無法使用。因為滑鼠驅動器
        是使用 PEN 函數的 BIOS 呼叫。使用滑鼠函數 14 來關閉驅動器的光筆模擬。
        而滑鼠函數 13 可再度開啟模擬。可參閱滑鼠手冊有提供更多的資訊。

下列清單描述 n 的值及其由 PEN 敘述所傳回對應的值:

  <span class="QH_1">參數       傳回值</span>
  0          最近光筆的使用: 如果自上次呼叫後,光筆有按下,則傳回 -1,
             否則為 0。

  1          上一次光筆按下時的 x-座標。

  2          上一次光筆按下時的 y-座標。

  3          目前光筆的開關狀態,有按下則傳回 -1, 否則傳回 0。

  4          上一次光筆位置的 x-座標。

  5          上一次光筆位置的 y-座標。

  6          上一次光筆按下時,該位置的字元列(Character Row)。

  7          上一次光筆按下時,該位置的字元行(Character Column)。

  8          上一次光筆位置的字元列。

  9          上一次光筆位置的字元行。


<hr>

<span id="L8163" class="QBtitle">PEN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L804A">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8162"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PEN 函數程式範例</span>

下列範例產生無窮迴路來列印目前光筆開關的狀態(UP/DOWN)。按 CTRL+BREAK 則離開
迴圈。

             <span class="QH_1">------------- 注意 -------------</span>
           若您的滑鼠驅動器仍開啟時,請勿執行此範例。
             <span class="QH_1">--------------------------------</span>

' 按下 CTRL+BREAK 鍵離開此迴圈
COLOR 0,7
CLS                ' 清螢幕
PEN ON
DO
   P = PEN(3)
   LOCATE 1,1 : PRINT "光筆為";
   IF P THEN PRINT "DOWN" ELSE PRINT "UP  "
   X = PEN(4) : Y = PEN(5)
   PRINT "X =" X, "Y =" Y; "  "
LOOP
COLOR 7,0
END


<hr>

<span id="L8164" class="QBtitle">PEN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808F">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8165"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PEN 敘述細節</span>

<span class="QH_1">語法</span>
  PEN ON
  PEN OFF
  PEN STOP

PEN ON 敘述藉著使用一個 ON PEN 敘述,來啟動光筆設陷事件(lightpen-event
trapping)。光筆起始時是關閉(OFF) 的狀態。光筆事件發生在當光筆的筆尖接觸到
螢幕或按下觸環(touch ring)時才有作用。PEN ON 敘述必須在任何呼叫讀取光筆函數
之前被執行,假如光筆是關閉,則呼叫讀取光筆函數時,會產生 "不正確的函數呼叫"
錯誤訊息。

PEN OFF 敘述關閉光筆事件設陷。PEN STOP 敘述暫停光筆事件設陷;但光筆事件將
會被記錄,且當事件設陷一旦再被啟動時,就會執行事件設陷。

為加速程式執行,當光筆設陷不需要時,應使用 PEN OFF 敘述來關閉設陷。

        注意: 光筆的使用需要 IBM 彩色繪圖轉接器(CGA)。


<hr>

<span id="L8165" class="QBtitle">PEN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L808F">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8164"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PEN 敘述程式範例</span>

請參閱 <span class="QH_2">&lt;</span><a href="#L8163">PEN 函數程式範例</a><span class="QH_2">&gt;</span>, 有使用 PEN 敘述。



<hr>

<span id="L8166" class="QBtitle">PLAY 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8090">Quick 畫面</a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L816B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY 敘述細節</span>

<span class="QH_1">語法</span>
  PLAY 命令字串

命令字串參數為一個字串運算式,它包含一個或多個音樂命令。PLAY 敘述使用類似
DRAW 敘述的觀念,將音樂巨集語言嵌入一個敘述之內。將一組命令當做 PLAY 敘述
的一部分,以設定特殊的動作。

  <span class="QH_2">&lt;</span><a href="#L8167">音階與音符命令</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8168">音長與速度命令</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L8169">前景/背景演奏命令</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L816A">執行子字串命令</a><span class="QH_2">&gt;</span>

在被編譯的(compiled)程式中,您應該使用 VARPTR$(變數) 的格式來使用變數。
例如: BASICA 的敘述:

  PLAY "XA$"
  PLAY "O = I"

對編譯器(compiler)則應改寫為下列格式:

  PLAY "X" + VARPTR$(A$)
  PLAY "O=" + VARPTR$(I)


<hr>

<span id="L8167" class="QBtitle">PLAY 敘述細節 - 音階與音符</span>
  <span class="QH_2">&lt;</span><a href="#L8166"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 音階與音符 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8168"> 音長 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8169"> 演奏 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L816A"> 子字串 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">音階與音調命令</span>

 <span class="QH_1">音階        動作</span>
  O n        設定目前的音階。有 7 個音階, n 從 0 到 6。

  &gt;          自動升一個音階,音階不能超過 6。

  &lt;          自動降一個音階,音階不能低於 0。

 <span class="QH_1">音符        動作</span>
  A-G        演奏一個音符介於 A 到 G 之間。"#" 符號或 "+" 符號在一個音符
             之後會設定為升半音; "-" 符號會設定為降半音。

  N n        演奏音符 n。 n 是介於 0 到 84( 7 個八度音階中,共 84 個音符)
             之間的音階; n = 0 表示休止符。

  <span class="QH_1">後置符號           動作</span>
  # 或 +     跟隨所設定的音符,並升半音。

  -          跟隨所設定的音符,並降半音。


<hr>

<span id="L8168" class="QBtitle">PLAY 敘述細節 - 音長與速度</span>
  <span class="QH_2">&lt;</span><a href="#L8166"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 音長與速度 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8167"> 音階與音符 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8169"> 演奏 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L816A"> 子字串 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">音長與速度命令</span>

  <span class="QH_1">音長                   動作</span>
  L n        設定每一音符的長度。L 4 為 1/4 音符, L 1 為全音符 ...等等。
             n 為介於 1 到 64 之間。僅在特殊的音符需要改變音長時,
             長度可跟隨在音符的後面。例如 : A 16 可寫成 L 16 A。

  MN         設定 "正常演奏法", 每個音符在它所設定的音長(L)中,一般
             將演奏 7/8 倍的時間, 1/8 倍時不發音。

  ML         設定"圓滑演奏法",每個音符在它所設定的音長(L)中,全部時間
             都發音。

  MS         設定"斷音演奏法",每個音符在它所設定的音長(L)中,一般將演奏
             3/4 倍的時間, 1/4 倍的時間時不發音。

  <span class="QH_1">速度       動作</span>
  P n        設定休止符,介於 1 到 64 之間。此選擇項對應到用 L n 所設定
             的音符長度。

  T n        設定 "速度," 或每一分鐘 L 4 (1/4 音符)的數目。
             n 的值介於 32 到 255 之間, n 的預設值為 120。

    注意: 因為較慢的時鐘中斷速率,某些音符將無法以快速來演奏
          (例如, L 64 的 T 255)。

  .          若一個音符後面緊跟著一個附點,則演奏 L(長度)乘上 T(速度)的
             3/2 倍的長度。附點音符與在樂譜中的意義相同,多個附點音符
             可出現在音符後面。每一個附點音符會增加長度為前一個
             附點音符的一半。例如:
               * 命令 A. 演奏 1 + 1/2, 或為長度的 3/2 倍。
               * A.. 演奏 1 + 1/2 + 1/4, 或為長度的 7/4 倍。
             附點可出現在休止符(P)的後面。在這種狀況下,休止符的長度與
             其他音符所計算的長度方式是一樣的。


<hr>

<span id="L8169" class="QBtitle">PLAY 敘述細節 - 演奏</span>
  <span class="QH_2">&lt;</span><a href="#L8166"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 演奏 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8168"> 音長 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8167"> 音階與音符 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L816A"> 子字串 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">前景/背景演奏命令</span>

  <span class="QH_1">演奏        動作</span>
  MF          設定音樂(PLAY 敘述)及 SOUND 在前景之下演奏。亦即,每一個
              後繼的音符,或聲音需要等到前面的音符或聲音執行完才能開啟。
              系統預設為前景演奏。

  MB          設定音樂(PLAY 敘述)及 SOUND 在背景執行。亦即,每一音符
              或聲音放置在緩衝區,然後,繼續執行其他的 BASIC 程式,同時
              也會演奏在背景的音符或聲音。在背景中,一次至多可演奏 32
              個音符。


<hr>

<span id="L816A" class="QBtitle">PLAY 敘述細節 - 執行子字串</span>
  <span class="QH_2">&lt;</span><a href="#L8166"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 子字串 &gt;</span>   <span class="QH_2">&lt;</span><a href="#L8168"> 音長 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8169"> 演奏 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8167">音階與音符 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">執行子字串命令</span>

  <span class="QH_1">子字串                  動作</span>
  "X" + VARPTR$(字串)     執行一個子字串。


<hr>

<span id="L816B" class="QBtitle">PLAY 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8090"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8166"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY 敘述程式範例</span>

這些範例使用 PLAY 敘述來演奏音階及一首熟悉的曲調。

<span class="QH_1">範例 1</span>

本範例使用 "&gt;" 升高一度音階來演奏從音階零到音階六,然後再反轉回來使用 "&lt;"
降低一度音階來演奏從音階六到音階零:

SCALE$ = "CDEFGAB"
PLAY "o0 X" + VARPTR$(SCALE$)
FOR I = 1 TO 6
   PLAY "&gt;X" + VARPTR$(SCALE$)
NEXT
PLAY "o6 X" + VARPTR$(SCALE$)
FOR I = 1 TO 6
   PLAY "&lt;X" + VARPTR$(SCALE$)
NEXT

<span class="QH_1">範例 2</span>

本範例演奏貝多芬第五交響曲的前面幾個音符:

LISTEN$ = "T180 o2 P2 P8 L8 GGG L2 E-"
FATE$ = "P24 P8 L8 FFF L2 D"
PLAY LISTEN$ + FATE$



<hr>

<span id="L816C" class="QBtitle">PLAY(n) 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L804B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L816D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY(n) 函數細節</span>

<span class="QH_1">語法</span>
  PLAY(n)

n 參數是虛擬參數,可以為任意數值。

當使用者在音樂前景的模式下, PLAY(n) 將傳回 0 的值。


<hr>

<span id="L816D" class="QBtitle">PLAY(n) 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L804B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L816C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY(n) 函數程式範例</span>

沒有 PLAY(n) 函數的程式範例。



<hr>

<span id="L816E" class="QBtitle">PLAY ON, PLAY OFF, 與 PLAY STOP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L804C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L816F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY ON, PLAY OFF, 與 PLAY STOP 敘述細節</span>

<span class="QH_1">語法</span>
  PLAY ON
  PLAY OFF
  PLAY STOP

這些敘述與 ON PLAY 敘述一同用來設陷演奏事件。當 PLAY OFF 敘述被執行時,
事件設陷次常式(event-trapping subroutine)並不執行,且事件狀況也不會被記錄。

PLAY STOP 敘述並不執行事件設陷次常式,只要 PLAY ON 敘述被執行,設陷次常式
便馬上被執行。

當演奏事件設陷發生時(亦即 GOSUB 敘述執行), QuickBASIC 會自動地執行
PLAY STOP 敘述,所以遞迴(recursion)設陷是無法發生。當 RETURN 由設陷
次常式中回來, QuickBASIC 會自動執行一個 PLAY ON 敘述,除非在次常式內
有指定 PLAY OFF 敘述時,才不會執行 PLAY ON 敘述。


<hr>

<span id="L816F" class="QBtitle">PLAY ON, PLAY OFF, PLAY STOP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L804C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L816E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PLAY ON, PLAY OFF, PLAY STOP 敘述程式範例</span>

請參閱 <span class="QH_2">&lt;</span><a href="#L814D">ON PLAY(n) 敘述程式範例</a><span class="QH_2">&gt;</span>, 有使用 PLAY ON 敘述。


<hr>

<span id="L8170" class="QBtitle">PMAP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8091"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8171"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PMAP 敘述細節</span>

<span class="QH_1">語法</span>
  PMAP(運算式, 函數)

運算式參數表示所對應到的點座標。函數參數可以為下列的四種值之一:

  <span class="QH_1">值      說明</span>
  0       將邏輯座標系統內的 x 座標,轉換成螢幕上實際座標的 x 座標。

  1       將邏輯座標系統內的 y 座標,轉換成螢幕上實際座標的 y 座標。

  2       將螢幕上實際座標的 x 座標,轉換成邏輯座標系統內的 x 座標。

  3       將螢幕上實際座標的 y 座標,轉換成邏輯座標系統內的 y 座標。

此四種 PMAP 函數允許使用者在 WINDOW 敘述所設定的邏輯座標系統內的座標,與
實際螢幕座標,或在 VIEW 敘述定義的實際景象埠(physical viewport)中找出等效
(對映) 的座標點。


<hr>

<span id="L8171" class="QBtitle">PMAP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8091"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8170"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PMAP 敘述程式範例</span>

本範例使用 PMAP 轉換邏輯座標系統內之座標成為實際螢幕座標,並且再從實際螢幕
座標轉換成邏輯座標系統內的座標。

                     <span class="QH_1">--------- 注意 ---------</span>
這不是一個完整的程式,請勿以目前的格式執行此範例。
                     <span class="QH_1">------------------------</span>

SCREEN 71
'在下面敘述中,定義視窗的左上角座標為(80,100);右下角為 (200,200)
WINDOW SCREEN (80,100) - (200,200)

'若實際螢幕標在左上角為(0,0),右下角為(639,199),則下列敘述將傳回
'與邏輯座標系統內座標 80,100 等效的實際螢幕座標
X = PMAP(80,0)          'X = 0
Y = PMAP(100,1)         'Y = 0

'下列敘述將傳回與邏輯座標系統內座標 200,200 等效的實際螢幕座標
X = PMAP(200,0)         'X = 639
Y = PMAP(200,1)         'Y = 199

'下列敘述將傳回與實際螢幕座標(639,199)等效的邏輯座標系統內的座標值
X = PMAP(639,2)         'X = 200
Y = PMAP(199,3)         'Y = 200



<hr>

<span id="L8172" class="QBtitle">POINT 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8092"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8173"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">POINT 函數細節</span>

<span class="QH_1">語法</span>
  POINT(x,y)
  POINT(數值)

若有給予 x, y 的一組座標時,則 POINT 函數傳回指定圖素(pixel)座標的顏色。
假如設定的圖素座標超出範圍時,則 POINT 傳回的值為 -1。

同時 POINT 函數也可以使用一個數值參數(如下所列出的說明),允許使用者取得
目前繪圖游標的座標。

 <span class="QH_1">參數        傳回值</span>
  0          目前螢幕上實際的 x 座標

  1          目前螢幕上實際的 y 座標

  2          目前邏輯座標系統內的 x 座標。如果沒有使用 WINDOW 敘述時,
             所傳回的值就和 POINT(0) 函數一樣。

  3          目前邏輯座標系統內的 y 座標。如果沒有使用 WINDOW 敘述時,
             所傳回的值就和 POINT(1) 函數一樣。



<hr>

<span id="L8173" class="QBtitle">POINT 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8092"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8172"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">POINT 函數程式範例</span>

本範例用 CIRCLE 敘述重新繪製一個橢圓,再使用 POINT 敘述來測試顏色是否改變,
以找出橢圓的邊框:

DEFINT X, Y
INPUT "輸入傾斜的角度 (0 到 90): ",Ang
SCREEN 82                           'VGA 繪圖螢幕模式
Ang = (3.1415926# / 180) * Ang      '轉換度度量成為弳度量
Cs = COS(Ang) : Sn = SIN(Ang)
CIRCLE (45, 70), 50, 2, , , 2       '繪製橢圓
PAINT (45, 70), 2                   '在橢圓的內部塗色
FOR Y = 20 TO 120
   FOR X = 20 TO 70
   '檢查圍繞橢圓之長方形的每一點
   IF POINT(X, Y) &lt;&gt; 0 THEN
       '若點落在橢圓中,則在所對應的 "傾斜" 橢圓上繪一點
       Xnew = (X * Cs - Y * Sn) + 200 : Ynew = (X * Sn + Y * Cs)
       PSET(Xnew, Ynew), 2
   END IF
   NEXT
NEXT
END



<hr>

<span id="L8174" class="QBtitle">POKE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8093"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8175"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">POKE 敘述細節</span>

<span class="QH_1">語法</span>
  POKE 位址,位元組

位址參數可為一個運算式的值,用來表示主記憶體的位址; 位址參數其值是介於 0
到 65,535 之間。

位元組參數可為一個運算式,表示所要寫入的資料; 其值介於 0 到 255 之間
的整數值。

位址參數是指由目前預設的節位址(Segment Address)(由 DEF SEG 敘述所設定)
到此參數之間的位移位址(節內位址--Offset Address)值。

如果參數是單或倍精確浮點數,或是長整數,將會被轉換成一個佔 2 個位元組長度的
整數。

POKE 與 PEEK 為互補函數。

                          <span class="QH_1">---------  警告   ---------</span>
    請小心使用 POKE 函數。如果用法不正確,可能會導致 BASIC 或作業系統當機。
                          <span class="QH_1">---------------------------</span>


<hr>

<span id="L8175" class="QBtitle">POKE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8093"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8174"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">POKE 敘述程式範例</span>

請參閱 <span class="QH_2">&lt;</span><a href="#L80B1">DEF SEG 敘述程式範例</a><span class="QH_2">&gt;</span>, 有使用 POKE 敘述。



<hr>

<span id="L8176" class="QBtitle">POS 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8094"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8177"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">POS 函數細節</span>

<span class="QH_1">語法</span>
  POS(0)

最左邊的游標行(Column)位置編號為 1。而使用 CSRLIN 函數,則可以得到游標的
列(Row)位置。



<hr>

<span id="L8177" class="QBtitle">POS 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8094"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8176"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">POS 函數程式範例</span>

本範例使用 POS 函數在每 40 個英文字元之後換到新的一行。

CLS                       ' 清螢幕
PRINT "本程式在每次鍵入 40 個英文字元之後會換行"
PRINT "請鍵入字元,按 &lt;CTRL+C&gt; 時,則結束。"
PRINT
DO
   DO WHILE POS(0) &lt; 41   '停留在同一行,直到輸入 40 個英文字元為止
      DO
         Char$ = INKEY$
      LOOP WHILE Char$ = ""
      '如果輸入的組合鍵是 &lt;CTRL+C&gt; 則結束;否則印列字元
      IF ASC(Char$) = 3 THEN END ELSE PRINT Char$;
   LOOP
   PRINT                  '換到新的一行
LOOP



<hr>

<span id="L8178" class="QBtitle">PRESET 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8095"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8179"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRESET 敘述細節</span>

<span class="QH_1">語法</span>
  PRESET [STEP] (x, y) [,顏色]

PRESET 執行方式與 PSET 類似,除了顏色參數沒有設定時,預設為目前的背景顏色
以外,其餘皆相同。

 <span class="QH_1">參數           說明</span>
  STEP          表示 x,y 座標為相對座標,而不是絕對座標。座標是以最後的
                游標位置為參考點,而不是以(0,0)螢幕座標為參考點。

                例如,最後座標點的參考位置為(10,10), 則
                     PRESET STEP (10,5), 將參考到點(20,15)。

  x             所耍設定圖素(pixel)的 x 座標。

  y             所要設定圖素的 y 座標。

  顏色          給此座標點顏色的顏色屬性暫存器號碼。

假如座標在目前景象埠(viewport)的外面,既不會顯示,也不會產生錯誤的訊息。


<hr>

<span id="L8179" class="QBtitle">PRESET 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8095"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8178"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRESET 敘述程式範例</span>

本範例使用 PSET 和 PRESET 敘述繪製一條具有 20 個圖素(pixel)長的直線,然後由
左而右移動直線經過螢幕。

SCREEN 82 : COLOR 1 : CLS
FOR I = 0 TO 299 STEP 3
    FOR J = I TO 20 + I
        PSET (J, 50), 2         '在新的位置繪一條線
    NEXT
    FOR J = I TO 20 + I
        PRESET (J, 50)          '清除此條線
    NEXT
NEXT



<hr>

<span id="L817A" class="QBtitle">PRINT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8096"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L817B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT 敘述細節</span>

<span class="QH_1">語法</span>
  PRINT [運算式串列][{,|;}]

假如省略運算式串列,則列印一空白行。若包含運算式串列,則運算式的值將列印在螢幕
上。在運算式串列中,運算式可為數值或字串運算式(若為字串定字(literal)時,必須由
雙引號括住)。

列印數值時其後通常跟著一個空白。若數值資料為正數,則於該數值前保留一個空白;
若輸出的數值為負數,則在數位前加上負號(-)。

PRINT 有兩種格式用來顯示單精確度數及倍精確度數 : 定點(fixed point)格式與
浮點數(floating point)格式。
若 PRINT 敘述能使用定點格式表示單精確度數,只要位數不超過 7 位,其值仍不失去
其正確性。否則,需要使用浮點格式。例如,數值 1.1E-6 之輸出顯示為 .0000011,
但數值 1.1E-7 之輸出顯示為 1.1E-7。

同樣地,若 PRINT 能使用定點格式表示倍精確度數,且其位數不超過 16 位數,其值仍不
失去其正確性,否則要使用浮點格式。例如,數值 1.1D-15 輸出為 .0000000000000011,
但數字 1.1D-16 之輸出仍為 1.1D-16。

PRINT 敘述僅提供基本的 BASIC 資料型態(整數,長整數,單精確實數,倍精確實數,
及字串)。使用 PRINT 敘述及個別記錄元素來列印記錄中的資訊,如下列程式片斷:

  TYPE MyType
     Word AS STRING * 20
     Count AS LONG
  END TYPE
  DIM Myrec AS MyType

  PRINT Myrec.Word

<span class="QH_1">列印位置</span>

每一個列印項目的位置,是透過串列中用來分開項目的標點符號來決定的。BASIC 將一行
區分成每個區域佔 14 個空白。在運算式串列中,逗號使得下一個數值列印在下一個區域
的開頭。一個分號使得下一個值緊跟著上一個值列印。鍵入一個或多個空白或 TAB 鍵在
運算式中,與鍵入一個分號的效用是相同的。

若以一個逗號或分號為運算式串列的結束字元,則下一個 PRINT 敘述仍列印在同一行。
假如運算式串列不以逗號或分號結束,則一個歸位(carriage-return)和換行(line-feed)
字元會自動加印在一行的結束。若列印行的寬度較螢幕的寬度還要寬,則 BASIC 會自動
換到下一行並繼續列印。



<hr>

<span id="L817B" class="QBtitle">PRINT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8096"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L817A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT 敘述程式範例</span>

這些範例顯示在 PRINT 敘述中使用逗號及分號的用法。

<span class="QH_1">範例 1</span>

本範例在 PRINT 敘述中使用逗號,來列印每個值在下一個列印區域的開端:

CLS                ' 清螢幕
X = 5
PRINT X + 5, X - 5, X * (-5), X ^ 5
END

<span class="QH_1">範例輸出</span>

 10            0            -25            3125

<span class="QH_1">範例 2</span>

本範例中,在第一個 PRINT 敘述的尾端使用分號,使得前兩個 PRINT 敘述會列印
在同一行上。而最後一個 PRINT 敘述會在下一個提示字串之前列印一個空白行。

CLS                ' 清螢幕
DO
   INPUT "輸入 X (鍵入 0 結束): ", X
   IF X = 0 THEN
      EXIT DO
   ELSE
      PRINT X; "的平方為"; X ^ 2; "而且";
      PRINT X; "的立方為"; X^3
      PRINT
   END IF
LOOP

<span class="QH_1">範例輸出</span>

輸入 X (鍵入 0 結束): 9
 9 的平方為 81 而且 9 的立方為 729

輸入 X (鍵入 0 結束): 21
 21 的平方為 441 而且 21 的立方為 9261

輸入 X (鍵入 0 結束): 0

<span class="QH_1">範例 3</span>

本範例中,在 PRINT 敘述中的分號使得所列印的值緊跟著前一個的值。
注意 : 空白通常跟隨著數值之後且在正數之前。

CLS                ' 清螢幕
FOR X = 1 TO 5
  J = J + 5
  K = K + 10
  PRINT J; K;
NEXT X

<span class="QH_1">範例輸出</span>

 5  10  10  20  15  30  20  40  25  50



<hr>

<span id="L817C" class="QBtitle">PRINT USING 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L804D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L817D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT USING 敘述細節</span>

<span class="QH_1">語法</span>
  PRINT USING 格式字串; 運算式串列[{,|;}]

格式字串參數為字串定字(literal, 或是變數)包含所要列印的定字字元(例如:標記)
及特殊的格式化字元。這些格式化字元決定所要列印字串或數值的欄位。空白,逗號
及分號在運算式串列中與在 PRINT 敘述中有相同的意義。

運算式串列參數包含所要列印的字串運算式或數值運算式,並用分號分開。

當 PRINT USING 用來列印字串時,您可以使用下列三種格式化字元中的一種來格式化
字串欄位:

 <span class="QH_1">字元        說明</span>
  !          僅印出給定字串中的第一個字元。
             若第一個字元是一個佔 2 個位元組長度的中文字元時,會印出該
             中文字元。

  \     \    由指定字串中列印 n+2 個以 "位元組" 為計算單位的資料,其中
             n 是介於兩個倒斜線間的空白碼(&H20)數目。
             若在倒斜線格式中的最右邊不能容納一個完整的中文字時,該中文
             字元將不會被印出。

  &          為指定變動長度字串欄位。當該欄位用 & 符號來設定時,則依照
             該字串原有的長度印出。

當 PRINT USING 被用來列印數值時,下列特殊字元可用來格式化數值欄位:

 <span class="QH_1">字元         說明</span>
  #           每一個 # 號代表一個數字的位置。如果數值資料被列印的位數
              少於設定的位置時,會向右靠齊(左邊補空白碼)。

  .           列印小數點。小數點可以插入到欄位中的任意位置上。小數點
              右邊的 # 號數字位數大於所要列印的數值資料時,多餘的位置
              會補 0 ; 若小於,則數值資料會被四捨五入。

  +           在數值資料的前面(若出現在格式化字串的前面),或後面
              (若出現在格式化字串的後面)列印正負號。

  -           若 "-" 字元出現在格式化字串的後面,則在數值資料為負數時,
              會在後面加上負號。

  **          在數值前面的空白位置補上 * 號。此兩個 * 號會使得原來由
              # 號所設定的位數,多增加二個數字位置。

  $$          在最左邊的第一位數字之前加上 $ 號。$$ 會使得原來由 # 號
              所設定的位數,多增加二個數字位置,其中之一是顯示錢號。

  **$         組合雙 * 號與雙 $ 號的功能。數值資料前面的前置空白碼
              以 * 號補上,而且在所列印數值的前面加上一個 $ 號。
              **$ 會使得原來由 # 號所設定的位數,多增加三個數字位置,
              其中之一是顯示 $ 號;當數值資料為負數時,負號會出現在
              $ 號的前面。

  ,           若逗號出現在格式化字串中小數點的左邊,則從小數點向左
              算起每三位加一逗號。若出現在格式化字串的尾部,則它被
              當成是字串的部分來列印。逗號若出現在指數(^^^^ 或^^^^)
              格式中,並不發生效用。

  ^^^^        設定指數格式,您可以使用 5 個補助符號(^^^^^) 來允許 E+xxx
              列印更大的數值。小數點可被設定在任意位置。有效位數是向左
              靠齊,但指數是可調整的。除非前置 + 號或後置 + 號,或者設定
              - 號,小數點左邊的一個位數會被用來列印一個空白或一個減號。

  _           底線在格式化字串中,用來將下一個字元當做定字(literal)字元
              印出。在一個格式化字串中,使用二個底線(__)可印出一個定字的
              底線。

  注意: 若欲列印的數字大於所設定的數值欄位,則百分比符號(%)列印在數值的
        前面。若四捨五入導致數值超出該欄位,百分比符號仍列印在四捨五入後
        的數值前。如果設定的數值的位數超過 24 位,則產生 "不正確函數呼叫"
        的錯誤訊息。


<hr>

<span id="L817D" class="QBtitle">PRINT USING 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L804D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L817C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT USING 敘述程式範例</span>

這些範例顯示字串與數值格式化字元在 PRINT USING 敘述中的用法。

<span class="QH_1">範例 1</span>

本範例使用 "字串格式化字元" :

CLS    ' 清螢幕
a$ = "QuickBASIC"
b$ = "中文化"
PRINT USING "!"; a$
PRINT USING "!"; b$
PRINT USING "\   \"; a$            ' n = 3
PRINT USING "\  \"; b$             ' n = 2
PRINT USING "\   \"; b$            ' n = 3


<span class="QH_1">範例輸出</span>

Q
中
Quick
中文
中文

<span class="QH_1">範例 2</span>

本範例顯示使用不同組合的 "數值格式化字元" 以後的效果:

'格式化並且列印數值資料
CLS    ' 清螢幕
PRINT USING "##.##"; .78
PRINT USING "###.##"; 987.654
PRINT USING "##.##   "; 10.2, 5.3, 66.789, .234
PRINT USING "+##.##   "; -68.95, 2.4, 55.6, -.9
PRINT USING "##.##-   "; -68.95, 22.449, -7.01
PRINT USING "**#.#   "; 12.39, -0.9, 765.1
PRINT USING "$$###.##"; 456.78
PRINT USING "**$##.##"; 2.34
PRINT USING "####,.##"; 1234.5
PRINT USING "##.##^^^^"; 234.56
PRINT USING ".####^^^^-"; -888888
PRINT USING "+.##^^^^"; 123
PRINT USING "+.##^^^^^"; 123
PRINT USING "_!##.##_!"; 12.34
PRINT USING "##.##"; 111.22
PRINT USING ".##"; .999

<span class="QH_1">範例輸出</span>

 0.78
987.65
10.20    5.30   66.79    0.23
-68.95    +2.40   +55.60    -0.90
68.95-   22.45     7.01-
*12.4   *-0.9   765.1
 $456.78
***$2.34
1,234.50
 2.35E+02
.8889E+06-
+.12E+03
+.12E+003
!12.34!
%111.22
%1.00

<span class="QH_1">範例 3</span>

CLS
PRINT USING "#####,.#"; 12345.67
PRINT USING "#####+"; 1234
PRINT USING ",#####"; 12345
PRINT USING "###.####,##"; 123.12345#
PRINT USING "###.,###"; 123.12345#

<span class="QH_1">範例輸出</span>

12,345.7
 1234+
,12345
123.1235,
123.,


<hr>

<span id="L817E" class="QBtitle">PRINT # 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L804E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L817F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT # 敘述細節</span>

<span class="QH_1">語法</span>
  PRINT #檔案代碼, [USING 字串運算式;] 運算式串列[{,|;}]

檔案代碼為以 "輸出模式" 開啟的檔案代號。字串運算式是由在 PRINT USING 敘述
中描述的格式化字元所組成的。在運算式串列中的運算式可為數值或字串運算式,
它們將被寫到所指定的檔案中。在運算式串列中的空白,逗號和分號,與 PRINT 敘述
中具有相同的意義。

若您省略運算式串列, PRINT # 敘述會在所指定的檔案中列印一個空白行。

PRINT # 與 PRINT 的用法類似,並且可以將資料寫到指定的檔案中,正如同資料
在螢幕中顯示一樣。為了此原因,請小心分隔資料,使得能正確的輸出。若您使用
逗號為分隔字元時,在列印欄位間的空白也會寫到檔案中。



<hr>

<span id="L817F" class="QBtitle">PRINT # 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L804E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L817E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PRINT # 敘述程式範例</span>

本範例顯示在 PRINT # 敘述中使用資料分隔字元的效用。

CLS                                    ' 清螢幕
A$ = "CAMERA, AUTOFOCUS" : B$= "September 20, 1985": C$ = "42"
Q$ = CHR$(34)
OPEN "INVENT.DAT" FOR OUTPUT AS #1     '開啟輸出檔 INVENT.DAT 以供
                                        '寫入 A$, B$, C$ 而不需分隔字元
PRINT #1, A$; B$; C$
'寫入 A$, B$, C$ 使用分隔字元
PRINT #1, Q$; A$; Q$; Q$; B$; Q$; Q$; C$; Q$
CLOSE #1
OPEN "INVENT.DAT" FOR INPUT AS #1      '開啟輸出檔 INVENT.DAT 以供讀取
FOR I% = 1 TO 2                        '讀取前兩個記錄並列印
   INPUT #1, First$, Second$, Third$
   PRINT First$; TAB(30); Second$; TAB(60); Third$ : PRINT
NEXT
CLOSE #1

<span class="QH_1">範例輸出</span>

CAMERA                  AUTOFOCUSSeptember 20           198542

CAMERA, AUTOFOCUS       September 20, 1985              42



<hr>

<span id="L8180" class="QBtitle">PSET 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8097"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8181"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PSET 敘述細節</span>

<span class="QH_1">語法</span>
  PSET [STEP] (x, y) [,顏色]

 <span class="QH_1">參數           說明</span>
  STEP          指定 x 座標,y 座標為相對座標,而不是絕對座標。座標是
                以上一次游標停留位置為參考點,而不是以(0,0)螢幕座標為
                參考點。

                例如,若上一次座標點的參考位置為(10,10),則
                     PSET STEP (10,5), 將畫點在 (20,15) 位置。

  x             為所要設定圖素(pixel)的 x 座標。

  y             為所要設定圖素的 y 座標。

  顏色          給此座標點顏色的顏色屬性暫存器號碼。

假如座標在目前景象埠(viewport)的外面,既不會顯示,也不會產生任何錯誤的訊息。

PSET 允許敘述內不使用顏色參數,假如省略顏色參數,則預設為目前的前景顏色。


<hr>

<span id="L8181" class="QBtitle">PSET 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8097"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8180"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PSET 敘述程式範例</span>

本範例繪製從(0,0)到(100,100) 的直線,然後藉著使用背景顏色再繪製一次,亦即
清除該直線。

SCREEN 82
' 繪製從(0,0)到(100,100)的直線。
FOR I = 0 TO 100
   PSET (I, I)
NEXT I
LOCATE 16,2: INPUT "按任何鍵清除該直線", Gar$
' 清除該直線
PSET (I-1, I-1), 0
FOR I = 0 TO 100
   PSET STEP (-1, -1), 0
NEXT I
LOCATE 16,2: PRINT "                                    "



<hr>

<span id="L8182" class="QBtitle">PUT(檔案輸入/輸出) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8183"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PUT(檔案輸入/輸出) 敘述細節</span>

<span class="QH_1">語法</span>
  PUT [#]檔案代碼 [,[記錄代碼] [,變數]]
  或
  PUT [#]檔案代碼 [,{記錄代碼 | 記錄代碼, 變數 | ,變數}]

  <span class="QH_1">參數           說明</span>
  檔案代碼       已在 OPEN 敘述中被開啟的檔案代號。

  記錄代碼       對於隨機模式檔而言,為所要寫入的記錄編號(record number)。
                 對於二進位檔,則為所要寫入檔案的位元組位置。第一筆記錄
                 在檔案中的記錄代碼為 1。如果省略記錄代碼,則下一筆為
                 所要寫入的記錄或位元組位置(為在上次 GET 或 PUT 敘述執行
                 以後,或是在上次 SEEK 敘述所指到的位置之後)。最大的記錄
                 代碼可為 : 2^31 -1 或 2,147,483,647。

  變數           變數中包含所要寫到檔案的資料。PUT 敘述會將此變數內
                 所包含的資料內容(全部的位元組)寫入檔案。

                 假如您使用一個變數,就不需要在寫入檔案之前,使用
                 MKI$, MKL$, MKS$, 或 MKD$ 來轉換數值欄位。若您使用
                 變數參數,可以不必使用 FIELD 敘述。

                 對於隨機存取檔,您可以使用任何變數,只要變數的長度小於,或等於
                 記錄的長度。通常一個記錄變數與定義在資料記錄的欄位相符合。

                 對於二進位模式檔,您可以使用任何變數。

                 當使用變動長度字串變數時,該敘述寫入與在字串值中之長度相同
                 的字元數。例如,下面兩個敘述寫入 15 個位元組到檔案代碼為 1
                 的檔案中:

                   VarString$=STRING$ (15, "X")
                   PUT #1,,VarString$

                 可參閱下面的範例,有提供更多關於在隨機存取檔中使用變數,
                 但不是用 FIELD 敘述所定義的變數之相關資訊。

                 一個記錄的長度不能超過 32,767 個位元組。


您可以省略記錄代碼,或變數或者兩者都省略。若僅省略記錄代碼,必須仍然用逗號分開:

  PUT #4,,FileBuffer

若兩個參數都省略,則不需要包括逗號:

  PUT #4

GET 和 PUT 敘述允許對 BASIC 通訊檔案做固定長度的輸入和輸出。在通訊上,
請小心使用 GET 和 PUT 敘述。因為 PUT 是以固定的字元數做寫入,而且如果
通訊失敗時,可能會一直等待下去。

  注意: 當使用由一個 FIELD 敘述所定義的檔案緩衝區,則 LSET, RSET, PRINT #,
        PRINT # USING, 和 WRITE # 等敘述可能在執行 PUT 敘述之前將字元放入
        隨機檔的緩衝區。在這種情況之下的 WRITE # 敘述, QuickBASIC 會將空白
        及歸位(carriage-return)字元填到緩衝區中。任何試圖讀取或寫入資料
        超過緩衝區大小時,會產生 "欄位超值溢位" 的錯誤訊息。


<hr>

<span id="L8183" class="QBtitle">PUT(檔案輸入/輸出) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L805A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8182"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PUT(檔案輸入/輸出) 敘述程式範例</span>

本範例從控制台讀取姓名及分數,並將它們存入隨機存取檔中。

' 從控制台讀取姓名及分數
' 儲存每一個姓名及分數為一筆記錄,並存入隨機存取檔內。

' 定義記錄欄位
TYPE TestRecord
   NameField  AS STRING * 20
   ScoreField AS SINGLE
END TYPE

' 開啟測試資料檔
DIM FileBuffer AS TestRecord
OPEN "TESTDAT.DAT" FOR RANDOM AS #1 LEN = LEN(FileBuffer)

' 從控制台讀取姓名及分數

CLS    ' 清螢幕
I = 0
DO
   I = I + 1
   INPUT "姓名 ? ", FileBuffer.NameField
   INPUT "分數? ", FileBuffer.ScoreField
   INPUT "--&gt;繼續 (y/n)? ", Resp$
   PUT #1, I, FileBuffer
LOOP UNTIL UCASE$(MID$(Resp$, 1, 1)) = "N"

PRINT I; " 記錄已寫入。"

CLOSE #1


<hr>

<span id="L8184" class="QBtitle">PUT(繪圖) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L804F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8185"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PUT(繪圖) 敘述細節</span>

<span class="QH_1">語法</span>
  PUT [STEP] (x, y), 陣列名稱[(索引)] [,作用]

 <span class="QH_1">參數          說明</span>
  STEP         指定 x 和 y 座標為相對座標,而不是絕對座標。座標以最後的
               游標位置為參考點,而不是螢幕座標 (0,0) 為參考點。

               例如,若最後座標參考點為(10,10), 則
                    PUT STEP (10,5),Ball
                    將存在 BALL 中的影像資料放在 (20,15) 上。

  (x,y)        在目前的輸出視窗上,要放置矩形影像資料的左上角座標點。

  陣列名稱     陣列名稱參數用來儲存影像。請參閱 GET(繪圖)敘述有說明如何
               計算儲存影像所需陣列容量的公式。陣列可為多維陣列
               (multidimensional array)。

  索引         設定所要讀取的影像是從指定陣列中的第 N 個元素開始,而不是
               從陣列的第一個元素開始。

  作用         作用(actionverb)參數用來決定儲存的資料影像與目前顯示在螢幕
               上的影像,彼此間的作用。


不同的作用參數值在下列中有說明。預設的作用參數為 XOR。

 <span class="QH_1">動作                   說明</span>
  PSET     螢幕上每一點有其顏色的屬性,PSET 是將 GET 敘述原來從螢幕上
           所儲存之點,再以原圖(點對點方式)放到螢幕指定的位置。

  PRESET   類似 PSET,但顯示在螢幕上的圖素(pixel)與原圖相反(例如,黑變白)。

  AND      用來將影像放到目前螢幕上已存在的影像上,而最後影像的結果為
           將螢幕上的顏色與所要 PUT 圖形中之顏色做 AND 邏輯運算。
           因此,對於每一點而言,若兩個影像點的顏色相同,就保留相同的顏色;
           若不相同,就清掉該點。

  OR       用來將影像重疊到目前螢幕上已存在的影像上;以 GET 敘述所儲存
           的影像並不清洗目前螢幕上的內容。最後的影像為儲存的影像點與
           螢幕上的影像點做邏輯 OR 的結果。

  XOR      一種特殊的模式,常常被使用在動畫上。最後的影像為儲存的影像點與
           螢幕上的影像點做邏輯 XOR 的結果。這動作類似游標 : 即將儲存的
           影像使用 XOR 作用放置在螢幕上同一位置二次時,原來在螢幕上的圖形
           會被還原成原圖。這允許您移動一個物體(object)來環繞整個螢幕,卻
           不會清洗(破壞)掉原來在螢幕上的圖形。


<hr>

<span id="L8185" class="QBtitle">PUT(繪圖) 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L804F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8184"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">PUT(繪圖) 敘述程式範例</span>

本範例產生一個可移動的白球,在螢幕的四周跳動,直到按下任意鍵為止。

DEFINT A-Z
DIM Ball(84)              '宣告一個足夠容納一個球圖形的整數陣列
SCREEN 71                 '設定 MGA 螢幕模式

INPUT "按任意鍵結束;按&lt;ENTER&gt;鍵開始", Test$
CLS
CIRCLE (16, 16), 14       '繪製一球形且塗上顏色
PAINT (16, 16), 1
GET (0, 0)-(32, 32), Ball
X = 0 : Y = 0
Xdelta = 2 : Ydelta = 1

DO
   '只要球在螢幕-(0,0)到(640,200)的邊界內,就可以同方向繼續移動
   X = X + Xdelta : Y = Y + Ydelta
   IF INKEY$ &lt;&gt; "" THEN END  ' 測試是否按鍵
   '若球落在最左或最右的邊界上,則更改 x 座標的方向
   IF (X &lt; 1 OR X &gt; 600) THEN
      Xdelta = -Xdelta
      BEEP
   END IF
   '若球落在最上面或最下面的邊界上,則更改 y 座標的方向
   IF (Y &lt; 1 OR Y &gt; 160) THEN
      Ydelta = -Ydelta
      BEEP
   END IF
   '將新的影像放置在螢幕上,亦即將舊影像清洗掉
   PUT (X, Y), Ball, PSET
LOOP
END



<hr>

<span id="L8186" class="QBtitle">RANDOMIZE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8098"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8187"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RANDOMIZE 敘述細節</span>

<span class="QH_1">語法</span>
  RANDOMIZE [運算式]

假如省略運算式,在執行 RANDOMIZE 敘述之前 QuickBASIC 會暫停執行,並顯示下列
訊息來要求輸入一個數值 :

  亂數種子 (-32768 到 32767)?


當您使用運算式參數,QuickBASIC 使用該值當作亂數產生器的種子(初值)。

如果不重新設定亂數產生器的種子,則 RND 函數在每次程式執行時,傳回相同次序
的亂數。為了改變程式每次執行時的亂數次序,可以將 RANDOMIZE 敘述放置在程式
的開端,並且每次執行的時候更改其參數。

另一種較方便的方法就是使用 TIMER 函數,如此可保證每次使用時,程式將會產生
新的亂數序列。



<hr>

<span id="L8187" class="QBtitle">RANDOMIZE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8098"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8186"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RANDOMIZE 敘述程式範例</span>

本範例使用 RANDOMIZE 來模擬投擲一對骰子。

' 使用計時器(TIMER)為亂數產生器的種子。
RANDOMIZE TIMER
DO
   ' 使用 RND 函數模擬投擲二個骰子
   D1 = INT(RND * 6) + 1
   D2 = INT(RND * 6) + 1
   ' 列印投擲之結果
   CLS    ' 清螢幕
   PRINT "您擲一個為"; D1; "另一個為"; D2; " 總和為"; D1 + D2
   INPUT "再擲一次(Y/N)"; Resp$
   PRINT
LOOP UNTIL UCASE$(MID$(Resp$, 1, 1)) = "N"
END

<span class="QH_1">範例輸出</span>

您擲一個為 3 另一個為 5 總和為 8
再擲一次(Y/N)? y

您擲一個為 4 另一個為 1 總和為 5
再擲一次(Y/N)? y

您擲一個為 5 另一個為 6 總和為 11
再擲一次(Y/N)? n



<hr>

<span id="L8188" class="QBtitle">READ 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8099"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8189"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">READ 敘述細節</span>

<span class="QH_1">語法</span>
  READ 變數串列

變數串列參數是由逗號所分隔的一系列有效的 QuickBASIC 變數。

READ 敘述通常與 DATA 敘述配合使用。READ 敘述指定 DATA 的值為一對一的方式
對應到該變數。這些變數可能為數值或字串變數。若試圖讀取一個字串值到數值變數
中,將會產生執行時的語法錯誤。但讀取數值到字串變數中,並不會產生錯誤,而是會將
該值以數值字串來儲存。

將數值讀入到整數變數時,在該值指定給變數之前會先作四捨五入。讀取一個太大的
數值給一個變數時,將產生執行期間(run-time)的錯誤。

當一個字串值讀入到固定長度字串變數時,若字串太長,則超過的部份將會被捨棄掉。
字串值若比字串變數的長度還要短,則會向左靠齊並補空白字元(&H20)。

僅個別的記錄元素變數可以出現在 READ 敘述。

單一的 READ 敘述可能使用一個或多個 DATA 敘述(依其順序取用),或多個 READ
敘述可能使用相同的 DATA 敘述。若在變數串列中的變數比在 DATA 敘述中的值
還要多,將產生 "資料不足" 的錯誤訊息。若變數比在 DATA 敘述中的元素個數
還要少,後面的 READ 敘述則會從第一個尚未被讀取的 DATA 資料項元素開始讀取。
若後面沒有 READ 敘述,則多餘的 DATA 資料項將會被忽略掉。

使用 RESTORE 敘述可以重新讀取 DATA 敘述中的資料。



<hr>

<span id="L8189" class="QBtitle">READ 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8099"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8188"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">READ 敘述程式範例</span>

本範例顯示如何使用 READ 敘述來讀取資料並放入使用者自定型態 Employee 中。

TYPE Employee
   EmpName AS STRING * 35
   SocSec AS STRING * 11
   JobClass AS INTEGER
END TYPE

CLS                ' 清除螢幕
DIM ThisEmp AS Employee
DATA "Julia Magruder","300-32-3403",3
DATA "Amelie Reeves Troubetzkoy","777-29-3206",7

' 讀取第一筆資料,並且列印資料來驗證
READ ThisEmp.EmpName, ThisEmp.SocSec, ThisEmp.JobClass
PRINT "員工為"; ThisEmp.EmpName
PRINT "員工的社會安全號碼為"; ThisEmp.SocSec
PRINT "員工的職業為"; ThisEmp.JobClass
PRINT    ' 列印空白行

' 讀取第二筆資料並驗證
READ ThisEmp.EmpName, ThisEmp.SocSec, ThisEmp.JobClass
PRINT "員工為"; ThisEmp.EmpName
PRINT "員工的社會安全號碼為"; ThisEmp.SocSec
PRINT "員工的職業為"; ThisEmp.JobClass

<span class="QH_1">範例輸出</span>

員工為 Julia Magruder
員工的社會安全號碼為 300-32-3403
員工的職業為 3

員工為 Amelie Reeves Troubetzkoy
員工的社會安全號碼為 777-29-3206
員工的職業為 7



<hr>

<span id="L818A" class="QBtitle">REDIM 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L818B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">REDIM 敘述細節</span>

<span class="QH_1">語法</span>
  REDIM [SHARED] 變數(註標) [AS 型態] [,變數(註標) [AS 型態]]...

  <span class="QH_1">參數         說明</span>
  SHARED       選擇項 SHARED 屬性,允許在同一個模組中的所有程序式共用變數;
               SHARED 屬性不同於 SHARED 敘述, SHARED 敘述僅影響在一個單一
               模組中的變數而已。SHARED 屬性僅用在模組層次碼的 REDIM 敘述
               中。

  變數         為一個 BASIC 變數名稱。

  註標         陣列的維度(dimension)。可以宣告為多維陣列。註標的語法
               如下所描述。

  AS 型態      宣告變數為一個基本的型態,或是使用者自定型態。
               基本的型態有: INTEGER, LONG, SINGLE, DOUBLE, 及 STRING。

在 REDIM 敘述中的註標(subscript),有下列的格式:

  [下界 TO] 上界 [,[下界 TO] 上界]...

TO 關鍵字提供另一種方法來設定陣列註標的下界(lower bound)及上界(upper bound)。
下界及上界參數為數值運算式用來設定註標最下界及最上界的值。
請參閱<span class="QH_2">&lt;</span><a href="#L80B4">DIM 敘述細節</a><span class="QH_2">&gt;</span> 有更多關於 TO 關鍵字的用法。

REDIM 敘述用來更改已經使用 $DYNAMIC 宣告的陣列之配置空間。

當 REDIM 敘述已被編譯過(is compiled),在此敘述中宣告的所有陣列會被視為
動態陣列。在執行時間(run-time),當 REDIM 敘述執行時,陣列會被釋放掉(假如
已經配置),然後再重新配置新的維度。舊有的陣列元素值已遺失,因為所有的數值
元素會被重設為 0,並且所有的字串元素會被重設為空字串。

  注意: 雖然您可用 REDIM 敘述修改陣列的大小,但卻無法修改其維度。
        例如,下列敘述是合法的:

          ' $DYNAMIC
          DIM A(50,50)
          ERASE A
          REDIM A(20,15)    '陣列 A 仍然為二維陣列

        無論如何,下列敘述是不合法的,且產生 "錯誤的維數" 的錯誤訊息。

          ' $DYNAMIC
          DIM A(50,50)
          ERASE A
          REDIM A(5,5,5)   '修改二維成為三維陣列


<hr>

<span id="L818B" class="QBtitle">REDIM 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809A"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L818A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">REDIM 敘述程式範例</span>

本範例顯示如何使用 REDIM 來配置記錄的陣列,然後如何釋放記錄所使用的記憶體。

TYPE KeyElement
   Word AS STRING * 20
   Count AS INTEGER
END TYPE

' 成為動態陣列
' $DYNAMIC
CLS                          ' 清除螢幕
' 當需要時,配置一個記錄陣列
REDIM Keywords(100) AS KeyElement
Keywords(99).Word = "ERASE"
Keywords(99).Count = 2
PRINT "關鍵字 99 為 "; Keywords(99).Word
PRINT "次數為"; Keywords(99).Count
' 當使用完成後,釋放關鍵字 Keywords 陣列所佔用的空間
ERASE Keywords
END

<span class="QH_1">範例輸出</span>

關鍵字 99 為 ERASE
次數為 2



<hr>

<span id="L818C" class="QBtitle">REM 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L818D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">REM 敘述細節</span>

<span class="QH_1">語法</span>
  REM 註解
  ' 註解

REM 敘述不會被編譯(compiled),但程式被列印時,仍然會列印該註解行。
您可以從 GOTO 或 GOSUB 敘述分歧到 REM 敘述上,繼續執行在 REM 敘述
的下一個可執行的敘述。

使用一個單引號可代替 REM 關鍵字。若在一程式行中,REM 關鍵字後面跟隨著
其他敘述,則必須用冒號與其他敘述分開。REM 敘述也可用來介紹假命令。

  注意: 請勿在 DATA 敘述中使用 REM 敘述的單引號格式,因為單引號會
        被視為有效資料。


<hr>

<span id="L818D" class="QBtitle">REM 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L818C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">REM 敘述程式範例</span>

本範例顯示二個相等的註解敘述。注意,您必須在 REM 敘述的前面使用冒號。

                         <span class="QH_1">--------- 注意 ---------</span>
    這不是一個完整的程式,請勿以目前的格式執行此範例。
                         <span class="QH_1">------------------------</span>

FOR I = 1 TO 23 : Array(I) = 1 : NEXT I : REM 起始化陣列
FOR I = 1 TO 23 : Array(I) = 1 : NEXT I   ' 起始化陣列



<hr>

<span id="L818E" class="QBtitle">RESET 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L818F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RESET 敘述細節</span>

<span class="QH_1">語法</span>
  RESET

RESET 敘述會關閉所有已經被開啟的磁碟檔,並且將檔案緩衝區的資料寫到指定磁碟機
的檔案中。

當磁碟片從磁碟機中取走之前,所有的檔案必須要被關閉。



<hr>

<span id="L818F" class="QBtitle">RESET 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809C"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L818E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

RESET 敘述沒有提供程式範例。



<hr>

<span id="L8190" class="QBtitle">RESTORE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8191"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RESTORE 敘述細節</span>

<span class="QH_1">語法</span>
  RESTORE [{行標記 | 行號}]

在執行沒有設定行標記或行號的 RESTORE 敘述以後,則下一個 READ 敘述是讀取程式
中第一個 DATA 敘述中的第一個資料項。

假如有設定行號或行標記,則下一個 READ 敘述是讀取該參數所指定的 DATA 敘述
中第一個資料項。若設定某一行,則該行標記必須出現在模組層次碼中。

注意 : 在 QuickBASIC 的環境中, 所有的 DATA 敘述會被自動地移到模組層次碼中。



<hr>

<span id="L8191" class="QBtitle">RESTORE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809D"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8190"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RESTORE 敘述程式範例</span>

QCARDS.BAS 被使用在 QuickBASIC 使用手冊中當成教學程式,其中有廣泛的使用
RESTORE 敘述。該程式被包含在所發行的 QuickBASIC 套裝軟體磁片中。可查閱
QCARDS.BAS 程式本文,了解如何使用 RESTORE 敘述,並可使用 [F/檔案] 功能表
中的 "O/載入程式" 命令載入該檔。至於執行 QCARDS.BAS 檔,您必須跟隨著
QuickBASIC 使用手冊中的指示來操作。



<hr>

<span id="L8192" class="QBtitle">RESUME 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8193"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RESUME 敘述細節</span>

<span class="QH_1">語法</span>
  RESUME [0]
  RESUME NEXT
  RESUME {行標記 | 行號}

不同形式的 RESUME 敘述會改變程式的流程,如下列的說明:

  <span class="QH_1">敘述                說明</span>
  RESUME [0]          在包含錯誤處理常式(error-handling routine)的模組中,
                      由發生錯誤的地方繼續執行。在發生錯誤的模組中,若存在
                      一個有效的錯誤處理常式,在此常式中當執行到此敘述時,
                      會由導致錯誤發生的敘述上繼續執行。

  RESUME NEXT         在包含錯誤處理常式模組中,由發生錯誤地方的下一行
                      開始執行。在發生錯誤的模組中,若存在一個有效的錯誤
                      處理常式,在此常式中當執行到此敘述時,會由導致錯誤
                      發生的下一個敘述繼續執行。

  RESUME 行標記       由指定的行標記繼續執行。

  RESUME 行號         由指定的行號繼續執行。

RESUME 敘述若不在錯誤處理常式中,則會產生 "RESUME 敘述無對應的錯誤狀況"
的錯誤訊息。當執行到錯誤處理常式的尾端而沒有發現 RESUME 敘述,則會產生
"沒有 RESUME 敘述" 的錯誤訊息。

在 RESUME { 行標記 | 行號 } 敘述中所指定的行參數,必須在模組層次碼中有
定義。儘量在 RESUME 敘述中避免使用行標記的選擇項。若省略行標記,則允許
程式在任何發生錯誤的位置上,繼續執行。

  注意: 程式中包含錯誤處理常式必須在 BC 的命令行中選擇 /E(On Error)
        或 /X (Resume Next) 的選擇項才可以正確的編譯。當在 QuickBASIC
        工作環境下編譯,或使用 QuickBASIC [R/執行] 功能表的 "產生 .EXE"
        命令,皆不需要選擇項。

<span class="QH_1">與 BASICA 的差異</span>

在 BASICA 中,若錯誤發生在 DEF FN 函數中,RESUME 及 RESUMR NEXT 敘述
會試圖在函數中的程式行繼續執行程式。


<hr>

<span id="L8193" class="QBtitle">RESUME 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809E"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8192"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RESUME 敘述程式範例</span>

本範例中包含起始行號為 900 的錯誤處理常式,用來對 SQR 函數中的負參數做設陷。

5 CLS
10 ON ERROR GOTO 900
20 FOR I = 4 TO -2 STEP -1
30     PRINT I, 1 - SQR(I)
40 NEXT
50 END

900 '錯誤處理常式
910 PRINT "參數不可為負值"
920 RESUME NEXT

<span class="QH_1">範例輸出</span>

4      -1
3      -.7320508
2      -.4142135
1       0
0       1
-1      參數不可為負值
-2      參數不可為負值



<hr>

<span id="L8194" class="QBtitle">RETURN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8195"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RETURN 敘述細節</span>

<span class="QH_1">語法</span>
  RETURN [{行標記 | 行號}]

若沒有行標記,RETURN 敘述繼續由事件發生的位置執行(對事件處理而言),或由
GOSUB 敘述的下一行(對次常式(subroutine)的呼叫而言)執行。沒有行標記的
GOSUB 和 RETURN 敘述,可以使用在程式中的任何地方,但是 GOSUB 及所對應的
RETURN 敘述必須在同一個層次之中。

在 RETURN 敘述中的行標記或行號將導致無條件的從一個 GOSUB 次常式中回到
所指定的行。若 RETURN 敘述中含有行標記或行號時,僅能將控制權傳回到模組
層次碼中的敘述上。

RETURN 敘述無法由 SUB 所定義的副程式中,將控制權傳回給呼叫的程式,但可以
使用 EXIT SUB 敘述來離開 SUB 程序式。

  注意:  QuickBASIC 的 SUB 程序式比 GOSUB 次常式提供了更好的結構化選擇。


<hr>

<span id="L8195" class="QBtitle">RETURN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L809F"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8194"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱<span class="QH_2">&lt;</span><a href="#L80E8">GOSUB 敘述程式範例 </a><span class="QH_2">&gt;</span>, 有使用 RETURN 敘述。



<hr>

<span id="L8196" class="QBtitle">RIGHT$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8197"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RIGHT$ 函數細節</span>

<span class="QH_1">語法</span>
  RIGHT$(字串運算式,n)

字串運算式參數可為任何字串變數,字串常數或字串運算式。若 n 等於字串運算式參數
中的位元組總數,則 RIGHT$ 函數傳回整個字串運算式。如果 n = 0,則 RIGHT$ 函數將
傳回空字串(長度為零)。



<hr>

<span id="L8197" class="QBtitle">RIGHT$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8196"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RIGHT$ 函數程式範例</span>

本範例將 "名[別號],姓" 的格式轉換為 "姓,名[別號]" 的格式。

CLS                                  ' 清除螢幕
LINE INPUT "姓名: "; Nm$
I = 1 : Sppos = 0
DO WHILE I &gt; 0
    I = INSTR(Sppos + 1, Nm$, " ")   '讀取下一個空白的位置
    IF I &gt; 0 THEN Sppos = I
LOOP

'SPPOS 變數指到最後空白的位置
IF Sppos = 0 THEN
    PRINT Nm$                        '僅輸入姓
ELSE
    '最後空白之後的字串(即姓)
    Lastname$ = RIGHT$(Nm$, LEN(Nm$) - Sppos)
    '最後空白之前的字串(即名)
    Firstname$ = LEFT$(Nm$, Sppos - 1)
    PRINT Lastname$ ", " Firstname$
END IF
END


<hr>

<span id="L8198" class="QBtitle">RMDIR 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A1"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8199"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RMDIR 敘述細節</span>

<span class="QH_1">語法</span>
  RMDIR 路徑名稱

路徑名稱參數為所欲刪除的目錄名稱。路徑名稱必須是小於 128 個英文字元的字串。

所欲刪除的目錄中不能有任何檔案存在,除非是工作目錄('.')及父目錄 ('..');
否則,將出現 "找不到設定的路徑" 或 "路徑/檔案存取錯誤" 的錯誤訊息。

RMDIR 執行方式與 DOS 命令相似。但是在 QuickBASIC 中的語法無法像 DOS 命令
可簡寫為 RD ,而必須使用全名。


<hr>

<span id="L8199" class="QBtitle">RMDIR 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A1"> Quick 畫面 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="#L8198"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RMDIR 敘述程式範例</span>

本範例顯示如何使用 RMDIR 來刪除子目錄。

                <span class="QH_1">------------ 注意 ------------</span>
請勿執行此範例除非在目錄 \SALES 之下有子目錄 \TEMP, 並且是您想要刪除的
該子目錄。
                <span class="QH_1">------------------------------</span>

CHDIR "C:\SALES\TEMP"     '移到 \SALES之下的 \ TEMP 子目錄
KILL "*.*"                '刪除在 \TEMP 子目錄之下的所有檔案
CHDIR ".."                '回到 \SALES 目錄之下
RMDIR "TEMP"              '刪除 \TEMP 子目錄


<hr>

<span id="L819A" class="QBtitle">RND 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A2"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L819B"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RND 函數細節</span>

<span class="QH_1">語法</span>
  RND[(n)]

 n 的值決定 RND 函數如何產生下一組亂數 :

  <span class="QH_1">參數             傳回數值</span>
  n &lt; 0            對給定的任意 n 值,都會傳回相同的數值。

  省略 0 或 n      傳回序列中的下一個亂數。

  n = 0            傳回上次所產生的亂數。

如果 n &gt; 0,則每次程式執行時會產生相同序列的亂數,除非您每次執行程式時再重新
啟始化亂數產生器(可參閱 RANDOMIZE 敘述,提供亂數產生器啟始化的更多資訊)。

然後您可以再使用下列公式,來產生固定範圍的整數亂數 :

  INT ((上界 - 下界 + 1) * RND + 下界)

其中上界(upper bound)為範圍中最大的數值,下界(lower bound)是範圍中的最小的
數值。



<hr>

<span id="L819B" class="QBtitle">RND 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A2"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L819A"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

下列程式範例有使用 RND 函數:

   <span class="QH_2">&lt;</span><a href="#L8187">RANDOMIZE 敘述程式範例</a><span class="QH_2">&gt;</span>, 和
   <span class="QH_2">&lt;</span><a href="#L81E8">TYPE...END TYPE 敘述程式範例</a><span class="QH_2">&gt;</span>。



<hr>

<span id="L819C" class="QBtitle">RSET 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8079"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L819D"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RSET 敘述細節</span>

<span class="QH_1">語法</span>
  RSET 字串變數 = 字串運算式

字串變數通常是一個隨機存取檔的欄位,是在 FIELD 敘述中定義的,但它可為任意的
字串變數。字串運算式用來指定值給字串變數。

  * 如果字串運算式的長度比在 FIELD 敘述中定義的字串變數的長度還要短,
    RSET 敘述會在該欄位中向右靠齊( LSET 使字串向左靠齊),剩下的位置則
    補上空白碼。

  * 若字串運算式的字串長度太長, LSET 及 RSET 敘述會先從右邊切除多餘的
    字元。而數值資料則必須在使用 RSET 或 LSET 敘述之前轉換成字串。

RSET 敘述可用在沒有以 FIELD 敘述定義的字串變數。當使用在固定長度字串變數時,
則字串向右靠齊,且左邊補上空白碼。

當 RSET 使用在變動長度字串變數時,會將此字串變數視為一個固定欄位。而欄位的
長度是在執行 RSET 敘述之前,該變數值的長度。


<hr>

<span id="L819D" class="QBtitle">RSET 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8079"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L819C"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RSET 敘述程式範例</span>

本範例使用 RSET 敘述來指定值給固定及變動長度的字串變數。

DIM TmpStr2 AS STRING * 10
CLS              ' 清除螢幕
PRINT "         1         2         3"
PRINT "123456789012345678901234567890"
' 使用 RSET 敘述在長度為 0 的變動長度字串中,
' 不印任何字元因為 TmpStr$ 是長度為 0 的欄位。
TmpStr$ = ""
RSET TmpStr$ = "Another"
PRINT TmpStr$
'使用 RSET 在有值的變動長度字串
TmpStr$ = SPACE$(20)
RSET TmpStr$ = "Another"
PRINT TmpStr$
'使用 RSET 敘述在長度為 10 的固定字串
RSET TmpStr2 = "Another"
PRINT TmpStr2

<span class="QH_1">範例輸出</span>

         1         2         3
123456789012345678901234567890

             Another
   Another



<hr>

<span id="L819E" class="QBtitle">RTRIM$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A3"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L819F"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RTRIM$ 函數細節</span>

<span class="QH_1">語法</span>
  RTRIM$(字串運算式)

字串運算式可為任何的字串運算式。

RTRIM$ 函數可使用固定或變動長度的字串變數。



<hr>

<span id="L819F" class="QBtitle">RTRIM$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A3"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L819E"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RTRIM$ 函數程式範例</span>

本範例顯示 RTRIM$ 使用在固定或變動長度字串的效果。


DIM FixStr AS STRING * 10
CLS            ' 清除螢幕
PRINT "         1         2"
PRINT "12345678901234567890"
FixStr = "Twine"
PRINT FixStr + "*"
PRINT RTRIM$(FixStr) + "*"
VarStr$ = "Braided" + SPACE$(10)
PRINT VarStr$ + "*"
PRINT RTRIM$(VarStr$) + "*"

<span class="QH_1">輸出</span>

         1         2
12345678901234567890
Twine     *
Twine*
Braided          *
Braided*


<hr>

<span id="L81A0" class="QBtitle">RUN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A4"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A1"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RUN 敘述細節</span>

<span class="QH_1">語法</span>
  RUN [{行號 | 檔名}]

  <span class="QH_1">參數          說明</span>
  行號          為所要開始執行程式的行編號。假如省略該參數,程式會從第一行
                開始執行。

  檔名          為一字串運算式,是所要載入並執行的程式檔名。
                在載入所指定的程式之前,會先將目前的程式從記憶體中清除。

所要開始執行的程式行,必須在模組層次碼中。因此,在 SUB 或 FUNCTION 程序式中
的 RUN 敘述必須指到在模組層次碼中的標記。假如沒有給定行標記,通常從主模組的
第一個可執行的程式行開始執行。

在編譯期間(during compilation),假如行號在模組層次碼中找不到,則編譯會停止,
並且產生 "標記未定義" 錯誤訊息。

程式行可以有行號或文數字的標記,例如 OpenWindow。假如文數字標記是 RUN 敘述
的目的行,則停止執行,並產生 "型態不一致" 的錯誤訊息。

注意: 假如您給定 RUN 敘述的參數是以文數字標記來代替行號時, QuickBASIC 的
      語法檢查器並不產生警告訊息。

在 QuickBASIC 工作環境中假定延伸檔名為 .BAS。所以在檔名參數中不需要設定
檔案的延伸檔名。QuickBASIC 當編譯成獨立的程式時,預設的延伸檔名為 ".EXE"。
您若需要不同的延伸檔名,則您必須給定延伸檔名。假如程式名稱沒有延伸檔名,則
檔名必須以點號(".")作結束符號。例如,

  RUN "CATCHALL"

會執行一個已編譯好的 CATCHALL.EXE 程式,而其原始檔案 CATCHALL.BAS 是在
QuickBASIC 工作環境下得來的。

在 QuickBASIC 工作環境中執行的程式必須僅能呼叫 QuickBASIC 的原始程式檔。
若該程式為 QuickBASIC 的程式時,會載入記憶體並執行之;若不是 QuickBASIC 程式
的格式，則停止執行,且根據檔案的內容出現不同的錯誤訊息。同樣地,用 BC 編譯
過的程式無法呼叫 QuickBASIC 的原始檔,因為 QuickBASIC 的原始檔僅能在
QuickBASIC 的工作環境下執行。

一個可執行檔並不一定要用 QuickBASIC 語言來編寫。任意可執行檔均可被執行。

當在 QuickBASIC 下執行一個程式,若找不到符合的檔案名稱,則會產生 "找不到檔案"
的錯誤訊息,並將控制權傳回到 QuickBASIC 之下。當執行一個由 BC 編譯的程式,若
出現 "檔案無法在模組程式名稱中找到" 的錯誤訊息,則會將控制權傳回到 DOS 之下。

當被呼叫的程式(called progarm)執行完畢之後,控制權並不能回到原來呼叫的程式
(calling program)。若呼叫程式不在 QuickBASIC 中執行,則控制權會傳回到 DOS。
若呼叫的程式是在 QuickBASIC 之下,則控制權會回到 QuickBASIC 中。

假如您所編輯的 QuickBASIC 程式中包含 RUN 敘述,然後在所修改的程式尚未儲存
之前就執行程式, QuickBASIC 會自動詢問您是否在執行之前,要將新版本的程式儲存
起來。

載入所指定的程式之前, RUN 敘述會關閉所有檔案,並且清除主記憶體中的程式。
BC 編譯器並不提供 BASICA 所擁有的 R 選擇項。( R 選擇項保持所有開啟的資料檔
開啟著)假如您想執行不同的程式,但要保留已開啟檔案開啟著,可使用 CHAIN 敘述。


<hr>

<span id="L81A1" class="QBtitle">RUN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A4"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A0"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">RUN 敘述程式範例</span>

本範例顯示如何以 RUN 行號 敘述來重新設定所有數值變數為零。
在行號 60, 70, 80,和 90 之中,RUN 敘述指定執行的行號,使得前面敘述中的變數
遺失原來所指定的值。

10 A = 9
20 B = 7
30 C = 5
40 D = 4
50 PRINT A, B, C, D
60 IF A = 0 THEN 70 ELSE RUN 20
70 IF B = 0 THEN 80 ELSE RUN 30
80 IF C = 0 THEN 90 ELSE RUN 40
90 IF D = 0 THEN END ELSE RUN 50

<span class="QH_1">範例輸出</span>

9       7       5       4
0       7       5       4
0       0       5       4
0       0       0       4
0       0       0       0


<hr>

<span id="L81A2" class="QBtitle">SADD 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A5"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A3"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SADD 函數細節</span>

<span class="QH_1">語法</span>
  SADD(字串變數)

SADD 函數傳回字串變數參數在目前資料節(DS-Data Segment)內的位移位址
(近程指標 - near pointer)。位移位址(Offset Address)是一個佔 2 個位元組
長度的整數值。SADD 常使用在混合語言程式設計(mixed-language programming)中。

參數可以是簡單的字串變數或是一個字串的單一元素。但您不能使用固定長度
的字串參數。

請小心使用此函數,因為字串會隨時在 BASIC 的字串空間(儲存區域)中搬移。
而且 SADD 僅執行儲存在 DGROUP 中的字串變數。

  注意: 請勿再增加字元到已被使用在 SADD 或 LEN 函數中的被用來傳遞的字串變數
        之開端或結尾。因為增加字元可能會產生執行期間(run-time)的錯誤。


<hr>

<span id="L81A3" class="QBtitle">SADD 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A5"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A2"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SADD 函數程式範例</span>

下列範例使用 SADD 及 LEN 來傳遞字串到一個用 C 語言所寫成的函數中。
此 C 語言函數會傳回在字串中給定位置上字元的 ASCII 碼。

用 C 寫的程式需要以大型記憶體模式(/AL)獨立編譯(compiled),並且存入
Quick 程式庫中,或明確地連結(link)形成一個 .EXE 檔的格式。
注意: BYVAL 用來預設為 C 語言的格式。

在 DOS 命令列下產生 .EXE 可執行檔的步驟範例是(假如此 SADD 函數範例程式
儲存在 NAME1.BAS 檔, C 語言函數程式儲存在 NAME2.C 檔) :

(1). BC NAME1.BAS
(2). cl /c /AL NAME2.C
(3). LINK NAME1.OBJ+NAME2.OBJ


'*** 程式範例 : SADD 函數 ***
'
' 請勿執行此程式除非您已經獨立編譯 C 函數,並且已存到 Quick 程式庫中,
' 或者連結(link)到 BASIC 的程式中。
'
' 使用 SADD 及 LEN 函數傳遞字串到 C 語言函數中
DEFINT A-Z
' 宣告該函數;
DECLARE FUNCTION MyAsc CDECL(BYVAL A AS INTEGER, BYVAL B AS INTEGER, _
BYVAL C AS INTEGER)

A$="abcdefghijklmnopqrstuvwxyz"

PRINT "輸入一個字元的位置(1-26),輸入小於或等於 0 時,則結束。"
DO
' 讀取字元位置
    INPUT N
' 若位置小於零則結束
    IF N&lt;=0 THEN EXIT DO
' 呼叫 C 語言函數; 此函數傳回在 A$ 字串中第 N 個位置字元的 ASCII 碼
    AscValue=MyAsc(SADD(A$),LEN(A$),N)
    PRINT "ASCII 碼: ";AscValue;"字元: ";CHR$(AscValue)
LOOP
END

/* C 語言函數用來傳回長度為 len 的字串 C 中第 pos 個位置字元的 ASCII 碼  */

int far myasc(c,len,pos)
char near *c;
int len, pos;
{

   if(pos&gt;len) return(c[--len]);/* 避免索引超過結尾 */
   else if (pos&lt;1) return(c[0]);/* 避免索引超過開頭 */
   else
      return(c[--pos]);/* 正確的 pos 值, 傳回第 pos-1  個
                          字元, 因為 C 語言的陣列(字串)註標(subscript),
                          是以零為開始. */
}

<span class="QH_1">範例輸出</span>

輸入字元的位置(1-26),輸入小於或等於 0 時,則結束。
? 24
ASCII 碼:  120 字元: x
? -1



<hr>

<span id="L81A4" class="QBtitle">SCREEN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L8050"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A5"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SCREEN 函數細節</span>

<span class="QH_1">語法</span>
  SCREEN (列, 行 [,顏色旗標])

  <span class="QH_1">參數        說明</span>
  列          螢幕上的列(Row)位置。列參數是一個數值運算式用來計算一個
              無正負號的整數。

  行          螢幕上的行(Column)位置。行參數是一個數值運算式用來計算
              一個無正負號的整數。

  顏色旗標    此參數為一數值運算式。當它為 00 或未使用時,將傳回 :
(Color flag)  (1). 佔 1 個位元組長度的英文字元 ASCII 碼, 或
              (2). 佔 2 個位元組長度的中文字元碼之高位元組(High Byte)+&H100
                   值; 或是低位元組(Low Byte)+&H200 值。
                   (由於中文碼高位元組與低位元組的值有部份重複,所以分別
                    加上 &H100 與 &H200 來予以區分。)

              其他則傳回螢幕位置對應在視訊本文緩衝區(Video Text Buffer)
              內的顯示屬性(display attribute)值。

在下列範例中,假如字元 "A" 在 (10,10) 的位置上,那麼此函數將傳回 "A" 的
ASCII 碼為 65。

  X=SCREEN(10,10)


<hr>

<span id="L81A5" class="QBtitle">SCREEN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8050"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A4"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SCREEN 函數程式範例</span>

<span class="QH_1">範例 1</span>

'下列範例傳回在螢幕左上角字元的顏色屬性。

X=SCREEN(1,1,1)

<span class="QH_1">範例 2</span>

'
' 在 VGA 本文模式(Text Mode)下 ,傳回儲存在本文緩衝區(Text Buffer)內 'A'
' 的顏色屬性值。
' 前景=顏色屬性暫存器 15 內的顏色 + 閃爍; 背景=顏色屬性暫存器 5 內的顏色
'
SCREEN 3
CLS
COLOR 31, 5
PRINT "ABCD"
a% = SCREEN(1, 1, 1)
PRINT a%

<span class="QH_1">範例輸出</span>
ABCD
 223

<span class="QH_1">範例 3</span>

'
' 在 MGA 本文模式(Text Mode)下 ,傳回字元 '文' 的中文碼
'
SCREEN 7
CLS
PRINT "中文電腦"
a% = SCREEN(1, 3, 0)
b% = SCREEN(1, 4, 0)
PRINT a%            ' "文" 中文碼的高位元組 + &H100 之值
PRINT b%            ' "文" 中文碼的低位元組 + &H200 之值

<span class="QH_1">範例輸出</span>
中文電腦
  420
  741


<hr>

<span id="L81A6" class="QBtitle">SCREEN 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A6"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SCREEN 敘述細節</span>

<span class="QH_1">語法</span>
  SCREEN [模式] [,[顏色切換]] [,[有效分頁]] [,[景象分頁]]

  <span class="QH_1">參數          說明</span>
  模式          為一整數常數或運算式, 用來表示螢幕的模式。
                請參閱<span class="QH_2">&lt;</span><a href="#L81A7">螢幕模式摘要</a><span class="QH_2">&gt;</span> 有關合法的模式代號之清單。
                如果程式中沒有使用 SCREEN 敘述設定螢幕模式,則是沿用啟動
                QuickBASIC 當時的螢幕模式。

  顏色切換      決定是否允許合成顯示器(composite monitors)顯示彩色顏色。
                顏色切換為一數值運算式,其值介於 0 到 255 之間。
                  * 當此參數為假(為零)時,禁止使用彩色功能,且僅能顯示黑色
                    或白色的影像。
                  * 當顏色切換為真(不為零)時,允許使用彩色功能。
                當螢幕模式為 80 和 82 時,此顏色切換參數會被忽略掉。

  有效分頁      為一數值運算式。用來選擇本文輸出或繪圖命令所要寫到的
                螢幕頁數號碼。
                請參閱<span class="QH_2">&lt;</span><a href="#L81A8">轉接板和顯示器</a><span class="QH_2">&gt;</span> 提供每一個繪圖轉換器可以使用的
                頁數號碼。

  景象分頁      為一數值運算式,用來選擇那一頁要被顯示出來。

<span class="QH_1">可參閱</span>
  <span class="QH_2">&lt;</span><a href="#L81A7">螢幕模式摘要</a><span class="QH_2">&gt;</span>   列出每一個螢幕模式的功能。
  <span class="QH_2">&lt;</span><a href="#L81A8">轉接板及螢幕模式</a><span class="QH_2">&gt;</span> 列出每一個轉接板的螢幕模式。
  <span class="QH_2">&lt;</span><a href="#L81A9">顏色代號及屬性</a><span class="QH_2">&gt;</span>  列出不同螢幕模式下預設的顏色。


<hr>

<span id="L81A7" class="QBtitle">SCREEN 敘述細節 - 螢幕模式</span>
  <span class="QH_2">&lt;</span><a href="#L81A6"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 螢幕模式 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A8"> 轉接板 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A9"> 顏色 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">螢幕模式摘要</span>

本表簡潔的摘錄下面的每一個轉接板所使用的螢幕模式 :
  * IBM 加強型繪圖轉接器 (EGA),
  * IBM 視訊繪圖陣列 (VGA),
  * Hercules 繪圖轉接器 (MGA)。


-------------------MGA, EGA,或 VGA 轉接板----------------------------
SCREEN 0: 僅本文模式(Text Mode)適用
  * 25 列(row) x 80 行(column)的本文格式。
    8 x 15 字元框大小(MGA, EGA); 8 x 18 (VGA)。
  * 256K 種顏色提供給調色盤內 16 個顏色屬性暫存器(color attributes)
    使用(VGA)。
  * 64 種顏色提供給調色盤內 16 個顏色屬性暫存器使用(EGA)。


-------------------------EGA, VGA 轉接板------------------------------
SCREEN 3: 僅本文模式適用
  * 25 列 x 80 行的本文格式。
    8 x 15 字元框大小 (EGA); 8 x 18 (VGA)。
  * 256K 種顏色提供給調色盤內 16 個顏色屬性暫存器(color attributes)
    使用(VGA)。
  * 64 種顏色提供給調色盤內 16 個顏色屬性暫存器使用(EGA)。


-------------------------MGA 轉接板-----------------------------------
SCREEN 7: 僅本文模式適用
  * 25 列 x 80 行的本文格式; 字元框大小 8 x 15。


-------------------------MGA 轉接板-----------------------------------
SCREEN 71: 僅繪圖模式(Graphic Mode)適用
  * 640(橫向座標) x 375(縱向座標)的繪圖區域。
  * 25 列 x 80 行的本文格式; 字元框大小 8 x 15。


-------------------------EGA 轉接板-----------------------------------
SCREEN 80: 僅繪圖模式適用
  * 640(橫向座標) x 375(縱向座標)的繪圖區域。
  * 25 列 x 80 行的本文格式; 字元框大小 8 x 15。
  * 64 種顏色提供給調色盤內 16 個顏色屬性暫存器使用。


-------------------------VGA 轉接板-----------------------------------
Screen 82 : 僅繪圖模式適用
  * 640(橫向座標) x 450(縱向座標)的繪圖區域。
  * 25 列 x 80 行的本文格式; 字元框大小 8 x 18。
  * 256K 種顏色提供給調色盤內 16 個顏色屬性暫存器使用。


<hr>

<span id="L81A8" class="QBtitle">SCREEN 敘述細節 - 轉接板</span>
  <span class="QH_2">&lt;</span><a href="#L81A6"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 轉接板 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A7"> 螢幕模式 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A9"> 顏色 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">轉接板及螢幕模式</span>

本主題列出每一個轉接板所提供的螢幕模式。


<span class="QH_1">Hercules(MGA) 的螢幕模式</span>


  模式   列和行    顯示屬性    解析度     繪圖區     頁數   頁碼

  0, 7    80x25   前景:00-31   640x400                1      0
                  背景:00-07
  71      80x25                640x400    640x375     1      0


<span class="QH_1">EGA 的螢幕模式</span>


  模式   列和行   屬性暫存器   顏色    解析度     繪圖區    頁數    頁碼

  0,3    80x25       16        64     640x400               1       0
  80     80x25       16        64     640x400    640x375    1       0


<span class="QH_1">VGA 的螢幕模式</span>


  模式   列和行   屬性暫存器   顏色     解析度    繪圖區    頁數     頁碼

  0,3    80x25       16       256K     640x480               1       0
  82     80x25       16       256K     640x480   640x450     1       0

請參閱 <span class="QH_2">&lt;</span><a href="#L815C">PALETTE 敘述細節 </a><span class="QH_2">&gt;</span> 描述 VGA 如何計算顏色值。


<hr>

<span id="L81A9" class="QBtitle">SCREEN 敘述細節 - 顏色</span>
  <span class="QH_2">&lt;</span><a href="#L81A6"> 細節 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 顏色 &gt;</span>        <span class="QH_2">&lt;</span><a href="#L81A7"> 螢幕模式 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A8"> 轉接板 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">顏色代號及顏色屬性暫存器</span>

在彩色螢幕模式 0, 3, 80 和 82 下,顏色屬性暫存器內預設的顏色值:

顏色屬性      顏色       顯示
 暫存器       代號       顏色
  號碼        (a)

  0            0         黑色
  1            1         藍色
  2            2         綠色
  3            3         青藍色
  4            4         紅色
  5            5         紫紅色
  6            6         粽色
  7            7         白色
  8            8         灰色
  9            9         亮藍色
  10           10        亮綠色
  11           11        亮青藍色
  12           12        亮紅色
  13           13        亮紫紅色
  14           14        黃色
  15           15        亮白色
  -------------------------------------------------------------------------
  說明 : (a) 此為 EGA 的顏色代號; VGA 則可以使用能產生視覺上等效的顏色代號。

  (請參閱 <span class="QH_2">&lt;</span><a href="#L815C"> PALETTE 敘述細節 </a><span class="QH_2">&gt;</span> 有提供顏色屬性暫存器及顏色值的討論)


<hr>

<span id="L81AA" class="QBtitle">SCREEN 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A6"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81A6"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱下列任一個範例程式,有使用到 SCREEN 敘述:
  <span class="QH_2">&lt;</span><a href="#L807B">CIRCLE 敘述程式範例</a><span class="QH_2">&gt;</span>,
  <span class="QH_2">&lt;</span><a href="#L80BE">DRAW 敘述程式範例</a><span class="QH_2">&gt;</span>, 或
  <span class="QH_2">&lt;</span><a href="#L8112">LINE 敘述程式範例</a><span class="QH_2">&gt;</span>。



<hr>

<span id="L81AB" class="QBtitle">SEEK 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L8051"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SEEK 函數細節</span>

<span class="QH_1">語法</span>
  SEEK(檔案代碼)

檔案代碼是使用 OPEN 敘述開啟檔案的代號。
SEEK 函數傳回介於 1 到 2,147,483,647(等於 2^31 -1)的整數值。

當使用在 RANDOM 模式檔案下,SEEK 函數傳回下一筆所要讀取,或寫入的記錄編號
(record number)。對於檔案以 BINARY, OUTPUT, APPEND, 或 INPUT 模式下開啟,
SEEK 傳回在檔案中下一個要被運作的位元組的位置。檔案中的第一個位元組為 1 。

當所使用的裝置(device)並不提供 SEEK 函數時,則此函數將傳回零的值。
BASIC 的裝置(SCRN:, CONS:, KYBD:, COMn:, 及 LPTn:) 並不提供給 SEEK 函數使用。

下列程式片斷表示最後一次的讀取或寫入是在檔案前面 1/3 或 2/3 或最後的部份:

SELECT CASE (SEEK(1))
   CASE IS &lt; .333*LOF(1)
      PRINT "在檔案前面 1/3 部份."
   CASE .333*LOF(1) TO .667*LOF(1)
      PRINT "在檔案前面 2/3 部份."
   CASE IS &gt;= .667*LOF(1)
      PRINT "在檔案最後的部份."
   CASE ELSE
END SELECT



<hr>

<span id="L81AC" class="QBtitle">SEEK 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8051"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SEEK 函數程式範例</span>

請參閱<span class="QH_2">&lt;</span><a href="#L81AE">SEEK 敘述程式範例</a><span class="QH_2">&gt;</span>, 有使用 SEEK 函數及 SEEK 敘述。



<hr>

<span id="L81AD" class="QBtitle">SEEK 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A7"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SEEK 敘述細節</span>

<span class="QH_1">語法</span>
  SEEK [#]檔案代碼, 位置

檔案代碼為在 OPEN 敘述中所開啟的檔案號碼。

位置參數為一數值運算式,表示下一個要被讀取或寫入的地方。位置參數必須
介於 1 到 2,147,483,647(等於 2^31-1)之間的整數。若檔案以 RANDOM 模式
開啟,則位置參數為檔案中的一個記錄代號。

當檔案以 BINARY, INPUT, OUTPUT, 或 APPEND 模式開啟時,位置參數為檔案中
距離資料開始位置的位元組數目。在檔案中的第一個位元組為 1。經過 SEEK 敘述
執行以後,檔案的下一個輸入/輸出動作,將從該位元組位置開始。

  注意: GET 或 PUT 敘述的記錄代號可蓋過(override)由 SEEK 所指定的檔案位置。

SEEK 敘述中位置參數的值若為負數或零,將產生 "記錄編號錯誤" 之錯誤訊息。
可以先執行 SEEK 敘述指到檔案的最末端,然後再執行寫入檔案動作,以擴增檔案。

當使用一個不提供給 SEEK 敘述的裝置時,BASIC 會忽略此 SEEK 敘述,且不更改
檔案的位置。BASIC 裝置 (SCRN:, CONS:, KYBD:, COMn:, 和 LPTn:)是不提供給
SEEK 敘述使用的。


<hr>

<span id="L81AE" class="QBtitle">SEEK 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A7"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SEEK 敘述程式範例</span>

下列程式使用 SEEK 函數及 SEEK 敘述的組合,來移動檔案位置到特定的一筆記錄上。
若變數為真(不為零)時,會修改資料再重新寫入。

'*** SEEK 函數及敘述的程式範例。
'
CONST FALSE=0, TRUE=NOT FALSE
'  定義記錄欄位
TYPE TestRecord
   NameField  AS STRING * 20
   ScoreField AS SINGLE
END TYPE
' 定義使用者型態的變數
DIM RecordVar AS TestRecord
'*************************************************************
' 此程式為一個程式的片斷,其功能僅用來建立一個隨機存取檔,以便
' 提供給程式的第二部份使用。
'*************************************************************
OPEN "TESTDAT2.DAT" FOR RANDOM AS #1 LEN = LEN(Rec)
CLS
RESTORE
READ NameField$, ScoreField
I = 0
DO WHILE UCASE$(NameField$) &lt;&gt; "END"
   I = I + 1
   RecordVar.NameField = NameField$
   RecordVar.ScoreField = ScoreField
   PUT #1, I, RecordVar
   READ NameField$, ScoreField
   IF NameField$ = "END" THEN EXIT DO
LOOP
CLOSE #1
'
  DATA "John Simmons", 100
  DATA "Allie Simpson", 95
  DATA "Tom Tucker", 72
  DATA "Walt Wagner", 90
  DATA "Mel Zucker", 92
  DATA "END", 0

'  開啟測試資料檔
'
DIM FileBuffer AS TestRecord
OPEN "TESTDAT2.DAT" FOR RANDOM AS #1 LEN=LEN(FileBuffer)
'  計算檔案中的記錄數目
Max = LOF(1) / LEN(FileBuffer)
'  讀取並列印每一筆記錄的內容
FOR I = 1 TO Max
   GET #1, I, FileBuffer
   IF FileBuffer.NameField = "Tom Tucker" THEN
      ReWriteFlag = TRUE
      EXIT FOR
   END IF
NEXT I
'
IF ReWriteFlag = TRUE THEN
   ' 藉著使用記錄變數的長度來將資料寫到檔案中,以備份(back up)資料檔
   FileBuffer.ScoreField = 100
   SEEK #1, SEEK(1) - LEN(RecordVar)
   PUT #1 , , RecordVar
END IF
'
CLOSE #1
KILL "TESTDAT2.DAT"
END



<hr>

<span id="L81AF" class="QBtitle">SELECT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A8"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SELECT 敘述細節</span>

<span class="QH_1">語法</span>
  SELECT CASE 測試運算式
  CASE 運算式串列1
    [ 敘述區段-1 ]
  [CASE 運算式串列2
    [ 敘述區段-2 ]] ...

  [CASE ELSE
    [ 敘述區段-n ]]
  END SELECT

  <span class="QH_1">參數                說明</span>
  測試運算式          任何數值或字串運算式。

  敘述區段 -1,        敘述區段-1 到 敘述區段-n 的元素
  敘述區段 -2,        包括任意個敘述在一行或多行上。
  敘述區段 -n

  運算式串列1,        這些元素可為下列三種格式
  運算式串列2         中的任一種 :

                      運算式[,運算式...]

                      運算式 TO 運算式

                      IS 關係運算子  運算式


下面列出一個運算式串列參數各部份的說明:

  <span class="QH_1">參數                  說明</span>
  運算式                任何數值或字串運算式。運算式的型態
                        必須符合測試運算式的型態。

  關係運算子            可為下列任一個運算子(operator):

                          <span class="QH_1">符號      意義</span>
                          &lt;         小於
                          &lt;=        小於或等於
                          &gt;         大於
                          &gt;=        大於或等於
                          &lt;&gt;        不等於
                          =         等於

假如測試運算式與 CASE 子句的運算式串列符合時,則會執行該 CASE 子句到
下一個 CASE 子句中間的敘述區段,若都不符合則執行 CASE ELSE 子句到
END SELECT 中間的敘述區段;然後才將控制權傳給 END SELECT 的下一個敘述。

假如您使用 TO 關鍵字來代表運算值的範圍時,運算式值較小的必須排在前面。
例如: 若測試運算式的值為 -4,則 CASE -1 TO -5 將不執行,您必須改寫為
      CASE -5 TO -1 。

若 IS 關鍵字出現時,您只能使用關係運算子(relational operators)。若使用
CASE ELSE 子句,是在當測試運算式與其它的 CASE 選擇項均不符合時,則僅執行
其相關的敘述。在SELECT CASE 區段中所使用的 CASE SELECT 敘述,是用來處理
意外的測試運算式值的好方法。

當沒有 CASE ELSE 敘述,而且在 CASE 子句中沒有一個運算式符合測試運算式時,
則程式會繼續正常的執行而沒有錯誤發生。您也可以在每一個 CASE 子句中使用
多個運算式或多個範圍。例如,下列敘述行是合法的 :

  CASE 1 TO 4, 7 TO 9, 11, 13, IS &gt; MaxNumber%

您也可以對字串設定範圍和多個運算式 :

CASE "everything", "nuts" To "soup", TestItem$

符合上面 CASE 之字串是指剛好等於 "everything" 或等於目前字串變數 TestItem$
的值,或者字母的順序介於 "nuts" 到 "soup" 間的字串。

字串求值的方式是依據他們字元的 ASCII 碼值,因為小寫字母比大寫的字母有較大的
ASCII 碼值,因此 :

  nuts &gt; Nuts &gt; NUTS

如果一個運算式出現多個 CASE 子句中,僅與第一個出現的運算式相關的敘述區段會
被執行。

SELECT CASE 敘述可以為巢狀(nested)。每一個 SELECT CASE 敘述必須有對應的
END SELECT 敘述。


<hr>

<span id="L81B0" class="QBtitle">SELECT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A8"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81AF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SELECT 敘述程式範例</span>

有兩個 SELECT CASE 程式範例。

<span class="QH_1">範例 1</span>

下列程式中,SELECT CASE 敘述根據輸入的值執行不同的動作:

' 程式說明 CASE 項目的不同格式
     INPUT "輸入可接受的風險層次 (1-10): ", Total
     SELECT CASE Total

        CASE IS &gt;= 10
           PRINT "最大的風險及有潛力的報酬"
           PRINT "選擇股票投資計劃"

        CASE  6 TO 9
           PRINT "高度風險性及有潛力的報酬"
           PRINT "選擇公司債券"

        CASE  2 TO 5
           PRINT "中度的風險性及報酬"
           PRINT "選擇共同基金"

        CASE 1
           PRINT "沒有風險性,低報酬"
           PRINT "選擇 IRA"

        CASE ELSE
           PRINT "輸入值超出範圍"

     END SELECT

<span class="QH_1">範例輸出</span>

輸入可接受的風險層次 (1-10): 10
最大的風險及有潛力的報酬
選擇股票投資計劃

輸入可接受的風險層次 (1-10): 0
輸入值超出範圍

<span class="QH_1">範例 2</span>

下列程式 SLECT CASE 敘述根據字元的 ASCII 碼,執行不同的動作。

' 定義函數及控制鍵常數
CONST ESC = 27, DOWN = 80, UP = 72, LEFT = 75, RIGHT = 77
CONST HOME = 71, ENDKEY = 79, PGDN = 81, PGUP = 73

DO
    ' 讀取函數或 ASCII 鍵
    DO
        Choice$ = INKEY$
    LOOP WHILE Choice$ = ""

    IF LEN(Choice$) = 1 THEN
        ' 處理 ASCII 按鍵
        SELECT CASE ASC(Choice$)
            CASE ESC
                PRINT "ESC 鍵"
                END
            CASE IS &lt; 32, 127
                PRINT "控制碼"
            CASE 48 TO 57
                PRINT "數字: "; Choice$
            CASE 65 TO 90
                PRINT "大寫字母: "; Choice$
            CASE 97 TO 122
                PRINT "小寫字母: "; Choice$
            CASE ELSE
                PRINT "可列印符號: "; Choice$
        END SELECT

    ELSE
        ' 轉換 2 個位元組擴充碼成為一個位元組的 ASCII 碼並處理之
        Choice$ = RIGHT$(Choice$, 1)

        SELECT CASE Choice$
            CASE CHR$(DOWN)
                PRINT "向下鍵"
            CASE CHR$(UP)
                PRINT "向上鍵"
            CASE CHR$(PGDN)
                PRINT "PGDN 鍵"
            CASE CHR$(PGUP)
                PRINT "PGUP 鍵"
            CASE CHR$(HOME)
                PRINT "HOME 鍵"
            CASE CHR$(ENDKEY)
                PRINT "END 鍵"
            CASE CHR$(RIGHT)
                PRINT "向右鍵"
            CASE CHR$(LEFT)
                PRINT "向左鍵"
            CASE ELSE
                BEEP
        END SELECT
    END IF

LOOP


<hr>

<span id="L81B1" class="QBtitle">SETMEM 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A9"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SETMEM 函數細節</span>

<span class="QH_1">語法</span>
  SETMEM(數值運算式)

數值運算式表示用來增加或減少遠程堆疊(Far-Heap)的位元組數目。

  * 假如數值運算式為負數, SETMEM 藉由所指定的位元組數來減少遠程堆疊空間。
  * 假如數值運算式為正數, SETMEM 藉由所指定的位元組數來增加遠程堆疊空間。

SETMEM 傳回在遠程堆疊中的位元組數的總和。假如數值運算式為零,則 SETMEM 傳回
目前遠程堆疊的大小。

若 SETMEM 無法透過所要求的位元組數來更改遠程堆疊,則它會儘可能重新配置所需求
的位元組數。

SETMEM 可使用在混合語言的程式設計(mixed-language programming)中,以減少
遠程堆疊空間,使得在其他語言的程序式可以動態地配置遠程記憶體(far memory)。

  注意: 第一次呼叫 SETMEM 來嘗試增加遠程堆疊並沒有效用,因為程式啟動時,
        QuickBASIC 已儘可能的配置所需的記憶體空間給遠程堆疊。


<hr>

<span id="L81B2" class="QBtitle">SETMEM 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80A9"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SETMEM 函數程式範例</span>

下列程式概要的說明 SETMEM 函數,它用來釋放由 C 函數使用 malloc 函數所
取得的動態記憶體。

C 函數必須獨立編譯(compiled),然後放入 Quick 程式庫,或已連結(Linked)到
BASIC 程式。C 函數使用大型記憶體模式(/AL)來編譯,並且由呼叫 malloc 函數
取得記憶體,然後由 BASIC 程式來釋放該記憶體空間。


'*** 程式範例 : SETMEM 函數 ***
'
' 請勿嘗試去執行本程式,除非您已使用大型記憶體模式對 C 函數已獨立編譯過,
' ,而且已放置在 Quick 程式庫或已連結到 BASIC 程式。
'
DECLARE SUB CFunc CDECL (BYVAL X AS INTEGER)

' 減少遠程堆疊(stack)的大小,如此 CFunc 才可以使用 malloc 來取得動態記憶體。
BeforeCall = SETMEM(-2048)

' 呼叫 C 函數。
CFunc(1024%)

' 傳回記憶體給遠程堆疊,使用一個較大的數值運算式參數,可使所有空間傳回堆疊中。
AfterCall = SETMEM(3500)

IF AfterCall &lt;= BeforeCall THEN PRINT "記憶體無法重新配置"

END

void far cfunc(bytes)
int bytes;
{
   char *workspace;

   /* 配置 BASIC 所釋放的工作記憶體 */
   workspace=(char *)malloc((unsigned) bytes);

   /* 在此使用工作空間 */

   /* 在回到 BASIC 之前先釋放掉記憶體 */
   free(workspace);
}



<hr>

<span id="L81B3" class="QBtitle">SGN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AA"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SGN 函數細節</span>

<span class="QH_1">語法</span>
  SGN(數值運算式)

SGN 函數根據參數的正負號來傳回值:
  * 如果數值運算式大於零,則 SGN(數值運算式)傳回 1。
  * 如果數值運算式等於零,則 SGN(數值運算式)傳回 0。
  * 如果數值運算式小於零,則 SGN(數值運算式)傳回 -1。


<hr>

<span id="L81B4" class="QBtitle">SGN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AA"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SGN 函數程式範例</span>

下列程式計算及列印所輸入的二次方程式之解。本程式使用測試運算式的正負號
來決定如何求解。

CONST NoRealSoln=-1, OneSoln=0, TwoSolns=1
' 輸入二次方程式的係數:
' ax^2 + bx + c = 0.
INPUT;"a = ",   A
INPUT;",  b = ",B
INPUT ",  c = ",C
Test = B^2 - 4*A*C
SELECT CASE SGN(Test)
   CASE  NoRealSoln
      PRINT "此方程式沒有實數解"
   CASE  OneSoln
      PRINT "此方程式僅有一解: ";
      PRINT -B/(2*A)
   CASE  TwoSolns
      PRINT "此方程式有兩個解: ";
      PRINT (-B + SQR(Test))/(2*A) " and ";
      PRINT (-B - SQR(Test))/(2*A)
END SELECT

<span class="QH_1">範例輸出</span>

此方程式有兩個解:  .6666667      -.25



<hr>

<span id="L81B5" class="QBtitle">SHARED 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AB"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SHARED 敘述細節</span>

<span class="QH_1">語法</span>
  SHARED 變數 [AS 型態] [,變數 [AS 型態]]...

變數參數可為陣列名稱跟隨著(),或是變數名稱。AS 子句可用來表示變數的型態。型態
參數可為 INTEGER, LONG, SINGLE, DOUBLE, STRING,固定長度字串(STRING * 長度),
或者為一個使用者自定型態。

在 SUB 或 FUNCTION 程序式中使用 SHARED 敘述,或在模組層次碼中的 COMMON 或
DIM 敘述使用 SHARED 屬性,您都可以在程序式中共用變數而不需要用參數來傳遞變數。
SHARED 屬性在同一個模組的所有程序式中共用變數,而 SHARED 敘述可以在單一的
程序式和模組層次碼間共用變數。

  注意: SHARED 敘述僅能在單一編譯(compiled)的模組中共用變數。無法在 Quick
        程式庫的程式中共用變數,或者在獨立編譯的程序式並連結(link)到程式中
        共用變數。
        SHARED 敘述僅能在同一個模組中的模組層次碼,與 SUB 或 FUNCTION 程序式
        中共用變數。

SHARED 敘述僅能出現在 SUB 或 FUNCTION 程序式中。


<hr>

<span id="L81B6" class="QBtitle">SHARED 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AB"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SHARED 敘述程式範例</span>

SHARE_EX.BAS 是在 ADVR_EX 子目錄下的程式檔,用來說明 SHARED 敘述。
可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入該程式,並執行它。

程式呼叫 CONVERT 副程式,將所輸入的十進制數轉換成所給定新基底的字串表示式。
其中字串 N$ 可在副程式與主程式共用。



<hr>

<span id="L81B7" class="QBtitle">SHELL 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AC"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SHELL 敘述細節</span>

<span class="QH_1">語法</span>
  SHELL [命令字串]

命令字串必須為合法的字串運算式,它包含所欲執行的程式名稱,及任何程式的
選擇項。

任何 .COM 檔案, .EXE 檔案, .BAT 程式, 或在 SHELL 敘述下執行的 DOS 功能
稱為 "子處理"(child process)。子處理透過 SHELL 敘述來執行, SHELL 敘述
會自動載入並且執行 COMMAND.COM(加上 /C 的選擇項);此選擇項允許在命令字串
中的任一參數傳遞到子處理中。亦可允許對標準輸入/輸出作重新導向(Redirection),
並可以對內建(built-in)命令,如 : DIR, PATH 和 TYPE 命令的執行。

在命令字串中的程式名稱可以含有任何您希望的延伸檔名。假如省略延伸檔名時,
COMMAND.COM 首先查看 .COM 檔,然後為 .EXE 檔,最後為 .BAT 檔。若 COMMAND.COM
尚未發現該檔名, SHELL 敘述產生 "檔案找不到" 的錯誤訊息。若 COMMAND.COM 無法
在命令字串中找到所指定的檔案, QuickBASIC 並不會產生錯誤訊息。

任何本文(text)至少需用一個空格與程式名稱隔開,它會被 COMMAND.COM 視為程式的
參數。

當子處理執行時,QuickBASIC 仍然保留在記憶體中。當子處理結束時, QuickBASIC
會繼續執行下一敘述。

SHELL 敘述若不含命令字串,則給一個新的 COMMAND.COM shell。此時,您可以執行
任何 COMMAND.COM 所允許的命令。當您想要回到 QuickBASIC 時,只要輸入 DOS
所提供的 EXIT 命令。



<hr>

<span id="L81B8" class="QBtitle">SHELL 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AC"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SHELL 敘述程式範例</span>

<span class="QH_1">範例 1</span>

下列範例顯示單一的 SHELL 敘述如何啟動一個新的 COMMAND.COM :

SHELL   '取得一個新的 COMMAND.COM


<span class="QH_1">範例輸出</span>

Microsoft(R) MS-DOS(R)  Version 3.30
             (C)Copyright Microsoft Corp 1981-1987


<span class="QH_1">範例 2</span>

SHELL_EX.BAS 是在子目錄 ADVR_EX 之下的程式檔,用來說明 SHELL 敘述。可在景象
視窗中查看該程式,且可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入該程式,
並可執行之。

此程式由一個指定的目錄中拷貝對某一特定日期有修改過的所有檔案。



<hr>

<span id="L81B9" class="QBtitle">SIN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AD"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81BA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SIN 函數細節</span>

<span class="QH_1">語法</span>
  SIN(數值運算式)

當數值運算式參數為倍精確度值時,SIN 函數以倍精確度來計算其值。但當數值運算式
參數不為倍精確度值時,SIN 函數以單精確度來計算其值。

您可將一個角的量度由度度量乘上 π/180 轉換成為弳度量。其中 π= 3.141593。
亦可將弳度量乘上 57.2958 轉換成度度量。


<hr>

<span id="L81BA" class="QBtitle">SIN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AD"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81B9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SIN 函數程式範例</span>

本範例繪製極座標方程式 r = 1 + sin n (θ)的圖形。這圖形為著名的 Cardioid 圖,
當 n 等於 1 時,會類似一個心臟線。

'*** SIN 函數的程式範例 ***
CLS
CONST PI = 3.141593
SCREEN 82 : COLOR 1              'VGA 繪圖模式,藍色的前景
WINDOW (-3,-2)-(3,2)             '轉換螢幕到直角座標
INPUT "花瓣的數目 = ", N
CLS
PSET (1,0)                       '設定起始點
FOR Angle = 0 TO 2*PI STEP .02
   R = 1 + SIN(N*Angle)          '"花"圖形的極座標方程式
   X = R * COS(Angle)            '轉換極座標到
   Y = R * SIN(Angle)            '直角座標
   LINE -(X,Y)                   '從上一點到此點繪製一直線
NEXT
END


<hr>

<span id="L81BB" class="QBtitle">SLEEP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AE"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81BC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SLEEP 敘述細節</span>

<span class="QH_1">語法</span>
  SLEEP [秒數]

秒數參數選擇項用來決定程式要被暫停執行的秒數。

SLEEP 敘述暫停程式的執行,直到下列的其中一個事件發生:
  * 在所設定的秒數參數的時間週期已耗盡(time period has elapsed)時。
  * 按下一個鍵時。
  * 一個被啟動的事件發生時。

若秒數為零,或未設定,則程式會無限期的暫停執行,僅在有按鍵或啟動事件發生時,
才能中斷無限期的暫停。

SLEEP 僅回應在該敘述執行後所發生的按鍵。SLEEP 會忽略執行前已鍵入在鍵盤緩衝區
中的字元。

事件(如 ON COM 或 ON TIMER)不能中斷一個 SLEEP 的暫停,除非當事件發生時其設陷
是有效的。這意味著設陷必須用 "ON 事件" 敘述來啟動,而且不能用 "事件 OFF" 敘述
或一個 "事件 STOP" 敘述來關閉設陷。



<hr>

<span id="L81BC" class="QBtitle">SLEEP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AE"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81BB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SLEEP 敘述程式範例</span>

下列程式暫停執行 10 秒鐘。沒有 "ON 事件" 敘述,所以唯一中斷暫停執行的方法
是在 10 秒鐘之內按下任意鍵。

CLS                               '清除螢幕
PRINT "小睡 10 秒鐘..."
SLEEP 10
PRINT "醒來!"
END



<hr>

<span id="L81BD" class="QBtitle">SOUND 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AF"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81BE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SOUND 敘述細節</span>

<span class="QH_1">語法</span>
  SOUND 頻率, 音長

頻率參數是以赫茲(hertz--週期/秒數)為單位。必須為一數值運算式,傳回介於
37 - 32,767 之間的整數值。

音長參數為時鐘滴答(tick)的持續時間(每一秒鐘有 18.2 個時鐘滴答聲(clockticks),
與 CPU 的速度無關),音長參數必須為一個數值運算式,傳回之值是介於 0 - 65,535
之間的無正負號的整數。

如果音長為零時,任何正在執行的 SOUND 敘述會被關閉。如果沒有 SOUND 敘述在執行,
則音長為零時,對 SOUND 敘述將沒有效用。


<hr>

<span id="L81BE" class="QBtitle">SOUND 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80AF"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81BD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SOUND 敘述程式範例</span>

本程式產生升音及降音的圓滑演奏法:

CLS
FOR I = 440 TO 1000 STEP 5
   SOUND I, I/1000
NEXT
FOR I = 1000 TO 440 STEP -5
  SOUND I, I/1000
NEXT



<hr>

<span id="L81BF" class="QBtitle">SPACE$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SPACE$ 函數細節</span>

<span class="QH_1">語法</span>
  SPACE$(n)

運算式 n 會四捨五入成為整數,且 n 值必須介於 0 到 32,767 之間。


<hr>

<span id="L81C0" class="QBtitle">SPACE$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81BF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SPACE$ 函數程式範例</span>

CLS                    ' 清除螢幕
FOR I=1 TO 5
   X$=SPACE$(I)
   PRINT X$;I
NEXT I

<span class="QH_1">範例輸出</span>

1
 2
  3
   4
    5



<hr>

<span id="L81C1" class="QBtitle">SPC 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B1"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SPC 函數細節</span>

<span class="QH_1">語法</span>
  SPC(n)

SPC 僅使用在 PRINT 和 LPRINT 敘述中。參數 n (以 "位元組" 為計算單位)
必須介於 0 到 32,767 之間。此函數會假設有一個分號(;)緊跟在 SPC(n) 敘述
的後面。



<hr>

<span id="L81C2" class="QBtitle">SPC 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B1"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SPC 函數程式範例</span>

CLS                               '清除螢幕
PRINT "OVER";SPC(15) "THERE"

<span class="QH_1">範例輸出</span>

OVER               THERE



<hr>

<span id="L81C3" class="QBtitle">SQR 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B2"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SQR 函數細節</span>

<span class="QH_1">語法</span>
  SQR(數值運算式)

數值運算式參數值必須 &gt;= 0。



<hr>

<span id="L81C4" class="QBtitle">SQR 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B2"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SQR 函數程式範例</span>

此程式繪製下列方程式的圖形 :
y = √-x , 且 -9 &lt;= x &lt; 0 ; 和
y = √x , 且 0 &lt;= x &lt;= 9

'*************************
'  SQR 函數的範例程式
'*************************
SCREEN 82 : COLOR 1          'VGA 繪圖模式
WINDOW (-9,-.25)-(9,3.25)    '轉換螢幕成直角座標
LINE (-9,0)-(9,0)            '繪製 X 座標
LINE (0,-.25)-(0,3.25)       '繪製 Y 座標
FOR X = -9 TO 9
    LINE(X,.04)-(X,-.04)     '在 X 軸上定標記
NEXT
FOR Y = .25 TO 3.25 STEP .25
    LINE (-.08,Y)-(.12,Y)    '在 Y 軸上定標記
NEXT
PSET (-9,3)                  '繪上函數的第一點
FOR X = -9 TO 9 STEP .25
    Y = SQR(ABS(X))          'SQR 函數之參數不能為負號
    LINE -(X,Y),2            '畫一條線到下一點
NEXT



<hr>

<span id="L81C5" class="QBtitle">STATIC 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B3"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STATIC 敘述細節</span>

<span class="QH_1">語法</span>
  STATIC 變數串列

STATIC 敘述變數串列的語法如下:

  變數[()] [AS 型態] [,變數[()] [AS 型態]]...

變數串列需要下列參數:

  <span class="QH_1">參數       說明</span>
  變數       為變數名稱或陣列名稱。

  AS 型態    宣告變數的型態。型態參數可為 INTEGER, LONG, SINGLE,
             DOUBLE, STRING, 或者使用者自定型態。

STATIC 敘述僅能出現在 SUB, FUNCTION, 或 DEF FN 函數中。

早期的 BASIC 版本必須要在陣列名稱的後面用括號括住維度(dimension)。而在
QuickBASIC 中,維度是一個可選擇項。

在 STATIC 敘述中宣告的變數,蓋過在模組層次碼中用 DIM 或 COMMON 敘述宣告
為共用變數的相同變數名稱。在 STATIC 敘述中的變數亦蓋過(override)相同變數
名稱的全域常數(global constants)。

通常,使用在 DEF FN 函數中的變數,在模組中是全域(global)變數;但是,您可以在
DEF FN 敘述中使用 STATIC 敘述來宣告一個變數僅在該函數中成為區域(local)變數。

  注意: 在 SUB 及 FUNCTION 敘述中的 STATIC 屬性,用來宣告變數預設為 STATIC。
        在變數若與在模組層次碼中的共用變數,具有相同名稱時仍為共用變數。
        相反地,STATIC 敘述可設定變數為 STATIC,而且可蓋過(override)任何
        共用在模組層次碼中的共用變數。$STATIC 假命令則是影響到如何配置
        記憶體給陣列。


<hr>

<span id="L81C6" class="QBtitle">STATIC 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B3"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STATIC 敘述程式範例</span>

STAT_EX.BAS 是在子目錄 ADVR_EX 之下的程式檔,說明 STATIC 敘述的用法。
可使用 [F/檔案] 功能表中的 "O/載入程式" 命令載入該程式,並執行它。

程式中搜尋在檔案中每次出現的特定字串運算式,並用其他字串來取代之。檔案的
名稱亦隨著內容的更改而修改,將舊檔名的延伸檔名更改為 .NEW。程式中也會列印
取代的次數及更改的行數。



<hr>

<span id="L81C7" class="QBtitle">STICK 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B5"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STICK 函數細節</span>

<span class="QH_1">語法</span>
  STICK(n)

參數 n 為數值運算式,其值為介於 0 到 3 的無正負號的整數:

  <span class="QH_1">參數       傳回值</span>
  0          傳回搖桿 A 的 x 座標。

  1          傳回當 STICK(0) 最後一次被呼叫時,搖桿 A 的 y 座標。

  2          傳回當 STICK(0) 最後一次被呼叫時,搖桿 B 的 x 座標。

  3          傳回當 STICK(0) 最後一次被呼叫時,搖桿 B 的 y 座標。

x 和 y 座標的範圍介於 1 到 200 之間。您必須在使用 STICK(1), STICK(2), 或
STICK(3)之前,先使用 STICK(0)。STICK(0)不但傳回搖桿 A 的 x 座標,也記錄其他
的搖桿座標。這些記錄的座標是藉著呼叫 STICK(1) 到 STICK(3) 函數傳回來的。



<hr>

<span id="L81C8" class="QBtitle">STICK 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B5"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STICK 函數程式範例</span>

下列程式列印搖桿 B 的座標:

'*** STICK 函數的程式範例 ***
' 請勿嘗試執行此程式,除非搖桿已裝置好了
TEMP = STICK(0)
PRINT STICK(2), STICK(3)



<hr>

<span id="L81C9" class="QBtitle">STOP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B6"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STOP 敘述細節</span>

<span class="QH_1">語法</span>
  STOP

STOP 敘述可用在程式中的任何地方,用來終止程式的執行。

在 QuickBASIC 工作環境中執行時, STOP 敘述使得已開啟之檔案仍開啟著,且不會
回到作業系統中。相反地,在獨立執行的.EXE 檔中的 STOP 敘述,則會關閉所有已經
被開啟的檔案,並且會回到作業系統下。

如果您在 BC 命令行中使用 /O, /E, 或 /X 的編譯選項,若程式中有行號,則 STOP
敘述會列印執行停止時的行號;若行號沒有和 STOP 敘述結合在一起,則最接近的
行號將被顯示出來。若您的程式沒有行號,則列印的行號值為零。

在過去, STOP 敘述是用於偵錯。由於現在 QuickBASIC 提供更佳的偵錯特性,所以
使得 STOP 敘述更不適用了。



<hr>

<span id="L81CA" class="QBtitle">STOP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B6"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81C9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

此處並無有關 STOP 敘述的程式範例。可參閱 QuickBASIC 對於停止或暫停程式
執行所提供不同的方法。請參閱<span class="QH_2">&lt;</span><a href="#L8212">執行和偵錯鍵</a><span class="QH_2">&gt;</span> 的主題。



<hr>

<span id="L81CB" class="QBtitle">STR$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B7"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STR$ 函數細節</span>

<span class="QH_1">語法</span>
  STR$(數值運算式)

若數值運算式為正數,則 STR$ 函數會傳回一個包含前置空白碼的字串。

VAL 函數為 STR$ 的互補函數。



<hr>

<span id="L81CC" class="QBtitle">STR$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B7"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STR$ 函數程式範例</span>

下例使用 STR$ 函數來轉換一個數值為其字串表示式,並且除去一般 BASIC 在列印數值
時包含在該字串前後的空白。

'*** STR$ 函數程式範例  ***
CLS                            ' 清除螢幕
PRINT "輸入 0 表示結束"
DO
    INPUT "欲找尋的餘弦數(COSINE): ",Num
    IF Num = 0 THEN EXIT DO
    X$ = STR$(Num)
    NumRemBlanks$ = LTRIM$(RTRIM$(X$))
    PRINT "COS(" NumRemBlanks$ ") = " COS(Num)
LOOP

<span class="QH_1">範例輸出</span>

輸入 0 表示結束
欲找尋的餘弦數(COSINE): 3.1
COS(3.1) = -.9991351
欲找尋的餘弦數(COSINE): 0



<hr>

<span id="L81CD" class="QBtitle">STRIG 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L8052"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STRIG 函數細節</span>

<span class="QH_1">語法</span>
  STRIG(n)

STRIG 函數被用於測試搖桿的觸動狀態。在早期的 BASIC 版本, STRIG ON 敘述
用來啟動搖桿觸動的測試; STRIG OFF 則取消搖桿觸動的測試。QuickBASIC 可以
忽略 STRIG ON 及 STRIG OFF 敘述--此敘述能與早期的版本相容。

數值運算式 n 是一個介於 0 到 7 範圍的無正負號整數。表示搖桿及觸動的測試。
下面描述由 STRIG(n) 函數,依照不同的 n 值所傳回的不同值:

  <span class="QH_1">參數         傳回值</span>
  0          自上次 STRIG(0) 呼叫後,若搖桿 A 的下按鈕有被按下,則傳回 -1,
             否則傳回 0。

  1          若搖桿 A 的下按鈕目前正被按住,則傳回 -1,否則傳回 0。

  2          自上次 STRIG(2) 呼叫後,若搖桿 B 的下按鈕有被按下,則傳回 -1,
             否則傳回 0。

  3          若搖桿 B 的下按鈕目前正被按住,則傳回 -1,否則傳回 0。

  4          自上次 STRIG(4) 呼叫後,若搖桿 A 的上按鈕有被按下,則傳回 -1,
             否則傳回 0。

  5          若搖桿 A 的上按鈕目前正被按住,則傳回 -1,否則傳回 0。

  6          自上次 STRIG(6) 呼叫後,若搖桿 B 的上按鈕有被按下,則傳回 -1,
             否則傳回 0。

  7          若搖桿 B 的上按鈕目前正被按住,則傳回 -1,否則傳回 0。

您亦可藉由 ON STRIG 敘述,使用事件設陷來取得搖桿的資訊。不能在搖桿事件設陷
狀態下使用 STRIG 函數,因為事件會導致設陷被破壞掉。

<span class="QH_1">與 BASICA 的差異</span>

QuickBASIC 程式中有包含一個 STRIG 敘述,在對此程式作編譯時,必需在 BC 命令行
上使用 /V 或 /W 的選擇項。


<hr>

<span id="L81CE" class="QBtitle">STRIG 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8052"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STRIG 函數程式範例</span>

下面範例說明 STRIG:

' *** STRIG 函數程式範例  ***
' 若無安裝好搖桿,不要執行此程式。
'
' 等待搖桿 A 被按下
DO
   GotATrig = STRIG(0)
LOOP UNTIL GotATrig
' 只要搖桿 A 被按下,就會嗶一聲。
DO
   GotATrig = STRIG(1)
   BEEP
LOOP WHILE GotATrig



<hr>

<span id="L81CF" class="QBtitle">STRIG 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B8"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STRIG 敘述細節</span>

<span class="QH_1">語法</span>
  STRIG(n) ON
  STRIG(n) OFF
  STRIG(n) STOP

參數 n 為一數值運算式,用來表示作設陷的搖桿按鈕值:

  <span class="QH_1">按鈕值</span>

  0      搖桿 A 的下按鈕
  2      搖桿 B 的下按鈕
  4      搖桿 A 的上按鈕
  6      搖桿 B 的上按鈕

STRIG(n) ON 敘述藉由 ON STRIG 敘述,來啟動搖桿事件設陷。當設陷被啟動,而且
若一個不為零的行號被指定在 ON STRIG 敘述中, QuickBASIC 會檢查搖桿按鈕是否
在敘述之間有被按下。

STRIG(n) OFF 敘述用來關閉事件設陷。若有一個連續事件發生(例如,若按鈕被按下)
時,它將不會被記錄。

STRIG(n) STOP 敘述禁止事件被設陷。若有一事件發生,則會被記錄,而且當事件一旦
重新被設陷(STRIG(n) ON),則所記錄的事件將被執行。


<hr>

<span id="L81D0" class="QBtitle">STRIG 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B8"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81CF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

此處並無使用 STRIG 事件設陷敘述的程式範例。

請參閱下列的事件設陷程式範例,並使用此技巧應用到搖捍的事件設陷。

  一個 <span class="QH_2">&lt;</span><a href="#L803B">按鍵的事件被設陷的程式範例</a><span class="QH_2">&gt;</span>, 或
  一個 <span class="QH_2">&lt;</span><a href="#L814D">背景音樂佇列事件被設陷的程式範例</a><span class="QH_2">&gt;</span>.



<hr>

<span id="L81D1" class="QBtitle">STRING$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B9"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STRING$ 函數細節</span>

<span class="QH_1">語法</span>
  STRING$(m, n)
  STRING$(m, 字串運算式)

  <span class="QH_1">參數               說明</span>
  m                  為一個數值運算式,用來表示將被傳回的字串長度。

  n                  為一個數值運算式,其值為一個英文字元的 ASCII 碼,
                     或是以 &H 為首的中文碼。

  字串運算式         字串運算式中的第一個字元為被用來產生一個要傳回的字串。



<hr>

<span id="L81D2" class="QBtitle">STRING$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80B9"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">STRING$ 函數程式範例</span>

<span class="QH_1">範例 1</span>

下例使用 STRIG$ 來產生一個報表頭:

Dash$ = STRING$(10,45)
PRINT Dash$;"月報表";Dash$

<span class="QH_1">範例輸出</span>

----------月報表----------


<span class="QH_1">範例 2</span>

下例程式使用 STRING$ 來產生一長條圖:

PRINT TAB(7);"西雅圖的日平均溫度"
PRINT
'取得各月份的資料及圖形
FOR Month = 1 TO 12 STEP 2
    READ Month$, Temp
    '列印(Temp-35)個星號
    PRINT Month$;" +"; STRING$(Temp-35,"*")
    PRINT "    |"
NEXT Month

'列印水平線
PRINT "    +";
FOR X = 1 TO 7
    PRINT "----+";
NEXT X
PRINT

'列印溫度標記
FOR X = 4 TO 39 STEP 5
    PRINT TAB(X); X+31;
NEXT X
PRINT

DATA Jan, 40, Mar, 46, May, 56
DATA Jul, 66, Sep, 61, Nov, 46

<span class="QH_1">範例輸出</span>

西雅圖的日平均溫度

Jan +*****
    |
Mar +***********
    |
May +*********************
    |
Jul +*******************************
    |
Sep +**************************
    |
Nov +***********
    |
    +----+----+----+----+----+----+----+
    35   40   45   50   55   60   65   70



<hr>

<span id="L81D3" class="QBtitle">SUB...END SUB 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BA"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SUB...END SUB 敘述細節</span>

<span class="QH_1">語法</span>
  SUB 全域名稱[(參數串列)] [STATIC]
    [ 敘述區段 ]
  [EXIT SUB]
    [ 敘述區段 ]
  END SUB

  <span class="QH_1">參數            說明</span>
  全域名稱        為一個最長為 40 個英文字元的變數名稱。此名稱不可出現在
                  相同程式或使用者程式庫中其它的 FUNCTION 或 SUB 程序式中。

  參數串列        為 SUB 程序式被呼叫時,傳遞給此副程式(subprogram)使用
                  的簡單變數和陣列。每個名稱之間以一個逗號分開。注意 :
                  這些變數及陣列的傳送是以傳址方式傳遞,所以在副程式中
                  改變任何一個參數中的值,也會改變原來呼叫程式(calling
                  program)內該變數的值。
                  請參閱底下較完整的語法說明。

一個 SUB 參數串列包含下列語法:

  變數[()] [AS 型態] [, 變數[()] [AS 型態]]...

  * 一個變數為一個 BASIC 的變數名稱。較早的 BASIC 版本需要在陣列名稱後
    加上其維度(dimension)。但在 QuickBASIC 中,陣列的維度可被省略。

  * 型態參數為一個變數的資料型態。型態參數可以為 INTEGER, LONG, SINGLE,
    DOUBLE, STRING,或一個使用者自定型態。不可以使用一個固定長度字串,或
    固定長度字串陣列當作一個參數。但是,您可以在一個 CALL 敘述中使用一個
    固定長度字串來當作一個參數 -- QuickBASIC 會在此字串傳遞給 SUB 程序式
    之前,先將此簡單的固定長度字串參數轉換成一個變動長度字串參數。

一個副程式(subprogram,或稱次程式)如同一個 FUNCTION 是一個獨立的程序式。
然而與 FUNCTION 不同的是, SUB 不能使用在一個運算式中。

SUB 和 END SUB 用來標記一個程序式的開始和結束。您也可使用 EXIT SUB 敘述
選擇項,來中途離開一個程序式。

副程式(次程式)可經由 CALL 敘述或直接使用副程式名稱,再加上參數串列來呼叫。
請參閱有關 CALL 敘述的細節。

QuickBASIC 副程式可使用遞迴(recursion)呼叫--副程式可以呼叫自己本身以完成
所給定的工作。請參閱下面第二個例子。

STATIC 屬性表示所有在 SUB 中的變數對 SUB 均為區域變數,且為 STATIC - 意即 :
在彼此呼叫間他們的值均會被儲存。
使用 STATIC 關鍵字可稍微增加執行的速度。STATIC 通常不用在遞迴呼叫的副程式。
請參閱下列範例。

除非經過 SHARED 敘述特別宣告為共用變數,對副程式而言,副程式中的任何變數或
陣列,均被認為區域變數。

在 SUB 程序式中不可以再定義 SUB 程序式,DEF FN 函數或 FUNCTION 程序式。

  注意: 不可以使用 GOSUB, GOTO, 或 RETURN 來進入或離開一個副程式。


<hr>

<span id="L81D4" class="QBtitle">SUB...END SUB 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BA"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SUB...END SUB 敘述程式範例</span>

SUB_EX.BAS 為一個存在 ADVR_EX 子目錄下的程式檔,說明 SUB...END SUB 敘述的
使用。可使用 [F/檔案] 功能表中 "O/載入程式" 的命令將此檔案載入至景象視窗
中,並執行它。

主程式呼叫一個副程式(次程式),此程式由一個檔案所輸入的每一行尋找所給定的
字串。當副程式在一行中發現該字串,則列出該行之行號。注意, 行號值計數器在
呼叫間會被儲存起來,因為在 SUB 敘述中,有使用 STATIC 關鍵字。

下列為程式的範例輸出:(注意 : 執行 SUB_EX.BAS 程式前,請先將 SUB_EX.BAS
程式檔以 "本文" 格式儲存。)

請輸入要搜尋的檔案名稱 ? SUB_EX.BAS
請輸入要搜尋的字串? SUB
第 1 行 : DECLARE SUB Linesearch (Test$, P$)
第 3 行 : ' *** SUB_EX.BAS - SUB statement programming example
第 15 行 : SUB Linesearch (Test$, P$) STATIC
第 19 行 : END SUB


<hr>

<span id="L81D5" class="QBtitle">SWAP 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BB"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SWAP 敘述細節</span>

<span class="QH_1">語法</span>
  SWAP 變數1, 變數2

任意型態的變數均可被互換(整數,長整數,單精確度數,倍精確度數,字串,或
資料錄(record))。但是,此兩個變數必須確實擁有相同的型態,否則會產生
一個 "型態不一致" 的錯誤訊息。舉例來說,試圖對整數及單精確度數互換,
則產生 "型態不一致" 的錯誤訊息。



<hr>

<span id="L81D6" class="QBtitle">SWAP 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BB"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SWAP 敘述程式範例</span>

下列範例使用謝耳(SHELL)排序法依遞減的方式去排列一個字串陣列中的元素。
使用 SWAP 去互換不合次序的陣列元素。

' 使用一個謝耳(SHELL)排序法來排序一個宇串。
Num% = 4
Array$(1) = "紐約"
Array$(2) = "波士頓"
Array$(3) = "芝加哥"
Array$(4) = "西雅圖"
Span% = Num% \ 2
DO WHILE Span% &gt; 0
    FOR I% = Span% TO Num% - 1
    J% = I% - Span% + 1
        FOR J% = (I% - Span% + 1) TO 1 STEP -Span%
            IF Array$(J%) &lt;= Array$(J% + Span%) THEN EXIT FOR
            '
            ' 對不合次序的陣列元素作互換
            '
            SWAP Array$(J%), Array$(J% + Span%)
         NEXT J%
    NEXT I%
    Span% = Span% \ 2
LOOP
CLS
FOR I% = 1 TO Num%
    PRINT Array$(I%)
NEXT I%
END

此程式可被轉換成一個有用的 SUB 程序式,藉著使用如下所示的 SUB...END SUB
敘述來對一個任意大小的字串陣列做排序。

' 使用一個謝耳排序法來排序一個字串
SUB ShellSort (Array$(), Num%) STATIC
   Span% = Num% \ 2
   DO WHILE Span% &gt; 0
      FOR I% = Span% TO Num% - 1
         J% = I% - Span% + 1
         FOR J% = (I% - Span% + 1) TO 1 STEP -Span%
            IF Array$(J%) &lt;= Array$(J% + Span%) THEN EXIT FOR
            ' 對不合次序的陣列元素做互換
            SWAP Array$(J%), Array$(J% + Span%)
         NEXT J%
      NEXT I%
      Span% = Span% \ 2
   LOOP
END SUB


<hr>

<span id="L81D7" class="QBtitle">SYSTEM 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BC"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">SYSTEM 敘述細節</span>

<span class="QH_1">語法</span>
  SYSTEM

當 SYSTEM 命令一被執行,所有檔案均被關閉,而且 BASIC 會回到作業系統(對獨立
可執行的程式),或結束程式的執行(若程式是在 QuickBASIC 工作環境下執行)。

  注意: 在 QuickBASIC 命令中可使用 /RUN 選擇項來執行程式,若程式中
        包含有一個 SYSTEM 敘述,則會離開 QuickBASIC 回到作業系統中。

        在立即執行視窗中輸入一個 SYSTEM 敘述便結束 QuickBASIC 回到
        作業系統 。

<span class="QH_1">與 BASICA 的差異</span>

END 及 SYSTEM 的用法在 BASICA 中是不相同,但在 QuickBASIC 中是相同的。


<hr>

<span id="L81D8" class="QBtitle">SYSTEM 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BC"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

SYSTEM 敘述並無程式範例。



<hr>

<span id="L81D9" class="QBtitle">TAB 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BD"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TAB 函數細節</span>

<span class="QH_1">語法</span>
  TAB(行)

此行參數為一個數值運算式,表示新顯示的行(column)位置。若目前顯示的位置已大於
新顯示的行位置,則 TAB 函數將移動新顯示位置到下一列的該行上。1 為最左邊的行
位置,而最右邊的位置是由目前輸出裝置的列寬度(line width)而定。若行參數值比
輸出寬度還大,則 TAB 會變動新的顯示位置成為 "1+(行參數 MOD 寬度)"。若行參數
值比 1 小,則 TAB 將設定新的顯示位置在第一行。

TAB 只能在 PRINT 或 LPRINT 敘述中使用。


<hr>

<span id="L81DA" class="QBtitle">TAB 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BD"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81D9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TAB 函數程式範例</span>

<span class="QH_1">範例 1</span>

下列範例使用 TAB 函數來定位輸出的行數:

FOR I = 1 TO 4
   READ A$,B$
   PRINT A$ TAB(25) B$
NEXT
DATA NAME, AMOUNT,,, G.T. JONES, $25.00, H.L. STEVENS, $32.25

<span class="QH_1">範例輸出</span>

NAME                    AMOUNT

G.T. JONES              $25.00
H.L. STEVENS            $32.25


<span class="QH_1">範例 2</span>

下列範例顯示在 TAB 函數中使用不同的參數值,將有不同的輸出效果:

'假設螢幕寬度為 80 行
PRINT TAB(1287); "one"
PRINT TAB(255); "two"
PRINT TAB(-5); "three"
PRINT "123456789012345678901234567890" TAB(20) "four"

<span class="QH_1">範例輸出</span>

      one
              two
three
123456789012345678901234567890
                   four



<hr>

<span id="L81DB" class="QBtitle">TAN 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BE"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TAN 函數細節</span>

<span class="QH_1">語法</span>
  TAN(數值運算式)

TAN 函數以單精確度度數算出正切值,除非參數本身為倍精確度數,則 TAN 函數會以
倍精確度算出正切值。

必須將角度的量測值由度度量轉換成弳度量,只須將度度量乘上 π/180 就是弳度量,
其中 π = 3.141593。

轉換弳度量到度度量,是直接乘以 57.2958。

<span class="QH_1">與 BASICA 的差異</span>

在 BASICA 中,如果 TAN 產生超值溢位,則直譯器顯示 "超值溢位"(overflow)的錯誤
訊息,並傳回一個無限大的結果,並且會繼續執行。

若 TAN 產生超值溢位, QuickBASIC 不會在機器上顯示無限大的狀態,亦不會終止程式
執行(除非程式有一個錯誤處理次常式(error-handling subroutine))。



<hr>

<span id="L81DC" class="QBtitle">TAN 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BE"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TAN 函數程式範例</span>

下例利用物體的距離及該物體的仰角(angle of elevation)來計算出一個物體的高度。
此程式繪出由一個底及其高度所產生的三角形。

SCREEN 82

INPUT "底的長度: ",Baselen
INPUT "仰角為多少(度,分): ",Deg,Min

Ang = (3.141593/180)*(Deg + Min/60)   '轉換成弳度量
Height = Baselen*TAN(Ang)             '計算高度
PRINT "高度 =" Height
H = 180 - Height
B = 15 + Baselen

LINE (15,180)-(B,180):LINE -(B,H)     '畫出三角形
LINE -(10,180)
LOCATE 24,1 : PRINT "按任意鍵繼續...";
DO
LOOP WHILE INKEY$=""



<hr>

<span id="L81DD" class="QBtitle">TIME$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L8053"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIME$ 函數細節</span>

<span class="QH_1">語法</span>
  TIME$

TIME$ 函數會傳回一個佔 8 個位元組的字串,其型式為 hh:mm:ss, 其中 hh
表示 "小時" (00-23), mm 表示 "分"(00-59), 及 ss 表示 "秒"(00-59)。
它為一個 24 小時的時鐘; 所以下午 8:00 表示為 20:00:00。

可以使用 TIME$ 敘述來設定時間。


<hr>

<span id="L81DE" class="QBtitle">TIME$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8053"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIME$ 函數程式範例</span>


下例將 24 小時的時鐘轉換為 12 小時的時鐘。

'將 TIME$ 所傳回的 24 小時的時鐘轉換為 12 小時的時鐘,並以 "AM" 或 "PM" 來
'表示 "上午" 或 "下午"。

T$ = TIME$
Hr = VAL(T$)
IF Hr &lt; 12 THEN Ampm$ = " AM" ELSE Ampm$ = " PM"
IF Hr &gt; 12 THEN Hr = Hr - 12
PRINT "The time is" STR$(Hr) RIGHT$(T$,6) Ampm$

<span class="QH_1">範例輸出</span>

The time is 11:26:31 AM



<hr>

<span id="L81DF" class="QBtitle">TIME$ 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BF"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIME$ 敘述細節</span>

<span class="QH_1">語法</span>
  TIME$=字串運算式

字串運算式參數必須為下列型式之一:

 <span class="QH_1">型式        說明</span>
  hh         設定 "小時"; 而 "分" 及 "秒" 的預設值為 00。

  hh:mm      設定 "小時" 和 "分"; 而 "秒" 的預設值為 00。

  hh:mm:ss   設定 "小時", "分" 和 "秒"。

使用 24 小時的時鐘--所以下午 8:00 將被表示為 20:00:00。

此敘述與用來傳回目前時間的 TIME$ 函數是互補的。



<hr>

<span id="L81E0" class="QBtitle">TIME$ 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80BF"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81DF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIME$ 敘述程式範例</span>

下例設定目前的時間為上午 8:00:

'*** TIME$ 敘述程式範例  ***
' 除非您想改變目前系統時鐘為上午 8:00
' 否則不要執行此程式
'
TIME$="08:00:00"



<hr>

<span id="L81E1" class="QBtitle">TIMER 函數細節</span>
  <span class="QH_2">&lt;</span><a href="#L8054"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIMER 函數細節</span>

<span class="QH_1">語法</span>
  TIMER

TIMER 函數可與 RANDOMIZE 敘述共用,以產生一個隨機亂數。它通常用於時間程式或
程式中的一部份。



<hr>

<span id="L81E2" class="QBtitle">TIMER 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8054"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIMER 函數程式範例</span>

下列程式使用一個 Eratosthenes 篩(Sieve)的變化,由 3 到 10,000 間尋找出質數。
由 TIMER 函數來對程式作計時。

'*** TIMER 函數程式範例
'
DEFINT A-Z
CONST UNMARK = 0, MARKIT = NOT UNMARK
DIM Mark(10000)
CLS                     '清除螢幕
Start! = TIMER
Num = 0
FOR N = 3 TO 10000 STEP 2
   IF NOT Mark(N) THEN
      PRINT N,          '印出質數,並除去在 PRINT 敘述前面的
                        '備註分界符號(remark delimiter)
      Delta = 2*N
      FOR I = 3*N TO 10000 STEP Delta
         Mark(I) = MARKIT
      NEXT
      Num = Num + 1
   END IF
NEXT
Finish! = TIMER
PRINT
PRINT "程式共花費";Finish! - Start!;
PRINT "秒,找到";Num;"個質數"
END

<span class="QH_1">範例輸出</span>

程式共花費 19.16797 秒,找到 1228 個質數



<hr>

<span id="L81E3" class="QBtitle">TIMER 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIMER 敘述細節</span>

<span class="QH_1">語法</span>
  TIMER ON
  TIMER OFF
  TIMER STOP

透過 ON TIMER 敘述,用 TIMER ON 來啟動時間事件設陷。當設陷被啟動,則在每一個
敘述執行後,會產生一個檢查,以判斷是否指定的時間已耗盡。如果是, 則 ON TIMER
事件處理常式(event-handling routine)將會被執行。

TIMER OFF 用來關閉時間事件設陷。若一事件發生時,將不會被記錄,也不會在下一個
TIMER ON 時被執行。

TIMER STOP 用來關閉時間事件設陷。可是,若一個事件發生時,將會被記錄起來,一旦
"TIMER ON" 重新啟動事件,此 ON TIMER 的事件處理常式將會被執行。



<hr>

<span id="L81E4" class="QBtitle">TIMER 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TIMER 敘述程式範例</span>

下列在第一列顯示一天中的時間,並且每三秒更新顯示的時間:

'*** TIMER 敘述程式範例 ***
'按任意鍵結束程式
'
TIMER ON
ON TIMER(3) GOSUB Display
DO WHILE INKEY$ = "" : LOOP
END

Display:
    Oldrow = CSRLIN       '儲存目前的列值(line number)
    Oldcol = POS(0)       '儲存目前的行值(column number)
    LOCATE 1,1 : PRINT TIME$;
    LOCATE Oldrow,Oldcol   '恢復原來所在的行和列位置
RETURN



<hr>

<span id="L81E5" class="QBtitle">TRON 和 TROFF 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C2"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TRON 和 TROFF 敘述細節</span>

<span class="QH_1">語法</span>
  TRON
  TROFF

在 QuickBASIC 環境下,執行一個 TRON 敘述與在 [D/偵錯] 功能表內選擇 "T/追蹤"
命令的功能相同-- 即 : 每一個被執行的敘述會以反白方式顯示在螢幕上。

TROFF 敘述關閉程式的追蹤。

當用偵錯選項或在 BC 命令行上加入 /D 選擇項編譯時, TRON 及 TROFF 敘述
僅顯示行號。

  注意: QuickBASIC 工作環境下的偵錯特性使得這兩個敘述變成不需要。
        請參閱 <span class="QH_2">&lt;</span><a href="#L8212">偵錯鍵</a><span class="QH_2">&gt;</span> 有更多的訊息。


<hr>

<span id="L81E6" class="QBtitle">TRON 和 TROFF 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C2"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

此處並無 TRON 及 TROFF 敘述的程式範例。可參閱 QB Advisor 線上援助中的
<span class="QH_2">&lt;</span><a href="#L8212">偵錯鍵</a><span class="QH_2">&gt;</span>,以瞭解如何在 QuickBASIC 4.50 用來追蹤程式執行的流向。



<hr>

<span id="L81E7" class="QBtitle">TYPE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C3"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TYPE 敘述細節</span>

<span class="QH_1">語法</span>
  TYPE 使用者型態
    元素名稱 AS 型態名稱
    [元素名稱 AS 型態名稱]
    .
    .
    .
  END TYPE

   <span class="QH_1">參數         說明</span>
  使用者型態    為一使用者自定資料型態的名稱。依照 QuickBASIC 變數名稱的
                命名規則來命名。

  元素名稱      為一使用者自定資料型態的元素名稱。與 QuickBASIC 變數名稱
                的命名規則相同,但不是一個陣列的名稱。

  型態名稱      可為下列任一個 QuickBASIC 資料型態:如 INTEGER,LONG,SINGLE
                DOUBLE,固定長度字串(請參閱下列注意中所示)或使用者自定型態。

  注意: 在使用者自定型態中的字串,必須是固定長度字串。其字串長度可用一星號
        及一數值常數來表示。例如:下列即以使用者自定型態來定義一個名稱為
        keyword 的元素,且其長度為 40 個位元組的字串變數。

            Keyword AS STRING * 40

在一個程式中使用使用者自定型態變數之前,必須先以 TYPE 宣告。雖然一個使用者
自定型態僅能在模組層次碼中宣告,但您可以在任何模組,即使在 SUB 或 FUNCTION
程序式中,宣告一個為使用者自定型態的變數。

使用 DIM, REDIM, COMMON, STATIC, 或 SHARED 敘述亦可宣告一個使用者自定型態
的變數。


<hr>

<span id="L81E8" class="QBtitle">TYPE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C3"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">TYPE 敘述程式範例</span>

TYPE_EX.BAS 為一在 ADVR_EX 子目錄下的程式檔,說明 TYPE...END TYPE 敘述的
使用。可利用 [F/檔案] 功能表中的 "O/載入程式" 命令將此程式檔載入到景象
視窗中,並執行它。

此程式使用一個使用者自定型態來模擬一副撲克牌。此程式產生一副撲克牌(一個
使用者自定型態陣列),洗牌,並且顯示最前面五張牌。


<hr>

<span id="L81E9" class="QBtitle">UBOUND 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C4"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81EA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">UBOUND 函數細節</span>

<span class="QH_1">語法</span>
  UBOUND(陣列名稱 [,維度])

其中維度參數是一個由 1 到所宣告陣列維度(dimension)的整數值。若一個陣列
宣告如下,則 UBOUND 會傳回如下所列的數值:

  DIM A(1 TO 100, 1 TO 50, -3 TO 4)

  <span class="QH_1">動作          傳回值</span>
  UBOUND(A,1)   100
  UBOUND(A,2)    50
  UBOUND(A,3)     4

因為維度的預設值為 1, 所以宣告一個一維陣列的語法可以縮寫為 UBOUND(陣列名稱)。

使用 LBOUND 函數,可以測知一個陣列中指定維度的下界(lower bound)。


<hr>

<span id="L81EA" class="QBtitle">UBOUND 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C4"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81E9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">UBOUND 函數程式範例</span>

UBO_EX.BAS 為一在 ADVR_EX 子目錄下的程式檔,用來說明 UBOUND 及 LBOUND 函數
的使用。您可以使用 [F/檔案] 功能表中 "O/載入程式" 命令將它載入景象視窗內,
並執行它。

此程式顯示如何在一個 SUB 程序式中,同時使用 LBOUND 和 UBOUND 敘述來傅回陣列
的上下界值。


<hr>

<span id="L81EB" class="QBtitle">UCASE$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C5"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81EC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">UCASE$ 函數細節</span>

<span class="QH_1">語法</span>
  UCASE$(字串運算式)

此字串運算式參數可為任意的字串運算式。

UCASE$ 函數可適用於變動或固定長度字串。

UCASE$ 和 LCASE$ 敘述在比較兩個字串時是非常有用的。



<hr>

<span id="L81EC" class="QBtitle">UCASE$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C5"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81EB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">UCASE$ 函數程式範例</span>

UCASE_EX.BAS 為一在 ADVR_EX 子目錄下的程式檔,它說明了 UCASE$ 函數的使用。
您可以使用 [F/檔案] 功能表中的 "O/載入程式" 命令將此程式檔載入景象視窗中,
並執行它。

此程式包含了一個 FUNCTION "YesQues" 的函數,它將傳回一布林(Boolean)值,
而此傳回值視使用者的回應而定。此 FUNCTION YesQues 函數使用 UCASE$ 建立
一個使用者的回應測試。


<hr>

<span id="L81ED" class="QBtitle">UEVENT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C6"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81EE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">UEVENT 敘述細節</span>

<span class="QH_1">語法</span>
  UEVENT ON
  UEVENT OFF
  UEVENT STOP

VEVENT 敘述的功效與其他事件設陷敘述相似。當 UEVENT ON 被執行,事件設陷常式
(event-trapping routine)會被設定。當事件發生時,便觸動該事件處理常式的執行。

當 UEVENT OFF 被執行,事件設陷常式會被關閉。任何發生的事件均被忽略。

當 UEVENT STOP 被執行,事件設陷常式會被暫停。但發生的事件會被記錄起來,且在
一個 UEVENT ON 敘述被執行時,事件設陷常式就會立刻被執行。



<hr>

<span id="L81EE" class="QBtitle">UEVENT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C6"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81ED"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱<span class="QH_2">&lt;</span><a href="#L8151">ON UEVENT 敘述程式範例</a><span class="QH_2">&gt;</span>,有用到 UEVENT 敘述。



<hr>

<span id="L81EF" class="QBtitle">UNLOCK 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C7"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F0"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">UNLOCK 敘述細節</span>

<span class="QH_1">語法</span>
  UNLOCK [#]檔案代碼 [,{記錄 | [起始] TO 結束}]

UNLOCK 敘述僅可使用在 LOCK 敘述之後。請參閱<span class="QH_2">&lt;</span><a href="#L811B">LOCK 敘述細節</a><span class="QH_2">&gt;</span> 有更多的資訊。

對二進位模式檔案而言,記錄,起始及結束參數,表示與檔案起始位置相對的位元組數目。
檔案中的第一個位元組為位元組 1。

對隨機存取檔案而言,此三個參數為相對於檔案起始位置的記錄數目。檔案中的第一個
資料記錄為記錄代碼(record number) 1。



<hr>

<span id="L81F0" class="QBtitle">UNLOCK 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C7"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81EF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱<span class="QH_2">&lt;</span><a href="#L811C">LOCK 敘述程式範例</a><span class="QH_2">&gt;</span>,有使用 UNLOCK 的敘述。



<hr>

<span id="L81F1" class="QBtitle">VAL 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C9"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F2"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VAL 函數細節</span>

<span class="QH_1">語法</span>
  VAL(字串運算式)

字串運算式是一個將被解釋成一個數值的一連串字元,這些字元可以是中文數字的字元
(例如 : ０-９)。當碰到第一個非數字的字元時, VAL 函數會停止讀取後面的字元。
VAL 函數會先去除參數字串內的前導空白,定位(tab),跳行(line-feed)等符號字元。
如下例 :

  VAL("    -33/LP")

傳回值為 -33。



<hr>

<span id="L81F2" class="QBtitle">VAL 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80C9"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F1"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VAL 函數程式範例</span>

下面程式將列印所指定的電話區域號碼中,使用者的姓名和住址。

'  VAL 函數程式範例
'
' ***此部分程式建立一個簡單的資料檔
'
OPEN "PHONE.DAT" FOR OUTPUT AS #1
CLS
RESTORE
READ FuName$, ACPhone$
I = 0
DO WHILE UCASE$(FuName$) &lt;&gt; "END"
   I = I + 1
   WRITE #1, FuName$, ACPhone$
   READ FuName$, ACPhone$
   IF FuName$ = "END" THEN EXIT DO
LOOP
CLOSE #1
'
   DATA "Bob Hartzell ","206-378-3223"
   DATA "Alice Provan ","213-884-9700"
   DATA "Alex Landow ","213-456-3111"
   DATA "Walt Riley ","503-248-0048"
   DATA "Georgette Gump ","213-222-2222"
   DATA "END",0,0,0,0,0
'
' *** 此部分程式說明 VAL 函數
'
INPUT "請選擇要找尋的一個區域 (206, 213, or 503): ", Targetarea
OPEN "PHONE.DAT" FOR INPUT AS #1
DO WHILE NOT EOF(1)
   INPUT #1, Nm$, Phonenum$
   'VAL 一直讀取到第一個不為數字字元為止
   '("-" 在此範圍內)
   Area = VAL(Phonenum$)
   IF Area = Targetarea THEN
      PRINT
      PRINT Nm$;
      PRINT Phonenum$
   END IF
LOOP
CLOSE
KILL "PHONE.DAT"
END


<hr>

<span id="L81F3" class="QBtitle">VARPTR 和 VARSEG 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CA"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F4"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VARPTR 和 VARSEG 函數細節</span>

<span class="QH_1">語法</span>
  VARPTR(變數名稱)
  VARSEG(變數名稱)

變數名稱為任何 QuickBASIC 的變數,可以是一個記錄變數或記錄元素。VARPTR
函數傳回一個無正負符號的整數值,此值是指變數在該區段(節--Segment)內的
位移位址(Offset Address)。VARSEG 函數傳回一個無正負符號的整數,此值是該變數
所在的區段位址(節位址--Segment Address)。若變數名稱在 VARPTR 或 VARSEG
被呼叫之前沒有定義,變數會被建立且傳回其位址。若變數名稱是一個字串變數,VARPTR
和 VARSEG 傳回字串第一個位元組的位置。

  注意: 因為許多 QuickBASIC 敘述會改變變數在記憶體中的位置,在呼叫 VARPTR,
        VARSEG 函數以後,應立即使用由 VARPTR 和 VARSEG 所傳回的值。

VARPTR 和 VARSEG 通常與 BLOAD, BSAVE, CALL ABSOLUTE, PEEK, CALL INTERRUPT,
POKE, 或當傳遞陣列到以其他語言寫成的程序式時連用。

當要使用 VARPTR 或 VARSEG 來取得陣列的位址時,須將陣列的第一個元素當作參數:

  DIM A(150)
  .
  .
  .
  ArrAddress=VARPTR(A(1))

  注意: 並不須要用 VARPTR 來取得檔案緩衝區的位址,使用 FILEATTR 函數
        可取得有關檔案的資訊。

        此外,以較早版本寫成的 BASIC 程式,若使用 VARPTR 來存取數值陣列
        可能無法運作。現在必須將 VARPTR 及 VARSEG 聯合使用才行。
        如下例, 在 QuickBASIC Version 3.0 的程式片斷,將無法在 4.50 版本
        下正確地運作:

            DIM Cube(675)
            .
            .
            .
           BSAVE "graph.dat",VARPTR(Cube(1)),2700

       此程式片斷需被改寫成如下:

           DIM Cube(675)
           .
           .
           .
           ' 改變節(區段)位址到包含 Cube 的節位址
           DEF SEG=VARSEG(Cube(1))
           BSAVE "graph.dat",VARPTR(Cube(1)),2700
           ' 恢復到 QuickBASIC 預設的節位址
           DEF SEG

您可單獨使用 VARPTR 來取得儲存於 DGROUP 中的變數位址。但必須同時使用
VARPTR 和 VARSEG 來取得存在一個遠程資訊(far object)中的變數之完整位址。

同時使用 VARSEG 和 VARPTR 函數可以取代較早的 QuickBASIC 版本中
的 PTR86 副程式。

<span class="QH_1">在 QuickBASIC 下使用 Btrive</span>

在 QuickBASIC 4.50 版本以前所寫的 BASIC 程式中有包含 Btrive, 必需作小小的
改變,例如:

        OPEN "NUL" AS #1
        FIELD #1, 20 AS CITY$, 10 AS STATE$
        FCB.ADDR% = VARPTR(#1)

必需修改成 :

        OPEN "NUL" AS #1
        FIELD #1, 20 AS CITY$, 10 AS STATE$
        FCB.ADDR% = SADD(CITY$) - 188


<hr>

<span id="L81F4" class="QBtitle">VARPTR 和 VARSEG 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CA"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F3"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VARPTR 和 VARSEG 函數程式範例</span>

請參閱在其他敘述中如何使用 VARPTR 和 VARSEG 函數的範例 :

<span class="QH_2">&lt;</span><a href="#L8067">BSAVE 和 BLOAD 程式範例</a><span class="QH_2">&gt;</span>,
<span class="QH_2">&lt;</span><a href="#L8208">CALL ABSOLUTE 程式範例</a><span class="QH_2">&gt;</span>,或
<span class="QH_2">&lt;</span><a href="#L820A">CALL INTERRUPT 程式範例</a><span class="QH_2">&gt;</span>。

這個範例程式說明如何在 CALL 敘述中使用 VARPTR 和 VARSEG 函數來傳送一個
QuickBASIC 的陣列到一個 C-語言的函數中。

'*** 程式範例 : VARPTR 及 VARSEG 使用 CALL ***
'
' 除非已經用大模式(/AL)來獨立編譯(compiled) C 函數,並將編譯過的目的模組
' (object module) 置入 QuickBASIC 程式庫,或已連結到 BASIC 主程式中,否則
' 不可以執行此程式。
'
' BASIC 主程式傳遞一個陣列到 C 函數
'
DEFINT A-Z
'
DECLARE SUB AddArr CDECL (BYVAL Offs, BYVAL Segm, BYVAL Num)
DIM A(1 TO 100) AS INTEGER
' 此數值 1-15 填滿陣列
FOR I=1 TO 15
   A(I)=I
NEXT I
'
' 呼叫 C 函數,AddArr 期望一個遠程位址(節位址及節內位址)。
' 因為 CDECL 將事件(things)由右到左放入堆疊(stack)中,其中先將節內位址
' ( VARPTR(A(1)) )放在串列中,然後緊接著放節位址( VARSEG(A(1)) )。
'
CALL AddArr(VARPTR(A(1)),VARSEG(A(1)),15%)
'
' 列印修改過的陣列
FOR I=1 TO 15
   PRINT A(I)
NEXT I

END

/* 將陣列 arr 中的第一個元素加 1.*/
void far addarr(arr,num)
int far *arr;
int num;
{
   int i;
   for(i=0;i&lt;num;i++) arr[i]++;
}



<hr>

<span id="L81F5" class="QBtitle">VARPTR$ 函數細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CB"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F6"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VARPTR$ 函數細節</span>

<span class="QH_1">語法</span>
  VARPTR$(變數名稱)

變數名稱參數是程式中的一個變數的名稱。

若變數名稱為一陣列元素,則此陣列在使用 VARPTR$ 函數之前就必須事先宣告過,
並且陣列必須是一個變動長度字串陣列。

  注意: 為了保證正確的結果,在呼叫函數之後,應立即使用 VARPTR$ 所傳回的值。

<span class="QH_1">與 BASICA 的差異</span>

在 QuickBASIC 程式中, VARPTR$ 必須使用在 DRAW 和 PLAY 敘述中,以執行含有
變數的子字串。

BASICA 提供了 VARPTR$ 語法,以及只包含變數名稱的語法。


<hr>

<span id="L81F6" class="QBtitle">VARPTR$ 函數程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CB"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F5"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱下列使用 VARPTR$ 函數的程式範例 :

  <span class="QH_2">&lt;</span><a href="#L80BE">DRAW 敘述範例 2</a><span class="QH_2">&gt;</span>
  <span class="QH_2">&lt;</span><a href="#L816B">PLAY 敘述範例</a><span class="QH_2">&gt;</span>



<hr>

<span id="L81F7" class="QBtitle">VIEW 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CC"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F8"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VIEW 敘述細節</span>

<span class="QH_1">語法</span>
  VIEW [[SCREEN] (x1,y1)-(x2,y2) [,[顏色] [,邊界]]]

  <span class="QH_1">參數              說明</span>
  SCREEN            若有使用 SCREEN ,則在 VIEW 敘述以後所執行的繪圖敘述
                    或函數中的 x 和 y 座標是指螢幕的 "絕對座標"; 若省略
                    SCREEN, 則是以相對於目前實際的景象埠(physical viewport)
                    的 "相對座標" 來繪製所有圖點的(即 : 在繪點之前會先將
                    x 和 y 值與景象埠上的 x1 與 y1 座標相加)。

                    無論是 "絕對座標" 或是 "相對座標",其所繪出的圖形只有
                    畫在景象埠中的圖形才會被繪出來。

  (x1,y1)-(x2,y2)   表示螢幕上的一個矩形區域。x1, y1, x2, 和 y2 可以為
                    數值運算式用來表示所圍區域內的左上與右下兩個端點之
                    "絕對座標" 。

  顏色              用來填滿整個區域顏色的顏色屬性暫存器號碼。
                    若省略顏色參數,則此區域不會被填滿顏色。

  邊界              此參數為任意的數值運算式,若使用此參數,且空間允許
                    時,會沿著景象埠繪一邊界框。若省略邊界參數,則不畫出
                    邊界框。

VIEW 敘述用來定義一個 "實際的景象埠"(physical viewport),或是實際螢幕上
的一塊矩形區域,以做為將來顯示圖形或資料使用。在螢幕上可以連續開啟很多個
景象埠,每建立一個新的景象埠時,先前所開啟的景象埠就會自動關閉,只有此次
新開啟的景象埠才有效。

若在 VIEW 敘述中省略所有參數,則會將整個螢幕定義成景象埠(viewport)。在 RUN 及
SCREEN 敘述中會重新將原來實際螢幕的大小視為景象埠,並且關閉先前已經使用
VIEW 敘述所定義的景象埠。


<hr>

<span id="L81F8" class="QBtitle">VIEW 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CC"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F7"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VIEW 敘述程式範例</span>

您可以使用多個 VIEW 敘述。假如新描述的景象埠並不完全在上次景象埠之中,
此螢幕可以重新以 VIEW 敘述重新起始化,而且新的景象埠將被定義。
如果新的景象埠完全被包含於原有景象埠中,如下例所示,中間的 VIEW 敘述是多餘的。
此範例開啟三個景象埠,每一個都比上一個小。在每種情況,超出景象埠邊框的線都會
被截掉而不顯示在螢幕上。

SCREEN 82
CLS
VIEW    '產生的景象埠 = 實際的螢幕大小
VIEW (10,10) - (300,180),,1
   CLS
   LINE (0,0) - (310,190),1
   LOCATE 1,11: PRINT "一個大型景象埠"
VIEW SCREEN (50,50)-(250,150),,1
   CLS  '注意 CLS 只清除景象埠
   LINE (300,0)-(0,199),1
   LOCATE 9,9: PRINT "一個中型景象埠"
VIEW SCREEN (80,80)-(200,125),,1
   CLS
   CIRCLE (150,100),20,1
   LOCATE 7,11: PRINT "一個小型景象埠"


<hr>

<span id="L81F9" class="QBtitle">VIEW PRINT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8055"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FA"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">VIEW PRINT 敘述細節</span>

<span class="QH_1">語法</span>
  VIEW PRINT [頂行 TO 底行]

頂行參數為景象埠的最上面一行,其為一數值。而底行為景象埠內的最下面一行,
亦為一數值。

若省略頂行及底行兩參數,則 VIEW PRINT 敘述設定整個螢幕為本文景象埠(Text
Viewport)。螢幕上所能顯示的行數,可參閱<span class="QH_2">&lt;</span><a href="#L81FD">WIDTH 敘述細節</a><span class="QH_2">&gt;</span>pends 有更多的資訊。

可以在已定義的本文景象埠上運作的敘述和函數,包括: CLS, LOCATE, PRINT,
和 SCREEN 函數。


<hr>

<span id="L81FA" class="QBtitle">VIEW PRINT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8055"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81F9"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

請參閱<span class="QH_2">&lt;</span><a href="#L8085">CLS 敘述程式範例</a><span class="QH_2">&gt;</span>,有使用 VIEW PRINT 敘述。


<hr>

<span id="L81FB" class="QBtitle">WAIT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CD"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FC"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WAIT 敘述細節</span>

<span class="QH_1">語法</span>
  WAIT 埠編號, and-運算式 [,xor-運算式]

  <span class="QH_1">參數             說明</span>
  埠編號           為一整數運算式,其範圍為 0-255,表示埠(port)的編號。

  and-運算式       為一整數運算式,將與埠上所傳來的資料作一個 AND 處理。

  xor-運算式       為一整數運算式,將與埠上所傳來的資料作一個 XOR 處理。

WAIT 敘述暫停執行,直到從指定的輸入埠讀到一個特定的位元型態(bit pattern)為止。
由輸入埠所讀入的資料,若有資料出現時會先與 xor-運算式 作 XOR 運算,其結果再與
and-運算式 結合作 AND 邏輯運算。如果結果為零(假), QuickBASIC 重覆由此埠讀取
另外一個位元組資料,再執行位元測試; 如果結果不為零(真),表示輸入資料符合位元
型態,則執行 WAIT 敘述的下一個敘述。若省略 xor-運算式 ,則假設 xor-運算式
的值為零。

             <span class="QH_1">-------------------  警告   -------------------</span>
  如果輸入埠無法產生符合的位元型態,則可能會使 WAIT 敘述進入一個無窮迴圈
  之中。在此狀況下,則必須重新開機。
             <span class="QH_1">-----------------------------------------------</span>

以下範例程式即說明 WAIT 敘述的語法:

WAIT  HandShakePort, 2

此敘述將導致 QuickBASIC 對由 DOS 的輸入/輸出埠 HandShakePort 接收到
的位元型態與代表 2(00000010) 的位元型態做一個 AND 的運算。


<hr>

<span id="L81FC" class="QBtitle">WAIT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CD"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FB"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WAIT 敘述程式範例</span>

沒有可執行之 WAIT 敘述程式範例。



<hr>

<span id="L81FD" class="QBtitle">WIDTH 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CE"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FE"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WIDTH 敘述細節</span>

<span class="QH_1">語法</span>
  WIDTH [行數] [,列數]
  WIDTH {#檔案代號 | 裝置}, 寬度
  WIDTH LPRINT 寬度

檔案及裝置(device)均可被指定為一個輸出的列印寬度。

  <span class="QH_1">語法                      說明</span>
  WIDTH [行數][,列數]       設定顯示在螢幕上的行列值。
                            在程式開始執行時,所能顯示的列(Row)數是由預設值
                            來決定。

  WIDTH #檔案代碼,寬度      設定所開啟的輸出裝置之列寬度(Row Width)。
                            (例如, LPT1: 或 CONS:)。

                            其中,檔案代碼參數與在 OPEN 敘述中所開啟的輸出
                            裝置所使用的檔案代碼相同。

                            因為此敘述執行以後馬上有效,所以當一個裝置被打開
                            時,允許用來改變其寬度。

  WIDTH 裝置,寬度           設定裝置(即一個裝置檔案名稱)的列寬度。

                            其中,裝置參數為一字串運算式。(例如, "CONS:")

                            注意:此指定寬度一直被沿用到下一個 OPEN 敘述
                                 影響裝置為止;而此指定的參數並不影響已被
                                 開啟的檔案之輸出。

  WIDTH LPRINT 寬度         設定列表機的列寬度,可用於連續的 LPRINT 敘述。
                            請參閱 <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D3">使用函數及敘述應注意的事項</a><span class="QH_2">&gt;</span>內有說明
                            WIDTH LPRINT 在中文版使用時應注意的事項。



<hr>

<span id="L81FE" class="QBtitle">WIDTH 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CE"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FD"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WIDTH 敘述程式範例</span>

下列範例中,檔案代碼 #1(指列表機)的記錄寬度被設定成不同的寬度:

'*** 使用 WIDTH 的程式範例 ***
OPEN "LPT1:" FOR OUTPUT AS #1
Test$ = "1234567890"
WIDTH #1, 3
PRINT #1, Test$
WIDTH #1, 4
PRINT #1, Test$
CLOSE

<span class="QH_1">範例輸出</span> (於列表機上)

123
456
789
0
1234
5678
90



<hr>

<span id="L81FF" class="QBtitle">WINDOW 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CF"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8200"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WINDOW 敘述細節</span>

<span class="QH_1">語法</span>
  WINDOW [[SCREEN] (x1,y1)-(x2,y2)]

WINDOW 敘述允許使用者建立一個慣用的邏輯座標系統(邏輯視窗,即 : 改變螢幕上
每一個座標點的刻度大小,與改變 Y 座標遞增的方向),以用來繪線,圖形或物體,
而不受螢幕上實際的座標系統(指真正螢幕的大小,例如 : 在 MGA 的繪圖區域是
橫座標 640 點,座標的遞增方向是由左向右;縱座標 375 點,座標的遞增方向是由
上向下)的限制。

  <span class="QH_1">參數                      說明</span>
  SCREEN                    若省略 SCREEN 參數,則 Y 座標的遞增方向
                            是由下向上。相反地,當使用 SCREEN 參數時,
                            則與實際座標系統相同, Y 座標的遞增方向是
                            由上向下。請參閱下面有圖表說明。

 (x1,y1)-(x2,y2)            用來建立一個使用者自定的邏輯座標系統之範圍。
                            x1, y1, x2, y2 是單精確度的數值。
                            有關邏輯座標系統範圍內四個端點座標的決定,
                            是與 SCREEN 參數有關。請參閱下面的圖表說明。

對於使用者所定義的邏輯座標系統,將來在螢幕上實際的顯現區域是目前的景象埠
(viewport - 可以是實際的螢幕大小,或由 VIEW 敘述所定義的區域)。在景象埠內,
對於同一個繪圖敘述而言,會因為不同邏輯座標系統的影響,而使得實際顯現的圖形
大小有所改變。邏輯座標系統範圍愈大(每單位所對映到實際顯現的刻度愈小),實際
顯現的圖形就會愈小;邏輯座標系統範圍愈小(每單位所對映到實際顯現的刻度愈大),
實際顯現的圖形就會愈大。請執行範例程式就可以瞭解實際顯現的效果。

注意 : 執行 RUN 敘述,或在 WINDOW 敘述中省略所有參數時,則會關閉邏輯座標
       系統,返回到實際座標系統上。

            下圖為 WINDOW 與 WINDOW SCREEN 之對照表 :

    ┌─────────────────────────────────┐
    │                         遞增 X                                   │
    │                   ────────→                             │
    │                 (0,0)             (639,0)                        │
    │                │┌────────┐                            │
    │         遞增 Y ││                │                            │
    │                ││                │                            │
    │                ││                │                            │
    │                ││                │                            │
    │                ││                │                            │
    │                ▼└────────┘                            │
    │                  (0,374)          (639,374)                      │
    │                     ╱         ＼                                │
    │WINDOW(-25, -15) - (5, 10)     WINDOW SCREEN(-25, -15) - (5, 10)  │
    │LINE(-15, -10) - (-5, -5)      LINE(-15, -10) - (-5, -5)          │
    │                ↙                   ↘                           │
    │            遞增 X                        遞增 X                  │
    │       ────────→           ────────→            │
    │     (-25, 10)         (5, 10)    (-25, -15)      (5, -15)        │
    │      ┌────────┐         ┌────────┐           │
    │    ▲│             • │       ││ (-15, -10)     │           │
    │遞增││           (0,0)│   遞增││     ＼         │           │
    │ Y  ││   (-5, -5)     │    Y  ││    (-5, -5)    │           │
    │    ││     ／         │       ││             • │           │
    │    ││ (-15,-10)      │       ││           (0,0)│           │
    │    │└────────┘       ▼└────────┘           │
    │     (-25, -15)     (5, -15)      (-25, 10)       (5, 10)         │
    │                                                                  │
    └─────────────────────────────────┘



<hr>

<span id="L8200" class="QBtitle">WINDOW 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80CF"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L81FF"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WINDOW 敘述程式範例</span>

WINDO_EX.BAS 為一在 ADVR_EX 子目錄下說明 WINDOW 敘述的程式檔。您可以使用
[F/檔案] 功能表中的 "O/載入程式" 命令將此程式載入到景象視窗中,並可執行它。

此程式顯示如何藉由改變邏輯座標系統的大小,來改變顯現在螢幕上實際圖形的大小。
此效果如同將鏡頭拉長或縮短所造成的放大和縮小的效果。當邏輯座標系統範圍變小
時,則實際圖形在螢幕上會變得更大,直到部份圖形因為超出邏輯視窗的範圍而被截掉。
當邏輯座標系統範圍變大時,則實際圖形在螢幕上會變得較小。


<hr>

<span id="L8201" class="QBtitle">WRITE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="#L8056"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8202"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WRITE 敘述細節</span>

<span class="QH_1">語法</span>
  WRITE [運算式串列]

若省略運算式串列參數時,會印出一行空白。若含有運算式串列,則所有運算式的值均會
被顯示到螢幕。在串列中的運算式可以為數值 及/或 字串運算式,彼此之間用逗號來
分開。

當各項資料被輸出時,每項資料間會用一個逗號分隔開來。若為字串資料,則各項前後
還會以雙引號括起來。而串列中最後一項被列印時, QuickBASIC 會自動在其後加上
一個歸位(carriage-return)與換行(line-feed)字元。

WRITE 敘述輸出的數值變數,其前後均不留空白。



<hr>

<span id="L8202" class="QBtitle">WRITE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="#L8056"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="#L8201"> 細節 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 範例 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WRITE 敘述程式範例</span>

下列範例顯示 PRINT 與 WRITE 敘述間的不同。

'***  使用 WRITE 範例程式 ***
CLS                          '清螢幕
A=80 : B=90 : C$="That's all." : D=-1.0E-13
WRITE A,B,C$,D
PRINT A,B,C$,D

<span class="QH_1">範例輸出</span>

80,90,"That's all.",-1E-13
 80            90           That's all.  -1E-13



<hr>

<span id="L8203" class="QBtitle">WRITE # 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D0"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8204"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WRITE # 敘述細節</span>

<span class="QH_1">語法</span>
  WRITE #檔案代碼 [,運算式串列]

其中,檔案代碼為 OPEN 敘述所設定的檔案代號,且必須使用 OUTPUT 或 APPEND 模式來
開啟。在運算式串列參數中的運算式可為字串 及/或 數值運算式,各運算式間須以逗號
來隔開。若省略運算式串列,則此 WRITE # 敘述會將一列空白寫到所指定的檔案中。

WRITE # 敘述(不像 PRINT # 敘述)在寫入檔案時會在各項資料間插入逗號,而且在串列
中不必使用明確的分隔字元。一旦串列中的最後一項資料被寫入時,此新的一行便被插入
到檔案中。

若試圖使用 WRITE # 敘述將資料寫到一個有 LOCK 敘述所限制的循序檔案中,除非已經
使用錯誤設陷控制在程式中,否則會有一 "不予允用" 的錯誤訊息出現。所有 BASIC 的
一般錯誤處理常式(error-handling routine)都能被設陷,且檢查出這個錯誤。



<hr>

<span id="L8204" class="QBtitle">WRITE # 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L80D0"> Quick 畫面 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="#L8203"> 細節 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">WRITE# 敘述程式範例</span>

下列程式的輸出說明了 WRITE # 與 PRINT # 敘述的差異:

A$ = "VCR, remote control" : B$ = "$399.00"
OPEN  "PRICES.DAT" FOR OUTPUT AS #1            '開啟 PRICES.DAT 以便寫入資料
PRINT #1,A$,B$               '以 PRINT # 儲存 A$ 及 B$ 到第一筆記錄
WRITE #1,A$,B$               '以 WRITE # 儲存 A$ 及 B$ 到第二筆記錄
CLOSE #1

<span class="QH_1">範例輸出</span>

使用 QuickBASIC 編譯器來查看檔案 PRICES.DAT 的內容如下:

  1. 從 [F/檔案] 功能表中選擇 "O/載入程式" 命令。
  2. 在交談框內指定欲載入的檔案名稱 PRICE.DAT。
  3. 在提示儲存此程式之後, PRICES.DAT 檔案的內容將被顯示在景象視窗中:

VCR, remote control         $399.00
"VCR, remote control","$399.00"

  4. 清除景象視窗,並自 [F/檔案] 功能表中選擇 "N/新增程式" 命令。


<hr>

<span id="L8205" class="QBtitle">CALL 或 CALLS (非 BASIC 程序式) 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801B"> Quick 畫面 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 細節 &gt;</span>    <span class="QH_2">&lt;</span><a href="#L8206"> 範例 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL 或 CALLS (非 BASIC 程序式) 敘述細節</span>

<span class="QH_1">語法</span>

有三種不同的型式可用來執行這個函數:

  CALL 名稱 [( call-參數串列 )]
  名稱[( call-參數串列 )]
  CALLS 名稱 [( calls-參數串列 )]

  <span class="QH_1">參數                說明</span>
  名稱                此參數表示被呼叫的程序式名稱。最長可以到 40 個英文
                      字元。

  call-參數串列       為傳送到指定的程序式之變數或常數。call-參數串列的語法
                      下面有說明。

  calls-參數串列      為 CALLS 敘述傳送到指定的程序式之參數串列,此串列包含
                      變數和常數。所有的參數均須以逗號分隔開。注意,
                      這些參數是以該參數所在的 "節位址"(Segment Address)與
                      "節內位址"(Offset Address)的遠程位址(far reference)
                      傳址方式來傳遞。
                      不可以在 calls-參數串列 中使用 BYVAL 與 SEG。

一個 call-參數串列 的語法如下:

  [[{BYVAL | SEG}] 參數] [,[{BYVAL | SEG}] 參數] ...

若參數為一陣列時,括弧是必須的:

  [[{BYVAL | SEG}] 參數[()]] [,[{BYVAL | SEG}] 參數] ...

  <span class="QH_1">參數       說明</span>
  BYVAL      表示參數是以傳值方式來傳遞,而不是以近程位址(near reference)
             來傳遞(預設的傳遞方式)。

  SEG        表示參數是以遠程位址(far reference)的傳址方式來傳遞,
             即: 該參數所在的 "節位址"(segment address)與節內的
                 "位移位址"(offset address)。

  參數       將一個 BASIC 的變數,陣列或常數傳送給一個程序式。


"CALLS" 與 "在參數之前加上 SEG 的 CALL" 相同,即: 每一個在 CALL 敘述中加上
SEG 的參數,是以一個帶有節位址的遠程位址(far reference)傳址方式來傳遞。

  注意: 以上的語法描述並沒有正確的呼叫一個 BASIC 程序式,而是只能呼叫在其它的
        語言中的程序式。請參閱<span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801A">CALL (BASIC 程序式) 敘述</a><span class="QH_2">&gt;</span>其它語法。

如果任一敘述的參數串列包含一個陣列參數,此陣列可透過陣列名稱及一對小括號
來指定:

  DIM IntArray(20) AS INTEGER
  .
  .
  .
  CALL ShellSort(IntArray() AS INTEGER)

當使用到 CALL 敘述,此 "CALL" 關鍵字是有選擇性的。無論如何,當省略 CALL 時,
則必須用 DECLARE 敘述來宣告此程序式。也請注意到,當您省略 CALL 時,亦可同時
省略在參數串列上的括弧。

"BYVAL" 關鍵字與 BASIC 傳值呼叫所產生的結果並不相同:

  CALL Difference(BYVAL A,(B))

對第一個參數,只有 A 的值被傳送到 Difference 程序式。相反地,(B)會被計值,
然後一個暫時的位置會被產生以用來存放該值,並且此暫時位置的位址將被傳送到
Difference 程序式上。

  注意: 如果參照到一個組合語言程序式,它必須是一個 PUBLIC 名稱
        (符號 - symbol)。PUBLIC 名稱以 "$" 為起始且 "_" (底線)
        可能與 BASIC 執行期間(run-time)系統所用的名稱衝突。
        重覆的名稱在連結(linker)時將產生一個 "符號已經定義" 的
        錯誤訊息。

小心使用 SEG 關鍵字來傳送陣列,因為 QuickBASIC 可能在被呼叫的程序式還未開始
執行前,已經移動了記憶體中的變數位置。而在參數串列中任何導致記憶體的搬移,都
可能會產生問題。若 CALL 敘述的參數串列只包含簡單變數,算術運算式,或沒有使用
內建(intrinsic)函數的陣列索引,或沒有使用使用者定義函數的陣列索引時,您可以
安全的使用 SEG 來傳遞參數。

<span class="QH_1">與 BASICA 的差異</span>

從 BASICA 呼叫組合語言程式時,因為字串描述元(descriptor)在 QuickBASIC 之下
是四個位元組的長度,若有傳遞字串參數時,則須要改變。這四個位元組的內容順序是
: 表示字串長度的低位元組(low byte)和高位元組(high byte)值,和表示字串位址的
低位元組及高位元組值。

常式(routine)被呼叫時的定位方式, BASICA 的 CALLS 敘述是使用最近執行
DEF SEG 所定義的節位址。但現在 QuickBASIC 的 CALLS 敘述並不須要使用
DEF SEG,因為所有的參數是以帶有節位址(segment address)的遠程位址(far
address)方式來傳遞。


<hr>

<span id="L8206" class="QBtitle">CALL 或 CALLS (非-BASIC 程序式) 程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801B"> Quick 畫面 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="#L8205"> 細節 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────

可參閱<span class="QH_2">&lt;</span><a href="#L81F4">VARPTR 函數程式範例</a><span class="QH_2">&gt;</span>,有使用 CALL 敘述來呼叫 C 程序式。



<hr>

<span id="L8207" class="QBtitle">CALL ABSOLUTE 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801C"> Quick 畫面 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 細節 &gt;</span>      <span class="QH_2">&lt;</span><a href="#L8208"> 範例 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL ABSOLUTE 敘述細節</span>

<span class="QH_1">語法</span>
  CALL ABSOLUTE([參數串列,] 整數變數)

  <span class="QH_1">參數              說明</span>
  參數串列          為一可選擇性的參數,用來傳送給一個用機器語言
                    (machine-language)所寫的程序式。

  整數變數          一個整數變數,它包含由目前 DEF SEG 所設定的
                    程式節(Code Segment)到被呼叫常式(called routine)
                    起始位置之間的位移位址(Offset Address)值。
                    此整數變數參數並不會被傳遞到被呼叫常式的程式內。

                    您的程式必須在執行 CALL ABSOLUTE 之前先執行一個
                    DEF SEG 敘述,以用來設定被呼叫常式所在的程式節位址
                    (Code Segment Address)。

                    使用一個非整數值給整數變數,會產生不可預期的結果。


在參數串列中的參數是以傳址方式(近程指標 - near reference),即: 這些參數位於
目前資料節(DS-Data Segment)內的節內位址(Offset Address)來傳送到機器語言程式
內。雖然,參數是使用其節內位址來傳遞,而機器語言程式是以遠程呼叫(far call)的
方式來呼叫。

  注意: CALL ABSOLUTE 敘述用來維護與 BASIC 早期的版本保持相容性。
        混合式語言的程式設計(mixed-language programming)使用這種延伸性的
        CALL 敘述,同時新的 DECLARE 敘述也提供一個簡單的方法,使得能在 BASIC
        中使用組合語言。而且,為了使用 CALL ABSOLUTE, 必須在啟動 QuickBASIC
        時使用正確的 Quick 程式庫,例如: 用 QB.LIB 來連結(link)程式,或在
        QuickBASIC 工作環境中使用 QB.QLB 程式庫。
        請參閱 QuickBASIC 磁片內的 PACKING.LST 檔,以了解這些檔案的內容。

<span class="QH_1">與 BASICA 的差異</span>

由 BASICA 來呼叫組合語言程式時,若有使用字串參數時,則必需作修改。因為
目前 QuickBASIC 的字串描述元(descriptor)是佔 4 個位元組的長度。
這四個位元組的內容順序是 : 表示字串位址的低位元組(low byte)和高位元組
(high byte)值,和表示字串長度的低位元組和高位元組值。



<hr>

<span id="L8208" class="QBtitle">CALL ABSOLUTE 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801C"> Quick 畫面 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="#L8207"> 細節 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL ABSOLUTE 敘述程式範例</span>

以下的範例使用 CALL ABSOLUTE 去執行一個存在陣列中的機器語言程式。

CONST nASMBYTES=14
' 此程式列出一個訊息,以表示是否有安裝數學輔助處理器(math coprocessor)
' 用一個陣列來儲存機器語言程式,然後由作業系統取得資訊。
' AsmBytes 是一個標記(label); nASMBYTES 是一個符號常數(symbolic constant)
DEFINT A-Z
DIM AsmProg(1 TO (nASMBYTES/2))

' 機器語言程式被當作資料讀到陣列中
AsmBytes:
DATA &H55              :'PUSH BP        儲存基底指標
DATA &H8B, &HEC        :'MOV  BP,SP     取得所有
DATA &HCD, &H11        :'INT  11H       產生 ROM-BIOS 呼叫
DATA &H8B, &H5E, &H06  :'MOV  BX,[BP+6] 取得參數位址
DATA &H89, &H07        :'MOV  [BX],AX   將串列存入參數中
DATA &H5D              :'POP  BP        取回基底指標
DATA &HCA, &H02, &H00  :'RET  2         取出堆疊(stack)中的參數
                        '               並產生一個遠程返回(far return)

' 取得此陣列在節內的起始位址值(starting offset address)
P=VARPTR(AsmProg(1))
' 插入此機器語言程式到指定陣列中
DEF SEG=VARSEG(AsmProg(1)) ' 改變節位址
Restore AsmBytes
FOR I=0 TO nASMBYTES-1
   READ J
   POKE(P+I),J
NEXT I

' 執行此程式。此程式要求一個單一的整數參數。
CALL ABSOLUTE(X%,VARPTR(AsmProg(1)))
DEF SEG   ' 恢復節位址
' X% 現在包含由 DOS 所傳回的位元編碼裝置清單(bit-encoded equipment list)
' 除了第二個位元外的其他位元(bit)皆設定為零
CoProcessor=X% AND &H2
' 列印一個適當的訊息
IF CoProcessor=2 THEN
  PRINT "數學輔助處理器已存在"
ELSE
  PRINT "無數學輔助處理器"
END IF
END



<hr>

<span id="L8209" class="QBtitle">CALL INTERRUPT 敘述細節</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801D"> Quick 畫面 </a><span class="QH_2">&gt;</span>      <span class="QH_1">&lt; 細節 &gt;</span>      <span class="QH_2">&lt;</span><a href="#L820A"> 範例 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL INTERRUPT 敘述細節</span>

<span class="QH_1">語法</span>
  CALL INTERRUPT(中斷號碼,輸入暫存器,輸出暫存器)
  CALL INTERRUPTX(中斷號碼,輸入暫存器,輸出暫存器)

  <span class="QH_1">參數           說明</span>
  中斷號碼       為 DOS 的中斷編號(Interrupt Number),此值為介於 0 到 255
                 之間的整數。請參閱 DOS 手冊中有關中斷的資訊。

  輸入暫存器     輸入暫存器(inregs)參數包含當中斷發生時所要使用的暫存器值
                 (register values)。它被宣告為 RegType 的記錄資料型態。
                 此使用者自定型態 RegType 在下面有說明。

  輸出暫存器     輸出暫存器(outregs)參數包含執行中斷以後的暫存器值。它被宣告
                 為 RegType 的記錄資料型態。此使用者自定型態 RegType 在下面
                 有說明。

CALL INTERRUPT 和 CALL INTERRUPTX 敘述用來取代在較早的 BASIC 版本中所使用的
INT86 及 INT86X 常式(routine),他們提供了一種更方便的方法給 BASIC 程式作 DOS
中斷(interrupt)及服務(service)。

CALL INTERRUPT 及 CALL INTERRUPTX 是被放在 QuickBASIC 所提供的磁片內的一個
Quick 程式庫檔(QB.QLB),及一個傳統程式庫檔(QB.LIB)中。為了能方便的使用中斷
程式,在 QuickBASIC 的磁片上也同時有一個標頭檔案(Header file, "QB.BI")來做為
必要的宣告使用。

當在 QuickBASIC 工作環境下執行一個程式,並且使用到 CALL INTERRUPT 或
CALL INTERRUPTX 時, Quick 程式庫檔案 "QB.QLB" 必須被 QuickBASIC 所載入。
關於如何使用這些訊息,請參閱<span class="QH_2">&lt;</span><a href="#L8003">QB 命令行的選擇項</a><span class="QH_2">&gt;</span>。

在呼叫中斷程式前後所使用的暫存器值,是被宣告成 RegType 資料型態的變數來做
傳遞。下列敘述定義 RegType 為使用者定義型態:

  TYPE RegType
     AX AS INTEGER
     BX AS INTEGER
     CX AS INTEGER
     DX AS INTEGER
     BP AS INTEGER
     SI AS INTEGER

  DI AS INTEGER
     FLAGS AS INTEGER
     DS AS INTEGER
     ES AS INTEGER
  END TYPE

每一種型態中的每一個元素對應到 CPU 中的每一個暫存器。

在 INTERRUPTX 敘述中 CPU 上的 DS 與 ES 暫存器是使用資料錄中的元素值,
若要使用目前 CPU 上 DS 與 ES 暫存器的值時,需將資料錄中的元素設為 -1。



<hr>

<span id="L820A" class="QBtitle">CALL INTERRUPT 敘述程式範例</span>
  <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L801D"> Quick 畫面 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="#L8209"> 細節 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 範例 &gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>      <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">CALL INTERRUPT 敘述程式範例</span>

下列使用 INT86OLD 來開啟一個檔案,並且放置一些本文資料到該檔案中。

' 注意:  若使用 CALL INTERRUPT,必須先在啟動 QuickBASIC 時,有載入
'        Quick 程式庫檔(QB.LIB),且此程式會使用 "QB.BI" 這個標頭檔。

' 包含前置檔於 INT86OLD
' $INCLUDE: 'QB.BI'

DIM INARY%(7),OUTARY%(7)          '定義一個 INT86 用的輸入/輸出陣列
'
' 定義暫存器陣列索引以便讓程式更容易瞭解
CONST AX=0, BX=1, CX=2, DX=3, BP=4, SI=5, DI=6, FL=7
'
INARY%(AX) = &H3C00               '使用 DOS 功能來產生一個新的檔案
INARY%(CX) = 0                    '設定 DOS 檔案屬性給新產生的檔案
FOO$="FOO.TXT"+CHR$(0)
INARY%(DX) = SADD(FOO$)
                                  '指到檔案名稱字串的起始位址,若為空字串
                                  '則結束。

CALL INT86OLD(&H21,INARY%(),OUTARY%())
                                  '執行 "產生新檔案" 的功能
'
INARY%(BX) = OUTARY%(AX)          '取得新檔案的檔案代碼(File handle)
INARY%(AX) = &H4000               ' "寫入檔案" 的 DOS 功能呼叫
TEXT$ = "hello, world"+CHR$(13)+CHR$(10)
                                  '定義要寫入檔案的本文資料
INARY%(CX) = LEN(TEXT$)           '取得本文字串的長度
INARY%(DX) = SADD(TEXT$)          '取得本文字串的起始位址
CALL INT86OLD(&H21,INARY%(),OUTARY%())
                                  '執行 "寫入" 的功能
'
INARY%(AX) = &H3E00               ' "關閉檔案" 的 DOS 功能呼叫
CALL INT86OLD(&H21,INARY%(),OUTARY%())
                                  '執行 "關閉新檔案" 的功能


<hr>

<span id="L820B" class="QBtitle">簡化鍵</span>
  <span class="QH_1">&lt; 簡化鍵 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
    ┌插入──────────────┐ ┌複製───────────┐
    │ 插入/覆蓋(replace)的切換    INS│ │ 指定本文         CTRL+INS│
    │ 該行上方            HOME CTRL+N│ └─────────────┘
    │ 該行下方              END ENTER│ ┌找尋────────────┐
    │ 由截取板              SHIFT+INS│ │ 指定的本文         CTRL+\  │
    └────────────────┘ │ 重覆找尋                F3 │
    ┌選取──────────────┐ └──────────────┘
    │ 字元/列(line)       SHIFT+ARROW│ ┌偵錯────────────┐
    │                                │ │ 程式輸出螢幕            F4 │
    └────────────────┘ │ 繼續                    F5 │
    ┌刪除──────────────┐ │ 執行到游標處            F7 │
    │ 該行(同時存入到截取板內) CTRL+Y│ │ 中斷點切換              F9 │
    │ 到該行的最後(同上)     CTRL+Q Y│ │ 單一敘述步驟的執行      F8 │
    │ 指定的本文(同上)      SHIFT+DEL│ │ 程序式步驟的執行       F10 │
    │ 指定的本文(不存入)          DEL│ │ 立即監看          SHIFT+F9 │
    └────────────────┘ └──────────────┘


<hr>

<span id="L820C" class="QBtitle">編輯鍵</span>
  <span class="QH_1">&lt; 編輯鍵 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">編輯鍵</span>

QuickBASIC 智慧型編輯器會認得使用者以他自己熟悉的組合鍵所建立的其他
Microsoft 的程式(例如 Microsoft Word, 和 Wordstar 組合鍵)。在編輯鍵
表格中, WordStar 的等效鍵(組合鍵)被列在右側。

      <span class="QH_2">&lt;</span><a href="#L820D">游標移動鍵</a><span class="QH_2">&gt;</span>
      <span class="QH_2">&lt;</span><a href="#L820E">本文捲動鍵</a><span class="QH_2">&gt;</span>
      <span class="QH_2">&lt;</span><a href="#L820F">藉由下一個命令選取本文並更改之按鍵</a><span class="QH_2">&gt;</span>
      <span class="QH_2">&lt;</span><a href="#L8210">插入並複製本文區之按鍵</a><span class="QH_2">&gt;</span>
      <span class="QH_2">&lt;</span><a href="#L8211">刪除本文區之按鍵</a><span class="QH_2">&gt;</span>



<hr>

<span id="L820D" class="QBtitle">游標移動鍵</span>
  <span class="QH_2">&lt;</span><a href="#L820C"> 編輯鍵 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 移動游標 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
 向左一個字元(character)                    ←                  CTRL+S
 向右一個字元                               →                  CTRL+D
 向左一個字(word)                           CTRL+ ←            CTRL+A
 向右一個字                                 CTRL+ →            CTRL+F
 向上                                       ↑                  CTRL+E
 向下                                       ↓                  CTRL+X
───────────────────────────────────────
 第一個縮排層次                             HOME
 目前行的第一個位置                                             CTRL+Q+S
 下一行的開始                               CTRL+ENTER          CTRL+J
 目前行的結尾                               END                 CTRL+Q+D
───────────────────────────────────────
 視窗的頂端                                                     CTRL+Q+E
 視窗的底端                                                     CTRL+Q+X
───────────────────────────────────────
 模組/程序式的開頭                          CTRL+HOME           CTRL+Q+R
 模組/程序式的結尾                          CTRL+END            CTRL+Q+C
───────────────────────────────────────
 設定標記                                                       CTRL+K+n
 移向標記                                                       CTRL+Q+n
───────────────────────────────────────


<hr>

<span id="L820E" class="QBtitle">本文捲動鍵</span>
  <span class="QH_2">&lt;</span><a href="#L820C"> 編輯鍵 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 捲動 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
     向上一行                             CTRL+↑               CTRL+W
     向下一行                             CTRL+↓               CTRL+Z
     向上一頁                             PGUP                  CTRL+R
     向下一頁                             PGDN                  CTRL+C
───────────────────────────────────────
     向左移一個視窗                       CTRL+PGUP
     向右移一個視窗                       CTRL+PGDN
───────────────────────────────────────


<hr>

<span id="L820F" class="QBtitle">本文選擇鍵</span>
  <span class="QH_2">&lt;</span><a href="#L820C"> 編輯鍵 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 選取本文區 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
     左邊的字元(character)                   SHIFT+ ←
     右邊的字元                              SHIFT+ →
     左邊的一個字(word)                      CTRL+ ←
     右邊的一個字                            CTRL+ →
───────────────────────────────────────
     目前行                                  SHIFT+ ↓
     上面的一行                              SHIFT+ ↑
     向上一個畫面                            SHIFT+PGUP
     向下一個畫面                            SHIFT+PGDN
───────────────────────────────────────


<hr>

<span id="L8210" class="QBtitle">插入及複製鍵</span>
  <span class="QH_2">&lt;</span><a href="#L820C"> 編輯鍵 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 插入及複製 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
 插入模式之開關                                     INS            CTRL+V
───────────────────────────────────────
 將所選取的本文區複製到截取板上,並保留本文          CTRL+INS
───────────────────────────────────────
 拷貝所選定的本文到截取板,並刪除它                  SHIFT+DEL
 拷貝目前行到截取板,並刪除它                                       CTRL+Y
 拷貝至本行尾端的本文到截取板,並刪除它                             CTRL+Q+Y
───────────────────────────────────────
 插入截取板的內容                                   SHIFT+INS
 插入在一行之下                                     END ENTER
 插入在一行之上                                                    HOME+CTRL+N
───────────────────────────────────────


<hr>

<span id="L8211" class="QBtitle">刪除鍵</span>
  <span class="QH_2">&lt;</span><a href="#L820C"> 編輯鍵 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 刪除 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
 向左刪除一個字元(character)                        BKSP           CTRL+H
 刪除目前游標上的字元                               DEL            CTRL+G
 刪除游標所在的一個字(word)                                        CTRL+T
───────────────────────────────────────
 刪除所選定的本文                                   DEL            CTRL+G
 刪除所選定行的前導空白字元                         SHIFT+TAB
───────────────────────────────────────


<hr>

<span id="L8212" class="QBtitle">偵錯鍵</span>
  <span class="QH_1">&lt; 偵錯鍵 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
 從頭開始執行程式                                          SHIFT+F5
 由目前敘述繼續執行程式                                    F5
 執行程式至目前游標所在的位置                              F7
───────────────────────────────────────
 以一個敘述的執行視為一個步驟                              F8
 將整個程序式的呼叫視為一個步驟                            F10
 往回追溯每一步驟執行的流程情形                            SHIFT+F8
 向前追蹤每一步驟執行的流程情形                            SHIFT+F10
───────────────────────────────────────
 [D/偵錯] 功能表 "中斷點切換" 命令                         F9
 立即監看 (使用滑鼠時,簡化鍵是 SHIFT+滑鼠右鍵)             SHIFT+F9
───────────────────────────────────────


<hr>

<span id="L8213" class="QBtitle">景象鍵</span>
  <span class="QH_1">&lt; 景象鍵 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
 輸出畫面及景象視窗的切換                                  F4
───────────────────────────────────────
 顯示出所有載入的 SUB,模組或檔案之清單                     F2
 顯示下一個程序式                                          SHIFT+F2
 顯示前一個程序式                                          CTRL+F2
───────────────────────────────────────
 使下一個視窗成為有效視窗                                  F6
 使前一個視窗成為有效視窗                                  SHIFT+F6
───────────────────────────────────────
 切換有效視窗成為全螢幕,或多視窗螢幕                       CTRL+F10
 擴大有效視窗的大小                                        ALT+加號
 縮小有效視窗的大小                                        ALT+減號
───────────────────────────────────────



<hr>

<span id="L8214" class="QBtitle">援助鍵</span>
  <span class="QH_1">&lt; 援助鍵 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
 進入 [H/援助] 主功能表,顯示目前游標所在的 QuickBASIC       F1(或觸動滑鼠右鍵)
 之關鍵字,函數或敘述有關的訊息

 由螢幕清除援助訊息,結束援助功能                            ESC
───────────────────────────────────────
 查看線上援助                                               SHIFT+F1
 透過[H/援助]功能表命令查看援助                             ALT+H
───────────────────────────────────────
 移動游標到下一個關係鏈(hyperlink)                          TAB
 移動游標到前一個關係鏈                                     SHIFT+TAB
 移動游標到下一個關係鏈的起始字元上                         英文字母鍵
 移動游標到前一個關係鏈的起始字元上                         SHIFT+英文字母鍵
 參閱前一個關係鏈的主題(最多可以重覆按 20 次)               ALT+F1
───────────────────────────────────────
 參閱儲存在援助檔案內的下一個援助主題                       CTRL+F1
───────────────────────────────────────


<hr>

<span id="L8215" class="QBtitle">QuickBASIC 的限制</span>
  <span class="QH_1">&lt; QuickBASIC 的限制 &gt;</span>         <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>         <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 的限制</span>

在 QuickBASIC 中對於程式中元件(object)的大小和數值,是有一定的限制。

  <span class="QH_1">限制內容                             最大值和最小值</span>

  <span class="QH_2">&lt;</span><a href="#L8216">名稱,字串及數值</a><span class="QH_2">&gt;</span>                    變數名稱長度,字串長度,數值。

  <span class="QH_2">&lt;</span><a href="#L8217">陣列</a><span class="QH_2">&gt;</span>                               大小,維數,註標值大小。

  <span class="QH_2">&lt;</span><a href="#L8218">程序式和檔案</a><span class="QH_2">&gt;</span>                       參數的數目,記錄數目,錯誤訊息數目。

  <span class="QH_2">&lt;</span><a href="#L8219">編輯</a><span class="QH_2">&gt;</span>                               在不同的本文框內可以輸入的
                                       字元數,及在不同視窗中的行數。


<hr>

<span id="L8216" class="QBtitle">名稱,字串及數值的限制</span>
  <span class="QH_2">&lt;</span><a href="#L8215"> QuickBASIC 的限制 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 名稱,字串及數值 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 的限制-名稱,字串和數值</span>
                                       最大值                  最小值
變數名稱長度                           40 個英文字元           1 個英文字元
字串長度                               32,767 個位元組         0 個位元組
整數                                   32,767                 -32,768
長整數                                 2,147,483,647          -2,147,483,648
單精確度數字(正值)                     3.402823 E+38           1.401298 E-45
單精確度數字(負值)                    -1.401298 E-45          -3.402823 E+38
倍精確度數字(正值)
                          最大值 :     1.797693134862315 D+308
                          最小值 :     4.940656458412465 D-324
倍精確度(負值)
                          最大值 :    -4.940656458412465 D-324
                          最小值 :    -1.797693134862315 D+308


<hr>

<span id="L8217" class="QBtitle">陣列限制</span>
  <span class="QH_2">&lt;</span><a href="#L8215"> QuickBASIC 的限制 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 陣列 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 的限制-陣列</span>

                                       最大值                 最小值
陣列大小(所有元素)
  靜態                                 65,535 個位元組(64 K)   1
  動態                                 可允許使用的記憶體空間
允許的維數大小                         8                       1
陣列註標(subscript)值                  32,767                 -32,768

  注意: 在陣列註標值之間最大值的範圍是 32,767


<hr>

<span id="L8218" class="QBtitle">程序式和檔案的限制</span>
  <span class="QH_2">&lt;</span><a href="#L8215"> QuickBASIC 的限制 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 檔案和程序式 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 的限制-程序式和檔案</span>
                                       最大值                最小值
程序式的大小(直譯的-interpreted)       65,535 個位元組(64 K)   0
被傳遞參數的數目                       60 個直譯過的           0
巢狀(nested)內含檔之層數               5 層                    0
模組的大小(編譯的-compiled)            65,535 個位元組(64 K)   0
資料檔的數目                           255                     1
資料檔案記錄的數目                     2,147,483,647           1
資料檔案記錄大小(位元組)               32,767 個位元組(32 K)   1 個位元組
資料檔案的大小                         可用的磁碟空間          0
路徑名稱                               127 個位元組            1 個位元組
錯誤訊息的代號                         255                     1


<hr>

<span id="L8219" class="QBtitle">編輯的限制</span>
  <span class="QH_2">&lt;</span><a href="#L8215"> QuickBASIC 的限制 </a><span class="QH_2">&gt;</span>   <span class="QH_1">&lt; 編輯 &gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>   <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">QuickBASIC 的限制-編輯</span>
                                       最大值                  最小值
本文框的輸入                           127 個位元組            0 個位元組
"搜尋"字串                             79 個位元組             1 個位元組
"取代"字串                             39 個位元組             0 個位元組
位置定位器                             4                       0
監看點 和/或 監看運算式                8                       0
在立即執行視窗的行(line)數             10                      0
景象視窗內一行的英文字元數             255                     0
COMMAND$ 字串的長度                    124 個位元組            0 個位元組


<hr>

<span id="L821A" class="QBtitle">語法表示符號</span>
  <span class="QH_1">&lt; 語法表示符號 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">如何閱讀線上援助訊息內語法表示符號</span>

關鍵字                 關鍵字是一個敘述語法中必備的部份,或者是已經使用
                       角括號括起來。請記得,您必須將關鍵字拼正確。

位置定位器             位置定位器的資訊必須放在敘述中,例如:一個檔案名稱。

[選擇項]               在方形中括號裡的項目,可以不必使用在敘述中。

{選擇1 | 選擇2}        大括號和一垂直線,表示可以在兩個項目或多項間選擇一項。
                       您必須在敘述中使用其中的一個項目,但大括號在方括號內
                       除外。


另外一個符號的習慣用法是: 用連續三點來當作省略符號:

   項目, 項目, ...      表示在單行敘述中有更多的處理項目。

   開始的關鍵字
     [敘述區段]         用來描述多行敘述(或區段結構敘述),表示其他
                        可以用在關鍵字的開始與結束之間的敘述。
   結束的關鍵字


這裡有一個使用 PRINT 敘述的語法範例:

  <span class="QH_1">語法:</span>
    PRINT [運算式串列][{,|;}]

  用上面的語法規則,下列這些敘述都是合乎語法的 PRINT 敘述:
    PRINT
    PRINT x
    PRINT x, y + 1
    PRINT x,
    PRINT x;
    PRINT x + y + z, a - 1, b / 2;

  以及更多更多。


<hr>

<span id="L821B" class="QBtitle">由程式任務列出敘述和函數</span>
  <span class="QH_1">&lt; 程式任務 &gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>           <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">BASIC 敘述和函數的程式任務清單</span>

程式任務                                 在清單中關鍵字的例子
<span class="QH_2">&lt;</span><a href="#L821C">建立迴圈並選擇結構</a><span class="QH_2">&gt;</span>                    FOR...NEXT, DO...LOOP, IF...THEN,
                                        SELECT

<span class="QH_2">&lt;</span><a href="#L821D">定義並呼叫程序式</a><span class="QH_2">&gt;</span>                      DECLARE, FUNCTION...END FUNCTION,
                                        SUB...END SUB, CALL

<span class="QH_2">&lt;</span><a href="#L821E">裝置輸入/輸出</a><span class="QH_2">&gt;</span>                         PRINT, PRINT USING, LPRINT, INPUT$

<span class="QH_2">&lt;</span><a href="#L821F">檔案輸入/輸出</a><span class="QH_2">&gt;</span>                         OPEN, WRITE #, INPUT #, GET, PUT, EOF

<span class="QH_2">&lt;</span><a href="#L8220">字串的處理及轉換</a><span class="QH_2">&gt;</span>                      LEFT$, MID$, RIGHT$, LEN, INSTR

<span class="QH_2">&lt;</span><a href="#L8221">繪圖影像的顯示</a><span class="QH_2">&gt;</span>                        SCREEN, DRAW, COLOR, PALETTE, PAINT

<span class="QH_2">&lt;</span><a href="#L8222">對事件和錯誤設陷的設定</a><span class="QH_2">&gt;</span>                ON KEY GOSUB, ON ERROR GOTO, RESUME


<hr>

<span id="L821C" class="QBtitle">控制流程的敘述</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 控制流程 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">在迴圈及選擇結構中使用的敘述</span>

任務               敘述                       動作

迴圈               <a href="qb45qck.hlp.html#L8055">FOR...NEXT</a>        在一個指定的次數內重覆執行
                                     在 FOR 和 NEXT 之間的敘述。

                   <a href="qb45qck.hlp.html#L804F">EXIT FOR</a>          離開 FOR...NEXT 迴圈的另一種方法。

                   <a href="qb45qck.hlp.html#L8044">DO...LOOP</a>         重覆執行 DO 和 LOOP 之間的敘述,
                                     直到所給的條件為真才停止(DO...LOOP
                                     UNTIL 條件),或者當給予的條件為假時,
                                     (DO...LOOP WHILE 條件)才停止。

                   <a href="qb45qck.hlp.html#L804F">EXIT DO</a>           離開 DO...LOOP 迴圈的另一種方法。

                   <a href="qb45qck.hlp.html#L8043">WHILE...WEND</a>      當指定的條件為真時,重覆執行 WHILE 和
                                     WEND 間的敘述。(與 DO WHILE 條件...LOOP
                                     類似)

做選擇             <a href="qb45qck.hlp.html#L805E">IF...THEN...ELSE</a>  有條件地執行或分歧到不同的敘述。

                   <a href="qb45qck.hlp.html#L80A8">SELECT CASE</a>       有條件地執行不同的敘述。


<hr>

<span id="L821D" class="QBtitle">建立程序式的敘述</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 程序式 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">下面的敘述用來定義,呼叫程序式;或在程序式之間共用資料 :</span>

任務              敘述                             作用

定義一個          <a href="qb45qck.hlp.html#L8058">FUNCTION...END FUNCTION</a>  分別對每一個 FUNCTION 程序式的
程序式                                     開頭和結尾做標記。

                  <a href="qb45qck.hlp.html#L80BA">SUB...END SUB</a>            分別對每一個 SUB 程序式的
                                           開頭和結尾做標記。

呼叫一個         <a href="qb45qck.hlp.html#L801A">CALL</a>                      將控制權轉移到一個 BASIC 的 SUB
程序式                                     程序式,或是一個用其他語言程式編寫
                                           並且分開編譯的程序式(關鍵字 CALL
                                           可選用)。

離開一個          <a href="qb45qck.hlp.html#L804F">EXIT FUNCTION</a>            離開 FUNCTION 程序式的
程序式                                     另一種方法。

                  <a href="qb45qck.hlp.html#L804F">EXIT SUB</a>                 離開 SUB 程序式的另一種方法。

在一個程序        <a href="qb45qck.hlp.html#L803E">DECLARE</a>                  選擇性地宣告一個 FUNCTION 或
式被定義之                                 SUB 程序式,並指明其參數的個數
前參考到它                                 及型態。

在不同的          <a href="qb45qck.hlp.html#L8032">COMMON</a>                   在個別的模組中共用變數。
模組程序式                                 在與 SHARED 屬性共用時,表示
間,程式間                                  可在同一個模組內不同的程序式
共用變數                                   之間共用變數。此外,當控制權
                                           以 CHAIN 敘述轉移時,會將變數
                                           的值由目前的程式傳入新的程式。

                  <a href="qb45qck.hlp.html#L80AB">SHARED</a>                   在模組層次碼中與 COMMON, DIM,
                                           或 REDIM 敘述共用時(例如,
                                           DIM SHARED),可在單一模組內的
                                           每一個 SUB 或 FUNCTION 程序式
                                           中共用變數。
                                           在程序式中單獨使用時,可在該
                                           程序式和模組層次碼中共用變數。

保留變數          <a href="qb45qck.hlp.html#L80B3">STATIC</a>                   迫使變數成為一個程序式,或
之值                                       DEF FN 函數的區域變數,並且在
                                           程序式或函數結束後,仍保留變數
                                           之值,以便下次再呼叫時使用。

定義一個          <a href="qb45qck.hlp.html#L803F">DEF FN...END DEF</a>         分別對多行式 DEF FN 函數標明
多行函數                                   起始行和結束行。(這是 BASIC 函數
                                           的舊型態,而 FUNCTION 程序式
                                           可以提供更強的功能。)

離開一個          <a href="qb45qck.hlp.html#L804F">EXIT DEF</a>                 提供另一種方式來離開多行式
多行函數                                   的 DEF FN 函數。


呼叫一個          <a href="qb45qck.hlp.html#L805B">GOSUB</a>                    將控制權轉移到模組內的指定行。
BASIC                                      控制會以 RETURN 敘述由次常式
次常式                                     中回到 GOSUB 後的敘述行。(此
                                           為 BASIC 次常式的舊型式,而
                                           SUB 程序式可以提供更強大的
                                           功能。

轉移到另          <a href="qb45qck.hlp.html#L8021">CHAIN</a>                    將控制權由目前的程式轉移到
一個程式                                   另一個程式,再利用 COMMON 將
                                           變數傳入到另一個新程式。


<hr>

<span id="L821E" class="QBtitle">裝置輸入/輸出的敘述和函數</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 裝置輸入/輸出 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">使用在裝置輸入/輸出的敘述和函數</span>

任務                        敘述或函數             作用

在螢幕上列印本文            <a href="qb45qck.hlp.html#L8096">PRINT</a>            輸出本文(text)到螢幕。

                            <a href="#L804D">PRINT USING</a>      輸出格式化的本文到螢幕上。

改變輸出行的寬度            <a href="qb45qck.hlp.html#L80CE">WIDTH</a>            將螢幕的寬度改變。

                            <a href="qb45qck.hlp.html#L80CE">WIDTH "SCRN:"</a>    當使用在 OPEN "SCRN:" 敘述
                                             之前,可指定輸出到螢幕的最大
                                             列寬度(line width)。

從鍵盤上取得輸入            <a href="qb45qck.hlp.html#L8060">INKEY$</a>           由鍵盤讀取一個字元。

                            <a href="qb45qck.hlp.html#L8063">INPUT$</a>           由鍵盤上讀取指定個數的
                                             字元,並將它們存到單一字串
                                             變數中。

                            <a href="qb45qck.hlp.html#L8062">INPUT</a>            從鍵盤上讀取輸入的資料,並
                                             存到一連串的變數中。

                            <a href="#L8043">LINE INPUT</a>       由鍵盤上讀取一行的輸入資料
                                             ,並存到單一字串變數中。

在螢幕上為游標定位          <a href="qb45qck.hlp.html#L8072">LOCATE</a>           將游標移動到指定的列
                                             (Row)和行(Column)位置上。

                            <a href="qb45qck.hlp.html#L80B1">SPC</a>              在列印的輸出資料上空出空白。

                            <a href="qb45qck.hlp.html#L80BD">TAB</a>              在指定的行(column)位置上
                                             輸出資料。

從游標位置取得訊息          <a href="qb45qck.hlp.html#L8035">CPOS</a>             傳回由第一個字元到所給定參數
                                             位置間的個數(以位元組為單位)。

                            <a href="qb45qck.hlp.html#L8038">CSRLIN</a>           傳回目前游標所在的列(row)
                                             位置。

                            <a href="qb45qck.hlp.html#L8094">POS(n)</a>           傳回目前游標所在的行(column)
                                             位置。

產生一個本文景象埠          <a href="#L8055">VIEW PRINT</a>       設定可以顯示本文資料的最頂端和
                                             最底端之列(Row)範圍。


<hr>

<span id="L821F" class="QBtitle">檔案輸入/輸出的敘述和函數</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 檔案輸入/輸出 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">使用在檔案輸入/輸出的敘述和函數</span>

任務                        敘述或函數             作用

產生一個新的檔案或存取      <a href="qb45qck.hlp.html#L8086">OPEN</a>             開啟一個檔案以便讀取或寫入
一個已存在的檔案                             資料錄(Records)。

關閉一個檔案                <a href="qb45qck.hlp.html#L802B">CLOSE</a>            結束一個檔案的輸入/輸出。

儲存資料到一個檔案內        <a href="#L804E">PRINT #</a>          儲存一連串的變數到一個先前
                                             已開啟的循序檔案中的資料錄
                                             欄位(Record Fields)內。

                            <a href="#L804E">PRINT USING #</a>    與 PRINT # 相似,但 PRINT
                                             USING # 會將資料錄的欄位
                                             格式化。

                            <a href="qb45qck.hlp.html#L80D0">WRITE #</a>          儲存一連串的變數到一個先前已
                                             開啟的循序檔中之資料錄欄位內。

                            <a href="qb45qck.hlp.html#L80CE">WIDTH</a>            指定一個標準長度給循序檔中
                                             的每一個資料錄。

                            <a href="qb45qck.hlp.html#L805A">PUT</a>              儲存一個使用者定義的變數
                                             內容到一個先前已開啟的
                                             二進位檔或隨機存取檔中。

由檔案中擷取資料            <a href="qb45qck.hlp.html#L8024">CINPUT$</a>          傳回由指定檔案所讀取的
                                             字元字串。

                            <a href="#L8041">INPUT #</a>          從一個循序檔中讀取一個
                                             記錄,並將記錄中的每一欄位
                                             指定給程式中的變數。

                            <a href="qb45qck.hlp.html#L8063">INPUT$</a>           從一個檔案中讀取一組字元
                                             (以位元組為計算單位)字串。

                            <a href="#L8044">LINE INPUT #</a>     從一個循序檔中讀取一個
                                             記錄,並且把它存到一個單一
                                             字串變數中。

                            <a href="qb45qck.hlp.html#L8059">GET</a>              從二進位或隨機存取檔中讀取
                                             資料,並將資料指定給一個
                                             使用者自定變數內的元素。

管理磁碟上的檔案            <a href="qb45qck.hlp.html#L8053">FILES</a>            列出在指定目錄內的所有檔案。

                            <a href="qb45qck.hlp.html#L8057">FREEFILE</a>         傳回下一個可用的檔案代碼。

                            <a href="qb45qck.hlp.html#L806A">KILL</a>             由磁碟上刪除一個檔案。

                            <a href="qb45qck.hlp.html#L8080">NAME</a>             改變一個檔案的名稱。

取得檔案訊息                <a href="qb45qck.hlp.html#L8049">EOF</a>              測試是否所有的資料都已經從
                                             檔案中讀取完畢。

                            <a href="qb45qck.hlp.html#L8052">FILEATTR</a>         傳回經由作業系統指定給一個
                                             開啟檔案的代碼,以及代表該
                                             檔案開啟時的存取模式(INPUT,
                                             OUTPUT,APPEND,BINARY,或
                                             RANDOM)。

                            <a href="qb45qck.hlp.html#L8071">LOC</a>              傳回目前檔案指標的位置。
                                             在二進位存取模式中,它傳回
                                             位元組的位置。在循序存取
                                             模式中,則傳回位元組位置,
                                             並將此值除以 128。在隨機
                                             存取模式中,則傳回上次被
                                             讀/寫的記錄代碼。

                            <a href="qb45qck.hlp.html#L8074">LOF</a>              傳回已開啟檔案的位元組數目。

                            <a href="#L8051">SEEK (函數)</a>      傳回下次將發生輸入/輸出操作
                                             的位置。在隨機存取模式中這是
                                             傳回下次將讀/寫記錄的記錄代碼。
                                             其它別種檔案存取,均傳回下次將
                                             讀/寫的位元組位置。

移動檔案裡的指標            <a href="qb45qck.hlp.html#L80A7">SEEK (敘述)</a>      設定在已開啟的檔案中,下次將被
                                             讀/寫的位元組位置。


<hr>

<span id="L8220" class="QBtitle">處理字串的敘述和函數</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>    <span class="QH_1">&lt; 字串處理 &gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>    <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">使用在字串處理的敘述和函數</span>

任務                    敘述或函數                    動作

取得部分字串            <a href="qb45qck.hlp.html#L8020">CEXT$</a>              傳回在字串運算式中一個指定的
                                           型態字元(英文或中文字元)所組成
                                           的字串。

                        <a href="qb45qck.hlp.html#L802D">CMID$(函數)</a>        除了以 "字元" 為計算單位
                                           以外,其他均與 MID 函數相容。

                        <a href="qb45qck.hlp.html#L806D">LEFT$</a>              從一個字串的最左邊傳回
                                           所給定數目的字元字串。

                        <a href="qb45qck.hlp.html#L80A0">RIGHT$</a>             從一個字串的最右邊傳回
                                           所給定數目的字元字串。

                        <a href="qb45qck.hlp.html#L807A">LTRIM$</a>             傳回一個將字串之前導空白刪除
                                           後的字串。

                        <a href="qb45qck.hlp.html#L80A3">RTRIM$</a>             傳回一個將字串尾隨之空白刪除
                                           後的字串。

                        <a href="#L8045">MID$(函數)</a>         傳回在字串中的任意地方取出
                                           任意位元組數目的字串。

尋找字串                <a href="qb45qck.hlp.html#L8025">CINSTR</a>             除了以 "字元" 為計算單位
                                           以外,其他均與 INSTR 函數相容。

                        <a href="qb45qck.hlp.html#L8064">INSTR</a>              傳回一個字串在另一個字串內
                                           出現的位置。

轉換成大寫              <a href="qb45qck.hlp.html#L801F">CDBL$</a>              傳回一個將字串中佔 1 個位元組
字母,或小寫                                長度的英文字元,轉換成佔 2 個
字母                                       位元組長度的中文字元。

                        <a href="qb45qck.hlp.html#L8037">CSNG$</a>              傳回一個將字串中佔 2 個位元組
                                           長度的中文字元,轉換成佔 1 個
                                           位元組長度的英文字元。

                        <a href="qb45qck.hlp.html#L806C">LCASE$</a>             傳回一個將字串中所有的大寫字母
                                           (A-Z),轉換成小寫字母(a-z);而
                                           原來的小寫字母和其他字元維持
                                           不變。

                        <a href="qb45qck.hlp.html#L80C5">UCASE$</a>             傳回一個將字串中所有的小寫字母
                                           (a-z)轉換成大寫字母(A-Z);而
                                           原來的大寫字母和其他字元維持
                                           不變。

改變字串                <a href="qb45qck.hlp.html#L802E">CMID$(敘述)</a>        除了以 "字元" 為計算單位
                                           以外,其他均與 MID$ 敘述相容。

                        <a href="qb45qck.hlp.html#L807B">MID$(敘述)</a>         以另一個字串取代原字串中的
                                           某一部分。

                        <a href="qb45qck.hlp.html#L8078">LSET</a>               在一個固定長度字串中將一個
                                           字串向左靠齊。

                        <a href="qb45qck.hlp.html#L8079">RSET</a>               在一個固定長度字串中將一個
                                           字串向右靠齊。

在數值與字串之間轉換    <a href="qb45qck.hlp.html#L80B7">STR$</a>               傳回將一個數值運算式之值
                                           以字串方式表示。

                        <a href="qb45qck.hlp.html#L80C9">VAL</a>                傳回一個數值運算式的數值。

將數值轉換成資料檔      <a href="qb45qck.hlp.html#L803A">CV型態</a>             將程式中以舊的 BASIC 版本所
之字串,以及將資料                          產生的隨機存取檔案中所用到的,
檔之字串轉換成數值                         且以字串方式儲存的數值轉換為
                                           Microsoft 二進位格式的數值。

                        <a href="qb45qck.hlp.html#L8039">CV型態MBF</a>          將以 Microsoft 二進位格式
                                           字串儲存的數值轉換成 IEEE 格式
                                           的數值。

                        <a href="qb45qck.hlp.html#L807E">MK型態$</a>            將以 Microsoft 二進位格式數值
                                           轉換成適用於存入早期 BASIC 版本
                                           所產生的隨機存取檔案中的字串。

                        <a href="qb45qck.hlp.html#L807D">MK型態MBF$</a>         將 IEEE 格式數值轉換成為
                                           Microsoft 二進位格式之字串。

產生重覆字元的字串      <a href="qb45qck.hlp.html#L80B0">SPACE$</a>             傳回一個有指定長度的空白字串。

                        <a href="qb45qck.hlp.html#L80B9">STRING$</a>            傳回由一個重覆的單一字元
                                           所組成的字串。

取得字串的長度          <a href="qb45qck.hlp.html#L8029">CLEN</a>               除了以 "字元" 為計算單位以外,
                                           其他均與 LEN 函數相容。

                        <a href="qb45qck.hlp.html#L806E">LEN</a>                傳回一個字串的長度(以 "位元組"
                                           為計算單位)。

傳回 ASCII 碼           <a href="qb45qck.hlp.html#L8012">ASC</a>                傳回一個給定字元的 ASCII 碼,
或中文碼                                   或中文碼。

                        <a href="qb45qck.hlp.html#L8023">CHR$</a>               傳回由給定的 ASCII 碼所對應的
                                           英文字元,或中文字元。



<hr>

<span id="L8221" class="QBtitle">繪圖的敘述及函數</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 繪圖 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">顯示繪圖影像的敘述及函數</span>

任務                    敘述或函數               動作

設定螢幕                <a href="qb45qck.hlp.html#L80A6">SCREEN</a>        設定 BASIC 螢幕模式,用來決定螢幕
顯示的特性                            特性,例如解析度及顏色數目的範圍。

塗或擦一個點(圖素)      <a href="qb45qck.hlp.html#L8097">PSET</a>          以螢幕的前景顏色為預設的顏色,
                                      在螢幕上畫出一個圖素(pixel)。

                        <a href="qb45qck.hlp.html#L8095">PRESET</a>        以螢幕的背景顏色為預設的顏色,
                                      在螢幕上畫出一個圖素--實際上是清除
                                      此圖素(pixel)。

在螢幕上畫              <a href="qb45qck.hlp.html#L8070">LINE</a>          畫出直線或方框。
簡單的形狀
                        <a href="qb45qck.hlp.html#L8027">CIRCLE</a>        畫出圓形或橢圓形。

                        <a href="qb45qck.hlp.html#L8045">DRAW</a>          組合許多 BASIC 圖形敘述的特性
                                      (如畫線,移動圖形游標,放大圖形..等)
                                      成為一個多種功能的繪圖巨集語言。

定義螢幕座標            <a href="qb45qck.hlp.html#L80CC">VIEW</a>          在螢幕上指定一個矩形(或稱景象埠)
                                      當作將來繪圖的輸出區域。

                        <a href="qb45qck.hlp.html#L80CF">WINDOW</a>        允許使用者在螢幕的景象埠上
                                      建立一個邏輯座標系統。

                        <a href="qb45qck.hlp.html#L8091">PMAP</a>          將實際圖素座標對應到使用者在目前
                                      的視窗中所指定的景象座標,反之亦然。

                        <a href="qb45qck.hlp.html#L8092">POINT(數值)</a>   依據數值參數,傳回圖形游標所在
                                      的實際座標或景象座標。

使用顏色                <a href="qb45qck.hlp.html#L802F">COLOR</a>         設定繪圖(graphic)或本文(text)螢幕
                                      模式輸出的預設顏色。

                        <a href="qb45qck.hlp.html#L808C">PALETTE</a>       指定不同的顏色給顏色屬性暫存器,
                                      僅能在配有 EGA 或 VGA 的顯示卡
                                      中使用。

                        <a href="qb45qck.hlp.html#L8092">POINT(x,y)</a>    傳回在螢幕座標(x,y)點,單一圖素
                                      (pixel)上的顏色。

封閉圖形著色            <a href="qb45qck.hlp.html#L808B">PAINT</a>         以顏色或圖案塗滿螢幕上的一個
                                      區域。

動畫                    <a href="#L8040">GET</a>           將圖形之影像轉換成數值資料,並將
                                      這些資料儲存到一個數值陣列中,以便
                                      將來可以複製到螢幕上另一個矩形區域。

                        <a href="#L804F">PUT</a>           在螢幕上顯示一個先前以 GET 所
                                      儲存的影像資料。

                        <a href="qb45qck.hlp.html#L808D">PCOPY</a>         拷貝一個螢幕分頁到另一個分頁上。



<hr>

<span id="L8222" class="QBtitle">事件和錯誤設陷的敘述及函數</span>
  <span class="QH_2">&lt;</span><a href="#L821B"> 程式任務 </a><span class="QH_2">&gt;</span>     <span class="QH_1">&lt; 設陷 &gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8006"> 內容 </a><span class="QH_2">&gt;</span>     <span class="QH_2">&lt;</span><a href="qb45qck.hlp.html#L8007"> 索引 </a><span class="QH_2">&gt;</span>
───────────────────────────────────────
<span class="QH_1">使用在事件和錯誤設陷的敘述及函數</span>

任務               敘述或函數                           動作

當程式執行時       <a href="#L8046">ON ERROR GOTO 行號</a>       當程式執行中發生錯誤時可
設陷錯誤                                    造成分歧。引起一個程式分歧
                                            到指定的行號,此行號參數表示
                                            一個敘述的行號或標記。

                   <a href="qb45qck.hlp.html#L809E">RESUME</a>                   在執行一個錯誤處理常式之後,會
                                            將控制權傳回原來的程式。程式可
                                            以從造成錯誤的敘述(RESUME [0])
                                            或由造成錯誤的下一敘述(RESUME
                                            NEXT),或由行號所指示的敘述行
                                            (RESUME 行號)來恢復程式的執行。

取得               <a href="qb45qck.hlp.html#L804D">ERR</a>                      傳回一個執行期間(run-time)
錯誤狀態的                                  所發生的錯誤代號。
資料
                   <a href="qb45qck.hlp.html#L804D">ERL</a>                      傳回發生錯誤的敘述行之行號
                                            (如果程式內有行號時)。

                   <a href="qb45qck.hlp.html#L804C">ERDEV</a>                    傳回最近一個由 DOS 偵測到
                                            有錯誤的裝置(device)之錯誤代碼。

                   <a href="qb45qck.hlp.html#L804C">ERDEV$</a>                   傳回最近一個由 DOS 偵測到有
                                            錯誤的裝置名稱。

定義您自用的       <a href="qb45qck.hlp.html#L804E">ERROR</a>                    模擬一個 BASIC 錯誤的發生,
錯誤代碼                                    也可以被用來定義一個 BASIC
                                            沒有設陷的錯誤。

當程式執行時       <a href="#L813B">ON 事件 GOSUB 行號</a>       當指定的事件在執行中發生時,會
處理事件                                    分歧到次常式的起始行。行號參數
                                            可以是一個敘述的行號或行標記。

                   <a href="qb45qck.hlp.html#L8085">事件 ON</a>                  啟動指定事件的設陷。

                   <a href="qb45qck.hlp.html#L8084">事件 OFF</a>                 關閉指定事件的設陷。

                   <a href="qb45qck.hlp.html#L80B6">事件 STOP</a>                暫停指定事件的設陷。

                   <a href="qb45qck.hlp.html#L809F">RETURN</a>                   當事件處理常式執行完畢後,會將
                                            控制權傳回原程式。程式可自發生
                                            事件之後(RETURN),或以行號所指定
                                            的敘述(RETURN 行號)處恢復執行。


<hr>

<span id="L8223" class="QBtitle">ASCII 字元碼表</span>
             <span class="QH_1">正常的 ASCII 碼表(字元碼 0 - 127)</span>
000 (nul)  016 (dle)  032 sp  048 0  064 @  080 P  096 &gt;  112 p
001 (soh)  017 (dc1)  033 !   049 1  065 A  081 Q  097 a  113 q
002 (stx)  018 (dc2)  034 "   050 2  066 B  082 R  098 b  114 r
003 (etx)  019 (dc3)  035 #   051 3  067 C  083 S  099 c  115 s
004 (eot)  020 (dc4)  036 $   052 4  068 D  084 T  100 d  116 t
005 (enq)  021 (nak)  037 %   053 5  069 E  085 U  101 e  117 u
006 (ack)  022 (syn)  038 &   054 6  070 F  086 V  102 f  118 v
007 (bel)  023 (etb)  039 '   055 7  071 G  087 W  103 g  119 w
008 (bs)   024 (can)  040 (   056 8  072 H  088 X  104 h  120 x
009 (tab)  025 (em)   041 )   057 9  073 I  089 Y  105 i  121 y
010 (lf)   026 (eof)  042 *   058 :  074 J  090 Z  106 j  122 z
011 (vt)   027 (esc)  043 +   059 ;  075 K  091 [  107 k  123 {
012 (np)   028 (fs)   044 ,   060 &lt;  076 L  092 \  108 l  124 |
013 (cr)   029 (gs)   045 -   061 =  077 M  093 ]  109 m  125 }
014 (so)   030 (rs)   046 .   062 &gt;  078 N  094 ^  110 n  126 &lt;
015 (si)   031 (us)   047 /   063 ?  079 O  095 _  111 o  127 Del

注意 : (1). ASCII 碼 00 - 31 的字型,請參考 QuickBASIC 使用手冊
            "BASIC 程式設計手冊" 內的附錄 D 。

       (2). ASCII 碼 128 - 255 已被拿來當成中文字元碼使用。


<hr>

</pre></div></div></body></html>